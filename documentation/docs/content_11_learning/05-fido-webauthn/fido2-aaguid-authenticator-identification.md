---
sidebar_position: 9
---

# AAGUID - èªè¨¼å™¨ã®ãƒ¢ãƒ‡ãƒ«è­˜åˆ¥å­

---

## æ¦‚è¦

**AAGUIDï¼ˆAuthenticator Attestation Globally Unique Identifierï¼‰** ã¯ã€WebAuthn/FIDO2 ã«ãŠã‘ã‚‹èªè¨¼å™¨ï¼ˆAuthenticatorï¼‰ã®ãƒ¢ãƒ‡ãƒ«ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®128ãƒ“ãƒƒãƒˆUUIDã§ã™ã€‚

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§å­¦ã¹ã‚‹ã“ã¨**:
- AAGUID ã®å½¹å‰²ã¨ç”¨é€”
- AAGUID ã®å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨å ´æ‰€
- FIDO Metadata Serviceï¼ˆMDSï¼‰ã¨ã®é€£æº
- ä¸»è¦ãªèªè¨¼å™¨ã® AAGUID ä¸€è¦§
- ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã§ã®æ´»ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

---

## AAGUID ã¨ã¯

### åŸºæœ¬æ¦‚å¿µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AAGUID ã®ä½ç½®ã¥ã‘                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  èªè¨¼å™¨ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆè£½å“ãƒ©ã‚¤ãƒ³ï¼‰                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  YubiKey 5 NFC                                                       â”‚   â”‚
â”‚  â”‚  AAGUID: ee882879-721c-4913-9775-3dfcce97072a                       â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚ å€‹ä½“ A   â”‚  â”‚ å€‹ä½“ B   â”‚  â”‚ å€‹ä½“ C   â”‚  â”‚ å€‹ä½“ D   â”‚  ...       â”‚   â”‚
â”‚  â”‚  â”‚ (åŒã˜    â”‚  â”‚ (åŒã˜    â”‚  â”‚ (åŒã˜    â”‚  â”‚ (åŒã˜    â”‚            â”‚   â”‚
â”‚  â”‚  â”‚  AAGUID) â”‚  â”‚  AAGUID) â”‚  â”‚  AAGUID) â”‚  â”‚  AAGUID) â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ã€ç‰¹å¾´ã€‘                                                                    â”‚
â”‚  - åŒã˜ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®èªè¨¼å™¨ã¯åŒã˜ AAGUID ã‚’å…±æœ‰                    â”‚
â”‚  - å€‹ã€…ã®èªè¨¼å™¨ã‚’è­˜åˆ¥ã™ã‚‹ã‚‚ã®ã§ã¯ãªã„ï¼ˆãã‚Œã¯ credentialIdï¼‰                  â”‚
â”‚  - è£½é€ å…ƒãŒ FIDO Alliance ã«ç™»éŒ²ã—ã¦å–å¾—                                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AAGUID ã®ç‰¹æ€§

| ç‰¹æ€§ | èª¬æ˜ |
|-----|------|
| **å½¢å¼** | 128ãƒ“ãƒƒãƒˆ UUIDï¼ˆRFC 4122ï¼‰ |
| **ç™ºè¡Œè€…** | èªè¨¼å™¨ã®è£½é€ å…ƒ |
| **ä¸€æ„æ€§** | è£½é€ å…ƒ + ãƒ¢ãƒ‡ãƒ« + ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ã§ä¸€æ„ |
| **ç”¨é€”** | èªè¨¼å™¨ã®ç¨®é¡ã‚’è­˜åˆ¥ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å‚ç…§ã®ã‚­ãƒ¼ |
| **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼** | å€‹ä½“è­˜åˆ¥ã§ã¯ãªã„ãŸã‚ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼å½±éŸ¿ã¯é™å®šçš„ |

---

## AAGUID ã®å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°

### authenticatorData ã®æ§‹é€ 

AAGUID ã¯ç™»éŒ²ï¼ˆRegistrationï¼‰æ™‚ã® `authenticatorData` ã«å«ã¾ã‚Œã¾ã™ã€‚

```
authenticatorData ã®æ§‹é€ ï¼ˆattestedCredentialData ã‚ã‚Šï¼‰:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         authenticatorData                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  rpIdHash    â”‚ flags â”‚ signCount â”‚     attestedCredentialData         â”‚ â”‚
â”‚  â”‚  (32 bytes)  â”‚ (1)   â”‚ (4 bytes) â”‚     (variable)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚                              â”‚
â”‚                                              â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    attestedCredentialData                             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  AAGUID  â”‚ credentialIdLength  â”‚ credentialId  â”‚  publicKey      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚(16 bytes)â”‚     (2 bytes)       â”‚  (variable)   â”‚   (COSE)        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚       â–²                                                               â”‚ â”‚
â”‚  â”‚       â”‚                                                               â”‚ â”‚
â”‚  â”‚       â””â”€â”€â”€ ã“ã“ã« AAGUID ãŒå«ã¾ã‚Œã‚‹                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### flags ã®è©³ç´°

```
flags (1 byte) ã®ãƒ“ãƒƒãƒˆæ§‹æˆ:

â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ bit7â”‚ bit6â”‚ bit5â”‚ bit4â”‚ bit3â”‚ bit2â”‚ bit1â”‚ bit0â”‚
â”‚ ED  â”‚ AT  â”‚ 0   â”‚ BS  â”‚ BE  â”‚ 0   â”‚ UV  â”‚ UP  â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
  â”‚     â”‚           â”‚     â”‚           â”‚     â”‚
  â”‚     â”‚           â”‚     â”‚           â”‚     â””â”€ User Present (å¸¸ã« 1)
  â”‚     â”‚           â”‚     â”‚           â””â”€â”€â”€ User Verified (PIN/ç”Ÿä½“èªè¨¼)
  â”‚     â”‚           â”‚     â””â”€â”€â”€ Backup Eligible (Level 3)
  â”‚     â”‚           â””â”€â”€â”€ Backup State (Level 3)
  â”‚     â””â”€â”€â”€ Attested credential data included
  â”‚         (1 ã®å ´åˆã€AAGUID ç­‰ãŒå«ã¾ã‚Œã‚‹)
  â””â”€â”€â”€ Extension data included

ã€é‡è¦ã€‘
AT ãƒ•ãƒ©ã‚°ãŒ 1 ã®å ´åˆã®ã¿ attestedCredentialDataï¼ˆAAGUID ã‚’å«ã‚€ï¼‰ãŒå­˜åœ¨
```

### èªè¨¼æ™‚ã¨ã®é•ã„

| ã‚¿ã‚¤ãƒŸãƒ³ã‚° | AAGUID | attestedCredentialData |
|----------|--------|----------------------|
| **ç™»éŒ²æ™‚** | å«ã¾ã‚Œã‚‹ | å«ã¾ã‚Œã‚‹ï¼ˆAT=1ï¼‰ |
| **èªè¨¼æ™‚** | å«ã¾ã‚Œãªã„ | å«ã¾ã‚Œãªã„ï¼ˆAT=0ï¼‰ |

èªè¨¼æ™‚ã¯ credentialId ã§èªè¨¼å™¨ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã€AAGUID ã¯ä¸è¦ã§ã™ã€‚

---

## FIDO Metadata Service (MDS)

> ğŸ“– MDS ã®è©³ç´°ï¼ˆBLOB æ§‹é€ ã€å–å¾—æ–¹æ³•ã€å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ç­‰ï¼‰ã«ã¤ã„ã¦ã¯ [FIDO Metadata Service (MDS)](./fido2-metadata-service.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### MDS ã¨ã¯

FIDO Metadata Service ã¯ã€FIDO Alliance ãŒé‹å–¶ã™ã‚‹èªè¨¼å™¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FIDO Metadata Service (MDS)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     MDS ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ                               â”‚   â”‚
â”‚  â”‚            https://mds3.fidoalliance.org/                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                            â”‚
â”‚                                â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ BLOB                                   â”‚   â”‚
â”‚  â”‚  (JWT å½¢å¼ã€FIDO Alliance ãŒç½²å)                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                            â”‚
â”‚                                â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  entries: [                                                          â”‚   â”‚
â”‚  â”‚    {                                                                 â”‚   â”‚
â”‚  â”‚      aaguid: "ee882879-721c-4913-9775-3dfcce97072a",                â”‚   â”‚
â”‚  â”‚      metadataStatement: {                                            â”‚   â”‚
â”‚  â”‚        description: "YubiKey 5 Series with NFC",                    â”‚   â”‚
â”‚  â”‚        authenticatorVersion: 328966,                                 â”‚   â”‚
â”‚  â”‚        protocolFamily: "fido2",                                      â”‚   â”‚
â”‚  â”‚        schema: 3,                                                    â”‚   â”‚
â”‚  â”‚        upv: [{ major: 1, minor: 0 }, { major: 1, minor: 1 }],       â”‚   â”‚
â”‚  â”‚        authenticationAlgorithms: ["secp256r1_ecdsa_sha256_raw"],    â”‚   â”‚
â”‚  â”‚        publicKeyAlgAndEncodings: ["cose"],                          â”‚   â”‚
â”‚  â”‚        attestationTypes: ["basic_full"],                             â”‚   â”‚
â”‚  â”‚        userVerificationDetails: [[...], ...],                       â”‚   â”‚
â”‚  â”‚        keyProtection: ["hardware", "secure_element"],               â”‚   â”‚
â”‚  â”‚        matcherProtection: ["on_chip"],                              â”‚   â”‚
â”‚  â”‚        cryptoStrength: 128,                                          â”‚   â”‚
â”‚  â”‚        attachmentHint: ["external", "wired", "wireless", "nfc"],    â”‚   â”‚
â”‚  â”‚        tcDisplay: [],                                                â”‚   â”‚
â”‚  â”‚        attestationRootCertificates: ["MIID..."],                    â”‚   â”‚
â”‚  â”‚        icon: "data:image/png;base64,..."                            â”‚   â”‚
â”‚  â”‚      },                                                              â”‚   â”‚
â”‚  â”‚      statusReports: [                                                â”‚   â”‚
â”‚  â”‚        { status: "FIDO_CERTIFIED_L1", effectiveDate: "2024-01-15" } â”‚   â”‚
â”‚  â”‚      ]                                                               â”‚   â”‚
â”‚  â”‚    },                                                                â”‚   â”‚
â”‚  â”‚    ...                                                               â”‚   â”‚
â”‚  â”‚  ]                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MDS ã§å–å¾—ã§ãã‚‹æƒ…å ±

| ã‚«ãƒ†ã‚´ãƒª | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | èª¬æ˜ |
|---------|----------|------|
| **åŸºæœ¬æƒ…å ±** | description | èªè¨¼å™¨ã®èª¬æ˜ |
| | icon | ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆBase64 PNGï¼‰ |
| | protocolFamily | fido2, u2f, uaf |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | keyProtection | hardware, secure_element, tee |
| | matcherProtection | software, tee, on_chip |
| | cryptoStrength | æš—å·å¼·åº¦ï¼ˆãƒ“ãƒƒãƒˆæ•°ï¼‰ |
| **èªè¨¼ãƒ¬ãƒ™ãƒ«** | statusReports | FIDO_CERTIFIED_L1/L2/L3 |
| **è„†å¼±æ€§** | statusReports | REVOKED, USER_VERIFICATION_BYPASS ç­‰ |
| **Attestation** | attestationTypes | basic_full, basic_surrogate, attca |
| | attestationRootCertificates | ãƒ«ãƒ¼ãƒˆè¨¼æ˜æ›¸ |

### MDS ã®æ´»ç”¨ä¾‹

```java
// AAGUID ã‹ã‚‰èªè¨¼å™¨æƒ…å ±ã‚’å–å¾—
MetadataStatement metadata = mdsRepository.findByAaguid(aaguid);

// èªè¨¼å™¨ã®èªè¨¼ãƒ¬ãƒ™ãƒ«ã‚’ç¢ºèª
AuthenticatorStatus status = metadata.getLatestStatus();
if (status == AuthenticatorStatus.FIDO_CERTIFIED_L2) {
    // L2 èªå®šã®èªè¨¼å™¨ã®ã¿è¨±å¯
    allowRegistration();
}

// è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
if (status == AuthenticatorStatus.REVOKED) {
    // å¤±åŠ¹ã—ãŸèªè¨¼å™¨ã¯æ‹’å¦
    throw new AuthenticatorRevokedException("Authenticator has been revoked");
}
```

---

## ä¸»è¦ãªèªè¨¼å™¨ã® AAGUID ä¸€è¦§

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚­ãƒ¼

| è£½å“ | AAGUID |
|-----|--------|
| YubiKey 5 NFC | `ee882879-721c-4913-9775-3dfcce97072a` |
| YubiKey 5Ci | `c5ef55ff-ad9a-4b9f-b580-adebafe026d0` |
| YubiKey 5 Nano | `fa2b99dc-9e39-4257-8f92-4a30d23c4118` |
| YubiKey Bio | `d8522d9f-575b-4866-88a9-ba99fa02f35b` |
| Google Titan (USB-A) | `42b4fb4a-2866-43b2-9bf7-6c6669c2e5d3` |
| Feitian ePass FIDO | `3e22415d-7fdf-4ea4-8a0c-dd60c4249b9d` |

### ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ èªè¨¼å™¨

| è£½å“ | AAGUID |
|-----|--------|
| Windows Hello | `08987058-cadc-4b81-b6e1-30de50dcbe96` |
| macOS Touch ID | `adce0002-35bc-c60a-648b-0b25f1f05503` |
| Android | `b93fd961-f2e6-462f-b122-82002247de78` |
| Chrome on Mac | `adce0002-35bc-c60a-648b-0b25f1f05503` |
| iCloud Keychain | `dd4ec289-e01d-41c9-bb89-70fa845d4bf2` |

### ç‰¹æ®Šãª AAGUID

| å€¤ | æ„å‘³ |
|---|-----|
| `00000000-0000-0000-0000-000000000000` | Self Attestationï¼ˆNone attestationï¼‰ã®å ´åˆ |

---

## ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã§ã®æ´»ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: èªè¨¼å™¨ã®è¨±å¯ãƒªã‚¹ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     èªè¨¼å™¨ã®è¨±å¯ãƒªã‚¹ãƒˆç®¡ç†                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ãƒãƒªã‚·ãƒ¼è¨­å®š:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  allowed_aaguids:                                                    â”‚   â”‚
â”‚  â”‚    - "ee882879-721c-4913-9775-3dfcce97072a"  # YubiKey 5 NFC        â”‚   â”‚
â”‚  â”‚    - "c5ef55ff-ad9a-4b9f-b580-adebafe026d0"  # YubiKey 5Ci          â”‚   â”‚
â”‚  â”‚    - "d8522d9f-575b-4866-88a9-ba99fa02f35b"  # YubiKey Bio          â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  # ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ èªè¨¼å™¨ã¯ç¦æ­¢ï¼ˆãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°è€æ€§ã®è¦³ç‚¹ï¼‰              â”‚   â”‚
â”‚  â”‚  denied_aaguids:                                                     â”‚   â”‚
â”‚  â”‚    - "08987058-cadc-4b81-b6e1-30de50dcbe96"  # Windows Hello         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ç™»éŒ²ãƒ•ãƒ­ãƒ¼:                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼å™¨ã§ç™»éŒ²                                            â”‚   â”‚
â”‚  â”‚  2. attestationObject ã‹ã‚‰ AAGUID ã‚’æŠ½å‡º                              â”‚   â”‚
â”‚  â”‚  3. allowed_aaguids ã¨ç…§åˆ                                            â”‚   â”‚
â”‚  â”‚  4. ä¸€è‡´ â†’ ç™»éŒ²è¨±å¯ / ä¸ä¸€è‡´ â†’ ç™»éŒ²æ‹’å¦                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: èªè¨¼ãƒ¬ãƒ™ãƒ«è¦ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     èªè¨¼ãƒ¬ãƒ™ãƒ«ã«åŸºã¥ãã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  FIDO èªè¨¼ãƒ¬ãƒ™ãƒ«:                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Level 1 (L1): åŸºæœ¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã‚’æº€ãŸã™                        â”‚   â”‚
â”‚  â”‚  Level 2 (L2): ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ä¿è­·ã€ã‚»ã‚­ãƒ¥ã‚¢ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ                    â”‚   â”‚
â”‚  â”‚  Level 3 (L3): é«˜åº¦ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£                          â”‚   â”‚
â”‚  â”‚  Level 3+: è¿½åŠ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èªå®š                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒãƒªã‚·ãƒ¼:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  ãƒªã‚½ãƒ¼ã‚¹           â”‚ å¿…è¦ãªèªè¨¼ãƒ¬ãƒ™ãƒ« â”‚ ä¾‹                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  ä¸€èˆ¬æ¥­å‹™ã‚¢ãƒ—ãƒª      â”‚ L1 ä»¥ä¸Š          â”‚ ãƒ¡ãƒ¼ãƒ«ã€ãƒãƒ£ãƒƒãƒˆ              â”‚   â”‚
â”‚  â”‚  æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹  â”‚ L2 ä»¥ä¸Š          â”‚ äººäº‹ã‚·ã‚¹ãƒ†ãƒ ã€è²¡å‹™ãƒ‡ãƒ¼ã‚¿       â”‚   â”‚
â”‚  â”‚  ç‰¹æ¨©æ“ä½œ            â”‚ L3 ä»¥ä¸Š          â”‚ ç®¡ç†è€…æ“ä½œã€è¨¼æ˜æ›¸ç™ºè¡Œ        â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  å®Ÿè£…ä¾‹:                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  // èªè¨¼æ™‚ã«èªè¨¼å™¨ã®ãƒ¬ãƒ™ãƒ«ã‚’ç¢ºèª                                       â”‚   â”‚
â”‚  â”‚  Credential credential = credentialRepository.get(credentialId);      â”‚   â”‚
â”‚  â”‚  String aaguid = credential.getAaguid();                              â”‚   â”‚
â”‚  â”‚  AuthenticatorStatus status = mds.getStatus(aaguid);                  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  if (resource.requiresLevel(Level.L2) &&                             â”‚   â”‚
â”‚  â”‚      status.getLevel() < Level.L2) {                                  â”‚   â”‚
â”‚  â”‚      throw new InsufficientAuthenticatorLevelException();             â”‚   â”‚
â”‚  â”‚  }                                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: è„†å¼±æ€§ç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     èªè¨¼å™¨ã®è„†å¼±æ€§ç®¡ç†                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  MDS statusReports ã® status å€¤:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  FIDO_CERTIFIED          â”‚ èªå®šæ¸ˆã¿ï¼ˆæ­£å¸¸ï¼‰                          â”‚   â”‚
â”‚  â”‚  FIDO_CERTIFIED_L1       â”‚ Level 1 èªå®š                              â”‚   â”‚
â”‚  â”‚  FIDO_CERTIFIED_L2       â”‚ Level 2 èªå®š                              â”‚   â”‚
â”‚  â”‚  FIDO_CERTIFIED_L3       â”‚ Level 3 èªå®š                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  ATTESTATION_KEY_COMPROMISE  â”‚ Attestation éµã®æ¼æ´©                  â”‚   â”‚
â”‚  â”‚  USER_VERIFICATION_BYPASS    â”‚ UV ãƒã‚¤ãƒ‘ã‚¹ã®è„†å¼±æ€§                   â”‚   â”‚
â”‚  â”‚  USER_KEY_REMOTE_COMPROMISE  â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼éµã®ãƒªãƒ¢ãƒ¼ãƒˆæ¼æ´©              â”‚   â”‚
â”‚  â”‚  USER_KEY_PHYSICAL_COMPROMISEâ”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼éµã®ç‰©ç†çš„æ¼æ´©                â”‚   â”‚
â”‚  â”‚  REVOKED                     â”‚ å¤±åŠ¹ï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  è„†å¼±æ€§å¯¾å¿œãƒ•ãƒ­ãƒ¼:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  1. MDS ã‚’å®šæœŸçš„ã«å–å¾—ï¼ˆæ—¥æ¬¡æ¨å¥¨ï¼‰                                     â”‚   â”‚
â”‚  â”‚  2. statusReports ã®å¤‰æ›´ã‚’æ¤œçŸ¥                                         â”‚   â”‚
â”‚  â”‚  3. å½±éŸ¿ã‚’å—ã‘ã‚‹èªè¨¼å™¨ã‚’ç‰¹å®šï¼ˆAAGUID ã§æ¤œç´¢ï¼‰                          â”‚   â”‚
â”‚  â”‚  4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥ã€å†ç™»éŒ²ã‚’ä¿ƒã™                                       â”‚   â”‚
â”‚  â”‚  5. å¿…è¦ã«å¿œã˜ã¦æ—¢å­˜ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚’ç„¡åŠ¹åŒ–                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## DDL ã§ã® AAGUID ç®¡ç†

### æ¨å¥¨æ§‹é€ 

AAGUID ã¯èªè¨¼å™¨é–¢é€£ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ã¨ã‚‚ã« JSONB ã§ç®¡ç†ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

```sql
CREATE TABLE webauthn_credentials
(
    -- Core columns
    id TEXT PRIMARY KEY,
    tenant_id UUID NOT NULL,
    user_id VARCHAR(256) NOT NULL,
    username VARCHAR(256),
    rp_id VARCHAR(256) NOT NULL,
    public_key TEXT NOT NULL,
    sign_count BIGINT NOT NULL DEFAULT 0,

    -- Authenticator metadata (JSONB)
    authenticator JSONB NOT NULL DEFAULT '{}',
    -- ä¾‹:
    -- {
    --   "aaguid": "ee882879-721c-4913-9775-3dfcce97072a",
    --   "transports": ["usb", "nfc"],
    --   "attachment": "cross-platform"
    -- }

    created_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

-- AAGUID ã§ã®ã‚¯ã‚¨ãƒªç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_credentials_aaguid
ON webauthn_credentials ((authenticator->>'aaguid'));
```

### ã‚¯ã‚¨ãƒªä¾‹

```sql
-- ç‰¹å®šã® AAGUID ã‚’æŒã¤ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚’æ¤œç´¢
SELECT * FROM webauthn_credentials
WHERE authenticator->>'aaguid' = 'ee882879-721c-4913-9775-3dfcce97072a';

-- è„†å¼±æ€§ã®ã‚ã‚‹èªè¨¼å™¨ï¼ˆAAGUID ãƒªã‚¹ãƒˆï¼‰ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®š
SELECT DISTINCT user_id FROM webauthn_credentials
WHERE authenticator->>'aaguid' IN (
    'vulnerable-aaguid-1',
    'vulnerable-aaguid-2'
);
```

---

## ã¾ã¨ã‚

### AAGUID ã®è¦ç‚¹

| é …ç›® | å†…å®¹ |
|-----|------|
| **å®šç¾©** | èªè¨¼å™¨ãƒ¢ãƒ‡ãƒ«ã‚’è­˜åˆ¥ã™ã‚‹128ãƒ“ãƒƒãƒˆUUID |
| **å–å¾—ã‚¿ã‚¤ãƒŸãƒ³ã‚°** | ç™»éŒ²æ™‚ã® authenticatorData |
| **ç”¨é€”** | ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å‚ç…§ã€ãƒãƒªã‚·ãƒ¼åˆ¶å¾¡ã€è„†å¼±æ€§ç®¡ç† |
| **ä¿å­˜æ¨å¥¨** | JSONB ã® authenticator ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†… |

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ç™»éŒ²æ™‚ã« AAGUID ã‚’ä¿å­˜**
   - å¾Œã‹ã‚‰ã®ç›£æŸ»ãƒ»ãƒãƒªã‚·ãƒ¼é©ç”¨ã«å¿…è¦

2. **MDS ã¨ã®é€£æº**
   - å®šæœŸçš„ã« MDS ã‚’å–å¾—ã—ã¦æœ€æ–°ã®èªè¨¼å™¨æƒ…å ±ã‚’å‚ç…§

3. **ãƒãƒªã‚·ãƒ¼ã®æŸ”è»Ÿæ€§**
   - è¨±å¯ãƒªã‚¹ãƒˆ/æ‹’å¦ãƒªã‚¹ãƒˆã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†

4. **è„†å¼±æ€§ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°**
   - MDS ã® statusReports ã‚’ç›£è¦–ã€å½±éŸ¿ç¯„å›²ã‚’è¿…é€Ÿã«ç‰¹å®š

---

## å‚è€ƒãƒªãƒ³ã‚¯

- [W3C WebAuthn - Attested Credential Data](https://www.w3.org/TR/webauthn-2/#attested-credential-data)
- [FIDO Metadata Service](https://fidoalliance.org/metadata/)
- [FIDO MDS API](https://mds3.fidoalliance.org/)
- [FIDO Authenticator Certification Levels](https://fidoalliance.org/certification/authenticator-certification-levels/)
