# OWASP Top 10 2025 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨ºæ–­ - Sub-Issue åˆ†å‰²

**è¨ºæ–­å¯¾è±¡**: idp-server (OAuth 2.0/OIDC/CIBA/FAPIæº–æ‹ IDãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ )  
**è¨ºæ–­å®Ÿæ–½æ—¥**: 2025-10-09  
**è¨ºæ–­åŸºæº–**: OWASP Top 10 2025  
**ç·åˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢**: 73.5/100 (è‰¯å¥½ã€è¦æ”¹å–„ç‚¹ã‚ã‚Š)  
**å…ƒIssue**: #[ãƒ¡ã‚¤ãƒ³Issueç•ªå·ã‚’è¨˜è¼‰]

---

## ğŸ“‹ Sub-Issue åˆ†é¡ä¸€è¦§

### ğŸ”´ Phase 1: Critical Issues (å³æ™‚å¯¾å¿œå¿…é ˆ - 1é€±é–“ä»¥å†…)

#### Issue #1: [A03] TransactionManager SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ä¿®æ­£
**å„ªå…ˆåº¦**: ğŸ”´ Critical  
**CVSS**: 9.8  
**å·¥æ•°**: 2æ—¥  
**æ‹…å½“**: Senior Security Engineer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `libs/idp-server-platform/src/main/java/org/idp/server/platform/datasource/TransactionManager.java:132`
- **è„†å¼±æ€§**: PostgreSQL RLSè¨­å®šã§æ–‡å­—åˆ—é€£çµã‚’ä½¿ç”¨
- **å½±éŸ¿**: ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢æ©Ÿæ§‹ã®çªç ´ã€ãƒ‡ãƒ¼ã‚¿å‰Šé™¤/æ”¹ã–ã‚“ã®ãƒªã‚¹ã‚¯

**ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰**:
```java
stmt.execute("SET app.tenant_id = '" + tenantIdentifier.value() + "'");  // â† è„†å¼±
```

**ä¿®æ­£å†…å®¹**:
```java
private static void setTenantId(Connection conn, TenantIdentifier tenantIdentifier) {
  log.debug("[RLS] SET app.tenant_id: tenant={}", tenantIdentifier.value());
  
  try {
    UUID tenantUuid = tenantIdentifier.valueAsUuid();  // UUIDæ¤œè¨¼
    try (var stmt = conn.prepareStatement("SELECT set_config('app.tenant_id', ?::text, false)")) {
      stmt.setString(1, tenantUuid.toString());
      stmt.execute();
    }
  } catch (SQLException e) {
    throw new SqlRuntimeException("Failed to set tenant_id", e);
  }
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] UUIDæ¤œè¨¼ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] PreparedStatementä½¿ç”¨ã«ã‚ˆã‚ŠSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒä¸å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] å…¨E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆç‰¹ã«ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆé–¢é€£ï¼‰
- [ ] æ‰‹å‹•SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒè©¦è¡Œã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ã‚’ç¢ºèª

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/multi_tenancy/tenant/TenantIdentifier.java`
- ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«: `libs/idp-server-platform/src/test/java/org/idp/server/platform/datasource/TransactionManagerTest.java`ï¼ˆä½œæˆãŒå¿…è¦ãªå ´åˆï¼‰

---

#### Issue #2: [A06] Nimbus JOSE + JWT ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ›´æ–°
**å„ªå…ˆåº¦**: ğŸ”´ Critical  
**CVSS**: 7.5  
**å·¥æ•°**: 1æ—¥ + æ¤œè¨¼2æ—¥  
**æ‹…å½“**: Backend Developer + QA Engineer

**å•é¡Œã®è©³ç´°**:
- **ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 9.30.2
- **ä¿®æ­£ç‰ˆ**: 10.5ä»¥é™
- **CVE**:
  - CVE-2025-53864 (CVSS 5.8): æ·±ã„ãƒã‚¹ãƒˆJSONã«ã‚ˆã‚‹DoS
  - CVE-2024-31214 (CVSS 7.5): JWE p2cå¤§å€¤ã«ã‚ˆã‚‹DoS
- **å½±éŸ¿**: JWTå‡¦ç†ã¯OIDC/OAuth 2.0ã®ä¸­æ ¸æ©Ÿèƒ½

**ä¿®æ­£å†…å®¹**:
```gradle
// File: libs/idp-server-platform/build.gradle
-implementation 'com.nimbusds:nimbus-jose-jwt:9.30.2'
+implementation 'com.nimbusds:nimbus-jose-jwt:10.5'
```

**æ¤œè¨¼é …ç›®**:
- [ ] Gradleãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèª
- [ ] å…¨ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆJWTé–¢é€£ï¼‰
- [ ] å…¨E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆOIDCèªè¨¼ãƒ•ãƒ­ãƒ¼ï¼‰
- [ ] JWTç½²åæ¤œè¨¼ãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] Authorization Code Flowã€CIBA Flowã€FAPI Flowã®å‹•ä½œç¢ºèª
- [ ] æ—¢å­˜ã®JWTç”Ÿæˆãƒ»æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã¨ã®äº’æ›æ€§ç¢ºèª
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-platform/build.gradle`
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/jose/*`
- E2Eãƒ†ã‚¹ãƒˆ: `e2e/spec/oauth2/authorization-code-flow.spec.js`

---

#### Issue #3: [A06] Docker Base Image æ›´æ–°ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
**å„ªå…ˆåº¦**: ğŸ”´ Critical  
**CVSS**: 7.5  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: DevOps Engineer

**å•é¡Œã®è©³ç´°**:
- **ç¾åœ¨ã®ã‚¤ãƒ¡ãƒ¼ã‚¸**: `openjdk:21-slim`
- **CVE**:
  - CVE-2025-32988, CVE-2025-32989: GnuTLSè„†å¼±æ€§
  - CVE-2025-6020: Linux PAMæ¨©é™æ˜‡æ ¼
- **å¯¾ç­–**: ã‚ˆã‚Šå®‰å…¨ãª`eclipse-temurin:21-jre-alpine`ã¸ã®ç§»è¡Œ

**ä¿®æ­£å†…å®¹**:
```dockerfile
# File: Dockerfile
-FROM gradle:8.5-jdk21 AS builder
+FROM gradle:8.14-jdk21-alpine AS builder

-FROM openjdk:21-slim AS runtime
+FROM eclipse-temurin:21-jre-alpine AS runtime

+# érootãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å®Ÿè¡Œ
+RUN addgroup -S idpserver && \
+    adduser -S idpserver -G idpserver && \
+    chown -R idpserver:idpserver /app
+USER idpserver
```

**æ¤œè¨¼é …ç›®**:
- [ ] Docker buildæˆåŠŸã‚’ç¢ºèª
- [ ] ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•ã‚’ç¢ºèª
- [ ] érootãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆ`docker exec ... whoami`ï¼‰
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã®æ¯”è¼ƒï¼ˆæœ€é©åŒ–ç¢ºèªï¼‰
- [ ] Trivyã‚¹ã‚­ãƒ£ãƒ³ã§è„†å¼±æ€§ãŒãªã„ã“ã¨ã‚’ç¢ºèª

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `Dockerfile`
- `docker-compose.yaml`
- `.github/workflows/*` (CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³)

---

#### Issue #4: [A05] ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆèªè¨¼æƒ…å ±ã®å‰Šé™¤
**å„ªå…ˆåº¦**: ğŸ”´ Critical  
**CVSS**: 9.8  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: DevOps Engineer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: 
  - `app/src/main/resources/application.yaml:17-18, 25-26`
  - `libs/idp-server-database/postgresql/operation/01-create-users.sh:9-10`
  - `.env.local:4-5, 13, 17`
- **è„†å¼±æ€§**: `idpserver/idpserver` ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ã—ã¦ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
- **å½±éŸ¿**: æœ¬ç•ªç’°å¢ƒã§ã®èª¤ä½¿ç”¨ãƒªã‚¹ã‚¯

**ä¿®æ­£å†…å®¹**:
```yaml
# File: app/src/main/resources/application.yaml
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’å‰Šé™¤ã—ã€ç’°å¢ƒå¤‰æ•°å¿…é ˆåŒ–
-username: "${CONTROL_PLANE_DB_WRITER_USER_NAME:idpserver}"
-password: "${CONTROL_PLANE_DB_WRITER_PASSWORD:idpserver}"
+username: "${CONTROL_PLANE_DB_WRITER_USER_NAME}"
+password: "${CONTROL_PLANE_DB_WRITER_PASSWORD}"
```

```bash
# File: libs/idp-server-database/postgresql/operation/01-create-users.sh
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å‰Šé™¤ã€ç’°å¢ƒå¤‰æ•°å¿…é ˆåŒ–
-: "${IDP_DB_ADMIN_PASSWORD:=idp_admin_user}"
+: "${IDP_DB_ADMIN_PASSWORD:?IDP_DB_ADMIN_PASSWORD is required}"
```

```gitignore
# File: .gitignore ã«è¿½åŠ 
.env.local
.env
```

**æ¤œè¨¼é …ç›®**:
- [ ] ç’°å¢ƒå¤‰æ•°æœªè¨­å®šæ™‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•ãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ç’°å¢ƒå¤‰æ•°è¨­å®šæ™‚ã«æ­£å¸¸èµ·å‹•ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] `.env.local`ãŒGitç®¡ç†ã‹ã‚‰é™¤å¤–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ï¼ˆç’°å¢ƒå¤‰æ•°è¨­å®šæ–¹æ³•ï¼‰
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã®ç’°å¢ƒå¤‰æ•°è¨­å®šã‚’ç¢ºèª

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `app/src/main/resources/application.yaml`
- `libs/idp-server-database/postgresql/operation/01-create-users.sh`
- `.gitignore`
- `documentation/docs/content_05_how-to/deployment.md`

---

### ğŸŸ  Phase 2: High Priority Issues (2é€±é–“ä»¥å†…)

#### Issue #5: [A10] HttpRequestExecutor SSRFå¯¾ç­–å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ  High  
**CVSS**: 7.5  
**å·¥æ•°**: 3æ—¥  
**æ‹…å½“**: Security Engineer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `libs/idp-server-platform/src/main/java/org/idp/server/platform/http/HttpRequestExecutor.java`
- **è„†å¼±æ€§**: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPæ¤œè¨¼ã®æ¬ å¦‚
- **å½±éŸ¿**: 
  - Webhooké€ä¿¡æ™‚ã®å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹
  - Identity Verificationå¤–éƒ¨APIã‚³ãƒ¼ãƒ«ã®SSRF
  - OIDC Federation well-known URLãƒ•ã‚§ãƒƒãƒã®æ”»æ’ƒé¢

**å®Ÿè£…å†…å®¹**:
æ–°è¦ã‚¯ãƒ©ã‚¹ `HttpUrlValidator` ã‚’ä½œæˆ:
```java
// File: libs/idp-server-platform/src/main/java/org/idp/server/platform/http/HttpUrlValidator.java
package org.idp.server.platform.http;

import java.net.InetAddress;
import java.net.URI;
import java.net.UnknownHostException;
import java.util.List;

public class HttpUrlValidator {
    private static final List<String> PRIVATE_IP_RANGES = List.of(
        "127.0.0.0/8",    // Loopback
        "10.0.0.0/8",     // Private Class A
        "172.16.0.0/12",  // Private Class B
        "192.168.0.0/16", // Private Class C
        "169.254.0.0/16", // Link-local
        "::1/128",        // IPv6 Loopback
        "fc00::/7",       // IPv6 Unique Local
        "fe80::/10"       // IPv6 Link-local
    );

    public void validateUrl(URI uri) throws SsrfException {
        try {
            InetAddress address = InetAddress.getByName(uri.getHost());
            if (isPrivateNetwork(address) || address.isLoopbackAddress()) {
                throw new SsrfException(
                    "Access to private network is forbidden: " + uri.getHost()
                );
            }
        } catch (UnknownHostException e) {
            throw new SsrfException("Invalid hostname: " + uri.getHost(), e);
        }
    }

    private boolean isPrivateNetwork(InetAddress address) {
        // RFC 1918, RFC 4193 å®Ÿè£…
        byte[] addr = address.getAddress();
        // å®Ÿè£…è©³ç´°...
    }
}
```

`HttpRequestExecutor` ã«çµ±åˆ:
```java
public HttpRequestResult execute(HttpRequest httpRequest) {
    // URLæ¤œè¨¼ã‚’è¿½åŠ 
    httpUrlValidator.validateUrl(httpRequest.uri());
    // æ—¢å­˜ã®å®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] IPv6ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] æ­£å½“ãªå¤–éƒ¨URLãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] DNS rebindingæ”»æ’ƒã¸ã®å¯¾ç­–ã‚’ç¢ºèª
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆï¼ˆæ­£å¸¸ç³»ãƒ»ç•°å¸¸ç³»ï¼‰
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆWebhook, Identity Verificationï¼‰

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/http/HttpUrlValidator.java`ï¼ˆæ–°è¦ï¼‰
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/http/HttpRequestExecutor.java`
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/http/SsrfException.java`ï¼ˆæ–°è¦ï¼‰

---

#### Issue #6: [A01] CORS Originæ¤œè¨¼ã®ä¿®æ­£
**å„ªå…ˆåº¦**: ğŸŸ  High  
**CVSS**: 6.5  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/DynamicCorsFilter.java:61-64`
- **è„†å¼±æ€§**: `contains()` ã«ã‚ˆã‚‹éƒ¨åˆ†ä¸€è‡´æ¤œè¨¼
- **å½±éŸ¿**: Origin Validation Bypassã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ä¹—ã£å–ã‚Šæ”»æ’ƒã®ãƒªã‚¹ã‚¯

**ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰**:
```java
String allowOrigin = allowOrigins.stream()
    .filter(allow -> allow.contains(origin))  // â† å±é™º
    .findFirst()
    .orElse(tenant.domain().value());
```

**ä¿®æ­£å†…å®¹**:
```java
String allowOrigin = allowOrigins.stream()
    .filter(allow -> allow.equals(origin))  // å®Œå…¨ä¸€è‡´ã«å¤‰æ›´
    .findFirst()
    .orElse("null");  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ "null" ã«å¤‰æ›´
```

**æ¤œè¨¼é …ç›®**:
- [ ] æ­£å½“ãªOriginãŒè¨±å¯ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] éƒ¨åˆ†ä¸€è‡´ã®OriginãŒæ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ä¹—ã£å–ã‚Šæ”»æ’ƒãŒé˜²ã’ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆCORSé–¢é€£ï¼‰
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/DynamicCorsFilter.java`

---

#### Issue #7: [A04] ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ©Ÿæ§‹ã®å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ  High  
**CVSS**: 6.5  
**å·¥æ•°**: 5æ—¥  
**æ‹…å½“**: Backend Developer + DevOps Engineer

**å•é¡Œã®è©³ç´°**:
- **å½±éŸ¿ç¯„å›²**: 
  - Token Endpoint
  - CIBA Backchannel Authentication Endpoint
  - Authorization Endpoint
- **ãƒªã‚¹ã‚¯**: ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã€DoSæ”»æ’ƒã€ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆéè² è·

**å®Ÿè£…å†…å®¹**:
æ–°è¦ã‚¯ãƒ©ã‚¹ `RedisRateLimiter` ã‚’ä½œæˆ:
```java
// File: libs/idp-server-platform/src/main/java/org/idp/server/platform/ratelimit/RedisRateLimiter.java
package org.idp.server.platform.ratelimit;

import java.time.Duration;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Component;

@Component
public class RedisRateLimiter {
    private final RedisTemplate<String, String> redisTemplate;

    public boolean allowRequest(String key, int maxRequests, Duration window) {
        String script =
            "local current = redis.call('incr', KEYS[1]) " +
            "if current == 1 then redis.call('expire', KEYS[1], ARGV[1]) end " +
            "return current <= tonumber(ARGV[2])";
        
        Long result = redisTemplate.execute(
            // Lua scriptå®Ÿè¡Œ
        );
        return result != null && result == 1L;
    }
}
```

Filterã¸ã®çµ±åˆ:
```java
// TokenEndpoint, CIBAEndpoint, AuthorizationEndpointã«è¿½åŠ 
if (!rateLimiter.allowRequest(clientId, 100, Duration.ofMinutes(1))) {
    throw new RateLimitExceededException("Too many requests");
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] åˆ¶é™è¶…éæ™‚ã«é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãŒè¿”å´ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ç•°ãªã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã§ç‹¬ç«‹ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æœŸé–“çµŒéå¾Œã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ã‚’ç¢ºèª
- [ ] E2Eãƒ†ã‚¹ãƒˆä½œæˆï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ†ã‚¹ãƒˆï¼‰

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/ratelimit/RedisRateLimiter.java`ï¼ˆæ–°è¦ï¼‰
- `libs/idp-server-platform/src/main/java/org/idp/server/platform/ratelimit/RateLimitExceededException.java`ï¼ˆæ–°è¦ï¼‰
- Token/CIBA/Authorization Endpointå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

---

#### Issue #8: [A06] Spring Boot ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°
**å„ªå…ˆåº¦**: ğŸŸ  High  
**CVSS**: 6.1  
**å·¥æ•°**: 1æ—¥ + æ¤œè¨¼2æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.4.2
- **ä¿®æ­£ç‰ˆ**: 3.4.5ä»¥é™
- **CVE**: CVE-2025-22235 (Actuatorã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆèª¤matcher)

**ä¿®æ­£å†…å®¹**:
```gradle
// File: app/build.gradle
-id 'org.springframework.boot' version '3.4.2'
+id 'org.springframework.boot' version '3.4.5'
```

**æ¤œè¨¼é …ç›®**:
- [ ] Gradleãƒ“ãƒ«ãƒ‰æˆåŠŸã‚’ç¢ºèª
- [ ] å…¨ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] å…¨E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] Spring Boot Actuatorã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‹•ä½œç¢ºèª
- [ ] æ—¢å­˜æ©Ÿèƒ½ã¨ã®äº’æ›æ€§ç¢ºèª

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `app/build.gradle`

---

### ğŸŸ¡ Phase 3: Medium Priority Issues (1ãƒ¶æœˆä»¥å†…)

#### Issue #9: [A05] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ¡ Medium  
**CVSS**: 5.3  
**å·¥æ•°**: 2æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **æ¬ å¦‚ã—ã¦ã„ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼**:
  - `X-Frame-Options`: Clickjackingæ”»æ’ƒãƒªã‚¹ã‚¯
  - `X-Content-Type-Options`: MIME ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°æ”»æ’ƒ
  - `Strict-Transport-Security`: HTTPSå¼·åˆ¶ãªã—
  - `Content-Security-Policy`: XSSæ”»æ’ƒè»½æ¸›ç­–ãªã—

**å®Ÿè£…å†…å®¹**:
æ–°è¦Filterä½œæˆ:
```java
// File: libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/SecurityHeadersFilter.java
package org.idp.server.adapters.springboot;

import jakarta.servlet.*;
import jakarta.servlet.http.HttpServletResponse;
import java.io.IOException;
import org.springframework.stereotype.Component;

@Component
public class SecurityHeadersFilter implements Filter {
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        
        httpResponse.setHeader("X-Frame-Options", "DENY");
        httpResponse.setHeader("X-Content-Type-Options", "nosniff");
        httpResponse.setHeader("X-XSS-Protection", "1; mode=block");
        httpResponse.setHeader("Strict-Transport-Security", 
            "max-age=31536000; includeSubDomains");
        httpResponse.setHeader("Content-Security-Policy", 
            "default-src 'self'");
        
        chain.doFilter(request, response);
    }
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] å„ãƒ˜ãƒƒãƒ€ãƒ¼ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®å‹•ä½œç¢ºèª
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ç¢ºèª

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/SecurityHeadersFilter.java`ï¼ˆæ–°è¦ï¼‰

---

#### Issue #10: [A07] ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ©Ÿæ§‹ã®å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ¡ Medium  
**CVSS**: 5.3  
**å·¥æ•°**: 3æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **ãƒªã‚¹ã‚¯**: ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚¹ãƒ—ãƒ¬ãƒ¼æ”»æ’ƒã«ç„¡é˜²å‚™

**å®Ÿè£…å†…å®¹**:
```java
// File: libs/idp-server-core/src/main/java/org/idp/server/core/authentication/AccountLockoutManager.java
package org.idp.server.core.authentication;

import java.time.Duration;
import org.springframework.stereotype.Component;

@Component
public class AccountLockoutManager {
    private static final int MAX_FAILED_ATTEMPTS = 5;
    private static final Duration LOCKOUT_DURATION = Duration.ofMinutes(15);

    public void recordFailedAttempt(User user) {
        // Redis/DBã«ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨˜éŒ²
        // exponential backoffå®Ÿè£…
    }

    public boolean isLocked(User user) {
        // ãƒ­ãƒƒã‚¯çŠ¶æ…‹ç¢ºèª
    }

    public void reset(User user) {
        // æˆåŠŸæ™‚ã®ãƒªã‚»ãƒƒãƒˆ
    }
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] å¤±æ•—å›æ•°ãŒæ­£ã—ãã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæœŸé–“çµŒéå¾Œã«è§£é™¤ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] E2Eãƒ†ã‚¹ãƒˆä½œæˆ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-core/src/main/java/org/idp/server/core/authentication/AccountLockoutManager.java`ï¼ˆæ–°è¦ï¼‰
- èªè¨¼é–¢é€£Handler/Serviceãƒ•ã‚¡ã‚¤ãƒ«

---

#### Issue #11: [A07] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼ã‚¨ãƒ³ã‚¸ãƒ³ã®å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ¡ Medium  
**CVSS**: 5.3  
**å·¥æ•°**: 2æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **ç¾çŠ¶**: ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ã¿ã«æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯å­˜åœ¨
- **å¿…è¦ãªæ©Ÿèƒ½**:
  - æœ€å°é•·12æ–‡å­—
  - è¤‡é›‘æ€§è¦ä»¶ï¼ˆå¤§å°æ–‡å­—ã€æ•°å­—ã€è¨˜å·ï¼‰
  - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å±¥æ­´ç®¡ç†

**å®Ÿè£…å†…å®¹**:
```java
// File: libs/idp-server-core/src/main/java/org/idp/server/core/password/PasswordPolicy.java
package org.idp.server.core.password;

import java.util.List;

public class PasswordPolicy {
    private static final int MIN_LENGTH = 12;
    
    public ValidationResult validate(String password, List<String> previousHashes) {
        // æœ€å°é•·ãƒã‚§ãƒƒã‚¯
        // è¤‡é›‘æ€§ãƒã‚§ãƒƒã‚¯
        // å±¥æ­´ãƒã‚§ãƒƒã‚¯
    }
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] å„ãƒãƒªã‚·ãƒ¼ãƒ«ãƒ¼ãƒ«ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-core/src/main/java/org/idp/server/core/password/PasswordPolicy.java`ï¼ˆæ–°è¦ï¼‰

---

#### Issue #12: [A01] URLãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã®ä¿®æ­£
**å„ªå…ˆåº¦**: ğŸŸ¡ Medium  
**CVSS**: 5.3  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: Backend Developer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: 
  - `ManagementApiFilter.java:110-113`
  - `DynamicCorsFilter.java:94`
- **è„†å¼±æ€§**: `contains()` ã«ã‚ˆã‚‹URLæ¤œè¨¼ã€Path Traversalæ”»æ’ƒã®ãƒªã‚¹ã‚¯

**ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰**:
```java
if (request.getRequestURI().contains("/management/organizations/")) {
    return true;  // æ”»æ’ƒä¾‹: /malicious/management/../../admin
}
```

**ä¿®æ­£å†…å®¹**:
```java
if (request.getRequestURI().startsWith("/management/organizations/")) {
    return true;
}
```

**æ¤œè¨¼é …ç›®**:
- [ ] Path Traversalæ”»æ’ƒãŒé˜²ã’ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] æ­£å½“ãªURLãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/ManagementApiFilter.java`
- `libs/idp-server-springboot-adapter/src/main/java/org/idp/server/adapters/springboot/DynamicCorsFilter.java`

---

#### Issue #13: [A01] ControlPlaneAuthorizer ã®èªå¯å®Ÿè£…
**å„ªå…ˆåº¦**: ğŸŸ¡ Medium  
**CVSS**: 7.5  
**å·¥æ•°**: 3æ—¥  
**æ‹…å½“**: Security Engineer

**å•é¡Œã®è©³ç´°**:
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `libs/idp-server-control-plane/src/main/java/org/idp/server/control_plane/base/authorizer/ControlPlaneAuthorizer.java:21-23`
- **è„†å¼±æ€§**: `authorize()` ãƒ¡ã‚½ãƒƒãƒ‰ãŒå¸¸ã« `true` ã‚’è¿”ã™

**ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰**:
```java
public boolean authorize(String authorizationHeader) {
    return true;  // â† èªå¯ãƒã‚§ãƒƒã‚¯å®Œå…¨ã‚¹ã‚­ãƒƒãƒ—
}
```

**å®Ÿè£…å†…å®¹**:
- JWTæ¤œè¨¼å®Ÿè£…
- ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
- ãƒ†ãƒŠãƒ³ãƒˆã‚¢ã‚¯ã‚»ã‚¹æ¤œè¨¼

**æ¤œè¨¼é …ç›®**:
- [ ] èªå¯ãƒ­ã‚¸ãƒƒã‚¯ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ä¸æ­£ãªãƒˆãƒ¼ã‚¯ãƒ³ãŒæ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«**:
- `libs/idp-server-control-plane/src/main/java/org/idp/server/control_plane/base/authorizer/ControlPlaneAuthorizer.java`

---

### ğŸ”µ Phase 4: Low Priority Issues (3ãƒ¶æœˆä»¥å†…)

#### Issue #14: [A08] Gradleä¾å­˜é–¢ä¿‚æ¤œè¨¼ã®çµ±åˆ
**å„ªå…ˆåº¦**: ğŸ”µ Low  
**å·¥æ•°**: 2æ—¥  
**æ‹…å½“**: DevOps Engineer

**å®Ÿè£…å†…å®¹**:
```bash
./gradlew --write-verification-metadata sha256
```

**æ¤œè¨¼é …ç›®**:
- [ ] ä¾å­˜é–¢ä¿‚æ¤œè¨¼ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆ

---

#### Issue #15: [A02] SHA-1/MD5ã®éæ¨å¥¨åŒ–
**å„ªå…ˆåº¦**: ğŸ”µ Low  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: Backend Developer

**å®Ÿè£…å†…å®¹**:
```java
// File: libs/idp-server-platform/src/main/java/org/idp/server/platform/hash/HashAlgorithm.java
@Deprecated(since = "2025-10", forRemoval = true)
MD5,
@Deprecated(since = "2025-10", forRemoval = true)
SHA1,
```

**æ¤œè¨¼é …ç›®**:
- [ ] éæ¨å¥¨è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] UUID v4ã¸ã®ç§»è¡Œè¨ˆç”»ä½œæˆ

---

#### Issue #16: [A09] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°ã®ã‚¹ã‚¯ãƒ©ãƒ“ãƒ³ã‚°æ˜ç¤ºåŒ–
**å„ªå…ˆåº¦**: ğŸ”µ Low  
**å·¥æ•°**: 1æ—¥  
**æ‹…å½“**: Backend Developer

**å®Ÿè£…å†…å®¹**:
æ©Ÿå¯†æƒ…å ±ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®æ˜ç¤ºçš„å®Ÿè£…

**æ¤œè¨¼é …ç›®**:
- [ ] æ©Ÿå¯†æƒ…å ±ãŒãƒ­ã‚°ã«å‡ºåŠ›ã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª

---

#### Issue #17: [A10] Webhook URLãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ©Ÿæ§‹
**å„ªå…ˆåº¦**: ğŸ”µ Low  
**å·¥æ•°**: 2æ—¥  
**æ‹…å½“**: Backend Developer

**å®Ÿè£…å†…å®¹**:
ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ©Ÿæ§‹ã®å®Ÿè£…

**æ¤œè¨¼é …ç›®**:
- [ ] ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆæ¤œè¨¼ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

---

#### Issue #18: ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã®å°å…¥
**å„ªå…ˆåº¦**: ğŸ”µ Low  
**å·¥æ•°**: 3æ—¥  
**æ‹…å½“**: DevOps Engineer

**å®Ÿè£…å†…å®¹**:
- OWASP Dependency-Checkçµ±åˆ
- GitHub Actionsçµ±åˆ
- Renovate Botè¨­å®š
- Trivyã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚­ãƒ£ãƒ³

**æ¤œè¨¼é …ç›®**:
- [ ] è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] è„†å¼±æ€§æ¤œå‡ºæ™‚ã®é€šçŸ¥è¨­å®š

**å®Ÿè£…ä¾‹**:
```gradle
// build.gradle (root)
plugins {
    id 'org.owasp.dependencycheck' version '10.0.4'
}

dependencyCheck {
    format = 'ALL'
    failBuildOnCVSS = 7
}
```

```yaml
# .github/workflows/security.yml
name: Security Scan
on: [push, pull_request]
jobs:
  dependency-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run OWASP Dependency Check
        run: ./gradlew dependencyCheckAggregate
```

---

## ğŸ“Š å®Ÿè£…å„ªå…ˆé †ä½ã‚µãƒãƒªãƒ¼

### ç·Šæ€¥åº¦åˆ¥åˆ†é¡

| Phase | å„ªå…ˆåº¦ | Issueæ•° | æ¨å®šå·¥æ•° | æœŸé–“ |
|-------|--------|---------|----------|------|
| **Phase 1** | ğŸ”´ Critical | 4 | 5-7å–¶æ¥­æ—¥ | 1é€±é–“ |
| **Phase 2** | ğŸŸ  High | 4 | 8-10å–¶æ¥­æ—¥ | 2é€±é–“ |
| **Phase 3** | ğŸŸ¡ Medium | 6 | 6-8å–¶æ¥­æ—¥ | 1ãƒ¶æœˆ |
| **Phase 4** | ğŸ”µ Low | 4 | 5-7å–¶æ¥­æ—¥ | 3ãƒ¶æœˆ |
| **åˆè¨ˆ** | | **18** | **24-32å–¶æ¥­æ—¥** | **3ãƒ¶æœˆ** |

---

## ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢æ”¹å–„äºˆæ¸¬

| ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œ | ã‚¹ã‚³ã‚¢ | æ”¹å–„ | çŠ¶æ…‹ |
|---------------|--------|------|------|
| **ç¾åœ¨** | 73.5/100 | - | è‰¯å¥½ï¼ˆè¦æ”¹å–„ï¼‰ |
| **Phase 1å®Œäº†** | 85/100 | +11.5 | å„ªè‰¯ |
| **Phase 2å®Œäº†** | 90/100 | +5 | å“è¶Š |
| **Phase 3å®Œäº†** | 93/100 | +3 | å“è¶Š |
| **Phase 4å®Œäº†** | 95/100 | +2 | ä¸–ç•Œã‚¯ãƒ©ã‚¹ |

---

## ğŸ“ Sub-Issueä½œæˆæ™‚ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

å„Sub-Issueã‚’ä½œæˆã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ï¼š

```markdown
# [Category] Issue Title

**å„ªå…ˆåº¦**: ğŸ”´/ğŸŸ /ğŸŸ¡/ğŸ”µ  
**CVSS**: X.X  
**å·¥æ•°**: Xæ—¥  
**æ‹…å½“**: Role  
**è¦ªIssue**: #[ãƒ¡ã‚¤ãƒ³Issueç•ªå·]

## å•é¡Œã®è©³ç´°

### å½±éŸ¿ç¯„å›²
- ãƒ•ã‚¡ã‚¤ãƒ«: `path/to/file.java`
- æ©Ÿèƒ½: æ©Ÿèƒ½å

### è„†å¼±æ€§å†…å®¹
[è©³ç´°ãªèª¬æ˜]

### CVEæƒ…å ±ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
- CVE-XXXX-XXXXX: èª¬æ˜

## ä¿®æ­£å†…å®¹

### å¤‰æ›´ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
- [ ] `path/to/file1.java`
- [ ] `path/to/file2.java`

### ã‚³ãƒ¼ãƒ‰ä¾‹
```java
// Before
[ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰]

// After
[ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰]
```

## æ¤œè¨¼é …ç›®

- [ ] æ©Ÿèƒ½ãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ç¢ºèª
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

## é–¢é€£Issue

- ä¾å­˜: #XXX
- é–¢é€£: #YYY

## å‚è€ƒè³‡æ–™

- [RFC/CVE/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®ãƒªãƒ³ã‚¯]
```

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [OWASP Top 10 2025](https://owasp.org/www-project-top-ten/)
- [idp-server ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼](../SECURITY.md)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰](content_05_how-to/deployment.md)
- [Unit Testing Strategy](content_09_project/unit-testing-strategy-by-module.md)

---

**ä½œæˆæ—¥**: 2025-10-09  
**æœ€çµ‚æ›´æ–°**: 2025-10-09  
**æ‰¿èª**: Security Assessment Team
