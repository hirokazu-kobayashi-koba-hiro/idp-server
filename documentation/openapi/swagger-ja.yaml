openapi: 3.0.3
info:
  title: idp-server API
  description: OAuth 2.0 / OpenID Connect 1.0 ã«æº–æ‹ ã—ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä»•æ§˜
  version: 1.0.0
  contact:
    name: idp-server OSS

servers:
  - url: http://localhost:8080

tags:
  - name: CIBAãƒ•ãƒ­ãƒ¼
    description: |
      OpenID Connect Client Initiated Backchannel Authentication (CIBA) ãƒ•ãƒ­ãƒ¼ã¯ã€
      ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä»‹ã•ãšã«èªè¨¼ã‚’è¡Œã†ã€éåŒæœŸã‹ã¤ãƒ‡ãƒã‚¤ã‚¹åˆ†é›¢å‹ã®OpenID Connectèªè¨¼ãƒ•ãƒ­ãƒ¼ã§ã™ã€‚

      ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒRelying Partyï¼ˆRPï¼‰ã¨æ“ä½œã™ã‚‹ç«¯æœ«ï¼ˆConsumption Deviceï¼‰ã¨ã€
      èªè¨¼ã‚„åŒæ„ã‚’è¡Œã†ç«¯æœ«ï¼ˆAuthentication Deviceï¼‰ã‚’åˆ†é›¢ã—ã¦è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€
      RPãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è­˜åˆ¥å­ã‚’æ—¢ã«çŸ¥ã£ã¦ã„ã‚‹å ´åˆã«ã€OPã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„IDãƒˆãƒ¼ã‚¯ãƒ³ã‚’éåŒæœŸã§å–å¾—ã§ãã¾ã™ã€‚
      
      ğŸ“˜ ä»•æ§˜è©³ç´°ï¼ˆOpenIDå…¬å¼ï¼‰:  
      [OpenID Connect Client Initiated Backchannel Authentication Core 1.0](https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html)
  - name: èªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼
    description: |
      OpenID Connect èªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼ã¯ã€OAuth 2.0 ã‚’åŸºç›¤ã¨ã—ãŸèªè¨¼ãƒ•ãƒ­ãƒ¼ã§ã‚ã‚Šã€
      Relying Partyï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼‰ãŒã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å®‰å…¨ã‹ã¤ç¢ºå®Ÿã«å–å¾—ã™ã‚‹ãŸã‚ã®æ¨™æº–çš„ãªæ‰‹æ³•ã§ã™ã€‚

      ã“ã®ãƒ•ãƒ­ãƒ¼ã¯ **èªè¨¼ã‚³ãƒ¼ãƒ‰ï¼ˆauthorization codeï¼‰** ã‚’é€šã˜ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ ID ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹æ§‹æˆã¨ãªã£ã¦ãŠã‚Šã€
      ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨èªå¯ã‚µãƒ¼ãƒãƒ¼ã®é–“ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆUser Agentï¼‰ã‚’ä»‹åœ¨ã•ã›ã‚‹ã“ã¨ã§ã€ã‚»ã‚­ãƒ¥ã‚¢ãªèªå¯ã¨èªè¨¼ã‚’ä¸¡ç«‹ã—ã¾ã™ã€‚

      ğŸ” **OpenID Connect ã®ç‰¹é•·**ï¼š
      - OAuth 2.0 ã«ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ 
      - `id_token` ã‚’ç”¨ã„ã¦ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è­˜åˆ¥
      - `userinfo` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã®å–å¾—

      ğŸ”‘ **å…¸å‹çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**ï¼š
      - Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚¤ãƒ³
      - SPAï¼ˆSingle Page Applicationï¼‰ã‚„ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã®ã‚µãƒ¼ãƒãƒ¼èªè¨¼é€£æº

      ğŸ“˜ é–¢é€£ä»•æ§˜ï¼š
      - [OpenID Connect Core 1.0](https://openid-foundation-japan.github.io/openid-connect-core-1_0.ja.html)
      - [OAuth 2.0 Framework (RFC 6749)](https://openid-foundation-japan.github.io/rfc6749.ja.html)

  - name: ãƒˆãƒ¼ã‚¯ãƒ³
    description: |
      OAuth 2.0 / OpenID Connect ã«ãŠã‘ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã«é–¢é€£ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¾¤ã§ã™ã€‚

      - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„IDãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã® **ãƒˆãƒ¼ã‚¯ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**
      - ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã™ã‚‹ **ãƒˆãƒ¼ã‚¯ãƒ³ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³**
      - ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ **ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒœã‚±ãƒ¼ã‚·ãƒ§ãƒ³**

      ã‚’å«ã¿ã€IDé€£æºãƒ»ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã«ãŠã‘ã‚‹ä¸­å¿ƒçš„ãªå½¹å‰²ã‚’æ‹…ã„ã¾ã™ã€‚

      ã“ã‚Œã‚‰ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’é€šã˜ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨èªå¯ã‚µãƒ¼ãƒãƒ¼é–“ã®ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼ãƒ»èªå¯ã®ã‚„ã‚Šã¨ã‚ŠãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚

      ğŸ“˜ é–¢é€£ä»•æ§˜ï¼š
      - [RFC 6749 - The OAuth 2.0 Authorization Framework](https://openid-foundation-japan.github.io/rfc6749.ja.html)
      - [RFC 7009 - Token Revocation](https://datatracker.ietf.org/doc/html/rfc7009)
      - [RFC 7662 - Token Introspection](https://datatracker.ietf.org/doc/html/rfc7662)
      - [OpenID Connect Core 1.0](https://openid.net/specs/openid-connect-core-1_0.html)

  - name: OIDC
    description: |
      OpenID Connect ã¯, OAuth 2.0 ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ä¸Šã«ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä»˜ä¸ã—ãŸã‚‚ã®ã§ã™ã€‚ ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ Client ãŒ Authorization Server ã®èªè¨¼çµæœã«åŸºã¥ã„ã¦ End-User ã®ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ¤œè¨¼å¯èƒ½ã«ã—ã¾ã™ã€‚ 
      
      ã¾ãŸåŒæ™‚ã« End-User ã®å¿…è¦æœ€ä½é™ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’, ç›¸äº’é‹ç”¨å¯èƒ½ã‹ã¤ RESTful ãªå½¢ã§å–å¾—ã™ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚
      
      ğŸ“˜ é–¢é€£ä»•æ§˜:  
      [OpenID Connect Core 1.0](https://openid-foundation-japan.github.io/openid-connect-core-1_0.ja.html)

  - name: OIDCãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
    description: |
      OpenID Connect Discovery 1.0 ã«åŸºã¥ãã€OpenID Providerï¼ˆOPï¼‰ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æƒ…å ±ã‚’æä¾›ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¾¤ã§ã™ã€‚
      
      ğŸ“˜ é–¢é€£ä»•æ§˜:  
      [OpenID Connect Discovery 1.0](https://openid.net/specs/openid-connect-discovery-1_0.html)

  - name: SSF
    description: |
      Shared Signals Framework (SSF) ã¯ã€OpenID Foundation ã«ã‚ˆã‚Šç­–å®šã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆå…±æœ‰ã®æ¨™æº–ä»•æ§˜ã§ã™ã€‚
      IdP-Server ã§ã¯ã€**Push Delivery Mode** ã«å¯¾å¿œã—ã¦ãŠã‚Šã€SETï¼ˆSecurity Event Tokenï¼‰å½¢å¼ã®é€šçŸ¥ã‚’ `POST` ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å—ä¿¡ã—ã¾ã™ã€‚

      RFC 8935 ã«æº–æ‹ ã—ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤±åŠ¹ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåœæ­¢ã€ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«å¤‰æ›´ãªã©ã®é‡è¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€£æºã§ãã¾ã™ã€‚

      ğŸ“˜ ä»•æ§˜: [RFC 8935 - Push-Based Event Delivery](https://www.rfc-editor.org/rfc/rfc8935.html)

paths:
  /v1/backchannel/authentications:
    post:
      summary: ãƒãƒƒã‚¯ãƒãƒ£ãƒ³ãƒãƒ«èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
      tags:
        - CIBAãƒ•ãƒ­ãƒ¼
      description: |
        CIBAï¼ˆClient-Initiated Backchannel Authenticationï¼‰ãƒ•ãƒ­ãƒ¼ã®ãƒãƒƒã‚¯ãƒãƒ£ãƒ³ãƒãƒ«èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€‚
        OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0 ã«æº–æ‹ ã€‚
        
        ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚
        ä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼æ–¹å¼ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼ˆClient Authenticationï¼‰ï¼š

          - **client_secret_basic**ï¼šAuthorizationãƒ˜ãƒƒãƒ€ã«Basicèªè¨¼å½¢å¼ã§ `client_id` / `client_secret` ã‚’é€ä¿¡ã—ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã€‚
          - **client_secret_post**ï¼š`client_id` ã¨ `client_secret` ã‚’ãƒ•ã‚©ãƒ¼ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«å«ã‚ã¾ã™ã€‚
          - **client_secret_jwt**ï¼šclient_secret ã‚’å…±é€šéµã¨ã—ã¦ç½²åã—ãŸ JWT ã‚’ `client_assertion` ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€‚
          - **private_key_jwt**ï¼šç™»éŒ²æ¸ˆã¿ã®å…¬é–‹éµã«å¯¾å¿œã™ã‚‹ç§˜å¯†éµã§ç½²åã—ãŸ JWT ã‚’ `client_assertion` ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€‚

          JWTèªè¨¼ï¼ˆclient_secret_jwt / private_key_jwtï¼‰ã§ã¯ã€ä»¥ä¸‹ã®ã‚¯ãƒ¬ãƒ¼ãƒ ã‚’å«ã‚€JWTã‚’ç”Ÿæˆã—ã€æ¬¡ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ï¼š

          - `client_assertion_type`: urn:ietf:params:oauth:client-assertion-type:jwt-bearer
          - `client_assertion`: ç½²åæ¸ˆã¿JWT
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/BackchannelAuthenticationRequest'
      responses:
        '200':
          description: èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ­£å¸¸ã«å—ç†ã•ã‚ŒãŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackchannelAuthenticationResponse'

        '400':
          description: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ã‚„ä¸æ­£ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackchannelAuthenticationErrorResponse'

        '401':
          description: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆinvalid_clientï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BackchannelAuthenticationErrorResponse'

  /v1/authorizations:
    get:
      summary: èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
      tags:
        - èªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼
      description: |
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªå¯ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€‚
        OpenID Connect Core 1.0 Section 3 ã«æº–æ‹ ã€‚
        
        æœ¬ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€ä»¥ä¸‹ã® OpenID Connect èªå¯ãƒ•ãƒ­ãƒ¼ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼š
          - Authorization Code Flowï¼ˆèªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼ï¼‰
          - Implicit Flowï¼ˆã‚¤ãƒ³ãƒ—ãƒªã‚·ãƒƒãƒˆãƒ•ãƒ­ãƒ¼ï¼‰
          - Hybrid Flowï¼ˆãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ•ãƒ­ãƒ¼ï¼‰
        
        èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹ã¨ã€æœ¬ã‚µãƒ¼ãƒãƒ¼ã¯ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®èªè¨¼ãƒ»åŒæ„ã‚’è¡Œã†ãŸã‚ã®èªå¯ç”»é¢URLã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚¹(302)ã¨ã—ã¦è¿”å´ã—ã¾ã™ã€‚
        ã“ã®URLã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®å¯¾è©±ï¼ˆèªè¨¼ãƒ»åŒæ„ï¼‰ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚
      parameters:
        - $ref: '#/components/parameters/response_type'
        - $ref: '#/components/parameters/client_id'
        - $ref: '#/components/parameters/redirect_uri'
        - $ref: '#/components/parameters/scope'
        - $ref: '#/components/parameters/state'
        - $ref: '#/components/parameters/nonce'
        - $ref: '#/components/parameters/display'
        - $ref: '#/components/parameters/prompt'
        - $ref: '#/components/parameters/max_age'
        - $ref: '#/components/parameters/ui_locales'
        - $ref: '#/components/parameters/id_token_hint'
        - $ref: '#/components/parameters/login_hint'
        - $ref: '#/components/parameters/acr_values'
        - $ref: '#/components/parameters/request'
        - $ref: '#/components/parameters/request_uri'
        - $ref: '#/components/parameters/claims'
        - $ref: '#/components/parameters/code_challenge'
        - $ref: '#/components/parameters/code_challenge_method'
        - $ref: '#/components/parameters/authorization_details'
      responses:
        '302':
          description: èªå¯ç”»é¢ã®URLï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰

  /v1/tokens:
    post:
      summary: ãƒˆãƒ¼ã‚¯ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
      tags:
        - ãƒˆãƒ¼ã‚¯ãƒ³
      description: |
        grant_typeã«å¿œã˜ã¦ã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¾ã™ã€‚
        ã‚µãƒãƒ¼ãƒˆã™ã‚‹grant_type
        
        - authorization_code: èªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼Grant
        - refresh_token: ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³Grant
        - password: ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚ºGrant
        - client_credentials: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚ºGrant
        - urn:openid:params:grant-type:ciba: CIBAãƒ•ãƒ­ãƒ¼Grant
        
        ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚
          ä»¥ä¸‹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼æ–¹å¼ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼ˆClient Authenticationï¼‰ï¼š

          - **client_secret_basic**ï¼šAuthorizationãƒ˜ãƒƒãƒ€ã«Basicèªè¨¼å½¢å¼ã§ `client_id` / `client_secret` ã‚’é€ä¿¡ã—ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã€‚
          - **client_secret_post**ï¼š`client_id` ã¨ `client_secret` ã‚’ãƒ•ã‚©ãƒ¼ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«å«ã‚ã¾ã™ã€‚
          - **client_secret_jwt**ï¼šclient_secret ã‚’å…±é€šéµã¨ã—ã¦ç½²åã—ãŸ JWT ã‚’ `client_assertion` ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€‚
          - **private_key_jwt**ï¼šç™»éŒ²æ¸ˆã¿ã®å…¬é–‹éµã«å¯¾å¿œã™ã‚‹ç§˜å¯†éµã§ç½²åã—ãŸ JWT ã‚’ `client_assertion` ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€‚
          - **none**ï¼šèªè¨¼ã‚’è¡Œã„ã¾ã›ã‚“ã€‚PKCEã‚’ä½¿ç”¨ã™ã‚‹Publicã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‘ã‘ã€‚

          JWTèªè¨¼ï¼ˆclient_secret_jwt / private_key_jwtï¼‰ã§ã¯ã€ä»¥ä¸‹ã®ã‚¯ãƒ¬ãƒ¼ãƒ ã‚’å«ã‚€JWTã‚’ç”Ÿæˆã—ã€æ¬¡ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ï¼š

          - `client_assertion_type`: urn:ietf:params:oauth:client-assertion-type:jwt-bearer
          - `client_assertion`: ç½²åæ¸ˆã¿JWT
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              oneOf:
                - $ref: '#/components/schemas/AuthorizationCodeTokenRequest'
                - $ref: '#/components/schemas/RefreshTokenRequest'
                - $ref: '#/components/schemas/ResourceOwnerPasswordTokenRequest'
                - $ref: '#/components/schemas/ClientCredentialsTokenRequest'
                - $ref: '#/components/schemas/CibaTokenRequest'
      responses:
        '200':
          description: ãƒˆãƒ¼ã‚¯ãƒ³ãƒ¬ã‚¹ãƒãƒ³ã‚¹
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/TokenResponse'
                  - $ref: '#/components/schemas/CibaTokenResponse'

        '400':
          description: |
            OAuth 2.0 Token Endpoint ã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã€‚
            RFC 6749 Section 5.2 ã«æº–æ‹ ã€‚
            
            ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä¸€è¦§ï¼š

            - **invalid_request**  
              ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã‚‹ã€ã¾ãŸã¯æ§‹æ–‡ãŒä¸æ­£ãªå ´åˆã«è¿”ã•ã‚Œã‚‹ã€‚  
              ä¾‹ï¼š`grant_type` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ã€åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè¤‡æ•°å­˜åœ¨ã™ã‚‹ ãªã©ã€‚

            - **invalid_client**  
              ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã«è¿”ã•ã‚Œã‚‹ã€‚  
              ä¾‹ï¼šHTTP Basic èªè¨¼ã®æƒ…å ±ãŒä¸æ­£ã€`client_secret` ãŒé–“é•ã£ã¦ã„ã‚‹ã€JWTç½²åã®æ¤œè¨¼ã«å¤±æ•—ã€‚

            - **invalid_grant**  
              `authorization_code`ã€`refresh_token` ç­‰ã® grant ãŒä¸æ­£ã¾ãŸã¯å¤±åŠ¹ã—ã¦ã„ã‚‹å ´åˆã€‚  
              ä¾‹ï¼šèªå¯ã‚³ãƒ¼ãƒ‰ãŒä½¿ç”¨æ¸ˆã¿ã€æœŸé™åˆ‡ã‚Œã€ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒã€redirect_uri ãŒä¸€è‡´ã—ãªã„ã€‚

            - **unauthorized_client**  
              ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒè¨±å¯ã•ã‚Œã¦ã„ãªã„ `grant_type` ã‚’ä½¿ç”¨ã—ã‚ˆã†ã¨ã—ãŸå ´åˆã€‚  
              ä¾‹ï¼š`client_credentials` ãŒè¨±å¯ã•ã‚Œã¦ã„ãªã„ã®ã«ä½¿ã£ãŸå ´åˆã€‚

            - **unsupported_grant_type**  
              ã‚µãƒ¼ãƒãƒ¼ãŒã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ `grant_type` ã‚’æŒ‡å®šã—ãŸå ´åˆã€‚  
              ä¾‹ï¼štypo ã‚„æœªå¯¾å¿œã®ç‹¬è‡ªæ‹¡å¼µã€‚

            - **invalid_scope**  
              ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸ scope ãŒä¸æ­£ã¾ãŸã¯è¨±å¯ã•ã‚Œã¦ã„ãªã„å ´åˆã€‚  
              ä¾‹ï¼š`offline_access` ã®è¦æ±‚ãŒè¨±å¯ã•ã‚Œã¦ã„ãªã„ã€‚
            
            CIBAãƒ•ãƒ­ãƒ¼ã§ã¯ã€é€šå¸¸ã®OAuth 2.0ã®ã‚¨ãƒ©ãƒ¼ã«åŠ ãˆã¦ã€ä»¥ä¸‹ã®å›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼å€¤ã‚‚å«ã¾ã‚Œã¾ã™ï¼š
            
            - `authorization_pending`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªè¨¼ãŒã¾ã å®Œäº†ã—ã¦ã„ãªã„
            - `slow_down`: ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ãŒçŸ­ã™ãã‚‹
            - `expired_token`: èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸ
            - `access_denied`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼ã‚’æ‹’å¦ã—ãŸ
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/TokenErrorResponse'
                  - $ref: '#/components/schemas/CibaTokenErrorResponse'

        '401':
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã®ã‚¨ãƒ©ãƒ¼ã€‚

            ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ³ã§è¿”ã•ã‚Œã¾ã™ï¼š

              - Authorizationãƒ˜ãƒƒãƒ€ã«ä¸æ­£ãªBasicèªè¨¼æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ãŸ
              - client_secret ãŒé–“é•ã£ã¦ã„ã‚‹
              - client_assertionï¼ˆJWTï¼‰ã®ç½²åæ¤œè¨¼ã«å¤±æ•—ã—ãŸ
              - JWTã® `exp`, `aud`, `iss`, `jti` ãŒä¸æ­£ã¾ãŸã¯ä¸æ•´åˆã ã£ãŸ
              - ç™»éŒ²ã•ã‚Œã¦ã„ãªã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚¢ã‚¯ã‚»ã‚¹ã—ãŸ

              ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯å¸¸ã« `invalid_client` ãŒè¿”ã•ã‚Œã¾ã™ã€‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenInvalidClientErrorResponse'

  /v1/tokens/introspection:
    post:
      tags:
        - ãƒˆãƒ¼ã‚¯ãƒ³
      summary: ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
      description: |
        ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯è‡ªèº«ãŒç™ºè¡Œã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æ€§ã‚„é–¢é€£æƒ…å ±ã‚’ç…§ä¼šã§ãã¾ã™ã€‚
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenIntrospectionRequest'
      responses:
        '200':
          description: æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã«å¯¾ã™ã‚‹ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³çµæœã€‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenIntrospectionResponse'
        '400':
          description: ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã¾ãŸã¯å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¬ è½ã€‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenIntrospectionBadRequestResponse'
        '401':
          description: èªè¨¼ã‚¨ãƒ©ãƒ¼ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã€‚

  /v1/tokens/introspection-extensions:
    post:
      tags:
        - ãƒˆãƒ¼ã‚¯ãƒ³
      summary: ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ï¼ˆæ‹¡å¼µï¼‰
      description: |
        ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®æ¨™æº–ä»•æ§˜ã‚’æ‹¡å¼µã—ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚        
        ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼å´ã§å®Ÿæ–½ã—ã¦ã„ã‚‹è¨±å¯ã—ã¦ã„ã‚‹
         - ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å«ã‚“ã§ã„ã‚‹ã‹
         - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸ãŒãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‹
        
        ã®æ¤œè¨¼ã‚‚å®Ÿæ–½ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
      
        ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœ‰åŠ¹ãªå ´åˆã¯ã€æ¨™æº–ä»•æ§˜ã«æ²¿ã£ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”å´ã—ã¾ã™ã€‚
        
        ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ãªå ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ã®åŸå› ã‚’å«ã‚ã¦ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”å´ã—ã¾ã™ã€‚
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenIntrospectionExtensionRequest'
      responses:
        '200':
          description: æœ‰åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã«å¯¾ã™ã‚‹ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³çµæœã€‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenIntrospectionResponse'
        '400':
          description: ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã¾ãŸã¯å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¬ è½ã€‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenIntrospectionBadRequestResponse'
        '401':
          description: èªè¨¼ã‚¨ãƒ©ãƒ¼ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã€‚

  /v1/tokens/revocation:
    post:
      tags:
        - ãƒˆãƒ¼ã‚¯ãƒ³
      summary: ãƒˆãƒ¼ã‚¯ãƒ³å¤±åŠ¹
      description: |
        ç™ºè¡Œæ¸ˆã¿ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç„¡åŠ¹åŒ–ï¼ˆå–ã‚Šæ¶ˆã—ï¼‰ã™ã‚‹ãŸã‚ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯è‡ªåˆ†ãŒç™ºè¡Œã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã®ã¿ã‚’ãƒªãƒœãƒ¼ã‚¯å¯èƒ½ã§ã™ã€‚
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenRevocationRequest'
      responses:
        '200':
          description: ãƒªãƒœã‚±ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸã€‚å¸¸ã«200ã‚’è¿”ã™ä»•æ§˜ã€‚
        '400':
          description: ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¬ è½ã€‚
        '401':
          description: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼ã‚¨ãƒ©ãƒ¼ã€‚

  /v1/userinfo:
    get:
      summary: ãƒ¦ãƒ¼ã‚¶ãƒ¼Info
      tags:
        - OIDC
      description: |
        èªè¨¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’è¿”ã™ã€‚
        OpenID Connect Core 1.0 Section 5 ã«æº–æ‹ ã€‚
      security:
        - bearerAuth: [ ]
      responses:
        '200':
          description: æˆåŠŸæ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfoResponse'

        '401':
          description: |
            ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œã®å ´åˆã®èªè¨¼ã‚¨ãƒ©ãƒ¼ã€‚
            ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ã€OAuth 2.0 Bearer Token Usageï¼ˆRFC 6750ï¼‰Section 3 ã«å¾“ã„ã€
            `WWW-Authenticate` ãƒ˜ãƒƒãƒ€ä»˜ãã§è¿”å´ã•ã‚Œã¾ã™ã€‚

            ä¾‹:
              HTTP/1.1 401 Unauthorized  
              WWW-Authenticate: Bearer error=\"invalid_token\", error_description=\"The Access Token expired\"
          headers:
            WWW-Authenticate:
              description: |
                Bearer Token ã®èªè¨¼ã‚¨ãƒ©ãƒ¼æƒ…å ±ã€‚
                RFC 6750 Section 3 ã«å¾“ã„ã€ã‚¨ãƒ©ãƒ¼è©³ç´°ï¼ˆä¾‹ï¼šinvalid_tokenï¼‰ã¨èª¬æ˜ãŒå«ã¾ã‚Œã¾ã™ã€‚
              schema:
                type: string
    post:
      summary: ãƒ¦ãƒ¼ã‚¶ãƒ¼Info
      tags:
        - OIDC
      description: |
        èªè¨¼ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’è¿”ã™ã€‚
        OpenID Connect Core 1.0 Section 5 ã«æº–æ‹ ã€‚
      security:
        - bearerAuth: [ ]
      responses:
        '200':
          description: æˆåŠŸæ™‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfoResponse'

        '401':
          description: |
            ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œã®å ´åˆã®èªè¨¼ã‚¨ãƒ©ãƒ¼ã€‚
            ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ã€OAuth 2.0 Bearer Token Usageï¼ˆRFC 6750ï¼‰Section 3 ã«å¾“ã„ã€
            `WWW-Authenticate` ãƒ˜ãƒƒãƒ€ä»˜ãã§è¿”å´ã•ã‚Œã¾ã™ã€‚

            ä¾‹:
              HTTP/1.1 401 Unauthorized  
              WWW-Authenticate: Bearer error=\"invalid_token\", error_description=\"The Access Token expired\"
          headers:
            WWW-Authenticate:
              description: |
                Bearer Token ã®èªè¨¼ã‚¨ãƒ©ãƒ¼æƒ…å ±ã€‚
                RFC 6750 Section 3 ã«å¾“ã„ã€ã‚¨ãƒ©ãƒ¼è©³ç´°ï¼ˆä¾‹ï¼šinvalid_tokenï¼‰ã¨èª¬æ˜ãŒå«ã¾ã‚Œã¾ã™ã€‚
              schema:
                type: string

  /.well-known/openid-configuration:
    get:
      summary: OpenID Connect Discovery
      tags:
        - OIDCãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
      description: |
        OpenID Connect Discovery 1.0 ã«åŸºã¥ãã€OpenID Providerï¼ˆOPï¼‰ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æƒ…å ±ã‚’æä¾›ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç¾¤ã§ã™ã€‚
        
        èªå¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€UserInfoã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€JWKs URI ãªã©ã€
        OpenID Connect ã®å„ç¨®æ©Ÿèƒ½ã«å¿…è¦ãªæ§‹æˆæƒ…å ±ã‚’æ©Ÿæ¢°å¯èª­å½¢å¼ï¼ˆJSONï¼‰ã§æä¾›ã—ã¾ã™ã€‚

        ã“ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒOPã¨é€£æºã™ã‚‹ãŸã‚ã«äº‹å‰ã«å–å¾—ãƒ»æ¤œè¨¼ã™ã‚‹ã‚‚ã®ã§ã€
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è‡ªå‹•æ§‹æˆã‚„ã‚»ã‚­ãƒ¥ã‚¢ãªé€£æºã‚’å®Ÿç¾ã™ã‚‹åŸºç›¤ã¨ãªã‚Šã¾ã™ã€‚
    
        ğŸ“˜ é–¢é€£ä»•æ§˜:
        [OpenID Connect Discovery 1.0](https://openid.net/specs/openid-connect-discovery-1_0.html)
    
        ğŸ” æä¾›ã•ã‚Œã‚‹ä¸»ãªæƒ…å ±ï¼š
          - issuerï¼ˆç™ºè¡Œè€…è­˜åˆ¥å­ï¼‰
          - authorization_endpoint
          - token_endpoint
          - userinfo_endpoint
          - jwks_uriï¼ˆå…¬é–‹éµå–å¾—ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
          - response_types_supportedã€grant_types_supported ãªã©ã®å¯¾å¿œæ–¹å¼
      responses:
        '200':
          description: Discoveryãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OpenIDConfiguration'

  /v1/jwks:
    get:
      summary: JSON Web Key Set (JWKS)
      description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç½²åã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®å…¬é–‹éµã‚»ãƒƒãƒˆï¼ˆJWK Setï¼‰ã‚’è¿”ã—ã¾ã™ã€‚
      tags:
        - OIDCãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
      responses:
        '200':
          description: JWK Set response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JWKS'


  /v1/ssf/events/receive:
    post:
      summary: |
       SSF (Shared Signals Framework) Push Notification Receiver        
       â€» idp-serverã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ã™ã‚‹ã‚¢ãƒ—ãƒªãŒä½œæˆã™ã‚‹APIä»•æ§˜ã§ã™ã€‚ä»»æ„ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã§ãã¾ã™ã€‚
      tags:
        - SSF
      description: |
        ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€OpenID Shared Signals Framework (SSF) ã«ãŠã‘ã‚‹ **Pushå‹é€šçŸ¥ (Push Delivery Mode)** ã‚’å—ä¿¡ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚
                
        ğŸ“˜ ä»•æ§˜æº–æ‹ : [RFC 8935](https://www.rfc-editor.org/rfc/rfc8935.html)
        
        ğŸ” åˆ©ç”¨ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆä¾‹ï¼ˆä¾‹: RISCä»•æ§˜æº–æ‹ ï¼‰:
        - `https://schemas.openid.net/secevent/risc/event-type/account-disabled`
        - `https://schemas.openid.net/secevent/risc/event-type/credential-change-required`
        - `https://schemas.openid.net/secevent/risc/event-type/sessions-revoked`
        
        ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹Security Event Token (SET) å½¢å¼ã®JWTã‚’å—ã‘å…¥ã‚Œã€å¿…è¦ã«å¿œã˜ã¦æ¤œè¨¼ãƒ»å‡¦ç†ã‚’è¡Œã†ã‚‚ã®ã§ã™ã€‚
        
        > ğŸ”’ èªè¨¼ã«ã¯ `POST` ãƒªã‚¯ã‚¨ã‚¹ãƒˆã® `Authorization` ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ï¼ˆä¾‹: Bearer Tokenï¼‰ã€‚

      requestBody:
        required: true
        content:
          application/secevent+jwt:
            schema:
              $ref: '#/components/schemas/SecurityEventToken'

      responses:
        '202':
          description: é€šçŸ¥ã‚’å—ã‘å–ã‚Šã€æ­£å¸¸ã«ã‚­ãƒ¥ãƒ¼ã¾ãŸã¯å‡¦ç†ã«ç™»éŒ²ã—ãŸï¼ˆéåŒæœŸå‡¦ç†ãŒå‰æï¼‰
        '400':
          description: ä¸æ­£ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆJWTãŒç„¡åŠ¹ã€å½¢å¼ãŒä¸æ­£ï¼‰
        '401':
          description: èªè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã€ç½²åæ¤œè¨¼å¤±æ•—ï¼‰

  /v1/ssf/jwks:
    get:
      summary: JSON Web Key Set (JWKS)
      description: SETã®ç½²åã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®å…¬é–‹éµã‚»ãƒƒãƒˆï¼ˆJWK Setï¼‰ã‚’è¿”ã—ã¾ã™ã€‚
      tags:
        - SSF
      responses:
        '200':
          description: JWK Set response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JWKS'

components:
  parameters:
    response_type:
      name: response_type
      in: query
      required: true
      description: |
        ä½¿ç”¨ã™ã‚‹èªå¯ãƒ•ãƒ­ãƒ¼ã®ç¨®é¡ã€‚OpenID Connectã§ã¯é€šå¸¸ "code" ã‚’ä½¿ç”¨ã€‚
        ä»–ã«ã‚‚ "id_token" ã‚„ "token" ã‚’çµ„ã¿åˆã‚ã›ã¦ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ•ãƒ­ãƒ¼ã‚‚å¯èƒ½ã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      schema:
        type: string
        enum: [code, id_token, token, code id_token, code token, id_token token, code id_token token]

    client_id:
      name: client_id
      in: query
      required: true
      description: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸä¸€æ„ã®IDã€‚
      schema:
        type: string

    redirect_uri:
      name: redirect_uri
      in: query
      required: true
      description: èªå¯å¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹URIã€‚äº‹å‰ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
      schema:
        type: string
        format: uri

    scope:
      name: scope
      in: query
      required: true
      description: |
        è¦æ±‚ã™ã‚‹ã‚¹ã‚³ãƒ¼ãƒ—ã€‚è¤‡æ•°è¨­å®šã™ã‚‹å ´åˆã¯åŠè§’ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã€‚OpenID Connectã§ã¯ "openid" ã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
        ä¾‹: "openid profile email"
      schema:
        type: string

    state:
      name: state
      in: query
      required: true
      description: CSRFå¯¾ç­–ãªã©ã®ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ä»»æ„æ–‡å­—åˆ—ã€‚
      schema:
        type: string

    nonce:
      name: nonce
      in: query
      required: false
      description: ãƒªãƒ—ãƒ¬ã‚¤ã‚¢ã‚¿ãƒƒã‚¯é˜²æ­¢ã®ãŸã‚ã®ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼ˆIDãƒˆãƒ¼ã‚¯ãƒ³ã®æ¤œè¨¼ã«ä½¿ç”¨ï¼‰ã€‚
      schema:
        type: string

    display:
      name: display
      in: query
      required: false
      description: |
        èªå¯ç”»é¢ã®è¡¨ç¤ºæ–¹æ³•ã‚’æŒ‡å®šï¼ˆpopup / page / touch / wapï¼‰ã€‚
        åŸºæœ¬ã¯çœç•¥å¯èƒ½ã€‚
      schema:
        type: string

    prompt:
      name: prompt
      in: query
      required: false
      description: |
        èªå¯ã‚µãƒ¼ãƒãƒ¼ã®å‹•ä½œã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®ãƒ’ãƒ³ãƒˆã€‚
        ä¾‹: "login", "none", "consent", "select_account"
      schema:
        type: string

    max_age:
      name: max_age
      in: query
      required: false
      description: |
        æœ€å¾Œã®èªè¨¼ã‹ã‚‰ã®çµŒéç§’æ•°ã®æœ€å¤§å€¤ã€‚ã“ã‚Œã‚’è¶…ãˆã¦ã„ã‚‹ã¨å†èªè¨¼ãŒè¦æ±‚ã•ã‚Œã‚‹ã€‚
      schema:
        type: integer

    ui_locales:
      name: ui_locales
      in: query
      required: false
      description: |
        èªå¯ç”»é¢ã®UIè¨€èªè¨­å®šã€‚è¤‡æ•°æŒ‡å®šå¯èƒ½ï¼ˆä¾‹: "ja en-US fr"ï¼‰ã€‚
      schema:
        type: string

    id_token_hint:
      name: id_token_hint
      in: query
      required: false
      description: |
        ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç¤ºå”†ã™ã‚‹IDãƒˆãƒ¼ã‚¯ãƒ³ã€‚ãƒ­ã‚°ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³å†åˆ©ç”¨ã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ºå®šã«ä½¿ç”¨ã€‚
      schema:
        type: string

    login_hint:
      name: login_hint
      in: query
      required: false
      description: |
        ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥ã®ãƒ’ãƒ³ãƒˆï¼ˆemailã€phoneã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åãªã©ï¼‰ã€‚
        ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã®äº‹å‰å…¥åŠ›ãªã©ã«ä½¿ç”¨ã€‚
      schema:
        type: string

    acr_values:
      name: acr_values
      in: query
      required: false
      description: |
        å¿…è¦ã¨ã•ã‚Œã‚‹èªè¨¼ãƒ¬ãƒ™ãƒ«ï¼ˆä¾‹: "urn:mfa:required" ãªã©ï¼‰ã‚’æŒ‡å®šã€‚
        èªè¨¼å¼·åº¦ãƒãƒªã‚·ãƒ¼ã®åˆ¶å¾¡ã«ä½¿ç”¨ã€‚
      schema:
        type: string

    request:
      name: request
      in: query
      required: false
      description: |
        ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å«ã‚€JWTã€‚ç½²åãƒ»æš—å·åŒ–å¯èƒ½ãª "Request Object"ã€‚
        èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ä¸€è²«æ€§ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Šã«ä½¿ç”¨ã€‚
      schema:
        type: string

    request_uri:
      name: request_uri
      in: query
      required: false
      description: |
        äº‹å‰ç™»éŒ²ã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®URIã€‚
        ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚µã‚¤ã‚ºå‰Šæ¸›ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã«åˆ©ç”¨ã•ã‚Œã‚‹ã€‚
      schema:
        type: string

    claims:
      name: claims
      in: query
      required: false
      description: |
        ç‰¹å®šã® Claim ã‚’ `id_token` ã‚„ `userinfo` ã«å«ã‚ã‚‹ã‚ˆã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‚
        å€¤ã¯ JSON å½¢å¼ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ãŠã‚Šã€form-urlencoded ã«ã‚ˆã£ã¦é€ä¿¡ã•ã‚Œã‚‹ã€‚
        
        ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ã§ã€IDãƒˆãƒ¼ã‚¯ãƒ³ã‚„UserInfoã«å«ã‚ãŸã„Claimã‚’æŒ‡å®šã§ãã‚‹ï¼š
        
        ä¾‹:
        {
          "userinfo": {
            "email": { "essential": true },
            "email_verified": { "essential": true }
          },
          "id_token": {
            "auth_time": { "essential": true },
            "acr": { "values": ["urn:mace:incommon:iap:silver"] }
          }
        }
        
        - `essential`: Claim ãŒå¿…é ˆã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ï¼ˆtrue/falseï¼‰
        - `value`: ç‰¹å®šã®å€¤ã‚’è¦æ±‚
        - `values`: å€™è£œå€¤ã®é…åˆ—ã‚’æŒ‡å®š
        - `null`: ä»»æ„è¦æ±‚ï¼ˆVoluntary Claimï¼‰
        
        `claims_locales` ã¨ä½µç”¨ã™ã‚‹ã“ã¨ã§ã€è¨€èªã‚¿ã‚°æŒ‡å®šã®Claimè¦æ±‚ã‚‚å¯èƒ½ã€‚
        
        â—†è£œè¶³
        `claims` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€Authorization Request æ™‚ã« OpenID Provider ã«å¯¾ã—ã¦
        å¿…è¦ãª Claimï¼ˆå±æ€§ï¼‰ã‚’æ˜ç¤ºçš„ã«è¦æ±‚ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

        - `userinfo` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼šUserInfoã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«è¿”ã•ã‚Œã‚‹Claimã‚’æŒ‡å®š
        - `id_token` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼šIDãƒˆãƒ¼ã‚¯ãƒ³ã«å«ã¾ã‚Œã‚‹Claimã‚’æŒ‡å®š
        - `essential` ãƒ•ãƒ©ã‚°ã§å¿…é ˆï¼ä»»æ„ã‚’åŒºåˆ¥
        - `value` / `values` ã«ã‚ˆã‚‹å€¤åˆ¶ç´„
        - `claims_locales` ã¨ä½µç”¨ã™ã‚Œã°ã€è¨€èªæŒ‡å®šä»˜ãã®Claimã‚‚è¦æ±‚å¯èƒ½

        ä»•æ§˜ï¼šOpenID Connect Core 1.0 Section 5.5 ã‚’å‚ç…§ã€‚

      schema:
        type: string

    code_challenge:
      name: code_challenge
      in: query
      required: false
      description: |
        PKCEç”¨ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸æ–‡å­—åˆ—ã€‚SHA256ãªã©ã§ `code_verifier` ã‚’å¤‰æ›ã—ãŸå€¤ã€‚
        publicã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆSPAã‚„ãƒ¢ãƒã‚¤ãƒ«ï¼‰ã§ã¯ä½¿ç”¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ã€‚
      schema:
        type: string

    code_challenge_method:
      name: code_challenge_method
      in: query
      required: false
      description: |
        `code_challenge` ã®ç”Ÿæˆã«ä½¿ç”¨ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã€‚
        æ¨å¥¨ã¯ "S256"ã€‚çœç•¥æ™‚ã¯ "plain" æ‰±ã„ã«ãªã‚‹ã€‚
      schema:
        type: string
        enum: [ plain, S256 ]

    authorization_details:
      name: authorization_details
      in: query
      required: false
      description: |
        RFC 9396ï¼ˆãƒªãƒƒãƒèªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã§å®šç¾©ã•ã‚ŒãŸ authorization detail ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã€‚ã®JSONæ–‡å­—åˆ—
      schema:
        type: string
#        $ref: '#/components/schemas/AuthorizationDetails'

  schemas:
    AuthorizationCodeTokenRequest:
      type: object
      description: |
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒèªå¯ã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ã™ã‚‹ãŸã‚ã«é€ä¿¡ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        grant_type:
          type: string
          description: |
            ä½¿ç”¨ã™ã‚‹ã‚°ãƒ©ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã€‚
            èªå¯ã‚³ãƒ¼ãƒ‰ãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã¯ "authorization_code"ã€‚
        code:
          type: string
          description: |
            èªå¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å—ã‘å–ã£ãŸèªå¯ã‚³ãƒ¼ãƒ‰ã€‚
        redirect_uri:
          type: string
          description: |
            èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«æŒ‡å®šã—ãŸ redirect_uri ã¨ä¸€è‡´ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
            â€»èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã« redirect_uri ã‚’æŒ‡å®šã—ãŸå ´åˆã¯å¿…é ˆã€‚
          format: uri
        client_id:
          type: string
          description: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è­˜åˆ¥å­ã€‚public ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã¯å¿…é ˆã€‚
        client_secret:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
        code_verifier:
          type: string
          description: |
            PKCEã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒ£ãƒ¬ãƒ³ã‚¸æ¤œè¨¼ç”¨ã®æ–‡å­—åˆ—ã€‚
            èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ code_challenge ã‚’æŒ‡å®šã—ãŸå ´åˆã¯å¿…é ˆã€‚
      required:
        - grant_type
        - code

    ResourceOwnerPasswordTokenRequest:
      type: object
      description: |
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ã™ã‚‹ãŸã‚ã«é€ä¿¡ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        grant_type:
          type: string
          description: |
            ä½¿ç”¨ã™ã‚‹ã‚°ãƒ©ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã€‚
            ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³Grantã«ãŠã„ã¦ã¯"refresh_token"ã€‚
        username:
          type: string
          description: |
            ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ãƒ 
        password:
          type: string
          description: |
            ãƒªã‚½ãƒ¼ã‚¹ã‚ªãƒ¼ãƒŠãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
        client_id:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è­˜åˆ¥å­ã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_post or none ã®å ´åˆã«è¨­å®šã™ã‚‹
        client_secret:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
      required:
        - grant_type
        - username
        - password

    ClientCredentialsTokenRequest:
      type: object
      description: |
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã™ã‚‹ãŸã‚ã«é€ä¿¡ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        OAuth 2.0 ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        grant_type:
          type: string
          description: |
            ä½¿ç”¨ã™ã‚‹ã‚°ãƒ©ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã€‚
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«ã‚ºGrantã«ãŠã„ã¦ã¯"client_credentials"ã€‚
        scope:
          type: string
          description: |
            è¦æ±‚ã™ã‚‹ã‚¹ã‚³ãƒ¼ãƒ—ã€‚
        client_id:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è­˜åˆ¥å­
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
        client_secret:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
      required:
        - grant_type
        - scope

    RefreshTokenRequest:
      type: object
      description: |
        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ã™ã‚‹ãŸã‚ã«é€ä¿¡ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        grant_type:
          type: string
          description: |
            ä½¿ç”¨ã™ã‚‹ã‚°ãƒ©ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã€‚
            ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³Grantã«ãŠã„ã¦ã¯"refresh_token"ã€‚
        refresh_token:
          type: string
          description: |
            ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
        client_id:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è­˜åˆ¥å­ã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_post or none ã®å ´åˆã«è¨­å®šã™ã‚‹
        client_secret:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
      required:
        - grant_type
        - refresh_token

    CibaTokenRequest:
      type: object
      description: |
        CIBAï¼ˆClient Initiated Backchannel Authenticationï¼‰ãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã€èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆå®Œäº†å¾Œã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        grant_type ã¯å¸¸ã« "urn:openid:params:grant-type:ciba" ã¨ãªã‚‹ã€‚
      properties:
        grant_type:
          type: string
          enum:
            - urn:openid:params:grant-type:ciba
          description: |
            ã‚°ãƒ©ãƒ³ãƒˆã‚¿ã‚¤ãƒ—å›ºå®šå€¤ã€‚"urn:openid:params:grant-type:ciba"
        auth_req_id:
          type: string
          description: |
            backchannel authentication ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ç™ºè¡Œã•ã‚ŒãŸä¸€æ™‚çš„è­˜åˆ¥å­ã€‚
            èªè¨¼ãŒå®Œäº†ã™ã‚‹ã¨ã“ã®IDã‚’ä½¿ã£ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ã€‚
        client_id:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è­˜åˆ¥å­ã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
        client_secret:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã€‚
            èªè¨¼æ–¹å¼ãŒclient_secret_postã®å ´åˆã«è¨­å®šã™ã‚‹ã€‚
      required:
        - grant_type
        - auth_req_id


    TokenResponse:
      type: object
      description: |
        ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰è¿”å´ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        OpenID Connect ãƒ•ãƒ­ãƒ¼ã§ã‚ã‚Œã° id_token ãŒå«ã¾ã‚Œã‚‹ã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      required:
        - access_token
        - token_type
        - expires_in
      properties:
        access_token:
          type: string
          description: |
            APIã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            è­˜åˆ¥å­å‹ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼‰ or å†…åŒ…å‹ï¼ˆJWTï¼‰ã€‚
        token_type:
          type: string
          description: |
            ãƒˆãƒ¼ã‚¯ãƒ³ã‚¿ã‚¤ãƒ—ã€‚é€šå¸¸ã¯ "Bearer"ã€‚
          example: Bearer
        expires_in:
          type: integer
          description: |
            ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ï¼ˆç§’å˜ä½ï¼‰ã€‚
          example: 3600
        refresh_token:
          type: string
          description: |
            æ–°ã—ã„ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã‚„è¨­å®šã«ã‚ˆã£ã¦ã¯è¿”ã•ã‚Œãªã„ã€‚
        id_token:
          type: string
          description: |
            OpenID Connect ãƒ•ãƒ­ãƒ¼ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¡¨ã™JWTãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            subï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼‰ã‚„èªè¨¼æ™‚é–“ãªã©ã®ã‚¯ãƒ¬ãƒ¼ãƒ ãŒå«ã¾ã‚Œã‚‹ã€‚

    CibaTokenResponse:
      type: object
      description: |
        CIBAãƒ•ãƒ­ãƒ¼ã«ãŠã‘ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰è¿”å´ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0 ä»•æ§˜ã«æº–æ‹ ã€‚
      required:
        - access_token
        - token_type
        - expires_in
        - id_token
      properties:
        access_token:
          type: string
          description: |
            APIã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            è­˜åˆ¥å­å‹ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ï¼‰ or å†…åŒ…å‹ï¼ˆJWTï¼‰ã€‚
        token_type:
          type: string
          description: |
            ãƒˆãƒ¼ã‚¯ãƒ³ã‚¿ã‚¤ãƒ—ã€‚é€šå¸¸ã¯ "Bearer"ã€‚
          example: Bearer
        expires_in:
          type: integer
          description: |
            ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ï¼ˆç§’å˜ä½ï¼‰ã€‚
          example: 3600
        refresh_token:
          type: string
          description: |
            æ–°ã—ã„ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã‚„è¨­å®šã«ã‚ˆã£ã¦ã¯è¿”ã•ã‚Œãªã„ã€‚
        id_token:
          type: string
          description: |
            OpenID Connect ãƒ•ãƒ­ãƒ¼ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¡¨ã™JWTãƒˆãƒ¼ã‚¯ãƒ³ã€‚
            subï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼‰ã‚„èªè¨¼æ™‚é–“ãªã©ã®ã‚¯ãƒ¬ãƒ¼ãƒ ãŒå«ã¾ã‚Œã‚‹ã€‚

    TokenErrorResponse:
      type: object
      description: |
        ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        error:
          type: string
          enum: [invalid_request, invalid_client, invalid_grant, unauthorized_client, unsupported_grant_type, invalid_scope]
          description: |
            ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã€‚
        error_description:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ãªèª¬æ˜ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã§ã¯ãªã„ï¼‰
      required:
        - error

    TokenInvalidClientErrorResponse:
      type: object
      description: |
        ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        OAuth 2.0 / OpenID Connect ä»•æ§˜ã«æº–æ‹ ã€‚
      properties:
        error:
          type: string
          enum: [ invalid_client ]
          description: |
            ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã€‚
        error_description:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ãªèª¬æ˜ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã§ã¯ãªã„ï¼‰
      required:
        - error

    CibaTokenErrorResponse:
      type: object
      description: |
        CIBAãƒ•ãƒ­ãƒ¼ã«ãŠã‘ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        [OpenID CIBA Core 1.0](https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html#token-error-response) ã«æº–æ‹ ã€‚
      properties:
        error:
          type: string
          enum: [ invalid_request, invalid_client, invalid_grant, unauthorized_client, unsupported_grant_type, invalid_scope, authorization_pending, slow_down, expired_token, access_denied ]
          description: |
            ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã€‚
            é€šå¸¸ã®OAuth 2.0ã®ã‚¨ãƒ©ãƒ¼ã«åŠ ãˆã¦ã€ä»¥ä¸‹ã®CIBAå›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼å€¤ã‚‚å«ã¾ã‚Œã¾ã™ï¼š
            - `authorization_pending`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªè¨¼ãŒã¾ã å®Œäº†ã—ã¦ã„ãªã„
            - `slow_down`: ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ãŒçŸ­ã™ãã‚‹
            - `expired_token`: èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸ
            - `access_denied`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèªè¨¼ã‚’æ‹’å¦ã—ãŸ
        error_description:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ã«é–¢ã™ã‚‹è©³ç´°ãªèª¬æ˜ï¼ˆçœç•¥å¯èƒ½ï¼‰
      required:
        - error

    TokenIntrospectionRequest:
      type: object
      description: |
        RFC 7662 - Token Introspectionæ¨™æº–ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
      required:
        - token
      properties:
        token:
          type: string
          description: æ¤œè¨¼å¯¾è±¡ã¨ãªã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¾ãŸã¯ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
        token_type_hint:
          type: string
          enum: [ access_token, refresh_token ]
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¨®åˆ¥ã«é–¢ã™ã‚‹ãƒ’ãƒ³ãƒˆï¼ˆçœç•¥å¯èƒ½ï¼‰ã€‚

    TokenIntrospectionExtensionRequest:
      type: object
      description: |
        RFC 7662 - Token Introspectionã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸæ‹¡å¼µAPIã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€‚
        scope client_certã®æŒ‡å®šã—ã€ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼å´ã§æ¤œè¨¼ã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã¾ã›ã‚‹ã“ã¨ãŒå¯èƒ½ã€‚
      required:
        - token
      properties:
        token:
          type: string
          description: æ¤œè¨¼å¯¾è±¡ã¨ãªã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¾ãŸã¯ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
        token_type_hint:
          type: string
          enum: [ access_token, refresh_token ]
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¨®åˆ¥ã«é–¢ã™ã‚‹ãƒ’ãƒ³ãƒˆï¼ˆçœç•¥å¯èƒ½ï¼‰ã€‚
        scope:
          type: string
          description: |
            ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã—ãŸã„ã‚¹ã‚³ãƒ¼ãƒ—ã€‚è¤‡æ•°è¨­å®šã™ã‚‹å ´åˆã¯åŠè§’ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã€‚
            æŒ‡å®šã—ãŸã‚¹ã‚³ãƒ¼ãƒ—ãŒãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã‚’è¿”å´ã™ã‚‹ã€‚
        client_cert:
          type: string
          description: |
            ç›¸äº’TLSé€šä¿¡ã§å–å¾—ã—ãŸPEMå½¢å¼ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸ã€‚ã€‚
            è¨¼æ˜æ›¸ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨¼æ˜æ›¸ã®ã‚µãƒ ãƒ—ãƒªãƒ³ãƒˆã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚

    TokenIntrospectionResponse:
      type: object
      required:
        - active
      properties:
        active:
          type: boolean
          description: ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœ‰åŠ¹ã§ã‚ã‚Œã° `true`ã€ãã†ã§ãªã‘ã‚Œã° `false`ã€‚
        scope:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã«é–¢é€£ã¥ã‘ã‚‰ã‚ŒãŸã‚¹ã‚³ãƒ¼ãƒ—ã€‚
        client_id:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®IDã€‚
        username:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã«é–¢é€£ã¥ã‘ã‚‰ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼åã€‚
        token_type:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¨®åˆ¥ï¼ˆä¾‹ï¼šBearerï¼‰ã€‚
        exp:
          type: integer
          description: æœ‰åŠ¹æœŸé™ï¼ˆUNIXã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼‰ã€‚
        iat:
          type: integer
          description: ç™ºè¡Œæ—¥æ™‚ï¼ˆUNIXã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼‰ã€‚
        nbf:
          type: integer
          description: Not Beforeï¼ˆä½¿ç”¨é–‹å§‹æ™‚åˆ»ï¼‰ã€‚
        sub:
          type: string
          description: ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è­˜åˆ¥å­ï¼‰ã€‚
        aud:
          type: string
          description: ã‚ªãƒ¼ãƒ‡ã‚£ã‚¨ãƒ³ã‚¹ï¼ˆå¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹ï¼‰ã€‚
        iss:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç™ºè¡Œè€…ã€‚
        jti:
          type: string
          description: JWT IDï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ã®ä¸€æ„ãªè­˜åˆ¥å­ï¼‰ã€‚
      additionalProperties:
        description: ä»»æ„ã®æ‹¡å¼µãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€‚ãƒ†ãƒŠãƒ³ãƒˆã®è¨­å®šãªã©ã«ã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³ã«ä»˜ä¸ã•ã‚Œã‚‹ã€‚

    TokenIntrospectionBadRequestResponse:
      type: object
      description: |
        ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
      properties:
        error:
          type: string
          enum: [ invalid_request ]
          description: |
            ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã€‚
        error_description:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ã«é–¢ã™ã‚‹è©³ç´°ãªèª¬æ˜ï¼ˆçœç•¥å¯èƒ½ï¼‰
      required:
        - error

    TokenIntrospectionExtensionErrorResponse:
      type: object
      description: |
        RFC 7662 - Token Introspectionã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸæ‹¡å¼µAPIã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
      properties:
        active:
          type: boolean
          description: ã‚¨ãƒ©ãƒ¼ã®ãŸã‚ã€falseå›ºå®šã€‚
        error:
          type: string
          description: aa
        error_description:
          type: string
          description: aaa


    TokenRevocationRequest:
      type: object
      required:
        - token
      properties:
        token:
          type: string
          description: ç„¡åŠ¹åŒ–ã™ã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¾ãŸã¯ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã€‚
        token_type_hint:
          type: string
          enum: [ access_token, refresh_token ]
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¨®é¡ã«é–¢ã™ã‚‹ãƒ’ãƒ³ãƒˆï¼ˆçœç•¥å¯èƒ½ï¼‰ã€‚

    UserInfoResponse:
      type: object
      description: |
        OpenID Connect Core 1.0 ã«ãŠã‘ã‚‹ UserInfo ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¹ã‚­ãƒ¼ãƒã€‚

        æœ¬ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”å´ã•ã‚Œã‚‹å„ Claimï¼ˆå±æ€§æƒ…å ±ï¼‰ã¯ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§è¦æ±‚ã•ã‚Œã¦ã„ã‚‹å ´åˆã«å«ã¾ã‚Œã¾ã™ï¼š

        - `scope` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹Claimè¦æ±‚ï¼ˆä¾‹: `profile`, `email`, `address`, `phone`ï¼‰
        - `claims` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹å€‹åˆ¥Claimè¦æ±‚ï¼ˆJSONå½¢å¼ã§ `userinfo` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«æŒ‡å®šï¼‰

        å«ã¾ã‚Œã‚‹ã‹ã©ã†ã‹ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ãŠã‚ˆã³End-Userã®åŒæ„ãƒ»è¨­å®šã«ä¾å­˜ã—ã¾ã™ã€‚
        OpenID Providerï¼ˆOPï¼‰ã¯ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¸Šã®ç†ç”±ç­‰ã«ã‚ˆã‚Šã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸClaimã‚’è¿”ã•ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

        - `sub` Claim ã¯å¿…é ˆã§ã‚ã‚Šï¼ˆMUSTï¼‰ã€å¸¸ã«å«ã¾ã‚Œã¾ã™ã€‚
        - ãã®ä»–ã®Claimã¯ã€è¦æ±‚ã•ã‚Œã¦ã„ã¦ã‚‚è¿”ã•ã‚Œãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
        - è¦æ±‚ã•ã‚Œã¦ã„ãªã„ClaimãŒå«ã¾ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
        - å€¤ãŒ `null` ã®Claimã¯å«ã‚ã¦ã¯ãªã‚‰ãšï¼ˆSHOULD NOTï¼‰ã€æ¬ è½æ‰±ã„ã¨ã—ã¾ã™ã€‚

        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã€`userinfo` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹ `sub` ãŒ ID ãƒˆãƒ¼ã‚¯ãƒ³ã® `sub` ã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’å¿…ãšç¢ºèªã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ï¼ˆMUSTï¼‰ã€‚
        
        UserInfo ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã€ä¸»ã«ä»¥ä¸‹ã®2ã¤ã®æ–¹å¼ã§åˆ¶å¾¡ã•ã‚Œã¾ã™ï¼š

        1. `scope` ã«åŸºã¥ãClaimè¦æ±‚ï¼š
            - `profile`, `email`, `phone`, `address` ãªã©ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€é–¢é€£ã™ã‚‹æ¨™æº–ClaimãŒè¿”å´ã•ã‚Œã¾ã™ã€‚
            - å«ã¾ã‚Œã‚‹Claimã®ä¸€è¦§ã¯OpenID Connectä»•æ§˜ã® Section 5.1 ã‚’å‚ç…§ã€‚

        2. `claims` ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹æ˜ç¤ºçš„æŒ‡å®šï¼š
            - `userinfo` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ `email`, `email_verified`, `given_name` ãªã©ã®å€‹åˆ¥Claimã‚’æŒ‡å®šå¯èƒ½ã€‚
            - `"essential": true` ã«ã‚ˆã£ã¦ã€ç‰¹å®šã®ClaimãŒã€Œå¿…é ˆã€ã§ã‚ã‚‹ã“ã¨ã‚‚è¦æ±‚ã§ãã¾ã™ã€‚

        ã“ã‚Œã«ã‚ˆã‚Šã€æœ€å°é™ã®ãƒ‡ãƒ¼ã‚¿è¦æ±‚ã¨æœ€å¤§é™ã®æŸ”è»Ÿæ€§ãŒä¸¡ç«‹ã•ã‚Œã¾ã™ã€‚
      properties:
        sub:
          type: string
          description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ Subject Identifierã€‚å¿…é ˆã€‚
        name:
          type: string
          description: ãƒ•ãƒ«ãƒãƒ¼ãƒ ã€‚ä¾‹ï¼šIchiro Itoã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        given_name:
          type: string
          description: åï¼ˆFirst nameï¼‰ã€‚ä¾‹ï¼šIchiroã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        family_name:
          type: string
          description: å§“ï¼ˆLast nameï¼‰ã€‚ä¾‹ï¼šItoã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        middle_name:
          type: string
          description: ãƒŸãƒ‰ãƒ«ãƒãƒ¼ãƒ ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        nickname:
          type: string
          description: ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        preferred_username:
          type: string
          description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¸Œæœ›ã™ã‚‹è¡¨ç¤ºåï¼ˆä¾‹ï¼šj.doeï¼‰ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        profile:
          type: string
          format: uri
          description: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã®URLã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        picture:
          type: string
          format: uri
          description: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®URLã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        website:
          type: string
          format: uri
          description: Webã‚µã‚¤ãƒˆã‚„ãƒ–ãƒ­ã‚°ã®URLã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        email:
          type: string
          format: email
          description: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€‚`email` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        email_verified:
          type: boolean
          description: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ¤œè¨¼çŠ¶æ…‹ã€‚`email` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        gender:
          type: string
          enum: [ male, female ]
          description: æ€§åˆ¥ï¼ˆ"male"ã€"female" ã¾ãŸã¯ãã®ä»–ã®æ–‡å­—åˆ—ï¼‰ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        birthdate:
          type: string
          description: ç”Ÿå¹´æœˆæ—¥ï¼ˆå½¢å¼ï¼šYYYY-MM-DDï¼‰ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        zoneinfo:
          type: string
          description: ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã€‚ä¾‹ï¼šAsia/Tokyoã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        locale:
          type: string
          description: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚±ãƒ¼ãƒ«ï¼ˆä¾‹ï¼šja-JPã€en-USï¼‰ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        phone_number:
          type: string
          description: é›»è©±ç•ªå·ã€‚ä¾‹ï¼š+8190-1234-5678ã€‚`phone` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        phone_number_verified:
          type: boolean
          description: é›»è©±ç•ªå·ã®æ¤œè¨¼çŠ¶æ…‹ã€‚`phone` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
        address:
          type: object
          description: éƒµé€å…ˆä½æ‰€ã€‚`address` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
          properties:
            formatted:
              type: string
              description: æ”¹è¡Œä»˜ãæ•´å½¢æ¸ˆã¿ä½æ‰€ã€‚
            street_address:
              type: string
              description: ç•ªåœ°ã€é€šã‚Šåãªã©ã®è©³ç´°ä½æ‰€ã€‚
            locality:
              type: string
              description: å¸‚åŒºç”ºæ‘ã€‚
            region:
              type: string
              description: éƒ½é“åºœçœŒã‚„å·ã€‚
            postal_code:
              type: string
              description: éƒµä¾¿ç•ªå·ã€‚
            country:
              type: string
              description: å›½åã€‚
        updated_at:
          type: integer
          format: int64
          description: æœ€çµ‚æ›´æ–°æ™‚åˆ»ï¼ˆUNIXã‚¨ãƒãƒƒã‚¯ç§’ï¼‰ã€‚`profile` scope ã¾ãŸã¯ `claims` ã«ã‚ˆã‚‹è¦æ±‚æ™‚ã«è¿”å´ã•ã‚Œã‚‹ã€‚
      required:
        - sub

    OpenIDConfiguration:
      type: object
      description: |
        OpenID Connect Discovery 1.0 ã«æº–æ‹ ã—ãŸ OpenID Provider Metadata ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã€‚
        /.well-known/openid-configuration ã«ã¦æä¾›ã•ã‚Œã‚‹ã€‚
      required:
        - issuer
        - authorization_endpoint
        - jwks_uri
        - response_types_supported
        - subject_types_supported
        - id_token_signing_alg_values_supported
      properties:
        issuer:
          type: string
          description: ç™ºè¡Œè€…ï¼ˆIssuerï¼‰è­˜åˆ¥å­ã€‚https ã‚¹ã‚­ãƒ¼ãƒ ã®URLã€‚IDãƒˆãƒ¼ã‚¯ãƒ³ã® `iss` ã«ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆå¿…é ˆï¼‰ã€‚
        authorization_endpoint:
          type: string
          description: èªå¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®URLï¼ˆå¿…é ˆï¼‰ã€‚
        token_endpoint:
          type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®URLã€‚Implicit Flow ã®ã¿ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å ´åˆã‚’é™¤ãå¿…é ˆã€‚
        userinfo_endpoint:
          type: string
          description: UserInfo ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®URLï¼ˆæ¨å¥¨ï¼‰ã€‚
        jwks_uri:
          type: string
          description: JWK Set ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®URLã€‚ç½²åéµã‚„æš—å·éµã‚’å…¬é–‹ã™ã‚‹ï¼ˆå¿…é ˆï¼‰ã€‚
        registration_endpoint:
          type: string
          description: Dynamic Client Registration ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLï¼ˆæ¨å¥¨ï¼‰ã€‚
        scopes_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ scope å€¤ã®ä¸€è¦§ã€‚`openid` ã¯å¿…é ˆã€‚
        response_types_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ response_type å€¤ã®ä¸€è¦§ï¼ˆå¿…é ˆï¼‰ã€‚
        response_modes_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ response_mode å€¤ã®ä¸€è¦§ï¼ˆçœç•¥æ™‚ã¯ "query", "fragment"ï¼‰ã€‚
        grant_types_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ Grant Type ã®ä¸€è¦§ã€‚çœç•¥æ™‚ã¯ `authorization_code`, `implicit`ã€‚
        acr_values_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ ACRï¼ˆAuthentication Context Class Referenceï¼‰å€¤ã€‚
        subject_types_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ Subject Identifier ã®å‹ã€‚`public` ã¾ãŸã¯ `pairwise`ï¼ˆå¿…é ˆï¼‰ã€‚
        id_token_signing_alg_values_supported:
          type: array
          items:
            type: string
          description: ID Token ã®ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆJWSï¼‰ã¨ã—ã¦ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ alg å€¤ã®ä¸€è¦§ã€‚`RS256` ã¯å¿…é ˆã€‚
        id_token_encryption_alg_values_supported:
          type: array
          items:
            type: string
          description: ID Token ã®æš—å·åŒ–ï¼ˆJWEï¼‰ã«ä½¿ç”¨ã•ã‚Œã‚‹ alg å€¤ã€‚
        id_token_encryption_enc_values_supported:
          type: array
          items:
            type: string
          description: ID Token ã®æš—å·åŒ–ï¼ˆJWEï¼‰ã«ä½¿ç”¨ã•ã‚Œã‚‹ enc å€¤ã€‚
        userinfo_signing_alg_values_supported:
          type: array
          items:
            type: string
          description: UserInfo ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€‚
        userinfo_encryption_alg_values_supported:
          type: array
          items:
            type: string
          description: UserInfo ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æš—å·åŒ–ã«ä½¿ç”¨ã•ã‚Œã‚‹ alg å€¤ã€‚
        userinfo_encryption_enc_values_supported:
          type: array
          items:
            type: string
          description: UserInfo ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æš—å·åŒ–ã«ä½¿ç”¨ã•ã‚Œã‚‹ enc å€¤ã€‚
        request_object_signing_alg_values_supported:
          type: array
          items:
            type: string
          description: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€‚
        request_object_encryption_alg_values_supported:
          type: array
          items:
            type: string
          description: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æš—å·åŒ–ã«ä½¿ç”¨ã•ã‚Œã‚‹ alg å€¤ã€‚
        request_object_encryption_enc_values_supported:
          type: array
          items:
            type: string
          description: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æš—å·åŒ–ã«ä½¿ç”¨ã•ã‚Œã‚‹ enc å€¤ã€‚
        token_endpoint_auth_methods_supported:
          type: array
          items:
            type: string
          description: Token Endpoint ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆèªè¨¼æ–¹å¼ã€‚`client_secret_basic` ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€‚
        token_endpoint_auth_signing_alg_values_supported:
          type: array
          items:
            type: string
          description: ãƒˆãƒ¼ã‚¯ãƒ³ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹JWSç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆalgå€¤ï¼‰ã®ãƒªã‚¹ãƒˆã‚’å«ã‚€JSONé…åˆ—ã€‚ã“ã®JWTã¯ã€private_key_jwtãŠã‚ˆã³client_secret_jwtèªè¨¼æ–¹å¼ã§ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã¯RS256ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚noneã¨ã„ã†å€¤ã¯ä½¿ç”¨ã—ãªã„ã€‚
        display_values_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ `display` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å€¤ã€‚
        claim_types_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ Claim Typeï¼ˆnormal, aggregated, distributed ãªã©ï¼‰ã€‚
        claims_supported:
          type: array
          items:
            type: string
          description: ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ Claim åã®ä¸€è¦§ï¼ˆæ¨å¥¨ï¼‰ã€‚
        service_documentation:
          type: string
          format: uri
          description: OP ã«é–¢ã™ã‚‹äººé–“å¯èª­ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®URLã€‚
        claims_locales_supported:
          type: array
          items:
            type: string
          description: Claim å€¤ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹è¨€èªãƒ»æ–‡å­—ç¨®ï¼ˆBCP47 è¨€èªã‚¿ã‚°ï¼‰ã€‚
        ui_locales_supported:
          type: array
          items:
            type: string
          description: UIè¡¨ç¤ºã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹è¨€èªãƒ»æ–‡å­—ç¨®ï¼ˆBCP47 è¨€èªã‚¿ã‚°ï¼‰ã€‚
        claims_parameter_supported:
          type: boolean
          description: claims ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚µãƒãƒ¼ãƒˆæœ‰ç„¡ã€‚çœç•¥æ™‚ã¯ falseã€‚
        request_parameter_supported:
          type: boolean
          description: request ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚µãƒãƒ¼ãƒˆæœ‰ç„¡ã€‚çœç•¥æ™‚ã¯ falseã€‚
        request_uri_parameter_supported:
          type: boolean
          description: request_uri ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚µãƒãƒ¼ãƒˆæœ‰ç„¡ã€‚çœç•¥æ™‚ã¯ trueã€‚
        require_request_uri_registration:
          type: boolean
          description: request_uri ã®äº‹å‰ç™»éŒ²ãŒå¿…è¦ã‹ã©ã†ã‹ã€‚çœç•¥æ™‚ã¯ falseã€‚
        op_policy_uri:
          type: string
          format: uri
          description: OP ã®ãƒãƒªã‚·ãƒ¼ã‚’è¨˜è¼‰ã—ãŸURLã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç™»éŒ²è€…ã«è¡¨ç¤ºã•ã‚Œã‚‹ã¹ãã€‚
        op_tos_uri:
          type: string
          format: uri
          description: OP ã®åˆ©ç”¨è¦ç´„ã‚’è¨˜è¼‰ã—ãŸURLã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç™»éŒ²è€…ã«è¡¨ç¤ºã•ã‚Œã‚‹ã¹ãã€‚

    JWK:
      type: object
      required:
        - kty
        - kid
        - use
        - alg
        - crv
        - x
        - y
      properties:
        kty:
          type: string
          enum: [ EC ]
          example: EC
        kid:
          type: string
          example: ssf-debug
        use:
          type: string
          enum: [ sig ]
          example: sig
        alg:
          type: string
          enum: [ ES256 ]
          example: ES256
        crv:
          type: string
          enum: [ P-256 ]
          example: P-256
        x:
          type: string
          description: Base64url-encoded x coordinate of the public key
          example: nitxvSyqpZEhGXT-oJ8CJD_Pr3feMVFAO43d8TlHk1w
        y:
          type: string
          description: Base64url-encoded y coordinate of the public key
          example: xA6Slvr4rRnF53TNaIdeRsw9v655xGlHPD3YNGy_CMY

    JWKS:
      type: object
      properties:
        keys:
          type: array
          items:
            $ref: '#/components/schemas/JWK'

    AuthorizationDetails:
      type: array
      description: |
        RFC 9396 ã§å®šç¾©ã•ã‚ŒãŸ authorization detail ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—ã€‚
        å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ç‰¹å®šã®ã‚¢ã‚¯ã‚»ã‚¹è¦æ±‚ã‚’è¡¨ã—ã¾ã™ã€‚
        ã¾ãŸã€typeã«å¿œã˜ã¦æ‹¡å¼µãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆe.g., 'geolocation', 'currency'ï¼‰ã€‚
      items:
        type: object
        required:
          - type
        properties:
          type:
            type: string
            description: èªå¯è©³ç´°ã®ã‚¿ã‚¤ãƒ—ï¼ˆä¾‹ï¼š'payment_initiation'ã€'account_information' ãªã©ï¼‰ã€‚
          locations:
            type: array
            description: ãƒªã‚½ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼ã®URIã®ãƒªã‚¹ãƒˆã€‚
            items:
              type: string
              format: uri
          actions:
            type: array
            description: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå®Ÿè¡Œã—ãŸã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¾‹ï¼š'read'ã€'write' ãªã©ï¼‰ã€‚
            items:
              type: string
          datatypes:
            type: array
            description: èªå¯å¯¾è±¡ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ï¼ˆä¾‹ï¼š'transaction'ã€'balance' ãªã©ï¼‰ã€‚
            items:
              type: string
          identifier:
            type: string
            description: ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹è­˜åˆ¥å­ï¼ˆä¾‹ï¼šå£åº§IDãªã©ï¼‰ã€‚
          privileges:
            type: array
            description: è¦æ±‚ã•ã‚Œã‚‹æ¨©é™ãƒ¬ãƒ™ãƒ«ã‚„ç¨®åˆ¥ã®ä¸€è¦§ã€‚
            items:
              type: string
        additionalProperties:
          description: ä»»æ„ã®æ‹¡å¼µãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€‚

    BackchannelAuthenticationRequest:
      type: object
      description: |
        CIBA èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ä¿¡ã•ã‚Œã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¾¤ã€‚
        OpenID Connect CIBA Core 1.0 Section 7 ã«æº–æ‹ ã€‚
      properties:
        client_id:
          type: string
        client_secret:
          type: string
        scope:
          type: string
          description: "å¿…é ˆã€‚openid ã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä¾‹ï¼šopenid profile email"
        login_hint:
          type: string
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è­˜åˆ¥ã™ã‚‹ãƒ’ãƒ³ãƒˆã€‚IDã‚„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãªã©"
        id_token_hint:
          type: string
          description: "éå»ã® ID Token ã‚’ç”¨ã„ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥"
        binding_message:
          type: string
          description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç«¯æœ«ã«è¡¨ç¤ºã•ã‚Œã‚‹æ–‡è¨€"
        requested_expiry:
          type: integer
          description: "auth_req_id ã®æœ‰åŠ¹æœŸé™ï¼ˆç§’ï¼‰"
        request_context:
          type: string
          description: "èªè¨¼æ™‚ã®è¿½åŠ æƒ…å ±"
        acr_values:
          type: string
          description: "è¦æ±‚ã™ã‚‹èªè¨¼å¼·åº¦ï¼ˆACRå€¤ï¼‰"
        authorization_details:
          $ref: '#/components/schemas/AuthorizationDetails'
      required:
        - client_id
        - scope


    BackchannelAuthenticationResponse:
      type: object
      description: |
        CIBA ã® Backchannel Authentication ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã™ã‚‹æ­£å¸¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå—ç†ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™ã€‚
      properties:
        auth_req_id:
          type: string
          description: |
            ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¾Œç¶šã® `/tokens` ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹ä¸€æ„ã®èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆIDã€‚
        expires_in:
          type: integer
          description: |
            auth_req_id ã®æœ‰åŠ¹æœŸé™ï¼ˆç§’ï¼‰ã€‚ã“ã®æ™‚é–“ã‚’è¶…ãˆã‚‹ã¨ãƒˆãƒ¼ã‚¯ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æ‹’å¦ã•ã‚Œã‚‹ã€‚
        interval:
          type: integer
          description: |
            ãƒãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã†å ´åˆã®æœ€å°é–“éš”ï¼ˆç§’ï¼‰ã€‚
      required:
        - auth_req_id
        - expires_in

    BackchannelAuthenticationErrorResponse:
      type: object
      description: |
        CIBA èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€‚
        OpenID Connect CIBA Core 1.0 Section 13 ãŠã‚ˆã³ RFC 6749 Section 5.2 ã«æº–æ‹ ã€‚
      properties:
        error:
          type: string
          description: |
            ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã€‚
            ä¾‹: invalid_request, invalid_client, unauthorized_client, invalid_scope, access_denied, slow_down, expired_token, etc.
        error_description:
          type: string
          description: ã‚¨ãƒ©ãƒ¼ã®è©³ç´°èª¬æ˜ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        error_uri:
          type: string
          format: uri
          description: ã‚¨ãƒ©ãƒ¼ã«é–¢ã™ã‚‹è©³ç´°ã‚’èª¬æ˜ã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®URIï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
      required:
        - error

    SecurityEventToken:
      type: string
      description: |
        Security Event Token (SET) ã¯ RFC 8417 ã«æº–æ‹ ã—ãŸ JWT å½¢å¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã™ã€‚
        `application/secevent+jwt` ã® `POST` ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã¨ã—ã¦é€ä¿¡ã•ã‚Œã¾ã™ã€‚
        
        ### SET ã®æ§‹æˆ
        
        JWTã®Payloadéƒ¨ã¯ä»¥ä¸‹ã®Claimã‚’å«ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆRFC 8417ï¼‰ï¼š
        
        - `iss` (Issuer): ç™ºè¡Œè€…ã®è­˜åˆ¥å­ï¼ˆä¾‹: https://idp.example.comï¼‰
        - `aud` (Audience): å¯¾è±¡ã¨ãªã‚‹å—ä¿¡è€…ã®è­˜åˆ¥å­ï¼ˆä¾‹: https://relying-party.example.orgï¼‰
        - `iat` (Issued At): ç™ºè¡Œæ™‚åˆ»ï¼ˆUnixæ™‚é–“ï¼‰
        - `jti` (JWT ID): ãƒˆãƒ¼ã‚¯ãƒ³ã®ä¸€æ„ãªè­˜åˆ¥å­ï¼ˆãƒªãƒ—ãƒ¬ã‚¤é˜²æ­¢ï¼‰
        - `events`: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚ã‚­ãƒ¼ã¯ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã®URIã€‚
        
        ### ä¾‹: Account Disabled ã‚¤ãƒ™ãƒ³ãƒˆ
        
        ```json
        {
          "iss": "https://idp.example.com",
          "aud": "https://relying-party.example.org",
          "iat": 1682509200,
          "jti": "4f1g23a12aa",
          "events": {
            "https://schemas.openid.net/secevent/risc/event-type/account-disabled": {
              "subject": {
                "sub": "248289761001"
              }
            }
          }
        }
        ```
        
        JWTå…¨ä½“ã¯ç½²åã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆé€šå¸¸ã¯RS256ãªã©ï¼‰ã€‚
        ãƒ˜ãƒƒãƒ€ãƒ¼: `{"alg": "RS256", "typ": "secevent+jwt"}`
        
        è©³ç´°ã¯ [RFC 8417](https://www.rfc-editor.org/rfc/rfc8417.html) ã‚’å‚ç…§ã€‚
      example: >
        eyJhbGciOiJSUzI1NiIsInR5cCI6InN...ï¼ˆçœç•¥ã•ã‚ŒãŸç½²åä»˜ãJWTï¼‰


