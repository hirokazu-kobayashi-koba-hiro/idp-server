(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{999:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signin",function(){return t(262)}])},262:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>T});var a=t(4848),r=t(5759),i=t(2064),o=t(1501),s=t(2322),c=t(6247),l=t(3384),d=t(8556),h=t(3952),u=t(2035),x=t(4271),p=t(304),j=t(4897),f=t(7848),w=t(6540),m=t(6715),y=t(9206),_=t(430),A=t(9643),g=t(2741),v=t(8191),b=t(7330);let k=e=>new Promise(n=>setTimeout(n,e)),C=()=>((0,w.useEffect)(()=>{(async()=>{await k(1e3)})()},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:(0,a.jsx)(v.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,a.jsx)(b.A,{color:"inherit"})})})}));function T(){let[e,n]=(0,w.useState)(""),[t,v]=(0,w.useState)(""),b=(0,m.useRouter)(),{id:k,tenant_id:T,session_key:z}=b.query,{data:E,isPending:S}=(0,y.I)({queryKey:["fetchViewData"],queryFn:async()=>{let{id:e,tenant_id:n}=b.query,t=await fetch("".concat(_.backendUrl,"/").concat(n,"/api/v1/authorizations/").concat(e,"/view-data"),{credentials:"include"});if(!t.ok)throw console.error(t),Error(t.status.toString());return await t.json()}}),N=async()=>{let e=await fetch("".concat(_.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(k,"/deny"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await e.json();console.log(e.status,n),n.redirect_uri&&(window.location.href=n.redirect_uri)},O=async()=>{let n=await fetch("".concat(_.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(k,"/authorize"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,session_key:z})}),a=await n.json();console.log(n.status,a),a.redirect_uri&&(window.location.href=a.redirect_uri)};return((0,w.useEffect)(()=>{let e=async()=>{let e=await fetch("".concat(_.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(k,"/authorize-with-session"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok){console.error(e);return}let n=await e.json();console.log(e.status,n),n.redirect_uri&&(window.location.href=n.redirect_uri)};console.log(E),E&&!0===E.session_enabled&&(console.log("session_enabled"),e())},[E]),S||!E||E&&E.session_enabled)?(0,a.jsx)(C,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(r.A,{maxWidth:"xs",children:(0,a.jsx)(i.A,{sx:{mt:6,textAlign:"center"},children:(0,a.jsxs)(o.A,{variant:"outlined",sx:{p:3,boxShadow:3},children:[(0,a.jsx)(s.A,{src:E.logo_uri,sx:{width:80,height:80,mx:"auto",mb:2}}),(0,a.jsx)(c.A,{variant:"h5",children:E.client_name}),(0,a.jsx)(c.A,{variant:"h6",sx:{mt:4},children:"request scope"}),(0,a.jsx)(l.A,{direction:"row",spacing:1,justifyContent:"center",sx:{mt:2},children:E.scopes.map(e=>(0,a.jsx)(d.A,{label:e,color:"primary",variant:"outlined"},e))}),(0,a.jsxs)(i.A,{mt:2,display:"flex",flexDirection:"column",sx:{gap:2},children:[(0,a.jsx)(h.A,{name:"email",label:"email",placeholder:"test@gmail.com",type:"email",value:e,onChange:e=>{n(e.target.value)}}),(0,a.jsx)(h.A,{name:"password",label:"password",type:"password",value:t,onChange:e=>{v(e.target.value)}})]}),(0,a.jsxs)(u.A,{sx:{mt:2},children:[(0,a.jsxs)(x.Ay,{children:[(0,a.jsx)(p.A,{children:(0,a.jsx)(A.A,{color:"action"})}),(0,a.jsx)(j.A,{primary:(0,a.jsx)("a",{href:E.tos_uri,target:"_blank",rel:"noopener noreferrer",children:"term of use"})})]}),(0,a.jsxs)(x.Ay,{children:[(0,a.jsx)(p.A,{children:(0,a.jsx)(g.A,{color:"action"})}),(0,a.jsx)(j.A,{primary:(0,a.jsx)("a",{href:E.policy_uri,target:"_blank",rel:"noopener noreferrer",children:"privacy policy"})})]})]}),(0,a.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,a.jsx)(f.A,{variant:"contained",color:"error",onClick:N,children:"cancel"}),(0,a.jsx)(f.A,{variant:"contained",color:"primary",onClick:O,children:"approve"})]})]})})})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[52,884,636,593,792],()=>n(999)),_N_E=e.O()}]);