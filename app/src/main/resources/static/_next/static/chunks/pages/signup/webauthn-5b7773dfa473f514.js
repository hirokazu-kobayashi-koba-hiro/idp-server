(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[985],{581:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signup/webauthn",function(){return r(8121)}])},9413:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(7657),a=r(4848);let o=(0,n.A)((0,a.jsx)("path",{d:"M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"}),"Key")},2050:(e,t,r)=>{"use strict";r.d(t,{y:()=>c});var n=r(4848),a=r(2745),o=r(2124),i=r(389);let s=["Account Info","Email Verification","Passkey","Confirm"],c=e=>{let{activeStep:t}=e;return(0,n.jsx)(a.A,{activeStep:t,alternativeLabel:!0,children:s.map(e=>(0,n.jsx)(o.A,{children:(0,n.jsx)(i.A,{children:e})},e))})}},8121:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{default:()=>v});var a=r(4848),o=r(6540),i=r(2907),s=r(5759),c=r(1703),d=r(4136),l=r(2413),u=r(3384),p=r(2064),h=r(1917),f=r(7330);let y={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},g=new Uint8Array(16),m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));let x=function(e,t,r){if(y.randomUUID&&!t&&!e)return y.randomUUID();let a=(e=e||{}).random??e.rng?.()??function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(g)}();if(a.length<16)throw Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase()}(a)};var b=r(9413),w=r(6715),A=r(430),j=r(2050);function v(){let e=(0,w.useRouter)(),[t,r]=(0,o.useState)(!1),[n,y]=(0,o.useState)(""),{userId:g}=(0,A.useAppContext)(),{id:m,tenant_id:v}=e.query,k=(0,i.A)(),U=async()=>{r(!0),y("");try{let t=await fetch("".concat(A.backendUrl,"/").concat(v,"/api/v1/authorizations/").concat(m,"/webauthn/registration/challenge"),{credentials:"include"}),{challenge:r}=await t.json(),n=r.replace(/-/g,"+").replace(/_/g,"/"),a=new TextEncoder().encode(g||""),o=await navigator.credentials.create({publicKey:{challenge:new Uint8Array(atob(n).split("").map(e=>e.charCodeAt(0))),rp:{name:"Passkey Demo"},user:{id:a,name:g||x(),displayName:"test"},pubKeyCredParams:[{type:"public-key",alg:-7}]}});if((await fetch("".concat(A.backendUrl,"/").concat(v,"/api/v1/authorizations/").concat(m,"/webauthn/registration/response"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok){y("Passkey registration successful!"),e.push("/signup/authorize?id=".concat(m,"&tenant_id=").concat(v));return}y("Registration failed.")}catch(e){console.error(e),y("An error occurred during registration.")}r(!1)};return(0,a.jsx)(s.A,{maxWidth:"xs",children:(0,a.jsxs)(c.A,{elevation:0,sx:{borderRadius:4,px:5,py:6,mt:8,backgroundColor:"light"===k.palette.mode?"#fcfcfd":(0,d.X4)(k.palette.common.white,.035),border:"1px solid ".concat((0,d.X4)(k.palette.divider,.08)),boxShadow:"light"===k.palette.mode?"0 6px 24px rgba(0,0,0,0.025)":"0 0 0 1px rgba(255,255,255,0.06)"},children:[(0,a.jsx)(l.A,{variant:"h5",fontWeight:600,gutterBottom:!0,children:"Passkey Registration"}),(0,a.jsx)(l.A,{variant:"body2",color:"text.secondary",mb:4,children:"Secure your account with a passkey for fast and passwordless sign-in."}),(0,a.jsxs)(u.A,{spacing:3,children:[(0,a.jsx)(j.y,{activeStep:2}),(0,a.jsx)(p.A,{display:"flex",justifyContent:"center",children:(0,a.jsx)(b.A,{sx:{fontSize:40,color:"primary.main"}})}),(0,a.jsx)(p.A,{children:(0,a.jsx)(h.A,{variant:"contained",color:"primary",onClick:U,disabled:t,fullWidth:!0,sx:{textTransform:"none"},children:t?(0,a.jsx)(f.A,{size:24}):"Register Passkey"})}),n&&(0,a.jsx)(l.A,{mt:2,color:"error",align:"center",children:n})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8,571,917,584,636,593,792],()=>t(581)),_N_E=e.O()}]);