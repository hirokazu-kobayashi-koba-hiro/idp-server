(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[985],{581:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signup/webauthn",function(){return r(8121)}])},1794:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(7657),o=r(4848);let a=(0,n.A)((0,o.jsx)("path",{d:"M21 10h-8.35C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H13l2 2 2-2 2 2 4-4.04zM7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3"}),"Key")},3384:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var n=r(6540),o=r(4164),a=r(1317),i=r(1609),s=r(5659),c=r(4247),l=r(4467),u=r(9599),d=r(2370),p=r(9499),h=r(2308),y=r(4848);let f=(0,d.A)(),m=(0,c.A)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function g(e){return(0,l.A)({props:e,name:"MuiStack",defaultTheme:f})}let b=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],A=({ownerState:e,theme:t})=>{let r={display:"flex",flexDirection:"column",...(0,p.NI)({theme:t},(0,p.kW)({values:e.direction,breakpoints:t.breakpoints.values}),e=>({flexDirection:e}))};if(e.spacing){let n=(0,h.LX)(t),o=Object.keys(t.breakpoints.values).reduce((t,r)=>(("object"==typeof e.spacing&&null!=e.spacing[r]||"object"==typeof e.direction&&null!=e.direction[r])&&(t[r]=!0),t),{}),i=(0,p.kW)({values:e.direction,base:o}),s=(0,p.kW)({values:e.spacing,base:o});"object"==typeof i&&Object.keys(i).forEach((e,t,r)=>{if(!i[e]){let n=t>0?i[r[t-1]]:"column";i[e]=n}}),r=(0,a.A)(r,(0,p.NI)({theme:t},s,(t,r)=>e.useFlexGap?{gap:(0,h._W)(n,t)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${b(r?i[r]:e.direction)}`]:(0,h._W)(n,t)}}))}return(0,p.iZ)(t.breakpoints,r)};var x=r(3552),v=r(6322);let k=function(e={}){let{createStyledComponent:t=m,useThemeProps:r=g,componentName:a="MuiStack"}=e,c=()=>(0,s.A)({root:["root"]},e=>(0,i.Ay)(a,e),{}),l=t(A);return n.forwardRef(function(e,t){let a=r(e),{component:i="div",direction:s="column",spacing:d=0,divider:p,children:h,className:f,useFlexGap:m=!1,...g}=(0,u.A)(a),b=c();return(0,y.jsx)(l,{as:i,ownerState:{direction:s,spacing:d,useFlexGap:m},ref:t,className:(0,o.A)(b.root,f),...g,children:p?function(e,t){let r=n.Children.toArray(e).filter(Boolean);return r.reduce((e,o,a)=>(e.push(o),a<r.length-1&&e.push(n.cloneElement(t,{key:`separator-${a}`})),e),[])}(h,p):h})})}({createStyledComponent:(0,x.Ay)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>(0,v.b)({props:e,name:"MuiStack"})})},2050:(e,t,r)=>{"use strict";r.d(t,{y:()=>c});var n=r(4848),o=r(2745),a=r(2124),i=r(389);let s=["Account Info","Email Verification","Confirm"],c=e=>{let{activeStep:t}=e;return(0,n.jsx)(o.A,{activeStep:t,alternativeLabel:!0,children:s.map(e=>(0,n.jsx)(a.A,{children:(0,n.jsx)(i.A,{children:e})},e))})}},8121:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{default:()=>v});var o=r(4848),a=r(6540),i=r(5759),s=r(1703),c=r(3384),l=r(6247),u=r(2064),d=r(7848),p=r(7330);let h={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},y=new Uint8Array(16),f=[];for(let e=0;e<256;++e)f.push((e+256).toString(16).slice(1));let m=function(e,t,r){if(h.randomUUID&&!t&&!e)return h.randomUUID();let o=(e=e||{}).random??e.rng?.()??function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(y)}();if(o.length<16)throw Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=o[e];return t}return function(e,t=0){return(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase()}(o)};var g=r(1794),b=r(6715),A=r(430),x=r(2050);function v(){let e=(0,b.useRouter)(),[t,r]=(0,a.useState)(!1),[n,h]=(0,a.useState)(""),{userId:y}=(0,A.useAppContext)(),{id:f,tenant_id:v}=e.query,k=async()=>{r(!0),h("");try{let t=await fetch("".concat(A.backendUrl,"/").concat(v,"/api/v1/authorizations/").concat(f,"/webauthn/registration/challenge"),{credentials:"include"}),{challenge:r}=await t.json(),n=r.replace(/-/g,"+").replace(/_/g,"/"),o=new TextEncoder().encode(y||""),a=await navigator.credentials.create({publicKey:{challenge:new Uint8Array(atob(n).split("").map(e=>e.charCodeAt(0))),rp:{name:"Passkey Demo"},user:{id:o,name:m(),displayName:"test"},pubKeyCredParams:[{type:"public-key",alg:-7}]}});if((await fetch("".concat(A.backendUrl,"/").concat(v,"/api/v1/authorizations/").concat(f,"/webauthn/registration/response"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok){h("Passkey registration successful!"),e.push("/signup/authorize?id=".concat(f,"&tenant_id=").concat(v));return}h("Registration failed.")}catch(e){console.error(e),h("An error occurred during registration.")}r(!1)};return(0,o.jsx)(i.A,{maxWidth:"sm",children:(0,o.jsx)(s.A,{sx:{m:4,p:4,boxShadow:3},children:(0,o.jsxs)(c.A,{spacing:4,children:[(0,o.jsx)(l.A,{variant:"h5",children:"Sign Up"}),(0,o.jsx)(x.y,{activeStep:2}),(0,o.jsxs)(u.A,{display:"flex",gap:4,alignItems:"center",children:[(0,o.jsx)(g.A,{sx:{fontSize:50,color:"primary.secondary"}}),(0,o.jsx)(l.A,{variant:"h5",children:"Passkey Registration"})]}),(0,o.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Secure your account with a passkey for fast authentication."}),(0,o.jsx)(u.A,{mt:3,children:(0,o.jsx)(d.A,{variant:"contained",color:"primary",onClick:k,disabled:t,sx:{width:"100%",textTransform:"none"},children:t?(0,o.jsx)(p.A,{size:24}):"Next"})}),n&&(0,o.jsx)(l.A,{mt:2,color:"primary",children:n})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[49,584,636,593,792],()=>t(581)),_N_E=e.O()}]);