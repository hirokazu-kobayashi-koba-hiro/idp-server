(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{999:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signin",function(){return t(262)}])},262:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>z});var a=t(4848),r=t(5759),i=t(2064),s=t(1501),o=t(2322),c=t(6247),l=t(3384),d=t(8556),h=t(3952),u=t(2035),x=t(4271),p=t(304),j=t(4897),f=t(7848),m=t(3753),y=t(429),w=t(6540),A=t(6715),_=t(9206),g=t(430),v=t(9643),k=t(2741),b=t(8191),C=t(7330);let S=e=>new Promise(n=>setTimeout(n,e)),T=()=>((0,w.useEffect)(()=>{(async()=>{await S(1e3)})()},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:(0,a.jsx)(b.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,a.jsx)(C.A,{color:"inherit"})})})}));function z(){let[e,n]=(0,w.useState)(""),[t,b]=(0,w.useState)(""),C=(0,A.useRouter)(),{id:S,tenant_id:z,session_key:E}=C.query,{data:N,isPending:O}=(0,_.I)({queryKey:["fetchViewData"],queryFn:async()=>{let{id:e,tenant_id:n}=C.query,t=await fetch("".concat(g.backendUrl,"/").concat(n,"/api/v1/authorizations/").concat(e,"/view-data"),{credentials:"include"});if(!t.ok)throw console.error(t),Error(t.status.toString());return await t.json()}}),P=async()=>{let e=await fetch("".concat(g.backendUrl,"/").concat(z,"/api/v1/authorizations/").concat(S,"/deny"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await e.json();console.log(e.status,n),n.redirect_uri&&(window.location.href=n.redirect_uri)},q=async()=>{let n=await fetch("".concat(g.backendUrl,"/").concat(z,"/api/v1/authorizations/").concat(S,"/authorize"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,session_key:E})}),a=await n.json();console.log(n.status,a),a.redirect_uri&&(window.location.href=a.redirect_uri)};return((0,w.useEffect)(()=>{let e=async()=>{let e=await fetch("".concat(g.backendUrl,"/").concat(z,"/api/v1/authorizations/").concat(S,"/authorize-with-session"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok){console.error(e);return}let n=await e.json();console.log(e.status,n),n.redirect_uri&&(window.location.href=n.redirect_uri)};console.log(N),N&&!0===N.session_enabled&&e()},[N]),O||!N||N&&N.session_enabled)?(0,a.jsx)(T,{}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(r.A,{maxWidth:"xs",children:(0,a.jsx)(i.A,{sx:{mt:6,textAlign:"center"},children:(0,a.jsxs)(s.A,{variant:"outlined",sx:{p:3,boxShadow:3},children:[(0,a.jsx)(o.A,{src:N.logo_uri,sx:{width:80,height:80,mx:"auto",mb:2}}),(0,a.jsx)(c.A,{variant:"h5",children:N.client_name}),(0,a.jsx)(c.A,{variant:"h6",sx:{mt:4},children:"request scope"}),(0,a.jsx)(l.A,{direction:"row",spacing:1,justifyContent:"center",sx:{mt:2},children:N.scopes.map(e=>(0,a.jsx)(d.A,{label:e,color:"primary",variant:"outlined"},e))}),(0,a.jsxs)(i.A,{mt:2,display:"flex",flexDirection:"column",sx:{gap:2},children:[(0,a.jsx)(h.A,{name:"email",label:"email",placeholder:"test@gmail.com",type:"email",value:e,onChange:e=>{n(e.target.value)}}),(0,a.jsx)(h.A,{name:"password",label:"password",type:"password",value:t,onChange:e=>{b(e.target.value)}})]}),(0,a.jsxs)(u.A,{sx:{mt:2},children:[(0,a.jsxs)(x.Ay,{children:[(0,a.jsx)(p.A,{children:(0,a.jsx)(v.A,{color:"action"})}),(0,a.jsx)(j.A,{primary:(0,a.jsx)("a",{href:N.tos_uri,target:"_blank",rel:"noopener noreferrer",children:"term of use"})})]}),(0,a.jsxs)(x.Ay,{children:[(0,a.jsx)(p.A,{children:(0,a.jsx)(k.A,{color:"action"})}),(0,a.jsx)(j.A,{primary:(0,a.jsx)("a",{href:N.policy_uri,target:"_blank",rel:"noopener noreferrer",children:"privacy policy"})})]})]}),(0,a.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[(0,a.jsx)(f.A,{variant:"contained",color:"error",onClick:P,children:"cancel"}),(0,a.jsx)(f.A,{variant:"contained",color:"primary",onClick:q,children:"approve"})]}),(0,a.jsx)(i.A,{sx:{mt:2},children:(0,a.jsx)(m.A,{})}),(0,a.jsxs)(i.A,{sx:{mt:2,gap:2},display:"flex",children:[(0,a.jsx)(c.A,{children:"Dont have an account?"}),(0,a.jsx)(y.A,{onClick:()=>{C.push("/signup?id=".concat(S,"&tenant_id=").concat(z,"&session_key=").concat(E))},children:"Sign Up"})]})]})})})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[52,344,636,593,792],()=>n(999)),_N_E=e.O()}]);