(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{999:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signin",function(){return n(8564)}])},4414:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(7657),o=n(4848);let r=(0,i.A)((0,o.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock")},5074:(e,t,n)=>{"use strict";n.d(t,{R:()=>d});var i=n(4848),o=n(2064),r=n(8191),a=n(7330),s=n(6540);let c=e=>new Promise(t=>setTimeout(t,e)),d=()=>((0,s.useEffect)(()=>{(async()=>{await c(1e3)})()},[]),(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:(0,i.jsx)(r.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:!0,children:(0,i.jsx)(a.A,{color:"inherit"})})})}))},6137:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d});var i=n(4848),o=n(2907),r=n(4429),a=n(2064),s=n(5759),c=n(1703);let d=e=>{let{children:t}=e,n=(0,o.A)(),d=(0,r.A)(n.breakpoints.down("sm"));return(0,i.jsx)(a.A,{sx:{height:"100vh"},children:(0,i.jsx)(s.A,{maxWidth:"xs",children:d?(0,i.jsx)(a.A,{mt:2,children:t}):(0,i.jsx)(c.A,{sx:{p:3,boxShadow:1,borderRadius:3},children:t})})})}},423:(e,t,n)=>{"use strict";n.d(t,{r:()=>x});var i=n(4848),o=n(3384),r=n(1917),a=n(2413),s=n(9965),c=n.n(s),d=n(430),l=n(6540),h=n(4843),u=n(6420);let p=[{id:"1e68932e-ed4a-43e7-b412-460665e42df3",name:"Google",logo:"/logos/google.svg"},{id:"3be20da2-eea5-4420-9e1e-90215803b4a8",name:"Facebook",logo:"https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg"},{id:"4cc97cad-34ad-41e7-af53-c4ddee3f786b",name:"Yahoo! JAPAN ID",logo:"/logos/yahoo_japan_icon_64.png"}],x=()=>{let[e]=(0,h.fp)(u.D),[t]=(0,h.fp)(u.x),[n,s]=(0,l.useState)(""),x=async n=>{let i=await fetch("".concat(d.backendUrl,"/").concat(t,"/api/v1/authorizations/").concat(e,"/federations"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({federatable_idp_id:n})});if(i.ok){let e=await i.json();if(e.redirect_uri){window.location.href=e.redirect_uri;return}}s("Failed SSO. System error occurred")};return(0,i.jsxs)(o.A,{spacing:1,children:[p.map(e=>{let{id:t,name:n,logo:o}=e;return(0,i.jsxs)(r.A,{variant:"outlined",color:"inherit",sx:{textTransform:"none",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"8px 16px",borderColor:"#9e9e9e"},fullWidth:!0,onClick:()=>x(t),children:[(0,i.jsx)(c(),{src:o,alt:"".concat(n," logo"),width:24,height:24,style:{marginRight:8}}),"Sign in with ",n]},t)}),n&&(0,i.jsx)(a.A,{variant:"caption",color:"error",children:n})]})}},8564:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var i=n(4848),o=n(3384),r=n(2413),a=n(541),s=n(8590),c=n(1917),d=n(429),l=n(3753),h=n(6540),u=n(6715),p=n(9206),x=n(430),g=n(5074),f=n(4745),w=n(4414),m=n(2907),A=n(4429),j=n(6137);let y=async e=>e.userAgentData?await e.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion"]):null,b=e=>{let t="Unknown OS",n="Unknown Browser",i="Unknown Device";return/Windows/i.test(e)&&(t="Windows"),/Macintosh|Mac OS/i.test(e)&&(t="Mac"),/Android/i.test(e)&&(t="Android"),/iPhone|iPad|iPod/i.test(e)&&(t="iOS"),/Chrome/i.test(e)&&(n="Chrome"),/Safari/i.test(e)&&!/Chrome/i.test(e)&&(n="Safari"),/Firefox/i.test(e)&&(n="Firefox"),/Edge/i.test(e)&&(n="Edge"),/Mobile|Android|iPhone/i.test(e)&&(i="Mobile"),/Mac|Windows/i.test(e)&&(i="PC"),{os:t,browser:n,deviceType:i}};var v=n(423);function _(){let{setId:e,setTenantId:t}=(0,x.useAppContext)(),[n,_]=(0,h.useState)(""),[S,k]=(0,h.useState)(""),C=(0,u.useRouter)(),{id:P,tenant_id:T}=C.query,z=(0,m.A)(),O=(0,A.A)(z.breakpoints.down("sm")),{data:W,isPending:I}=(0,p.I)({queryKey:["fetchViewData",C.query],queryFn:async()=>{if(!C.isReady||0===Object.keys(C.query).length)return;let{id:n,tenant_id:i}=C.query;"string"==typeof n&&e(n),"string"==typeof i&&t(i),console.log(await y(navigator),b(navigator.userAgent));let o=await fetch("".concat(x.backendUrl,"/").concat(i,"/api/v1/authorizations/").concat(n,"/view-data"),{credentials:"include"});if(!o.ok)throw console.error(o),Error(o.status.toString());return await o.json()}}),U=async()=>{let e=await fetch("".concat(x.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(P,"/deny"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();console.log(e.status,t),t.redirect_uri&&(window.location.href=t.redirect_uri)},E=async()=>{(await fetch("".concat(x.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(P,"/password-authentication"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:S})})).ok&&C.push("/signin/authorize?id=".concat(P,"&tenant_id=").concat(T))};return((0,h.useEffect)(()=>{let e=async()=>{let e=await fetch("".concat(x.backendUrl,"/").concat(T,"/api/v1/authorizations/").concat(P,"/authorize-with-session"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok){console.error(e);return}let t=await e.json();console.log(e.status,t),t.redirect_uri&&(window.location.href=t.redirect_uri)};console.log(W),W&&!0===W.session_enabled&&e()},[W]),I||!W||W&&W.session_enabled)?(0,i.jsx)(g.R,{}):(0,i.jsx)(j.Y,{children:(0,i.jsxs)(o.A,{spacing:O?2:3,alignItems:"center",children:[(0,i.jsx)(r.A,{variant:"subtitle1",fontWeight:"medium",children:"IdP Server"}),(0,i.jsxs)(o.A,{spacing:2,width:"100%",children:[(0,i.jsx)(a.A,{placeholder:"Your email",inputMode:"email",fullWidth:!0,required:!0,InputProps:{disableUnderline:!0,sx:{height:48,fontSize:17,px:2,backgroundColor:"transparent"},startAdornment:(0,i.jsx)(s.A,{position:"start",children:(0,i.jsx)(f.A,{sx:{color:"gray"}})})},onChange:e=>_(e.target.value)}),(0,i.jsx)(a.A,{placeholder:"Your password",type:"password",fullWidth:!0,required:!0,InputProps:{disableUnderline:!0,sx:{height:48,fontSize:17,px:2,backgroundColor:"transparent"},startAdornment:(0,i.jsx)(s.A,{position:"start",children:(0,i.jsx)(w.A,{sx:{color:"gray"}})})},onChange:e=>{navigator.credentials.preventSilentAccess(),k(e.target.value)}})]}),(0,i.jsxs)(o.A,{spacing:1,width:"100%",children:[(0,i.jsx)(c.A,{variant:"contained",disabled:!n||!S,onClick:E,fullWidth:!0,sx:{textTransform:"none",borderRadius:8,height:44,fontSize:16,fontWeight:"bold",backgroundColor:"#007AFF",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.1)","&:hover":{opacity:.8}},children:"Next"}),W.show_cancel&&(0,i.jsx)(c.A,{variant:"outlined",onClick:U,sx:{textTransform:"none",fontSize:16,fontWeight:"medium",color:"#505050",borderColor:"rgba(0, 0, 0, 0.2)"},children:"Cancel"})]}),(0,i.jsxs)(o.A,{spacing:1,direction:"row",justifyContent:"center",sx:{mt:3},children:[(0,i.jsx)(r.A,{variant:"body2",children:"Don't have an account?"}),(0,i.jsx)(d.A,{onClick:()=>C.push("/signup?id=".concat(P,"&tenant_id=").concat(T)),sx:{fontWeight:"bold",cursor:"pointer",color:"primary.main",fontSize:16},children:"Sign Up"})]}),(0,i.jsxs)(o.A,{spacing:2,sx:{width:"100%"},children:[(0,i.jsx)(l.A,{variant:"fullWidth"}),(0,i.jsx)(v.r,{})]}),(0,i.jsxs)(r.A,{variant:"caption",color:"text.secondary",textAlign:"center",sx:{mt:2},children:["By signing in, you agree to our",(0,i.jsx)(d.A,{href:null==W?void 0:W.tos_uri,sx:{fontWeight:"bold",mx:.5},children:"Terms of Use"}),"and",(0,i.jsx)(d.A,{href:null==W?void 0:W.policy_uri,sx:{fontWeight:"bold",mx:.5},children:"Privacy Policy"})]})]})})}},6420:(e,t,n)=>{"use strict";n.d(t,{D:()=>r,x:()=>a});var i=n(4929);let o=(0,i.KU)(()=>window.sessionStorage),r=(0,i.tG)("authSessionId","",o,{getOnInit:!0}),a=(0,i.tG)("authSessionTenantId","",o,{getOnInit:!0})}},e=>{var t=t=>e(e.s=t);e.O(0,[8,571,917,191,573,206,918,615,636,593,792],()=>t(999)),_N_E=e.O()}]);