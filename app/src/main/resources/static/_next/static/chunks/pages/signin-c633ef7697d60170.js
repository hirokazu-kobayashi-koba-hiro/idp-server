(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{999:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/signin",function(){return n(8564)}])},4414:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var o=n(7657),i=n(4848);let r=(0,o.A)((0,i.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock")},5074:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var o=n(4848),i=n(8191),r=n(7330),a=n(2413),s=n(6540);let c=e=>new Promise(t=>setTimeout(t,e)),l=()=>((0,s.useEffect)(()=>{(async()=>{await c(500)})()},[]),(0,o.jsxs)(i.A,{open:!0,sx:{zIndex:e=>e.zIndex.drawer+2,backgroundColor:"rgba(255, 255, 255, 0.75)",color:"#1c1c1e",flexDirection:"column"},children:[(0,o.jsx)(r.A,{size:48,thickness:4,sx:{color:"#007aff",mb:2}}),(0,o.jsx)(a.A,{variant:"body2",sx:{fontWeight:500,letterSpacing:.5,color:"#1c1c1e"},children:"Loading, please wait..."})]}))},6137:(e,t,n)=>{"use strict";n.d(t,{Y:()=>l});var o=n(4848),i=n(2907),r=n(4429),a=n(2064),s=n(5759),c=n(1703);let l=e=>{let{children:t}=e,n=(0,i.A)(),l=(0,r.A)(n.breakpoints.down("sm"));return(0,o.jsx)(a.A,{sx:{height:"100vh"},children:(0,o.jsx)(s.A,{maxWidth:"xs",children:l?(0,o.jsx)(a.A,{mt:2,children:t}):(0,o.jsx)(c.A,{sx:{p:3,boxShadow:1,borderRadius:3},children:t})})})}},423:(e,t,n)=>{"use strict";n.d(t,{r:()=>p});var o=n(4848),i=n(3384),r=n(1917),a=n(2413),s=n(9965),c=n.n(s),l=n(430),d=n(6540),h=n(4843),u=n(6420);let g=[{type:"oidc",name:"google",label:"Google",logo:"/logos/google.svg"},{type:"oidc",name:"facebook",label:"Facebook",logo:"https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg"},{type:"oidc",name:"yahoo",label:"Yahoo! JAPAN ID",logo:"/logos/yahoo_japan_icon_64.png"}],p=()=>{let[e]=(0,h.fp)(u.D),[t]=(0,h.fp)(u.x),[n,s]=(0,d.useState)(""),p=async(n,o)=>{let i=await fetch("".concat(l.backendUrl,"/").concat(t,"/v1/authorizations/").concat(e,"/federations/").concat(n,"/").concat(o),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(i.ok){let e=await i.json();if(e.redirect_uri){window.location.href=e.redirect_uri;return}}s("Failed SSO. System error occurred")};return(0,o.jsxs)(i.A,{spacing:1,children:[g.map((e,t)=>{let{type:n,name:i,label:a,logo:s}=e;return(0,o.jsxs)(r.A,{variant:"outlined",color:"inherit",sx:{textTransform:"none",display:"flex",alignItems:"center",justifyContent:"flex-start",padding:"8px 16px",borderColor:"#9e9e9e"},fullWidth:!0,onClick:()=>p(n,i),children:[(0,o.jsx)(c(),{src:s,alt:"".concat(i," logo"),width:24,height:24,style:{marginRight:8}}),"Sign in with ",a]},t)}),n&&(0,o.jsx)(a.A,{variant:"caption",color:"error",children:n})]})}},8564:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var o=n(4848),i=n(3384),r=n(2413),a=n(541),s=n(8590),c=n(1917),l=n(429),d=n(3753),h=n(6540),u=n(6715),g=n(9206),p=n(430),x=n(5074),f=n(4745),w=n(4414),m=n(2907),y=n(4429),A=n(6137);let j=async e=>e.userAgentData?await e.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion"]):null,b=e=>{let t="Unknown OS",n="Unknown Browser",o="Unknown Device";return/Windows/i.test(e)&&(t="Windows"),/Macintosh|Mac OS/i.test(e)&&(t="Mac"),/Android/i.test(e)&&(t="Android"),/iPhone|iPad|iPod/i.test(e)&&(t="iOS"),/Chrome/i.test(e)&&(n="Chrome"),/Safari/i.test(e)&&!/Chrome/i.test(e)&&(n="Safari"),/Firefox/i.test(e)&&(n="Firefox"),/Edge/i.test(e)&&(n="Edge"),/Mobile|Android|iPhone/i.test(e)&&(o="Mobile"),/Mac|Windows/i.test(e)&&(o="PC"),{os:t,browser:n,deviceType:o}};var v=n(423),k=n(4843),S=n(6420);function _(){let[,e]=(0,k.fp)(S.D),[,t]=(0,k.fp)(S.x),[n,_]=(0,h.useState)(""),[C,P]=(0,h.useState)(""),z=(0,u.useRouter)(),{id:T,tenant_id:W}=z.query,O=(0,m.A)(),I=(0,y.A)(O.breakpoints.down("sm")),{data:U,isPending:E}=(0,g.I)({queryKey:["fetchViewData",z.query],queryFn:async()=>{if(!z.isReady||0===Object.keys(z.query).length)return;let{id:n,tenant_id:o}=z.query;"string"==typeof n&&e(n),"string"==typeof o&&t(o),console.log(await j(navigator),b(navigator.userAgent));let i=await fetch("".concat(p.backendUrl,"/").concat(o,"/v1/authorizations/").concat(n,"/view-data"),{credentials:"include"});if(!i.ok)throw console.error(i),Error(i.status.toString());return await i.json()}}),D=async()=>{let e=await fetch("".concat(p.backendUrl,"/").concat(W,"/v1/authorizations/").concat(T,"/deny"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();console.log(e.status,t),t.redirect_uri&&(window.location.href=t.redirect_uri)},q=async()=>{(await fetch("".concat(p.backendUrl,"/").concat(W,"/v1/authorizations/").concat(T,"/password-authentication"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:C})})).ok&&z.push("/signin/authorize?id=".concat(T,"&tenant_id=").concat(W))};return((0,h.useEffect)(()=>{let e=async()=>{let e=await fetch("".concat(p.backendUrl,"/").concat(W,"/v1/authorizations/").concat(T,"/authorize-with-session"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!e.ok){console.error(e);return}let t=await e.json();console.log(e.status,t),t.redirect_uri&&(window.location.href=t.redirect_uri)};console.log(U),U&&!0===U.session_enabled&&e()},[U]),E||!U||U&&U.session_enabled)?(0,o.jsx)(x.R,{}):(0,o.jsx)(A.Y,{children:(0,o.jsxs)(i.A,{spacing:I?2:3,alignItems:"center",children:[(0,o.jsx)(r.A,{variant:"subtitle1",fontWeight:"medium",children:"IdP Server"}),(0,o.jsxs)(i.A,{spacing:2,width:"100%",children:[(0,o.jsx)(a.A,{placeholder:"Your email",inputMode:"email",fullWidth:!0,required:!0,InputProps:{disableUnderline:!0,sx:{height:48,fontSize:17,px:2,backgroundColor:"transparent"},startAdornment:(0,o.jsx)(s.A,{position:"start",children:(0,o.jsx)(f.A,{sx:{color:"gray"}})})},onChange:e=>_(e.target.value)}),(0,o.jsx)(a.A,{placeholder:"Your password",type:"password",fullWidth:!0,required:!0,InputProps:{disableUnderline:!0,sx:{height:48,fontSize:17,px:2,backgroundColor:"transparent"},startAdornment:(0,o.jsx)(s.A,{position:"start",children:(0,o.jsx)(w.A,{sx:{color:"gray"}})})},onChange:e=>{navigator.credentials.preventSilentAccess(),P(e.target.value)}})]}),(0,o.jsxs)(i.A,{spacing:1,width:"100%",children:[(0,o.jsx)(c.A,{variant:"contained",disabled:!n||!C,onClick:q,fullWidth:!0,sx:{textTransform:"none",borderRadius:8,height:44,fontSize:16,fontWeight:"bold",backgroundColor:"#007AFF",boxShadow:"0px 2px 5px rgba(0, 0, 0, 0.1)","&:hover":{opacity:.8}},children:"Next"}),U.show_cancel&&(0,o.jsx)(c.A,{variant:"outlined",onClick:D,sx:{textTransform:"none",fontSize:16,fontWeight:"medium",color:"#505050",borderColor:"rgba(0, 0, 0, 0.2)"},children:"Cancel"})]}),(0,o.jsxs)(i.A,{spacing:1,direction:"row",justifyContent:"center",sx:{mt:3},children:[(0,o.jsx)(r.A,{variant:"body2",children:"Don't have an account?"}),(0,o.jsx)(l.A,{onClick:()=>z.push("/signup?id=".concat(T,"&tenant_id=").concat(W)),sx:{fontWeight:"bold",cursor:"pointer",color:"primary.main",fontSize:16},children:"Sign Up"})]}),(0,o.jsxs)(i.A,{spacing:2,sx:{width:"100%"},children:[(0,o.jsx)(d.A,{variant:"fullWidth"}),(0,o.jsx)(v.r,{})]}),(0,o.jsxs)(r.A,{variant:"caption",color:"text.secondary",textAlign:"center",sx:{mt:2},children:["By signing in, you agree to our",(0,o.jsx)(l.A,{href:null==U?void 0:U.tos_uri,sx:{fontWeight:"bold",mx:.5},children:"Terms of Use"}),"and",(0,o.jsx)(l.A,{href:null==U?void 0:U.policy_uri,sx:{fontWeight:"bold",mx:.5},children:"Privacy Policy"})]})]})})}},6420:(e,t,n)=>{"use strict";n.d(t,{D:()=>r,x:()=>a});var o=n(4929);let i=(0,o.KU)(()=>window.sessionStorage),r=(0,o.tG)("authSessionId","",i,{getOnInit:!0}),a=(0,o.tG)("authSessionTenantId","",i,{getOnInit:!0})}},e=>{var t=t=>e(e.s=t);e.O(0,[72,571,191,917,206,573,918,615,636,593,792],()=>t(999)),_N_E=e.O()}]);