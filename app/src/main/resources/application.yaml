idp:
  configurations:
   adminTenantId: "${ADMIN_TENANT_ID:67e7eae6-62b0-4500-9eff-87459f63fc66}"
   apiKey: ${IDP_SERVER_API_KEY}
   apiSecret: ${IDP_SERVER_API_SECRET}
   encryptionKey: ${ENCRYPTION_KEY}
   databaseType: "${DATABASE_TYPE:POSTGRESQL}"
  auth-session:
    # Cookie SameSite attribute: Lax (same-origin) or None (cross-origin, requires HTTPS)
    same-site: "${IDP_AUTH_SESSION_SAME_SITE:Lax}"
    # Cookie Secure flag: true for HTTPS, false for HTTP development
    secure: ${IDP_AUTH_SESSION_SECURE:true}
  server:
    shutdown:
      delay: "${IDP_SERVER_SHUTDOWN_DELAY:5s}"
  time:
   zone: "${TIME_ZONE:UTC}"
  logging:
    request-response:
      enabled: "${IDP_LOGGING_REQUEST_RESPONSE_ENABLED:false}"
      mask-tokens: "${IDP_LOGGING_REQUEST_RESPONSE_MASK_TOKENS:true}"
      max-body-size: "${IDP_LOGGING_REQUEST_RESPONSE_MAX_BODY_SIZE:10000}"
      endpoints: "${IDP_LOGGING_REQUEST_RESPONSE_ENDPOINTS:/v1/tokens,/v1/authorizations,/v1/backchannel/authentications,/v1/userinfo}"
  datasource:
    control-plane:
      writer:
        url: "${CONTROL_PLANE_DB_WRITER_URL:jdbc:postgresql://localhost:5432/idpserver}"
        username: ${CONTROL_PLANE_DB_WRITER_USER_NAME}
        password: ${CONTROL_PLANE_DB_WRITER_PASSWORD}
        hikari:
          connection-timeout: ${CONTROL_PLANE_DB_WRITER_TIMEOUT:2000}
          maximum-pool-size: ${CONTROL_PLANE_DB_WRITER_MAX_POOL_SIZE:10}
          minimum-idle: ${CONTROL_PLANE_DB_WRITER_MIN_IDLE:5}
      reader:
        url: "${CONTROL_PLANE_DB_READER_URL:jdbc:postgresql://localhost:5433/idpserver}"
        username: ${CONTROL_PLANE_DB_READER_USER_NAME}
        password: ${CONTROL_PLANE_DB_READER_PASSWORD}
        hikari:
          connection-timeout: ${CONTROL_PLANE_DB_READER_TIMEOUT:2000}
          maximum-pool-size: ${CONTROL_PLANE_DB_READER_MAX_POOL_SIZE:10}
          minimum-idle: ${CONTROL_PLANE_DB_READER_MIN_IDLE:5}
    app:
      writer:
        url: "${DB_WRITER_URL:jdbc:postgresql://localhost:5432/idpserver}"
        username: ${DB_WRITER_USER_NAME}
        password: ${DB_WRITER_PASSWORD}
        hikari:
          connection-timeout: ${DB_WRITER_TIMEOUT:2000}
          maximum-pool-size: ${DB_WRITER_MAX_POOL_SIZE:30}
          minimum-idle: ${DB_WRITER_MIN_IDLE:10}
      reader:
        url: "${DB_READER_URL:jdbc:postgresql://localhost:5433/idpserver}"
        username: ${DB_READER_USER_NAME}
        password: ${DB_READER_PASSWORD}
        hikari:
          connection-timeout: ${DB_READER_TIMEOUT:2000}
          maximum-pool-size: ${DB_READER_MAX_POOL_SIZE:30}
          minimum-idle: ${DB_READER_MIN_IDLE:10}
  cache:
    enabled: ${CACHE_ENABLE:true}
    timeToLiveSecond: ${CACHE_TIME_TO_LIVE_SECOND:300}
    redis:
      host: "${REDIS_HOST:localhost}"
      port: ${REDIS_PORT:6379}
      database: ${REDIS_CACHE_DATABASE:0}
      timeout: ${REDIS_CACHE_TIMEOUT:10000}
      password: ${REDIS_CACHE_PASSWORD:}
      maxTotal: ${REDIS_MAX_TOTAL:20}
      maxIdle: ${REDIS_MAX_IDLE:3}
      minIdle: ${REDIS_MIN_IDLE:2}
  session:
    enabled: ${SESSION_REDIS_ENABLE:true}
    redis:
      host: "${REDIS_HOST:localhost}"
      port: ${REDIS_PORT:6379}
      database: ${REDIS_SESSION_DATABASE:0}
      timeout: ${REDIS_SESSION_TIMEOUT:10000}
      password: ${REDIS_SESSION_PASSWORD:}
      maxTotal: ${REDIS_SESSION_MAX_TOTAL:20}
      maxIdle: ${REDIS_SESSION_MAX_IDLE:3}
      minIdle: ${REDIS_SESSION_MIN_IDLE:2}

logging:
  level:
    root: "${LOGGING_LEVEL_ROOT:info}"
    web: "${LOGGING_LEVEL_WEB:info}"
    org:
      idp:
        server:
          platform: "${LOGGING_LEVEL_IDP_SERVER_PLATFORM:info}"
          authentication: "${LOGGING_LEVEL_IDP_SERVER_AUTHENTICATION_INTERACTORS:info}"
          control_plane: "${LOGGING_LEVEL_IDP_SERVER_CONTROL_PLANE:info}"
          core.oidc: "${LOGGING_LEVEL_IDP_SERVER_CORE_OIDC:info}"
          core.openid: "${LOGGING_LEVEL_IDP_SERVER_CORE_OPENID:info}"
          core.adapters: "${LOGGING_LEVEL_IDP_SERVER_CORE_ADAPTERS:info}"
          core.extension: "${LOGGING_LEVEL_IDP_SERVER_CORE_EXTENSION:info}"
          email.aws: "${LOGGING_LEVEL_IDP_SERVER_EMAIL_AWS:info}"
          federation:  "${LOGGING_LEVEL_IDP_SERVER_FEDERATION:info}"
          notification.push.fcm: "${LOGGING_LEVEL_IDP_SERVER_NOTIFICATION_PUSH_FCM:info}"
          security.event.hook.ssf: "${LOGGING_LEVEL_IDP_SERVER_SECURITY_EVENT_HOOK_SSF:info}"
          security.event.hooks: "${LOGGING_LEVEL_IDP_SERVER_SECURITY_EVENT_HOOKS:info}"
          adapters.springboot: "${LOGGING_LEVEL_IDP_SERVER_ADAPTERS_SPRING_BOOT:info}"
          usecases: "${LOGGING_LEVEL_IDP_SERVER_USECASES:info}"
          authenticators.webauthn4j: "${LOGGING_LEVEL_IDP_SERVER_AUTHENTICATORS_WEBAUTHN4J:info}"
    org.idp.server.platform.http.HttpRequestExecutor: "${LOGGING_LEVEL_IDP_SERVER_HTTP_REQUEST_EXECUTOR:debug}"
    org.idp.server.adapters.springboot.logging.RequestResponseLoggingFilter: "${LOGGING_LEVEL_REQUEST_RESPONSE_LOGGING_FILTER:info}"

spring:
  lifecycle:
    timeout-per-shutdown-phase: 30s

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      probes:
        enabled: true
      show-details: when-authorized
  health:
    readiness-state:
      enabled: true
    liveness-state:
      enabled: true

server:
  shutdown: graceful
  tomcat:
    threads:
      max: ${SERVER_TOMCAT_THREADS_MAX:300}
      min-spare: ${SERVER_TOMCAT_THREADS_MIN_SPARE:50}
