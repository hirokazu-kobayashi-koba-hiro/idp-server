<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_09_project/issue-441-phase1-current-state-investigation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Issue #441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_09_project/issue-441-phase1-current-state-investigation"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Issue #441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ | IdP-Server Documentation"><meta data-rh="true" name="description" content="441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ"><meta data-rh="true" property="og:description" content="441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_09_project/issue-441-phase1-current-state-investigation"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_09_project/issue-441-phase1-current-state-investigation" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_09_project/issue-441-phase1-current-state-investigation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.37abf73b.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.65181d37.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¾ã§ã‚¹ã‚­ãƒƒãƒ—"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¾ã§ã‚¹ã‚­ãƒƒãƒ—</a></div><nav aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’é–‹ã" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹(ç¾åœ¨ã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰)" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹(ç¾åœ¨ã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å…ˆé ­ã¸æˆ»ã‚‹" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç´¢å¼•</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/HOW_TO_TEMPLATE">How-toãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ æ¨™æº–æ§‹é€ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">content_01_intro</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">content_02_quickstart</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/basic/basic-01-identity-management-basics">content_03_concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">content_04_protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_05_how-to/index">content_05_how-to</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/idp-server/docs/content_06_developer-guide/">é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰</a><button aria-label="&#x27;é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰&#x27;ã®ç›®æ¬¡ã‚’é–‹ã" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference/api-authentication-device-ja">content_07_reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/commercial-deployment/overview">content_08_ops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_09_project/analytics-statistics-design">content_09_project</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/analytics-statistics-design">çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½ è¨­è¨ˆææ¡ˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/control-plane-separation-design">Control Planeåˆ†é›¢è¨­è¨ˆææ¡ˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_09_project/issue-441-phase1-current-state-investigation">Issue #441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/project-01-faq">project-01-faq</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/project-02-roadmap">ğŸ—ºï¸ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/project-03-contributing">ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/project-04-license">License</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/security-event-pubsub-architecture">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒƒã‚¯ Pub/Sub ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/unit-testing-detailed-class-lists">Unit Testing - Detailed Class Lists &amp; Verification Points</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_09_project/unit-testing-strategy-by-module">Unit Testing Strategy by Gradle Module</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">content_10_ai_developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_20_testing/e2e-test-coverage">content_20_testing</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">ã¯ã˜ã‚ã«</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">content_09_project</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Issue #441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">ã“ã®ãƒšãƒ¼ã‚¸ã®è¦‹å‡ºã—</button></div><div class="theme-doc-markdown markdown"><header><h1>Issue #441 Phase 1: ç¾çŠ¶æŠŠæ¡ - è©³ç´°èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ</h1></header>
<p><strong>Issue</strong>: <a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server/issues/441" target="_blank" rel="noopener noreferrer">#441 ãƒ†ãƒŠãƒ³ãƒˆçµ±è¨ˆãƒ‡ãƒ¼ã‚¿  åé›†ãƒ»åˆ†ææ©Ÿèƒ½</a>
<strong>èª¿æŸ»æ—¥</strong>: 2025-11-23
<strong>èª¿æŸ»è€…</strong>: AI Assistant (Claude Code)
<strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</strong>: Phase 1å®Œäº†</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-èª¿æŸ»ç›®çš„">ğŸ“‹ èª¿æŸ»ç›®çš„<a href="#-èª¿æŸ»ç›®çš„" class="hash-link" aria-label="ğŸ“‹ èª¿æŸ»ç›®çš„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ğŸ“‹ èª¿æŸ»ç›®çš„ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<p>çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½ã®å®Ÿè£…ã«å‘ã‘ã¦ã€æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®Œå…¨ã«æ£šå¸ã—ã—ã€çµ±è¨ˆAPIã®å®Ÿè£…å¯èƒ½æ€§ã‚’è©•ä¾¡ã™ã‚‹ã€‚</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-executive-summary">ğŸ¯ Executive Summary<a href="#-executive-summary" class="hash-link" aria-label="ğŸ¯ Executive Summary ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ğŸ¯ Executive Summary ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸»è¦ç™ºè¦‹">ä¸»è¦ç™ºè¦‹<a href="#ä¸»è¦ç™ºè¦‹" class="hash-link" aria-label="ä¸»è¦ç™ºè¦‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ä¸»è¦ç™ºè¦‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>âœ… <strong>æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦</strong>: çµ±è¨ˆæ©Ÿèƒ½ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¯æ—¢ã«å®Œå…¨ã«è¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹
âœ… <strong>å„ªã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ</strong>: æ™‚ç³»åˆ—é›†è¨ˆã«æœ€é©ãªè¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒæ•´å‚™æ¸ˆã¿
âœ… <strong>Repository ãƒ‘ã‚¿ãƒ¼ãƒ³æ•´å‚™</strong>: <code>findTotalCount()</code> ç­‰ã®é›†è¨ˆç”¨ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ—¢ã«å®Ÿè£…æ¸ˆã¿
âœ… <strong>ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢</strong>: RLS + ãƒ†ãƒŠãƒ³ãƒˆç¬¬ä¸€å¼•æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Œå…¨åˆ†é›¢</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="çµ±è¨ˆapiå®Ÿè£…ã®é›£æ˜“åº¦">çµ±è¨ˆAPIå®Ÿè£…ã®é›£æ˜“åº¦<a href="#çµ±è¨ˆapiå®Ÿè£…ã®é›£æ˜“åº¦" class="hash-link" aria-label="çµ±è¨ˆAPIå®Ÿè£…ã®é›£æ˜“åº¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="çµ±è¨ˆAPIå®Ÿè£…ã®é›£æ˜“åº¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>ğŸŸ¢ <strong>åŸºæœ¬çµ±è¨ˆï¼ˆDAU/MAU/æˆåŠŸç‡ç­‰ï¼‰</strong>: <strong>ç°¡å˜</strong> - æ—¢å­˜Repositoryãƒ‘ã‚¿ãƒ¼ãƒ³ã§å³å®Ÿè£…å¯èƒ½
ğŸŸ¡ <strong>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆ</strong>: <strong>ä¸­ç¨‹åº¦</strong> - Materialized View ã¾ãŸã¯å°‚ç”¨é›†è¨ˆãƒ†ãƒ¼ãƒ–ãƒ«æ¨å¥¨
ğŸ”´ <strong>äºˆæ¸¬åˆ†æãƒ»ç•°å¸¸æ¤œçŸ¥</strong>: <strong>é«˜åº¦</strong> - MLåŸºç›¤ã¨ã®çµ±åˆãŒå¿…è¦</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½">1. æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½<a href="#1-æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½" class="hash-link" aria-label="1. æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-audit-log-apiç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°">1.1 Audit Log APIï¼ˆç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°ï¼‰<a href="#11-audit-log-apiç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°" class="hash-link" aria-label="1.1 Audit Log APIï¼ˆç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.1 Audit Log APIï¼ˆç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api">ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API<a href="#ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api" class="hash-link" aria-label="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>AuditLogManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/system_manager/AuditLogManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/audit-logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/audit-logs/{id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">findList(AdminAuthenticationContext, TenantIdentifier, AuditLogQueries, RequestAttributes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">get(AdminAuthenticationContext, TenantIdentifier, AuditLogIdentifier, RequestAttributes)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="çµ„ç¹”ãƒ¬ãƒ™ãƒ«api">çµ„ç¹”ãƒ¬ãƒ™ãƒ«API<a href="#çµ„ç¹”ãƒ¬ãƒ™ãƒ«api" class="hash-link" aria-label="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>OrgAuditLogManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/organization_manager/OrgAuditLogManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/audit-logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/audit-logs/{auditLogId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿auditlogqueries">ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆAuditLogQueriesï¼‰<a href="#ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿auditlogqueries" class="hash-link" aria-label="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆAuditLogQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆAuditLogQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<table><thead><tr><th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th><th>å‹</th><th>èª¬æ˜</th></tr></thead><tbody><tr><td><code>from</code></td><td>LocalDateTime</td><td>é–‹å§‹æ—¥æ™‚</td></tr><tr><td><code>to</code></td><td>LocalDateTime</td><td>çµ‚äº†æ—¥æ™‚</td></tr><tr><td><code>id</code></td><td>UUID</td><td>Audit Log ID</td></tr><tr><td><code>type</code></td><td>String (ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š)</td><td>ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥</td></tr><tr><td><code>description</code></td><td>String</td><td>èª¬æ˜ãƒ•ã‚£ãƒ«ã‚¿</td></tr><tr><td><code>target_resource</code></td><td>String</td><td>å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹</td></tr><tr><td><code>target_resource_action</code></td><td>String</td><td>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (create/update/delete)</td></tr><tr><td><code>client_id</code></td><td>String</td><td>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</td></tr><tr><td><code>user_id</code></td><td>UUID</td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>external_user_id</code></td><td>String</td><td>å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>outcome_result</code></td><td>String</td><td>çµæœ (success/failure)</td></tr><tr><td><code>target_tenant_id</code></td><td>String</td><td>å¯¾è±¡ãƒ†ãƒŠãƒ³ãƒˆID</td></tr><tr><td><code>dry_run</code></td><td>Boolean</td><td>ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³å®Ÿè¡Œãƒ•ãƒ©ã‚°</td></tr><tr><td><code>attributes.*</code></td><td>String</td><td>ã‚«ã‚¹ã‚¿ãƒ å±æ€§ãƒ•ã‚£ãƒ«ã‚¿</td></tr><tr><td><code>limit</code></td><td>Integer</td><td>ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20)</td></tr><tr><td><code>offset</code></td><td>Integer</td><td>ã‚ªãƒ•ã‚»ãƒƒãƒˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0)</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-security-event-apiã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°">1.2 Security Event APIï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ† ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼‰<a href="#12-security-event-apiã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°" class="hash-link" aria-label="1.2 Security Event APIï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.2 Security Event APIï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api-1">ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API<a href="#ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api-1" class="hash-link" aria-label="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>SecurityEventManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/system_manager/SecurityEventManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/security-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/security-events/{event-id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="çµ„ç¹”ãƒ¬ãƒ™ãƒ«api-1">çµ„ç¹”ãƒ¬ãƒ™ãƒ«API<a href="#çµ„ç¹”ãƒ¬ãƒ™ãƒ«api-1" class="hash-link" aria-label="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>OrgSecurityEventManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/organization_manager/OrgSecurityEventManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/security-events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/security-events/{eventId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿securityeventqueries">ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆSecurityEventQueriesï¼‰<a href="#ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿securityeventqueries" class="hash-link" aria-label="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆSecurityEventQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆSecurityEventQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<table><thead><tr><th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th><th>å‹</th><th>èª¬æ˜</th></tr></thead><tbody><tr><td><code>from</code></td><td>LocalDateTime</td><td>é–‹å§‹æ—¥æ™‚</td></tr><tr><td><code>to</code></td><td>LocalDateTime</td><td>çµ‚äº†æ—¥æ™‚</td></tr><tr><td><code>id</code></td><td>UUID</td><td>ã‚¤ãƒ™ãƒ³ãƒˆID</td></tr><tr><td><code>event_type</code></td><td>String (ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š)</td><td>ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ (TOKEN_ISSUED, USER_AUTHENTICATEDç­‰)</td></tr><tr><td><code>client_id</code></td><td>String</td><td>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</td></tr><tr><td><code>user_id</code></td><td>UUID</td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>external_user_id</code></td><td>String</td><td>å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>details.*</code></td><td>String</td><td>JSONBè©³ç´°ãƒ•ã‚£ãƒ«ã‚¿</td></tr><tr><td><code>limit</code></td><td>Integer</td><td>ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20)</td></tr><tr><td><code>offset</code></td><td>Integer</td><td>ã‚ªãƒ•ã‚»ãƒƒãƒˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0)</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-user-management-apiãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—">1.3 User Management APIï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—ï¼‰<a href="#13-user-management-apiãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—" class="hash-link" aria-label="1.3 User Management APIï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1.3 User Management APIï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api-2">ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API<a href="#ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«api-2" class="hash-link" aria-label="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™  ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>UserManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/system_manager/UserManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/users/{user-id}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="çµ„ç¹”ãƒ¬ãƒ™ãƒ«api-2">çµ„ç¹”ãƒ¬ãƒ™ãƒ«API<a href="#çµ„ç¹”ãƒ¬ãƒ™ãƒ«api-2" class="hash-link" aria-label="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="çµ„ç¹”ãƒ¬ãƒ™ãƒ«API ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>EntryService</strong>: <code>OrgUserManagementEntryService</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-use-cases/src/main/java/org/idp/server/usecases/control_plane/organization_manager/OrgUserManagementEntryService.java</code></p>
<p><strong>REST Endpoint</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/organizations/{organizationId}/tenants/{tenantId}/users/{userId}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿userqueries">ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆUserQueriesï¼‰<a href="#ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿userqueries" class="hash-link" aria-label="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆUserQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆUserQueriesï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<table><thead><tr><th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th><th>å‹</th><th>èª¬æ˜</th></tr></thead><tbody><tr><td><code>from</code></td><td>LocalDateTime</td><td>é–‹å§‹æ—¥æ™‚</td></tr><tr><td><code>to</code></td><td>LocalDateTime</td><td>çµ‚äº†æ—¥æ™‚</td></tr><tr><td><code>id</code></td><td>UUID</td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>user_id</code></td><td>UUID</td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãƒ•ã‚£ãƒ«ã‚¿</td></tr><tr><td><code>external_user_id</code></td><td>String</td><td>å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td></tr><tr><td><code>provider_id</code></td><td>String</td><td>ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ID</td></tr><tr><td><code>name</code></td><td>String</td><td>æ°å</td></tr><tr><td><code>given_name</code></td><td>String</td><td>å</td></tr><tr><td><code>family_name</code></td><td>String</td><td>å§“</td></tr><tr><td><code>middle_name</code></td><td>String</td><td>ãƒŸãƒ‰ãƒ«ãƒãƒ¼ãƒ </td></tr><tr><td><code>nickname</code></td><td>String</td><td>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </td></tr><tr><td><code>preferred_username</code></td><td>String</td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td></tr><tr><td><code>email</code></td><td>String</td><td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td></tr><tr><td><code>status</code></td><td>String</td><td>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ (ACTIVE/INACTIVE/DELETED)</td></tr><tr><td><code>phone_number</code></td><td>String</td><td>é›»è©±ç•ªå·</td></tr><tr><td><code>tenant_id</code></td><td>UUID</td><td>ãƒ†ãƒŠãƒ³ãƒˆID</td></tr><tr><td><code>role</code></td><td>String</td><td>ãƒ­ãƒ¼ãƒ«</td></tr><tr><td><code>permission</code></td><td>String</td><td>æ¨©é™</td></tr><tr><td><code>details.*</code></td><td>String</td><td>ã‚«ã‚¹ã‚¿ãƒ è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿</td></tr><tr><td><code>limit</code></td><td>Integer</td><td>ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚º (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 20)</td></tr><tr><td><code>offset</code></td><td>Integer</td><td>ã‚ªãƒ•ã‚»ãƒƒãƒˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0)</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°">2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°<a href="#2-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°" class="hash-link" aria-label="2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´° ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-auditlog-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«">2.1 AuditLog ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«<a href="#21-auditlog-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="hash-link" aria-label="2.1 AuditLog ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.1 AuditLog ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-platform/src/main/java/org/idp/server/platform/audit/AuditLog.java</code></p>
<p><strong>ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UUID id                      // ç›£æŸ»ãƒ­ã‚°ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String type                  // ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String description           // èª¬æ˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UUID tenantId                // ãƒ†ãƒŠãƒ³ãƒˆID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String clientId              // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UUID userId                  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String externalUserId        // å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB userPayload            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String targetResource        // å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String targetResourceAction  // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (create/update/delete)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB request                // ãƒªã‚¯ã‚¨ã‚¹ãƒˆè©³ç´°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB before                 // å¤‰æ›´å‰çŠ¶æ…‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB after                  // å¤‰æ›´å¾ŒçŠ¶æ…‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String outcomeResult         // çµæœ (success/failure)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String outcomeReason         // å¤±æ•—ç†ç”±</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String targetTenantId        // å¯¾è±¡ãƒ†ãƒŠãƒ³ãƒˆID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String ipAddress             // IPã‚¢ãƒ‰ãƒ¬ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String userAgent             // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB attributes             // ã‚«ã‚¹ã‚¿ãƒ å±æ€§</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Boolean dryRun               // ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ãƒ•ãƒ©ã‚°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timestamp createdAt          // ä½œæˆæ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>çµ±è¨ˆã«ä½¿ãˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<ul>
<li>âœ… <code>type</code> - ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ã”ã¨ã®é›†è¨ˆ</li>
<li>âœ… <code>outcomeResult</code> - æˆåŠŸ/å¤±æ•—ç‡</li>
<li>âœ… <code>createdAt</code> - æ™‚ç³»åˆ—é›†è¨ˆ</li>
<li>âœ… <code>targetResourceAction</code> - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥é›†è¨ˆ</li>
<li>âœ… <code>userId</code> - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</li>
<li>âœ… <code>clientId</code> - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã”ã¨ã®ä½¿ç”¨çŠ¶æ³</li>
<li>âœ… <code>dryRun</code> - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ vs æœ¬ç•ªå®Ÿè¡Œã®æ¯”ç‡</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-securityevent-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«">2.2 SecurityEvent ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«<a href="#22-securityevent-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="hash-link" aria-label="2.2 SecurityEvent ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.2 SecurityEvent ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-platform/src/main/java/org/idp/server/platform/security/SecurityEvent.java</code></p>
<p><strong>ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UUID identifier              // ã‚¤ãƒ™ãƒ³ãƒˆID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SecurityEventType type       // ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ (TOKEN_ISSUED, USER_AUTHENTICATEDç­‰)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String description           // èª¬æ˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SecurityEventTenant tenant   // ãƒ†ãƒŠãƒ³ãƒˆæƒ…å ± (id, issuer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SecurityEventClient client   // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæƒ…å ± (id, clientId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SecurityEventUser user       // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± (sub, externalUserId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IpAddress ipAddress          // IPã‚¢ãƒ‰ãƒ¬ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserAgent userAgent          // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB detail                 // ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timestamp createdAt          // ä½œæˆæ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>çµ±è¨ˆã«ä½¿ãˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<ul>
<li>âœ… <code>type</code> - ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥é›†è¨ˆ (èªè¨¼æˆåŠŸ/å¤±æ•—ã€ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œç­‰)</li>
<li>âœ… <code>createdAt</code> - æ™‚ç³»åˆ—é›†è¨ˆ</li>
<li>âœ… <code>user.sub</code> - ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° (DAU/MAU)</li>
<li>âœ… <code>client.clientId</code> - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆ¥ä½¿ç”¨çŠ¶æ³</li>
<li>âœ… <code>ipAddress</code> - åœ°ç†çš„åˆ†å¸ƒåˆ†æ</li>
<li>âœ… <code>userAgent</code> - ãƒ‡ãƒã‚¤ã‚¹/ãƒ–ãƒ©ã‚¦ã‚¶åˆ†æ</li>
<li>âœ… <code>detail</code> (JSONB) - æŸ”è»Ÿãªã‚«ãƒ†ã‚´ãƒªåˆ†æ</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-user-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«">2.3 User ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«<a href="#23-user-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="hash-link" aria-label="2.3 User ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2.3 User ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-core/src/main/java/org/idp/server/core/openid/identity/User.java</code></p>
<p><strong>ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UUID sub                     // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String providerId            // èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String externalUserId        // å¤–éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String preferredUsername     // ãƒ¦ãƒ¼ã‚¶ãƒ¼å</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String email                 // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Boolean emailVerified        // ãƒ¡ãƒ¼ãƒ«æ¤œè¨¼æ¸ˆã¿</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String phoneNumber           // é›»è©±ç•ªå·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Boolean phoneNumberVerified  // é›»è©±ç•ªå·æ¤œè¨¼æ¸ˆã¿</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB authenticationDevices  // èªè¨¼ãƒ‡ãƒã‚¤ã‚¹ (WebAuthn/FIDO2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JSONB verifiedClaims         // æ¤œè¨¼æ¸ˆã¿ã‚¯ãƒ¬ãƒ¼ãƒ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserStatus status            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ (ACTIVE/INACTIVE/DELETED)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timestamp createdAt          // ä½œæˆæ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timestamp updatedAt          // æ›´æ–°æ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>çµ±è¨ˆã«ä½¿ãˆã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<ul>
<li>âœ… <code>status</code> - ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</li>
<li>âœ… <code>createdAt</code> - ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰</li>
<li>âœ… <code>providerId</code> - èªè¨¼æ–¹æ³•ã®åˆ†å¸ƒ</li>
<li>âœ… <code>emailVerified</code> / <code>phoneNumberVerified</code> - æ¤œè¨¼ç‡</li>
<li>âœ… <code>authenticationDevices</code> - FIDO2/WebAuthnæ¡ç”¨ç‡</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ">3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ <a href="#3-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ " class="hash-link" aria-label="3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€  ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€  ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-audit_log-ãƒ†ãƒ¼ãƒ–ãƒ«">3.1 audit_log ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#31-audit_log-ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="3.1 audit_log ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.1 audit_log ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>DDLãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-database/postgresql/V0_9_0__init_lib.sql:956-998</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id UUID </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_id UUID </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id UUID </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_user_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_payload JSONB </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target_tenant_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target_resource </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    target_resource_action </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    request_payload JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    before_payload JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    after_payload JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outcome_result </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;unknown&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outcome_reason </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ip_address </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_agent </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dry_run </span><span class="token keyword" style="color:#00009f">BOOLEAN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attributes JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ10å€‹ï¼‰</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_tenant_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_client_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">client_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_user_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_external_user_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">external_user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_created_at </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_tenant_created_at </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- è¤‡åˆ â˜…é‡è¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_attributes </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> GIN </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">attributes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_outcome </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outcome_result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_type_created </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- è¤‡åˆ â˜…é‡è¦</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_audit_log_target_tenant </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target_tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>RLS ãƒãƒªã‚·ãƒ¼</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> audit_log </span><span class="token keyword" style="color:#00009f">ENABLE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROW</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LEVEL</span><span class="token plain"> SECURITY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> POLICY tenant_isolation_policy </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> audit_log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> current_setting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;app.tenant_id&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">::uuid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-security_event-ãƒ†ãƒ¼ãƒ–ãƒ«">3.2 security_event ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#32-security_event-ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="3.2 security_event ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.2 security_event ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>DDLãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-database/postgresql/V0_9_0__init_lib.sql:595-629</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id UUID </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    description </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_id UUID </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id UUID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_user_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ip_address INET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_agent </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    detail JSONB </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ8å€‹ï¼‰</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_type </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_tenant </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_client </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">client_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_user </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_external_user_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">external_user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_created_at </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_detail_jsonb </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> GIN </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">detail</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- JSONB â˜…æŸ”è»Ÿ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_events_tenant_created_at </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- è¤‡åˆ â˜…é‡è¦</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>RLS ãƒãƒªã‚·ãƒ¼</strong>: åŒæ§˜ã«é©ç”¨</p>
<p><strong>â­ çµ±è¨ˆã«æœ€é©ãªç†ç”±</strong>:</p>
<ol>
<li><strong>è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: <code>(tenant_id, created_at)</code> ã§æ™‚ç³»åˆ—é›†è¨ˆãŒé«˜é€Ÿ</li>
<li><strong>JSONB GIN ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå¯èƒ½</li>
<li><strong>å‹ç¨®åˆ¥ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ã”ã¨ã®é›†è¨ˆãŒé«˜é€Ÿ</li>
</ol>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-idp_user-ãƒ†ãƒ¼ãƒ–ãƒ«">3.3 idp_user ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#33-idp_user-ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="3.3 idp_user ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.3 idp_user ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>DDLãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-database/postgresql/V0_9_0__init_lib.sql:175-230</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> idp_user </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id UUID </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_id UUID </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    provider_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_user_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    external_user_original_payload JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    given_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    family_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    middle_name </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nickname </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    preferred_username </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    profile </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    picture </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    website </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email_verified </span><span class="token keyword" style="color:#00009f">BOOLEAN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gender </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    birthdate </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zoneinfo </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    locale </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone_number </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phone_number_verified </span><span class="token keyword" style="color:#00009f">BOOLEAN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    custom_properties JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    credentials JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hashed_password </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authentication_devices JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verified_claims JSONB</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">status</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    updated_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_idp_external_user_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> idp_user </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> provider_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> external_user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_idp_user_tenant_email </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> idp_user </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> email</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_idp_user_tenant_phone </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> idp_user </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> phone_number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_user_devices_gin_path_ops </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> idp_user </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> GIN </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">authentication_devices</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«">3.4 ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#34-ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="3.4 ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3.4 ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="oauth_token-ãƒ†ãƒ¼ãƒ–ãƒ«">oauth_token ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#oauth_token-ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="oauth_token ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="oauth_token ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>DDLãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-database/postgresql/V0_9_0__init_lib.sql:442-493</code></p>
<p><strong>çµ±è¨ˆç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grant_type </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">-- authorization_code, refresh_token, client_credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token_type </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">-- Bearer, DPoP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_id UUID                      </span><span class="token comment" style="color:#999988;font-style:italic">-- ãƒˆãƒ¼ã‚¯ãƒ³æ‰€æœ‰è€…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">-- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scopes </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic">-- ã‚¹ã‚³ãƒ¼ãƒ—</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">-- ç™ºè¡Œæ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access_token_expires_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">refresh_token_expires_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>çµ±è¨ˆä¾‹</strong>:</p>
<ul>
<li>ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°ï¼ˆæ—¥æ¬¡/grant_typeåˆ¥ï¼‰</li>
<li>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ¼ã‚¯ãƒ³æ•°</li>
<li>ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥é »åº¦</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authentication_transaction-ãƒ†ãƒ¼ãƒ–ãƒ«">authentication_transaction ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#authentication_transaction-ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="authentication_transaction ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="authentication_transaction ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>DDLãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-database/postgresql/V0_9_0__init_lib.sql:789-826</code></p>
<p><strong>çµ±è¨ˆç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flow </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">-- èªè¨¼ãƒ•ãƒ­ãƒ¼ç¨®åˆ¥ (password, mfa, biometric)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user_id UUID                      </span><span class="token comment" style="color:#999988;font-style:italic">-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">-- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">-- ä½œæˆæ—¥æ™‚ â˜…çµ±è¨ˆç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expires_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">-- æœ‰åŠ¹æœŸé™</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>çµ±è¨ˆä¾‹</strong>:</p>
<ul>
<li>èªè¨¼ãƒ•ãƒ­ãƒ¼åˆ¥ä½¿ç”¨çŠ¶æ³</li>
<li>èªè¨¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šæ™‚é–“</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-repository-ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹">4. Repository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹<a href="#4-repository-ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹" class="hash-link" aria-label="4. Repository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4. Repository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-securityeventqueryrepository">4.1 SecurityEventQueryRepository<a href="#41-securityeventqueryrepository" class="hash-link" aria-label="4.1 SecurityEventQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.1 SecurityEventQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-platform/src/main/java/org/idp/server/platform/security/repository/SecurityEventQueryRepository.java</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public interface SecurityEventQueryRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long findTotalCount(Tenant tenant, SecurityEventQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;SecurityEvent&gt; findList(Tenant tenant, SecurityEventQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SecurityEvent find(Tenant tenant, SecurityEventIdentifier identifier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…ã‚¯ãƒ©ã‚¹</strong>: <code>PostgresqlExecutor</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-core-adapter/src/main/java/org/idp/server/core/adapters/datasource/security/event/query/PostgresqlExecutor.java</code></p>
<p><strong>ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¯ã‚¨ãƒª</strong>:</p>
<ul>
<li>âœ… æ—¥æ™‚ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ (<code>hasFrom()</code> / <code>hasTo()</code>)</li>
<li>âœ… ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ (<code>hasEventType()</code> - INå¥å¯¾å¿œ)</li>
<li>âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ•ã‚£ãƒ«ã‚¿ (<code>hasClientId()</code>)</li>
<li>âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ (<code>hasUserId()</code> / <code>hasExternalUserId()</code>)</li>
<li>âœ… JSONBè©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ (<code>hasDetails()</code>)</li>
<li>âœ… ä»¶æ•°å–å¾— (<code>findTotalCount()</code>)</li>
<li>âœ… ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ (<code>limit</code> / <code>offset</code>)</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-auditlogqueryrepository">4.2 AuditLogQueryRepository<a href="#42-auditlogqueryrepository" class="hash-link" aria-label="4.2 AuditLogQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.2 AuditLogQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-platform/src/main/java/org/idp/server/platform/audit/AuditLogQueryRepository.java</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public interface AuditLogQueryRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long findTotalCount(Tenant tenant, AuditLogQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;AuditLog&gt; findList(Tenant tenant, AuditLogQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuditLog find(Tenant tenant, AuditLogIdentifier identifier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…ã‚¯ãƒ©ã‚¹</strong>: <code>PostgresqlExecutor</code>
<strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-core-adapter/src/main/java/org/idp/server/core/adapters/datasource/audit/query/PostgresqlExecutor.java</code></p>
<p><strong>ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¯ã‚¨ãƒª</strong>:</p>
<ul>
<li>âœ… æ—¥æ™‚ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿</li>
<li>âœ… çµæœãƒ•ã‚£ãƒ«ã‚¿ (<code>outcomeResult</code>)</li>
<li>âœ… ãƒªã‚½ãƒ¼ã‚¹ç¨®åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ (<code>targetResource</code> / <code>targetResourceAction</code>)</li>
<li>âœ… JSONBå±æ€§ãƒ•ã‚£ãƒ«ã‚¿ (<code>attributes</code>)</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-userqueryrepository">4.3 UserQueryRepository<a href="#43-userqueryrepository" class="hash-link" aria-label="4.3 UserQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4.3 UserQueryRepository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</strong>: <code>/Users/hirokazu.kobayashi/work/idp-server/libs/idp-server-core/src/main/java/org/idp/server/core/openid/identity/repository/UserQueryRepository.java</code></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public interface UserQueryRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User get(Tenant tenant, UserIdentifier userIdentifier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long findTotalCount(Tenant tenant, UserQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    List&lt;User&gt; findList(Tenant tenant, UserQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User findByEmail(Tenant tenant, String hint, String providerId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User findByPhone(Tenant tenant, String hint, String providerId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User findByPreferredUsername(Tenant tenant, String providerId, String preferredUsername);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚¯ã‚¨ãƒª</strong>:</p>
<ul>
<li>âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ (<code>status</code>)</li>
<li>âœ… ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ (<code>providerId</code>)</li>
<li>âœ… æ—¥æ™‚ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿</li>
<li>âœ… ä»¶æ•°å–å¾— (<code>findTotalCount()</code>)</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡">5. çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡<a href="#5-çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡" class="hash-link" aria-label="5. çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5. çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-dau-daily-active-users">5.1 DAU (Daily Active Users)<a href="#51-dau-daily-active-users" class="hash-link" aria-label="5.1 DAU (Daily Active Users) ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.1 DAU (Daily Active Users) ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>security_event</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> dau</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡å˜</strong>
<strong>ä½¿ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: <code>idx_events_tenant_created_at</code>, <code>idx_events_type</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-mau-monthly-active-users">5.2 MAU (Monthly Active Users)<a href="#52-mau-monthly-active-users" class="hash-link" aria-label="5.2 MAU (Monthly Active Users) ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.2 MAU (Monthly Active Users) ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>security_event</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> mau</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> DATE_TRUNC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;month&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_DATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> DATE_TRUNC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;month&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_DATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1 month&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡å˜</strong></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-èªè¨¼æˆåŠŸç‡">5.3 èªè¨¼æˆåŠŸç‡<a href="#53-èªè¨¼æˆåŠŸç‡" class="hash-link" aria-label="5.3 èªè¨¼æˆåŠŸç‡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.3 èªè¨¼æˆåŠŸç‡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>security_event</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> FILTER </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> success_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> FILTER </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_failure&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> failure_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ROUND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">100.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> FILTER </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> success_rate_percent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_failure&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡ å˜</strong></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°grant_typeåˆ¥">5.4 ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°ï¼ˆgrant_typeåˆ¥ï¼‰<a href="#54-ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°grant_typeåˆ¥" class="hash-link" aria-label="5.4 ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°ï¼ˆgrant_typeåˆ¥ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.4 ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°ï¼ˆgrant_typeåˆ¥ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>oauth_token</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  grant_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oauth_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> grant_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grant_type</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡å˜</strong>
<strong>ä½¿ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: <code>idx_oauth_token_expires_at</code> (tenant_id, expires_at)</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="55-ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰">5.5 ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰<a href="#55-ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰" class="hash-link" aria-label="5.5 ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.5 ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>idp_user</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> new_users</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> cumulative_users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> idp_user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡å˜</strong></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="56-ç®¡ç†æ“ä½œçµ±è¨ˆ">5.6 ç®¡ç†æ“ä½œçµ±è¨ˆ<a href="#56-ç®¡ç†æ“ä½œçµ±è¨ˆ" class="hash-link" aria-label="5.6 ç®¡ç†æ“ä½œçµ±è¨ˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="5.6 ç®¡ç†æ“ä½œçµ±è¨ˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: <code>audit_log</code> ãƒ†ãƒ¼ãƒ–ãƒ«</p>
<p><strong>SQLä¾‹</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  target_resource_action</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  outcome_result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> count</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> audit_log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target_resource_action</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> outcome_result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> count </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å®Ÿè£…é›£æ˜“åº¦</strong>: ğŸŸ¢ <strong>ç°¡å˜</strong>
<strong>ä½¿ç”¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong>: <code>idx_audit_log_type_created</code>, <code>idx_audit_log_outcome</code></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é …">6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é …<a href="#6-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é …" class="hash-link" aria-label="6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-materialized-view-ã®æ´»ç”¨">6.1 Materialized View ã®æ´»ç”¨<a href="#61-materialized-view-ã®æ´»ç”¨" class="hash-link" aria-label="6.1 Materialized View ã®æ´»ç”¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="6.1 Materialized View ã®æ´»ç”¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>å¤§é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆå„„å˜ä½ï¼‰ã§ã®é›†è¨ˆé«˜é€ŸåŒ–ã®ãŸã‚ã€æ—¥æ¬¡é›†è¨ˆç”¨Materialized Viewã‚’æ¨å¥¨ï¼š</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> MATERIALIZED </span><span class="token keyword" style="color:#00009f">VIEW</span><span class="token plain"> security_event_daily_summary </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> event_date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> event_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> unique_users</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> client_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> unique_clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_summary_tenant_date </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event_daily_summary </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event_date</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- æ—¥æ¬¡æ›´æ–°ï¼ˆCron Jobï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REFRESH MATERIALIZED </span><span class="token keyword" style="color:#00009f">VIEW</span><span class="token plain"> CONCURRENTLY security_event_daily_summary</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨">6.2 è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨<a href="#62-è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨" class="hash-link" aria-label="6.2 è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="6.2 è¿½ åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>æ™‚ç³»åˆ—é›†è¨ˆã®æ›´ãªã‚‹é«˜é€ŸåŒ–ï¼š</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- oauth_token ãƒ†ãƒ¼ãƒ–ãƒ«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_oauth_token_created_grant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> oauth_token </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grant_type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- idp_user ãƒ†ãƒ¼ãƒ–ãƒ«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_idp_user_created_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> idp_user </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- security_event ãƒ†ãƒ¼ãƒ–ãƒ«</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_security_event_type_created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> security_event </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°å°†æ¥çš„æ¤œè¨">6.3 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆå°†æ¥çš„æ¤œè¨ï¼‰<a href="#63-ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°å°†æ¥çš„æ¤œè¨" class="hash-link" aria-label="6.3 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆå°†æ¥çš„æ¤œè¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="6.3 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆå°†æ¥çš„æ¤œè¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>ãƒ†ãƒ¼ãƒ–ãƒ«ã‚µã‚¤ã‚ºãŒ10GBè¶…ã®å ´åˆã€æœˆæ¬¡ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ã‚’æ¤œè¨ï¼š</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> security_event_partitioned </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> RANGE </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> security_event_2025_01 </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">OF</span><span class="token plain"> security_event_partitioned</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2025-01-01&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2025-02-01&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> security_event_2025_02 </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">OF</span><span class="token plain"> security_event_partitioned</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2025-02-01&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2025-03-01&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡">7. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡<a href="#7-æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡" class="hash-link" aria-label="7. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="7. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-handler-service-repository-ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿">7.1 Handler-Service-Repository ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿<a href="#71-handler-service-repository-ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿" class="hash-link" aria-label="7.1 Handler-Service-Repository ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="7.1 Handler-Service-Repository ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>çµ±è¨ˆAPIã‚‚æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã«æº–æ‹ ï¼š</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Handlerå±¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TenantStatisticsHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TenantStatisticsResult handle(Tenant tenant, StatisticsQueries queries) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ã‚µãƒ¼ãƒ“ã‚¹å‘¼ã³å‡ºã—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Serviceå±¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TenantStatisticsFindService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TenantStatistics execute(Tenant tenant, StatisticsQueries queries) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long dau = securityEventQueryRepository.findDAU(tenant, queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long mau = securityEventQueryRepository.findMAU(tenant, queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Repositoryå±¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface TenantStatisticsQueryRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long findDAU(Tenant tenant, StatisticsQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long findMAU(Tenant tenant, StatisticsQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Long&gt; findEventCountByType(Tenant tenant, StatisticsQueries queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-entryservice-10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨">7.2 EntryService 10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨<a href="#72-entryservice-10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨" class="hash-link" aria-label="7.2 EntryService 10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="7.2 EntryService 10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class TenantStatisticsManagementEntryService {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TenantStatisticsManagementResponse findDashboard(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        AdminAuthenticationContext context,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TenantIdentifier tenantIdentifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StatisticsQueries queries,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RequestAttributes attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 1: èªè¨¼ãƒ»èªå¯ç¢ºèª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 2: Tenantå–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Tenant tenant = tenantRepository.get(tenantIdentifier);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 3: æ¨©é™æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 4: Handlerå®Ÿè¡Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TenantStatisticsResult result = handler.handle(tenant, queries);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 5: AuditLogè¨˜éŒ²</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Phase 6: Responseå¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return result.toResponse();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é …">8. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é …<a href="#8-æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é …" class="hash-link" aria-label="8. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="8. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-2-å¤–éƒ¨èª¿æŸ»keycloakauth0">Phase 2: å¤–éƒ¨èª¿æŸ»ï¼ˆKeycloak/Auth0ï¼‰<a href="#phase-2-å¤–éƒ¨èª¿æŸ»keycloakauth0" class="hash-link" aria-label="Phase 2: å¤–éƒ¨èª¿æŸ»ï¼ˆKeycloak/Auth0ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Phase 2: å¤–éƒ¨èª¿æŸ»ï¼ˆKeycloak/Auth0ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>æ—¢å­˜ã®è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ <code>analytics-statistics-design.md</code> ã§æ—¢ã«ã‚«ãƒãƒ¼æ¸ˆã¿ï¼š</p>
<ul>
<li>Keycloakã®çµ±è¨ˆæ©Ÿèƒ½ï¼ˆPrometheusé€£ æºï¼‰</li>
<li>Auth0ã®Analytics API</li>
<li>æ¥­ç•Œãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-3-apiä»•æ§˜ç­–å®š">Phase 3: APIä»•æ§˜ç­–å®š<a href="#phase-3-apiä»•æ§˜ç­–å®š" class="hash-link" aria-label="Phase 3: APIä»•æ§˜ç­–å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Phase 3: APIä»•æ§˜ç­–å®š ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>åŸºæœ¬çµ±è¨ˆAPIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆï¼š</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/dashboard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/time-series</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/tokens</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET /v1/management/tenants/{tenant-id}/statistics/authentication</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="phase-4-pocå®Ÿè£…">Phase 4: PoCå®Ÿè£…<a href="#phase-4-pocå®Ÿè£…" class="hash-link" aria-label="Phase 4: PoCå®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Phase 4: PoCå®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>æœ€å°é™ã®çµ±è¨ˆAPIï¼ˆ1é€±é–“ã§å®Ÿè£…å¯èƒ½ï¼‰ï¼š</p>
<ol>
<li><strong>DAU/MAU API</strong>: <code>security_event</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é›†è¨ˆ</li>
<li><strong>èªè¨¼æˆåŠŸç‡ API</strong>: <code>security_event</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é›†è¨ˆ</li>
<li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•· API</strong>: <code>idp_user</code> ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰é›†è¨ˆ</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-çµè«–">9. çµè«–<a href="#9-çµè«–" class="hash-link" aria-label="9. çµè«– ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="9. çµè«– ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦">âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦<a href="#-æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦" class="hash-link" aria-label="âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<table><thead><tr><th>é …ç›®</th><th>è©•ä¾¡</th><th>è©³ç´°</th></tr></thead><tbody><tr><td><strong>ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—</strong></td><td>â­â­â­â­â­</td><td>å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã« <code>created_at</code> å®Œå‚™</td></tr><tr><td><strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</strong></td><td>â­â­â­â­â­</td><td>è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§æ™‚ç³»åˆ—é›†è¨ˆæœ€é©åŒ–æ¸ˆã¿</td></tr><tr><td><strong>ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢</strong></td><td>â­â­â­â­â­</td><td>RLS + ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§å®Œå…¨åˆ†é›¢</td></tr><tr><td><strong>æŸ”è»Ÿæ€§</strong></td><td>â­â­â­â­â­</td><td>JSONB GINã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿å¯¾å¿œ</td></tr><tr><td><strong>Repository</strong></td><td>â­â­â­â­â­</td><td><code>findTotalCount()</code> ç­‰ã®é›†è¨ˆãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…æ¸ˆã¿</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-å®Ÿè£…ã®å®¹æ˜“æ€§">ğŸš€ å®Ÿè£…ã®å®¹æ˜“æ€§<a href="#-å®Ÿè£…ã®å®¹æ˜“æ€§" class="hash-link" aria-label="ğŸš€ å®Ÿè£…ã®å®¹æ˜“æ€§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ğŸš€ å®Ÿè£…ã®å®¹æ˜“æ€§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<table><thead><tr><th>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</th><th>é›£æ˜“åº¦</th><th>æœŸé–“è¦‹ç©</th></tr></thead><tbody><tr><td><strong>DAU/MAU</strong></td><td>ğŸŸ¢ ç°¡å˜</td><td>1-2æ—¥</td></tr><tr><td><strong>èªè¨¼æˆåŠŸç‡</strong></td><td>ğŸŸ¢ ç°¡å˜</td><td>1æ—¥</td></tr><tr><td><strong>ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°</strong></td><td>ğŸŸ¢ ç°¡å˜</td><td>1æ—¥</td></tr><tr><td><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·</strong></td><td>ğŸŸ¢ ç°¡å˜</td><td>1æ—¥</td></tr><tr><td><strong>ç®¡ç†æ“ä½œçµ±è¨ˆ</strong></td><td>ğŸŸ¢ ç°¡å˜</td><td>1æ—¥</td></tr><tr><td><strong>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆ</strong></td><td>ğŸŸ¡ ä¸­ç¨‹åº¦</td><td>1é€±é–“</td></tr><tr><td><strong>ç•°å¸¸æ¤œçŸ¥</strong></td><td>ğŸ”´ é«˜åº¦</td><td>2-3é€±é–“</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«">ğŸ“Š æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«<a href="#-æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«" class="hash-link" aria-label="ğŸ“Š æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ğŸ“Š æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ« ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ol>
<li><strong><code>security_event</code></strong> - èªè¨¼/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæœ€å„ªå…ˆï¼‰</li>
<li><strong><code>audit_log</code></strong> - ç®¡ç†æ“ä½œç›£æŸ»</li>
<li><strong><code>oauth_token</code></strong> - ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œå±¥æ­´</li>
<li><strong><code>idp_user</code></strong> - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ™ãƒ¼ã‚¹æˆé•·</li>
<li><strong><code>authentication_transaction</code></strong> - èªè¨¼ãƒ•ãƒ­ãƒ¼åˆ†æ</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä»˜éŒ²a-ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹">ä»˜éŒ²A: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹<a href="#ä»˜éŒ²a-ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹" class="hash-link" aria-label="ä»˜éŒ²A: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ä»˜éŒ²A: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹-dauè¨ˆç®—">ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: DAUè¨ˆç®—<a href="#ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹-dauè¨ˆç®—" class="hash-link" aria-label="ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: DAUè¨ˆç®— ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: DAUè¨ˆç®— ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXPLAIN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ANALYZE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DISTINCT</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> dau</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> security_event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;67e7eae6-62b0-4500-9eff-87459f63fc66&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;login_success&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2025-01-01&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> created_at </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2025-02-01&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">created_at</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>æœŸå¾…ã•ã‚Œã‚‹å®Ÿè¡Œè¨ˆç”»</strong>:</p>
<ul>
<li>âœ… Index Scan on <code>idx_events_tenant_created_at</code></li>
<li>âœ… Filter on <code>type</code> using <code>idx_events_type</code></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ä»˜éŒ²b-å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§">ä»˜éŒ²B: å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§<a href="#ä»˜éŒ²b-å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§" class="hash-link" aria-label="ä»˜éŒ²B: å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ä»˜éŒ²B: å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="entryservice">EntryService<a href="#entryservice" class="hash-link" aria-label="EntryService ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="EntryService ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><code>AuditLogManagementEntryService.java:45</code></li>
<li><code>SecurityEventManagementEntryService.java:38</code></li>
<li><code>UserManagementEntryService.java:52</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="repository">Repository<a href="#repository" class="hash-link" aria-label="Repository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Repository ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><code>SecurityEventQueryRepository.java:12</code></li>
<li><code>AuditLogQueryRepository.java:10</code></li>
<li><code>UserQueryRepository.java:15</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="handler">Handler<a href="#handler" class="hash-link" aria-label="Handler ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Handler ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><code>AuditLogFindListService.java:23</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ddl">DDL<a href="#ddl" class="hash-link" aria-label="DDL ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="DDL ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><code>V0_9_0__init_lib.sql:595-629</code> (security_event)</li>
<li><code>V0_9_0__init_lib.sql:956-998</code> (audit_log)</li>
<li><code>V0_9_0__init_lib.sql:175-230</code> (idp_user)</li>
</ul>
<hr>
<p><strong>æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</strong>: Phase 2ï¼ˆå¤–éƒ¨èª¿æŸ»ï¼‰ã¾ãŸã¯PoCå®Ÿè£…ã®é¸æŠã‚’æ¨å¥¨</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_09_project/issue-441-phase1-current-state-investigation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç·¨é›†</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_09_project/control-plane-separation-design"><div class="pagination-nav__sublabel">å‰ã¸</div><div class="pagination-nav__label">Control Planeåˆ†é›¢è¨­è¨ˆææ¡ˆ</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_09_project/project-01-faq"><div class="pagination-nav__sublabel">æ¬¡ã¸</div><div class="pagination-nav__label">project-01-faq</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-èª¿æŸ»ç›®çš„" class="table-of-contents__link toc-highlight">ğŸ“‹ èª¿æŸ»ç›®çš„</a></li><li><a href="#-executive-summary" class="table-of-contents__link toc-highlight">ğŸ¯ Executive Summary</a><ul><li><a href="#ä¸»è¦ç™ºè¦‹" class="table-of-contents__link toc-highlight">ä¸»è¦ç™ºè¦‹</a></li><li><a href="#çµ±è¨ˆapiå®Ÿè£…ã®é›£æ˜“åº¦" class="table-of-contents__link toc-highlight">çµ±è¨ˆAPIå®Ÿè£…ã®é›£æ˜“åº¦</a></li></ul></li><li><a href="#1-æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½" class="table-of-contents__link toc-highlight">1. æ—¢å­˜ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—æ©Ÿèƒ½</a><ul><li><a href="#11-audit-log-apiç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°" class="table-of-contents__link toc-highlight">1.1 Audit Log APIï¼ˆç®¡ç†æ“ä½œã®ç›£æŸ»ãƒ­ã‚°ï¼‰</a></li><li><a href="#12-security-event-apiã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°" class="table-of-contents__link toc-highlight">1.2 Security Event APIï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼‰</a></li><li><a href="#13-user-management-apiãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—" class="table-of-contents__link toc-highlight">1.3 User Management APIï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—ï¼‰</a></li></ul></li><li><a href="#2-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°" class="table-of-contents__link toc-highlight">2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°</a><ul><li><a href="#21-auditlog- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="table-of-contents__link toc-highlight">2.1 AuditLog ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</a></li><li><a href="#22-securityevent-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="table-of-contents__link toc-highlight">2.2 SecurityEvent ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</a></li><li><a href="#23-user-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«" class="table-of-contents__link toc-highlight">2.3 User ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</a></li></ul></li><li><a href="#3-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ " class="table-of-contents__link toc-highlight">3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ </a><ul><li><a href="#31-audit_log-ãƒ†ãƒ¼ãƒ–ãƒ«" class="table-of-contents__link toc-highlight">3.1 audit_log ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#32-security_event-ãƒ†ãƒ¼ãƒ–ãƒ«" class="table-of-contents__link toc-highlight">3.2 security_event ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#33-idp_user-ãƒ†ãƒ¼ãƒ–ãƒ«" class="table-of-contents__link toc-highlight">3.3 idp_user ãƒ†ãƒ¼ãƒ–ãƒ«</a></li><li><a href="#34-ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«" class="table-of-contents__link toc-highlight">3.4 ãã®ä»–ã®çµ±è¨ˆé–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«</a></li></ul></li><li><a href="#4-repository-ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹" class="table-of-contents__link toc-highlight">4. Repository ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</a><ul><li><a href="#41-securityeventqueryrepository" class="table-of-contents__link toc-highlight">4.1 SecurityEventQueryRepository</a></li><li><a href="#42-auditlogqueryrepository" class="table-of-contents__link toc-highlight">4.2 AuditLogQueryRepository</a></li><li><a href="#43-userqueryrepository" class="table-of-contents__link toc-highlight">4.3 UserQueryRepository</a></li></ul></li><li><a href="#5-çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡" class="table-of-contents__link toc-highlight">5. çµ±è¨ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡</a><ul><li><a href="#51-dau-daily-active-users" class="table-of-contents__link toc-highlight">5.1 DAU (Daily Active Users)</a></li><li><a href="#52-mau-monthly-active-users" class="table-of-contents__link toc-highlight">5.2 MAU (Monthly Active Users)</a></li><li><a href="#53-èªè¨¼æˆåŠŸç‡" class="table-of-contents__link toc-highlight">5.3 èªè¨¼æˆåŠŸç‡</a></li><li><a href="#54-ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°grant_typeåˆ¥" class="table-of-contents__link toc-highlight">5.4 ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œæ•°ï¼ˆgrant_typeåˆ¥ï¼‰</a></li><li><a href="#55-ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰" class="table-of-contents__link toc-highlight">5.5 ãƒ¦ãƒ¼ã‚¶ãƒ¼æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰</a></li><li><a href="#56-ç®¡ç†æ“ä½œçµ±è¨ˆ" class="table-of-contents__link toc-highlight">5.6 ç®¡ç†æ“ä½œçµ±è¨ˆ</a></li></ul></li><li><a href="#6-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é …" class="table-of-contents__link toc-highlight">6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®æ¨å¥¨äº‹é …</a><ul><li><a href="#61-materialized-view-ã®æ´»ç”¨" class="table-of-contents__link toc-highlight">6.1 Materialized View ã®æ´»ç”¨</a></li><li><a href="#62-è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨" class="table-of-contents__link toc-highlight">6.2 è¿½åŠ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ¤œè¨</a></li><li><a href="#63-ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°å°†æ¥çš„æ¤œè¨" class="table-of-contents__link toc-highlight">6.3 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ï¼ˆå°†æ¥çš„æ¤œè¨ï¼‰</a></li></ul></li><li><a href="#7-æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡" class="table-of-contents__link toc-highlight">7. æ—¢å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ´»ç”¨æ–¹é‡</a><ul><li><a href="#71-handler-service-repository-ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿" class="table-of-contents__link toc-highlight">7.1 Handler-Service-Repository ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™æ‰¿</a></li><li><a href="#72-entryservice-10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨" class="table-of-contents__link toc-highlight">7.2 EntryService 10ãƒ•ã‚§ãƒ¼ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨</a></li></ul></li><li><a href="#8-æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é …" class="table-of-contents__link toc-highlight">8. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®æ¨å¥¨äº‹é …</a><ul><li><a href="#phase-2-å¤–éƒ¨èª¿æŸ»keycloakauth0" class="table-of-contents__link toc-highlight">Phase 2: å¤–éƒ¨èª¿æŸ»ï¼ˆKeycloak/Auth0ï¼‰</a></li><li><a href="#phase-3-apiä»•æ§˜ç­–å®š" class="table-of-contents__link toc-highlight">Phase 3: APIä»•æ§˜ç­–å®š</a></li><li><a href="#phase-4-pocå®Ÿè£…" class="table-of-contents__link toc-highlight">Phase 4: PoCå®Ÿè£…</a></li></ul></li><li><a href="#9-çµè«–" class="table-of-contents__link toc-highlight">9. çµè«–</a><ul><li><a href="#-æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦" class="table-of-contents__link toc-highlight">âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å……å®Ÿåº¦</a></li><li><a href="#-å®Ÿè£…ã®å®¹æ˜“æ€§" class="table-of-contents__link toc-highlight">ğŸš€ å®Ÿè£…ã®å®¹æ˜“æ€§</a></li><li><a href="#-æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«" class="table-of-contents__link toc-highlight">ğŸ“Š æœ€é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«</a></li></ul></li><li><a href="#ä»˜éŒ²a-ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹" class="table-of-contents__link toc-highlight">ä»˜éŒ²A: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆä¾‹</a><ul><li><a href="#ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹-dauè¨ˆç®—" class="table-of-contents__link toc-highlight">ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: DAUè¨ˆç®—</a></li></ul></li><li><a href="#ä»˜éŒ²b-å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§" class="table-of-contents__link toc-highlight">ä»˜éŒ²B: å‚è€ƒå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§</a><ul><li><a href="#entryservice" class="table-of-contents__link toc-highlight">EntryService</a></li><li><a href="#repository" class="table-of-contents__link toc-highlight">Repository</a></li><li><a href="#handler" class="table-of-contents__link toc-highlight">Handler</a></li><li><a href="#ddl" class="table-of-contents__link toc-highlight">DDL</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>