<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_10_ai_developer/ai-42-webauthn" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">idp-server-webauthn4j-adapter - WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆ | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_10_ai_developer/ai-42-webauthn"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="idp-server-webauthn4j-adapter - WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆ | IdP-Server Documentation"><meta data-rh="true" name="description" content="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦"><meta data-rh="true" property="og:description" content="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_10_ai_developer/ai-42-webauthn"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_10_ai_developer/ai-42-webauthn" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_10_ai_developer/ai-42-webauthn" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.cb324818.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.67cd65aa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¾ã§ã‚¹ã‚­ãƒƒãƒ—"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¾ã§ã‚¹ã‚­ãƒƒãƒ—</a></div><nav aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’é–‹ã" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹(ç¾åœ¨ã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰)" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹(ç¾åœ¨ã¯ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å…ˆé ­ã¸æˆ»ã‚‹" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚µã‚¤ãƒ‰ãƒãƒ¼" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">ã¯ã˜ã‚ã«</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç´¢å¼•</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">è£½å“ç´¹ä»‹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/concept-01-multi-tenant">ã‚³ã‚¢æ¦‚å¿µ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">èªè¨¼ãƒ»èªå¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_05_how-to/index">How-toï¼ˆè¨­å®šãƒ»é‹ç”¨ãƒ¬ã‚·ãƒ”ï¼‰</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_06_developer-guide/getting-started/service-overview">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference">ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/ops-01-test-strategy">é‹ç”¨ï¼ˆOpsï¼‰</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/project-01-faq">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_10_ai_developer/ai-01-index">AI</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-01-index">AIé–‹ç™ºè€…å‘ã‘ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¬ã‚¤ãƒ‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-02-lessons-learned">AIé–‹ç™ºè€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚¬ã‚¤ãƒ‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-10-use-cases">idp-server-use-cases - ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ï¼ˆEntryServiceå®Ÿè£…ï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-11-core">idp-server-core - OAuth 2.0/OIDCæº–æ‹ ã‚³ã‚¢ã‚¨ãƒ³ã‚¸ãƒ³</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-12-platform">idp-server-platform - ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åŸºç›¤</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-13-control-plane">idp-server-control-plane - ç®¡ç†APIå¥‘ç´„å®šç¾©</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-20-adapters">Adapterå±¤ - Repositoryå®Ÿè£…ã¨ã‚¤ãƒ³ãƒ•ãƒ©çµ±åˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-21-core-adapter">idp-server-core-adapter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-22-database">idp-server-database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-23-springboot-adapter">idp-server-springboot-adapter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-30-extensions">æ‹¡å¼µæ©Ÿèƒ½å±¤ - OAuth/OIDCæ‹¡å¼µä»•æ§˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-31-extension-ciba">idp-server-core-extension-ciba - CIBAæ‹¡å¼µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-32-extension-fapi">idp-server-core-extension-fapi - FAPIæ‹¡å¼µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-33-extension-ida">idp-server-core-extension-ida - IDAæ‹¡å¼µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-34-extension-pkce">idp-server-core-extension-pkce - PKCEæ‹¡å¼µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-35-extension-vc">idp-server-core-extension-verifiable-credentials - VCæ‹¡å¼µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation">èªè¨¼ãƒ»é€£æºå±¤ - ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã¨ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-41-authentication">idp-server-authentication-interactors - èªè¨¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚¿ãƒ¼</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-42-webauthn">idp-server-webauthn4j-adapter - WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-43-federation-oidc">idp-server-federation-oidc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-50-notification-security-event">é€šçŸ¥ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå±¤ - é€šçŸ¥é…ä¿¡ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-51-notification-fcm">idp-server-notification-fcm-adapter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-52-notification-apns">idp-server-notification-apns-adapter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-53-email-aws">idp-server-email-aws-adapter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-54-security-event-framework">idp-server-security-event-framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/ai-55-security-event-hooks">idp-server-security-event-hooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_10_ai_developer/external-api-response-handling-investigation">å¤–éƒ¨APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ”¹å–„èª¿æŸ»</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">AI</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">idp-server-webauthn4j-adapter - WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆ</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">ã“ã®ãƒšãƒ¼ã‚¸ã®è¦‹å‡ºã—</button></div><div class="theme-doc-markdown markdown"><header><h1>idp-server-webauthn4j-adapter - WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆ</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦<a href="#ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦" class="hash-link" aria-label="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<p><strong>æƒ…å ±æº</strong>: <code>libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/</code>
<strong>ç¢ºèªæ—¥</strong>: 2025-11-08
<strong>ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</strong>: <code>com.webauthn4j:webauthn4j-core:0.28.5.RELEASE</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="è²¬å‹™">è²¬å‹™<a href="#è²¬å‹™" class="hash-link" aria-label="è²¬å‹™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="è²¬å‹™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>WebAuthn/FIDO2å®Ÿè£…ï¼ˆwebauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆï¼‰ã€‚</p>
<p><strong>ä»•æ§˜</strong>: <a href="https://www.w3.org/TR/webauthn-2/" target="_blank" rel="noopener noreferrer">Web Authentication Level 2</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä¸»è¦æ©Ÿèƒ½">ä¸»è¦æ©Ÿèƒ½<a href="#ä¸»è¦æ©Ÿèƒ½" class="hash-link" aria-label="ä¸»è¦æ©Ÿèƒ½ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ä¸»è¦æ©Ÿèƒ½ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><strong>Registration Challenge</strong>: èªè¨¼å™¨ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆï¼ˆPasskeyä½œæˆé–‹å§‹ï¼‰</li>
<li><strong>Registration</strong>: èªè¨¼å™¨ç™»éŒ²æ¤œè¨¼ï¼ˆPasskeyä½œæˆå®Œäº†ï¼‰</li>
<li><strong>Authentication Challenge</strong>: èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆï¼ˆèªè¨¼é–‹å§‹ï¼‰</li>
<li><strong>Authentication</strong>: èªè¨¼å™¨æ¤œè¨¼ï¼ˆèªè¨¼å®Œäº†ï¼‰</li>
<li><strong>Attestation</strong>: èªè¨¼å™¨è¨¼æ˜ï¼ˆãƒ‡ãƒã‚¤ã‚¹ä¿¡é ¼æ€§ï¼‰</li>
<li><strong>User Verification</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œè¨¼ï¼ˆPIN/ç”Ÿä½“èªè¨¼ï¼‰</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦<a href="#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦" class="hash-link" aria-label="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼">4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼<a href="#4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼" class="hash-link" aria-label="4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>WebAuthn4jã¯ä»¥ä¸‹ã®4ã¤ã®Executorã§æ§‹æˆã•ã‚Œã€AuthenticationExecutorã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ï¼š</p>
<ol>
<li><strong>RegistrationChallengeExecutor</strong>: ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</li>
<li><strong>RegistrationExecutor</strong>: ç™»éŒ²æ¤œè¨¼ãƒ»Credentialä¿å­˜</li>
<li><strong>AuthenticationChallengeExecutor</strong>: èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</li>
<li><strong>AuthenticationExecutor</strong>: èªè¨¼æ¤œè¨¼</li>
</ol>
<p><strong>æƒ…å ±æº</strong>: <code>libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ">ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ<a href="#ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ" class="hash-link" aria-label="ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-webauthn4jconfiguration---è¨­å®šç®¡ç†">1. WebAuthn4jConfiguration - è¨­å®šç®¡ç†<a href="#1-webauthn4jconfiguration---è¨­å®šç®¡ç†" class="hash-link" aria-label="1. WebAuthn4jConfiguration - è¨­å®šç®¡ç† ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. WebAuthn4jConfiguration - è¨­å®šç®¡ç† ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jConfiguration-ec5d7ddb2971bca9e75e8d2a78cf19a8.java#L25" target="_blank">WebAuthn4jConfiguration.java:25-110</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * WebAuthnè¨­å®šï¼ˆRPæƒ…å ±ãƒ»æ¤œè¨¼è¦ä»¶ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String rpId;                          // Relying Party ID (ä¾‹: example.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String rpName;                        // Relying Partyå</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String origin;                        // ã‚ªãƒªã‚¸ãƒ³ï¼ˆä¾‹: https://example.comï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  byte[] tokenBindingId;                // Token Binding IDï¼ˆé€šå¸¸nullï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String attestationPreference;         // Attestationè¨­å®šï¼ˆnone/indirect/directï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String authenticatorAttachment;       // èªè¨¼å™¨ã‚¿ã‚¤ãƒ—ï¼ˆplatform/cross-platformï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  boolean requireResidentKey;           // Resident Keyå¿…é ˆã‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  boolean userVerificationRequired;     // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œè¨¼ï¼ˆPIN/ç”Ÿä½“èªè¨¼ï¼‰å¿…é ˆã‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  boolean userPresenceRequired;         // ãƒ¦ãƒ¼ã‚¶ãƒ¼å­˜åœ¨ç¢ºèªå¿…é ˆã‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // webauthn4jã®RegistrationParametersã«å¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RegistrationParameters toRegistrationParameters(WebAuthn4jChallenge challenge) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Origin origin = Origin.create(this.origin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ServerProperty serverProperty =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new ServerProperty(origin, rpId, challenge, tokenBindingId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new RegistrationParameters(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverProperty,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null, // pubKeyCredParams</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userVerificationRequired,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userPresenceRequired);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>é‡è¦è¨­å®šé …ç›®</strong>:</p>
<ul>
<li><code>rpId</code>: WebAuthnã®ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆé€šå¸¸ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³åï¼‰</li>
<li><code>origin</code>: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®URLï¼ˆhttpså¿…é ˆï¼‰</li>
<li><code>userVerificationRequired</code>: PIN/ç”Ÿä½“èªè¨¼ã®è¦å¦</li>
<li><code>userPresenceRequired</code>: ã‚¿ãƒƒãƒ—/ã‚¿ãƒƒãƒã®è¦å¦</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-webauthn4jchallenge---ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ">2. WebAuthn4jChallenge - ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ<a href="#2-webauthn4jchallenge---ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="hash-link" aria-label="2. WebAuthn4jChallenge - ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. WebAuthn4jChallenge - ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jChallenge-ac3fd1820355cf1ca4aa8e91ed861c28.java#L29" target="_blank">WebAuthn4jChallenge.java:29-82</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * WebAuthnãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ˆChallengeã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jChallenge implements Challenge {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  byte[] value;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // UUID v4ãƒ™ãƒ¼ã‚¹ã®16ãƒã‚¤ãƒˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static WebAuthn4jChallenge generate() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID uuid = UUID.randomUUID();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long hi = uuid.getMostSignificantBits();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long lo = uuid.getLeastSignificantBits();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] value = ByteBuffer.allocate(16).putLong(hi).putLong(lo).array();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new WebAuthn4jChallenge(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Base64URLæ–‡å­—åˆ—ã¨ã—ã¦å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String challengeAsString() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Base64.getUrlEncoder().encodeToString(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // FIDO2Challengeï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰ã«å¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Fido2Challenge toWebAuthnChallenge() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new Fido2Challenge(challengeAsString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ãƒãƒ£ãƒ¬ãƒ³ã‚¸è¨­è¨ˆ</strong>:</p>
<ul>
<li>UUIDv4ãƒ™ãƒ¼ã‚¹ï¼ˆ128bit = 16ãƒã‚¤ãƒˆï¼‰</li>
<li>Base64URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰</li>
<li>ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒé˜²æ­¢ã®ãŸã‚ã€å„æ“ä½œã§ä¸€æ„</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-webauthn4jcredential---credentialç®¡ç†">3. WebAuthn4jCredential - Credentialç®¡ç†<a href="#3-webauthn4jcredential---credentialç®¡ç†" class="hash-link" aria-label="3. WebAuthn4jCredential - Credentialç®¡ç† ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. WebAuthn4jCredential - Credentialç®¡ç† ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jCredential-4bbd60bbebf05721e3436a751813e6a8.java#L23" target="_blank">WebAuthn4jCredential.java:23-95</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * WebAuthnèªè¨¼æƒ…å ±ï¼ˆPasskeyï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jCredential {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String id;                  // Credential IDï¼ˆBase64URLï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String userId;              // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String rpId;                // Relying Party ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String publicKey;           // å…¬é–‹éµï¼ˆBase64URLï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String attestationObject;   // Attestationãƒ‡ãƒ¼ã‚¿ï¼ˆBase64URLï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  long signCount;             // ç½²åã‚«ã‚¦ãƒ³ã‚¿ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ãƒã‚¤ãƒˆé…åˆ—ã¨ã—ã¦å–å¾—ï¼ˆwebauthn4jæ¤œè¨¼ç”¨ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public byte[] idAsBytes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Base64.getUrlDecoder().decode(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public byte[] attestationObjectAsBytes() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Base64.getUrlDecoder().decode(attestationObject);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // ã‚¹ãƒãƒ¼ã‚¯ã‚±ãƒ¼ã‚¹Mapã«å¤‰æ›ï¼ˆJSONä¿å­˜ç”¨ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Map&lt;String, Object&gt; toMap() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; result = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;id&quot;, id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;user_id&quot;, userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;rp_id&quot;, rpId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;public_key&quot;, publicKey);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;attestation_object&quot;, attestationObject);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result.put(&quot;sign_count&quot;, signCount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Credentialãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«</strong>:</p>
<ol>
<li>Registrationæ™‚ã«ä½œæˆï¼ˆ<code>WebAuthn4jRegistrationManager</code>ï¼‰</li>
<li><code>WebAuthn4jCredentialRepository.register()</code>ã§ä¿å­˜</li>
<li>Authenticationæ™‚ã«<code>get(id)</code>ã§å–å¾—</li>
<li>æ¤œè¨¼æˆåŠŸå¾Œã«<code>updateSignCount()</code>ã§ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³<a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³" class="hash-link" aria-label="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-ç™»éŒ²ãƒ•ãƒ­ãƒ¼---webauthn4jregistrationmanager">1. ç™»éŒ²ãƒ•ãƒ­ãƒ¼ - WebAuthn4jRegistrationManager<a href="#1-ç™»éŒ²ãƒ•ãƒ­ãƒ¼---webauthn4jregistrationmanager" class="hash-link" aria-label="1. ç™»éŒ²ãƒ•ãƒ­ãƒ¼ - WebAuthn4jRegistrationManager ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. ç™»éŒ²ãƒ•ãƒ­ãƒ¼ - WebAuthn4jRegistrationManager ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jRegistrationManager-8ced81fa946bffeafb23c5b68b8a3a00.java#L27" target="_blank">WebAuthn4jRegistrationManager.java:27-104</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * webauthn4jã‚’ä½¿ã£ãŸç™»éŒ²æ¤œè¨¼ãƒ»Credentialä½œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jRegistrationManager {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthnManager webAuthnManager;           // webauthn4jã‚³ã‚¢ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jConfiguration configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jChallenge webAuthn4jChallenge;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String request;                            // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®JSON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String userId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public WebAuthn4jRegistrationManager(...) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // NonStrictãƒ¢ãƒ¼ãƒ‰ï¼ˆæœ¬ç•ªã¯Strictãƒ¢ãƒ¼ãƒ‰æ¨å¥¨ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public WebAuthn4jCredential verifyAndCreateCredential() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. JSONã‚’RegistrationDataã«ãƒ‘ãƒ¼ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RegistrationData registrationData = parseRequest();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. æ¤œè¨¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ§‹ç¯‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RegistrationParameters registrationParameters =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        configuration.toRegistrationParameters(webAuthn4jChallenge);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. webauthn4jã§æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RegistrationData verified =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        webAuthnManager.verify(registrationData, registrationParameters);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. Credential IDæŠ½å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] credentialId = Objects.requireNonNull(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        verified.getAttestationObject()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .getAuthenticatorData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .getAttestedCredentialData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ).getCredentialId();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 5. AttestedCredentialDataã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectConverter objectConverter = new ObjectConverter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AttestedCredentialDataConverter converter =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new AttestedCredentialDataConverter(objectConverter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] attestedCredentialData =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        converter.convert(verified.getAttestationObject()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .getAuthenticatorData()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .getAttestedCredentialData());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 6. WebAuthn4jCredentialä½œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String id = Base64.getUrlEncoder().withoutPadding()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .encodeToString(credentialId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String attestationDataString = Base64.getUrlEncoder().withoutPadding()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .encodeToString(attestedCredentialData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new WebAuthn4jCredential(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id, userId, configuration.rpId(), &quot;&quot;, attestationDataString, 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private RegistrationData parseRequest() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return webAuthnManager.parseRegistrationResponseJSON(request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      throw new WebAuthn4jBadRequestException(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;webauthn registration request is invalid&quot;, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç™»éŒ²å‡¦ç†ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
<ol>
<li><strong>webauthn4jæ¤œè¨¼</strong>: <code>WebAuthnManager.verify()</code>ã§RFCæº–æ‹ æ¤œè¨¼</li>
<li><strong>AttestedCredentialDataä¿å­˜</strong>: å…¬é–‹éµãƒ»Credential IDã‚’å«ã‚€</li>
<li><strong>Base64URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰</strong>: ã™ã¹ã¦ã®ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã‚’Base64URLåŒ–</li>
<li><strong>ä¾‹å¤–å‡¦ç†</strong>: webauthn4jã®ä¾‹å¤–ã‚’<code>WebAuthn4jBadRequestException</code>ã§ãƒ©ãƒƒãƒ—</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-èªè¨¼ãƒ•ãƒ­ãƒ¼---webauthn4jauthenticationmanager">2. èªè¨¼ãƒ•ãƒ­ãƒ¼ - WebAuthn4jAuthenticationManager<a href="#2-èªè¨¼ãƒ•ãƒ­ãƒ¼---webauthn4jauthenticationmanager" class="hash-link" aria-label="2. èªè¨¼ãƒ•ãƒ­ãƒ¼ - WebAuthn4jAuthenticationManager ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. èªè¨¼ãƒ•ãƒ­ãƒ¼ - WebAuthn4jAuthenticationManager ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jAuthenticationManager-920abd9964ea9e9d7d23187cc4c2dceb.java#L29" target="_blank">WebAuthn4jAuthenticationManager.java:29-102</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * webauthn4jã‚’ä½¿ã£ãŸèªè¨¼æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jAuthenticationManager {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthnManager webAuthnManager;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jConfiguration configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jChallenge challenge;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String request;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public WebAuthn4jAuthenticationManager(...) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // UserHandleï¼ˆuserIDï¼‰ã‚’æŠ½å‡º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String extractUserId() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationData authenticationData = parseAuthenticationData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new String(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Objects.requireNonNull(authenticationData.getUserHandle()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StandardCharsets.UTF_8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // èªè¨¼æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void verify(WebAuthn4jCredential credential) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. JSONã‚’AuthenticationDataã«ãƒ‘ãƒ¼ã‚¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationData authenticationData = parseAuthenticationData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. Credentialã‚’CredentialRecordã«å¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jCredentialConverter converter =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new WebAuthn4jCredentialConverter(credential);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CredentialRecordImpl credentialRecord = converter.convert();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. æ¤œè¨¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ§‹ç¯‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationParameters authenticationParameters =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        toAuthenticationParameters(credentialRecord);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. webauthn4jã§æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationData verifiedData =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        webAuthnManager.verify(authenticationData, authenticationParameters);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æ¤œè¨¼æˆåŠŸï¼ˆä¾‹å¤–ãŒæŠ•ã’ã‚‰ã‚Œãªã‘ã‚Œã°OKï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private AuthenticationParameters toAuthenticationParameters(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CredentialRecordImpl credentialRecord) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Server properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Origin origin = Origin.create(configuration.origin());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ServerProperty serverProperty =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new ServerProperty(origin, configuration.rpId(), challenge, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // expectations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    boolean userVerificationRequired = configuration.userVerificationRequired();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    boolean userPresenceRequired = configuration.userPresenceRequired();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new AuthenticationParameters(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverProperty,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        credentialRecord,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,  // allowCredentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userVerificationRequired,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        userPresenceRequired);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private AuthenticationData parseAuthenticationData() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return webAuthnManager.parseAuthenticationResponseJSON(request);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      throw new WebAuthn4jBadRequestException(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;Failed to parse authentication response&quot;, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>èªè¨¼å‡¦ç†ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
<ol>
<li><strong>Credentialå¤‰æ›</strong>: ä¿å­˜ã•ã‚ŒãŸ<code>WebAuthn4jCredential</code>ã‚’<code>CredentialRecordImpl</code>ã«å¤‰æ›</li>
<li><strong>UserHandleæŠ½å‡º</strong>: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒé€ä¿¡ã—ãŸUserIDã‚’æŠ½å‡º</li>
<li><strong>æ¤œè¨¼æˆåŠŸåˆ¤å®š</strong>: ä¾‹å¤–ãŒæŠ•ã’ã‚‰ã‚Œãªã‘ã‚Œã°èªè¨¼æˆåŠŸ</li>
<li><strong>SignCountæ›´æ–°</strong>: æ¤œè¨¼å¾Œã«åˆ¥é€”æ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œ  çŸ¥ï¼‰</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-webauthn4jcredentialconverter---credentialå¤‰æ›">3. WebAuthn4jCredentialConverter - Credentialå¤‰æ›<a href="#3-webauthn4jcredentialconverter---credentialå¤‰æ›" class="hash-link" aria-label="3. WebAuthn4jCredentialConverter - Credentialå¤‰æ› ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. WebAuthn4jCredentialConverter - Credentialå¤‰æ› ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jCredentialConverter-91c1c48a48f169c571604f9f0c417a2c.java#L27" target="_blank">WebAuthn4jCredentialConverter.java:27-56</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * WebAuthn4jCredential â†’ CredentialRecordImplå¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jCredentialConverter {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jCredential credential;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AttestedCredentialDataConverter attestedCredentialDataConverter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public CredentialRecordImpl convert() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Base64.Decoder urlDecoder = Base64.getUrlDecoder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // AttestedCredentialDataã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AttestedCredentialData deserializedAttestedCredentialData =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        attestedCredentialDataConverter.convert(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            urlDecoder.decode(credential.attestationObject()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // CredentialRecordImplä½œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new CredentialRecordImpl(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new NoneAttestationStatement(),        // Attestationï¼ˆnoneï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,                                  // isBackupEligible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,                                  // isBackedUp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,                                  // attestedCredentialData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        credential.signCount(),                // signCount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deserializedAttestedCredentialData,    // attestedCredentialData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new AuthenticationExtensionsAuthenticatorOutputs&lt;&gt;(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,                                  // clientExtensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null,                                  // authenticatorExtensions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        null                                   // transports</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Credentialå¤‰æ›ã®å½¹å‰²</strong>:</p>
<ul>
<li>ä¿å­˜ã•ã‚ŒãŸBase64URLæ–‡å­—åˆ—ã‚’ãƒã‚¤ãƒŠãƒªã«å¤‰æ›</li>
<li>webauthn4jã®<code>CredentialRecordImpl</code>ã«å†æ§‹ç¯‰</li>
<li>èªè¨¼æ¤œè¨¼æ™‚ã«ä½¿ç”¨</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="authenticationexecutorå®Ÿè£…4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚º">AuthenticationExecutorå®Ÿè£…ï¼ˆ4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰<a href="#authenticationexecutorå®Ÿè£…4ã¤ã®ãƒ• ã‚§ãƒ¼ã‚º" class="hash-link" aria-label="AuthenticationExecutorå®Ÿè£…ï¼ˆ4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="AuthenticationExecutorå®Ÿè£…ï¼ˆ4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-webauthn4jregistrationchallengeexecutor---ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ">1. WebAuthn4jRegistrationChallengeExecutor - ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ<a href="#1-webauthn4jregistrationchallengeexecutor---ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="hash-link" aria-label="1. WebAuthn4jRegistrationChallengeExecutor - ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. WebAuthn4jRegistrationChallengeExecutor - ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jRegistrationChallengeExecutor-d850e4a5aee3031b291dc0864d5f5f4b.java#L33" target="_blank">WebAuthn4jRegistrationChallengeExecutor.java:33-78</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”ŸæˆExecutor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * function: &quot;webauthn4j_registration_challenge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jRegistrationChallengeExecutor implements AuthenticationExecutor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthenticationInteractionCommandRepository transactionCommandRepository;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AuthenticationInteractionQueryRepository transactionQueryRepository;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jCredentialRepository credentialRepository;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  JsonConverter jsonConverter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;webauthn4j_registration_challenge&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Fido2ExecutorType type() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new Fido2ExecutorType(&quot;webauthn4j&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public AuthenticationExecutionResult execute(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tenant tenant,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationTransactionIdentifier identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionRequest request,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      RequestAttributes requestAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionConfig configuration) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆï¼ˆUUIDãƒ™ãƒ¼ã‚¹ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jChallenge webAuthn4jChallenge = WebAuthn4jChallenge.generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Fido2Challenge fido2Challenge = webAuthn4jChallenge.toWebAuthnChallenge();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ä¸€æ™‚ä¿å­˜ï¼ˆRedis/DBã«ä¿å­˜ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionCommandRepository.register(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tenant, identifier, type().value(), fido2Challenge);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. ã‚¯ãƒ© ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’è¿”ã™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; contents = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contents.put(&quot;challenge&quot;, webAuthn4jChallenge.challengeAsString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response.put(&quot;execution_webauthn4j&quot;, contents);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AuthenticationExecutionResult.success(response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å‡¦ç†ãƒ•ãƒ­ãƒ¼</strong>:</p>
<ol>
<li>UUID v4ãƒ™ãƒ¼ã‚¹ã®16ãƒã‚¤ãƒˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</li>
<li>AuthenticationInteractionRepositoryã«ä¸€æ™‚ä¿å­˜</li>
<li>Base64URLæ–‡å­—åˆ—ã¨ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”å´</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-webauthn4jregistrationexecutor---ç™»éŒ²æ¤œè¨¼">2. WebAuthn4jRegistrationExecutor - ç™»éŒ²æ¤œè¨¼<a href="#2-webauthn4jregistrationexecutor---ç™»éŒ²æ¤œè¨¼" class="hash-link" aria-label="2. WebAuthn4jRegistrationExecutor - ç™»éŒ²æ¤œè¨¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. WebAuthn4jRegistrationExecutor - ç™»éŒ²æ¤œè¨¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jRegistrationExecutor-9065b388442c908d1b9413b837cbfbd6.java#L35" target="_blank">WebAuthn4jRegistrationExecutor.java:35-91</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * ç™»éŒ²æ¤œè¨¼Executor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * function: &quot;webauthn4j_registration&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jRegistrationExecutor implements AuthenticationExecutor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;webauthn4j_registration&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public AuthenticationExecutionResult execute(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tenant tenant,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationTransactionIdentifier identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionRequest request,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      RequestAttributes requestAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionConfig configuration) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Fido2Challenge fido2Challenge =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        transactionQueryRepository.get(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tenant, identifier, type().value(), Fido2Challenge.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jChallenge webAuthn4jChallenge =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new WebAuthn4jChallenge(fido2Challenge.challenge());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String requestString = jsonConverter.write(request.toMap());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. è¨­å®šã‚’å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jConfiguration webAuthn4jConfiguration =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jsonConverter.read(configuration.details(), WebAuthn4jConfiguration.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. userIdç”Ÿæˆï¼ˆUUID v4ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String userId = UUID.randomUUID().toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 5. WebAuthn4jRegistrationManagerã§æ¤œè¨¼ãƒ»Credentialä½œæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jRegistrationManager manager =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new WebAuthn4jRegistrationManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            webAuthn4jConfiguration, webAuthn4jChallenge, requestString, userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jCredential webAuthn4jCredential = manager.verifyAndCreateCredential();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 6. Credentialã‚’æ°¸ç¶šåŒ–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    credentialRepository.register(webAuthn4jCredential);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 7. çµæœã‚’è¿”ã™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response.put(&quot;execution_webauthn4j&quot;, webAuthn4jCredential.toMap());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AuthenticationExecutionResult.success(response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å‡¦ç†ãƒ•ãƒ­ãƒ¼</strong>:</p>
<ol>
<li>ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’å–å¾—</li>
<li>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSONåŒ–</li>
<li>WebAuthn4jRegistrationManagerã§æ¤œè¨¼</li>
<li>Credentialã‚’æ°¸ç¶šåŒ–ï¼ˆPostgreSQL/MySQLï¼‰</li>
<li>æˆåŠŸçµæœã‚’è¿”å´</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-webauthn4jauthenticationchallengeexecutor---èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ">3. WebAuthn4jAuthenticationChallengeExecutor - èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ<a href="#3-webauthn4jauthenticationchallengeexecutor---èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="hash-link" aria-label="3. WebAuthn4jAuthenticationChallengeExecutor - èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. WebAuthn4jAuthenticationChallengeExecutor - èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jAuthenticationChallengeExecutor-42953f1ec43d3db928053ea1d5b02f9b.java#L34" target="_blank">WebAuthn4jAuthenticationChallengeExecutor.java:34-79</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”ŸæˆExecutor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * function: &quot;webauthn4j_authentication_challenge&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jAuthenticationChallengeExecutor implements AuthenticationExecutor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;webauthn4j_authentication_challenge&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public AuthenticationExecutionResult execute(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tenant tenant,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationTransactionIdentifier identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionRequest request,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      RequestAttributes requestAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionConfig configuration) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jChallenge webAuthn4jChallenge = WebAuthn4jChallenge.generate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Fido2Challenge fido2Challenge = webAuthn4jChallenge.toWebAuthnChallenge();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ä¸€æ™‚ä¿å­˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transactionCommandRepository.register(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tenant, identifier, type().value(), fido2Challenge);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’è¿”ã™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; contents = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contents.put(&quot;challenge&quot;, webAuthn4jChallenge.challengeAsString());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response.put(&quot;execution_webauthn4j&quot;, contents);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AuthenticationExecutionResult.success(response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã¨ã®é•ã„</strong>:</p>
<ul>
<li>åŸºæœ¬çš„ãªãƒ•ãƒ­ãƒ¼ã¯åŒã˜</li>
<li><code>function()</code>ãŒ<code>webauthn4j_authentication_challenge</code></li>
<li>èªè¨¼ãƒ•ãƒ­ãƒ¼ç”¨ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-webauthn4jauthenticationexecutor---èªè¨¼æ¤œè¨¼">4. WebAuthn4jAuthenticationExecutor - èªè¨¼æ¤œè¨¼<a href="#4-webauthn4jauthenticationexecutor---èªè¨¼æ¤œè¨¼" class="hash-link" aria-label="4. WebAuthn4jAuthenticationExecutor - èªè¨¼æ¤œè¨¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="4. WebAuthn4jAuthenticationExecutor - èªè¨¼æ¤œè¨¼ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jAuthenticationExecutor-ebef4c7a891116ef078e1c9f24b71fbb.java#L34" target="_blank">WebAuthn4jAuthenticationExecutor.java:34-92</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * èªè¨¼æ¤œè¨¼Executor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * function: &quot;webauthn4j_authentication&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jAuthenticationExecutor implements AuthenticationExecutor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public String function() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;webauthn4j_authentication&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public AuthenticationExecutionResult execute(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tenant tenant,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationTransactionIdentifier identifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionRequest request,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      RequestAttributes requestAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      AuthenticationExecutionConfig configuration) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 1. ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Fido2Challenge fido2Challenge =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        transactionQueryRepository.get(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tenant, identifier, type().value(), Fido2Challenge.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jChallenge webAuthn4jChallenge =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new WebAuthn4jChallenge(fido2Challenge.challenge());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 2. ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSONæ–‡å­—åˆ—ã«å¤‰æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String requestString = jsonConverter.write(request.toMap());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 3. è¨­å®šã‚’å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jConfiguration webAuthn4jConfiguration =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jsonConverter.read(configuration.details(), WebAuthn4jConfiguration.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 4. WebAuthn4jAuthenticationManagerã§æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jAuthenticationManager manager =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new WebAuthn4jAuthenticationManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            webAuthn4jConfiguration, webAuthn4jChallenge, requestString);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 5. Credential IDå–å¾—ãƒ»æ¤œè¨¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String id = request.optValueAsString(&quot;id&quot;, &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jCredential webAuthn4jCredential = credentialRepository.get(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    manager.verify(webAuthn4jCredential);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 6. æˆåŠŸçµæœã‚’è¿”ã™</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; contents = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contents.put(&quot;id&quot;, id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contents.put(&quot;status&quot;, &quot;ok&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response.put(&quot;execution_webauthn4j&quot;, contents);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AuthenticationExecutionResult.success(response);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å‡¦ç†ãƒ•ãƒ­ãƒ¼</strong>:</p>
<ol>
<li>ä¿å­˜ã•ã‚ŒãŸãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’å–å¾—</li>
<li>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSONåŒ–</li>
<li>Credential IDã§ä¿å­˜ã•ã‚ŒãŸCredentialã‚’å–å¾—</li>
<li>WebAuthn4jAuthenticationManagerã§æ¤œè¨¼</li>
<li>æˆåŠŸçµæœã‚’è¿”å´</li>
</ol>
<p><strong>é‡è¦</strong>: <code>verify()</code>ãŒä¾‹å¤–ã‚’æŠ•ã’ãªã„ = èªè¨¼æˆåŠŸ</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pluginç™»éŒ²ã¨factory">Pluginç™»éŒ²ã¨Factory<a href="#pluginç™»éŒ²ã¨factory" class="hash-link" aria-label="Pluginç™»éŒ²ã¨Factory ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Pluginç™»éŒ²ã¨Factory ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pluginç™»éŒ²">Pluginç™»éŒ²<a href="#pluginç™»éŒ²" class="hash-link" aria-label="Pluginç™»éŒ² ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Pluginç™»éŒ² ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <code>libs/idp-server-webauthn4j-adapter/src/main/resources/META-INF/services/org.idp.server.platform.dependency.ApplicationComponentProvider</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">org.idp.server.authenticators.webauthn4j.WebAuthn4jApplicationComponentProvider</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="executorfactoryå®Ÿè£…">ExecutorFactoryå®Ÿè£…<a href="#executorfactoryå®Ÿè£…" class="hash-link" aria-label="ExecutorFactoryå®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ExecutorFactoryå®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p>4ã¤ã®Executorã«å¯¾å¿œã™ã‚‹4ã¤ã®FactoryãŒå­˜åœ¨ï¼š</p>
<ol>
<li><code>WebAuthn4jRegistrationChallengeExecutorFactory</code></li>
<li><code>WebAuthn4jRegistrationExecutorFactory</code></li>
<li><code>WebAuthn4jAuthenticationChallengeExecutorFactory</code></li>
<li><code>WebAuthn4jAuthenticationExecutorFactory</code></li>
</ol>
<p><strong>Factoryãƒ‘ã‚¿ãƒ¼ãƒ³</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class WebAuthn4jRegistrationChallengeExecutorFactory {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public WebAuthn4jRegistrationChallengeExecutor create() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationInteractionCommandRepository commandRepo = ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AuthenticationInteractionQueryRepository queryRepo = ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WebAuthn4jCredentialRepository credentialRepo = ...;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new WebAuthn4jRegistrationChallengeExecutor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        commandRepo, queryRepo, credentialRepo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹<a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹" class="hash-link" aria-label="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webauthnmanagerã®ä½œæˆ">WebAuthnManagerã®ä½œæˆ<a href="#webauthnmanagerã®ä½œæˆ" class="hash-link" aria-label="WebAuthnManagerã®ä½œæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthnManagerã®ä½œæˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="https://webauthn4j.github.io/webauthn4j/ja/" target="_blank" rel="noopener noreferrer">WebAuthn4jå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="nonstrictãƒ¢ãƒ¼ãƒ‰æ¨å¥¨">NonStrictãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰<a href="#nonstrictãƒ¢ãƒ¼ãƒ‰æ¨å¥¨" class="hash-link" aria-label="NonStrictãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="NonStrictãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WebAuthnManager webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå¼•ç”¨</strong>:</p>
<blockquote>
<p>å¤§å¤šæ•°ã®ã‚µã‚¤ãƒˆã¯å³å¯†ãªæ§‹æˆè¨¼æ˜ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®æ¤œè¨¼ã‚’å¿…è¦ã¨ã›ãšã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ä»¥å¤–ã§ã¯å³å¯†ãªæ§‹æˆè¨¼æ˜ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®æ¤œè¨¼ã¯éæ¨å¥¨</p>
</blockquote>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>: âœ… æ­£ã—ãä½¿ç”¨</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jRegistrationManager.java:40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="strictãƒ¢ãƒ¼ãƒ‰ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿">Strictãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿ï¼‰<a href="#strictãƒ¢ãƒ¼ãƒ‰ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿" class="hash-link" aria-label="Strictãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Strictãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;AttestationStatementVerifier&gt; verifiers = Arrays.asList(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new PackedAttestationStatementVerifier(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new TPMAttestationStatementVerifier()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WebAuthnManager webAuthnManager = new WebAuthnManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verifiers,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new DefaultCertPathTrustworthinessVerifier(trustAnchorRepository)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹">ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹<a href="#ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹" class="hash-link" aria-label="ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å…¬å¼æ¨å¥¨</strong>: SecureRandomã§32ãƒã‚¤ãƒˆã®ãƒ©ãƒ³ãƒ€ãƒ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// å…¬å¼æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] challenge = new byte[32];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">new SecureRandom().nextBytes(challenge);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>: UUIDãƒ™ãƒ¼ã‚¹ï¼ˆ16ãƒã‚¤ãƒˆï¼‰</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jChallenge.java:42-48</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static WebAuthn4jChallenge generate() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UUID uuid = UUID.randomUUID();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long hi = uuid.getMostSignificantBits();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    long lo = uuid.getLeastSignificantBits();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] value = ByteBuffer.allocate(16).putLong(hi).putLong(lo).array();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new WebAuthn4jChallenge(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>è©•ä¾¡</strong>:</p>
<ul>
<li>âœ… ä¸€æ„æ€§: UUID v4ã¯æš—å·å­¦çš„ã«å®‰å…¨</li>
<li>âš ï¸ ã‚µã‚¤ã‚º: 16ãƒã‚¤ãƒˆï¼ˆå…¬å¼æ¨å¥¨32ãƒã‚¤ãƒˆã‚ˆã‚Šå°ã•ã„ï¼‰</li>
<li>âœ… ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰: Base64URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ¸ˆã¿</li>
<li>âœ… ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒå¯¾ç­–: å„æ“ä½œã§ä¸€æ„</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="credentialrecordã®æ°¸ç¶šåŒ–">CredentialRecordã®æ°¸ç¶šåŒ–<a href="#credentialrecordã®æ°¸ç¶šåŒ–" class="hash-link" aria-label="CredentialRecordã®æ°¸ç¶šåŒ– ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="CredentialRecordã®æ°¸ç¶šåŒ– ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å…¬å¼ã‚¬ã‚¤ãƒ‰å¼•ç”¨</strong>:</p>
<blockquote>
<p>ç™»éŒ²æ™‚ã«æ°¸ç¶šåŒ–ã™ã‚‹éš›ã¯ã€æ¤œç´¢ã™ã‚‹éš›ã®åˆ©ä¾¿æ€§ã‚’è€ƒãˆã€credentialIdã‚’ã‚­ãƒ¼ã«æ°¸ç¶šåŒ–ã™ã‚‹ã¨è‰¯ã„</p>
</blockquote>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>: âœ… æ­£ã—ãå®Ÿè£…</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jCredentialRepository.java:19-29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface WebAuthn4jCredentialRepository {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void register(WebAuthn4jCredential credential);      // credentialã§ä¿å­˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jCredentials findAll(String userId);        // userIdã§æ¤œç´¢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WebAuthn4jCredential get(String id);                 // credentialIdã§å–å¾—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void updateSignCount(String credentialId, long signCount);  // ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void delete(String credentialId);                    // credentialIdã§å‰Šé™¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ</strong>: <code>libs/idp-server-database/postgresql/V0_9_1__webauthn4j.sql</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> webauthn4j_credential </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">-- credentialIdï¼ˆBase64URLï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rp_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    attestation_object </span><span class="token keyword" style="color:#00009f">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- AttestedCredentialDataï¼ˆBase64URLï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sign_count </span><span class="token keyword" style="color:#00009f">BIGINT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">-- ã‚«ã‚¦ãƒ³ã‚¿ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    created_at </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> idx_webauthn4j_user_id </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> webauthn4j_credential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥">ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰<a href="#ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥" class="hash-link" aria-label="ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</strong>: èªè¨¼æˆåŠŸå¾Œã¯å¿…ãšã‚«ã‚¦ãƒ³ã‚¿ã‚’æ›´æ–°ã—ã¦ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ã‚’å®Ÿæ–½</p>
<p><strong>ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³</strong>:</p>
<ul>
<li>âŒ <strong>æœªå®Ÿè£…</strong>: <code>WebAuthn4jAuthenticationExecutor</code>ã§<code>updateSignCount()</code>ã‚’å‘¼ã³å‡ºã—ã¦ã„ãªã„</li>
</ul>
<p><strong>æ”¹å–„æ¡ˆ</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jAuthenticationExecutor.java:82-92ï¼ˆæ”¹å–„ç‰ˆï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">manager.verify(webAuthn4jCredential);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°è¿½åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AuthenticationData authenticationData = manager.parseAuthenticationData();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long newSignCount = authenticationData.getAuthenticatorData().getSignCount();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">credentialRepository.updateSignCount(id, newSignCount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (newSignCount &lt;= webAuthn4jCredential.signCount()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new WebAuthn4jBadRequestException(&quot;Possible credential clone detected&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›®">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›®<a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›®" class="hash-link" aria-label="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›® ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›® ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é‡è¦ãªæ¤œè¨¼é …ç›®</strong>:</p>
<table><thead><tr><th>æ¤œè¨¼é …ç›®</th><th>ç›®çš„</th><th>ç¾åœ¨ã®å®Ÿè£…</th></tr></thead><tbody><tr><td><strong>ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¸€è‡´</strong></td><td>ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒé˜²æ­¢</td><td>âœ… webauthn4jãŒè‡ªå‹•æ¤œè¨¼</td></tr><tr><td><strong>Originæ¤œè¨¼</strong></td><td>ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°å¯¾ç­–</td><td>âœ… <code>ServerProperty</code>ã§è¨­å®š</td></tr><tr><td><strong>RPIdç¢ºèª</strong></td><td>ã‚¹ ã‚³ãƒ¼ãƒ—ç®¡ç†</td><td>âœ… <code>configuration.rpId()</code>ã§è¨­å®š</td></tr><tr><td><strong>ã‚«ã‚¦ãƒ³ã‚¿ç›£è¦–</strong></td><td>ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥</td><td>âŒ æœªå®Ÿè£…ï¼ˆè¦æ”¹å–„ï¼‰</td></tr><tr><td><strong>UserVerification</strong></td><td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æœ¬äººç¢ºèª</td><td>âœ… <code>userVerificationRequired</code>ã§è¨­å®š</td></tr><tr><td><strong>UserPresence</strong></td><td>ç‰©ç†çš„å­˜åœ¨ç¢ºèª</td><td>âœ… <code>userPresenceRequired</code>ã§è¨­å®š</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é …">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é …<a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é …" class="hash-link" aria-label="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-attestationæ¤œè¨¼ã®æ··åœ¨ç¦æ­¢">1. Attestationæ¤œè¨¼ã®æ··åœ¨ç¦æ­¢<a href="#1-attestationæ¤œè¨¼ã®æ··åœ¨ç¦æ­¢" class="hash-link" aria-label="1. Attestationæ¤œè¨¼ã®æ··åœ¨ç¦æ­¢ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. Attestationæ¤œè¨¼ã®æ··åœ¨ç¦æ­¢ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå¼•ç”¨</strong>:</p>
<blockquote>
<p>Attestationæ¤œè¨¼ã‚’è¡Œã‚ãªã„NoneAttestationStatementVerifierãªã©ã‚’ã€ä»–ã®æ¤œè¨¼ã‚’è¡Œã†AttestationStatementVerifierã¨æ··ãœã¦ã—ã¾ã†ã¨ã€Attestationæ¤œè¨¼è¿‚å›ã«ä½¿ç”¨ã•ã‚Œã‚‹æŠœã‘ç©´ã¨ãªã‚‹</p>
</blockquote>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>: âœ… å®‰å…¨ï¼ˆNonStrictãƒ¢ãƒ¼ãƒ‰ä¸€è²«ä½¿ç”¨ï¼‰</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-webauthn4jã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã®å®Ÿè£…">2. WebAuthn4Jã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã®å®Ÿè£…<a href="#2-webauthn4jã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã®å®Ÿè£…" class="hash-link" aria-label="2. WebAuthn4Jã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã®å®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. WebAuthn4Jã®ã‚¹ã‚³ãƒ¼ãƒ—å¤–ã®å®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<p><strong>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</strong>:</p>
<blockquote>
<p>HTTPãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‡¦ç†ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€CredentialRecordæ°¸ç¶šåŒ–ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è²¬å‹™</p>
</blockquote>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>: âœ… é©åˆ‡ã«åˆ†é›¢</p>
<ul>
<li>HTTPãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: <code>AuthenticationExecutionRequest</code>ã§ã‚«ãƒ—ã‚»ãƒ«åŒ–</li>
<li>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†: <code>AuthenticationInteractionRepository</code>ã§ç®¡ç†</li>
<li>æ°¸ç¶šåŒ–: <code>WebAuthn4jCredentialRepository</code>ã§ã‚«ãƒ—ã‚»ãƒ«åŒ–</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜ã®é‡è¦æ€§">3. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜ã®é‡è¦æ€§<a href="#3-ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜ã®é‡è¦æ€§" class="hash-link" aria-label="3. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜ã®é‡è¦æ€§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜ã®é‡è¦æ€§ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// âœ… æ­£ã—ã„å®Ÿè£…ï¼ˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ä¸€æ™‚ä¿å­˜ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">transactionCommandRepository.register(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant, identifier, type().value(), fido2Challenge);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// âŒ é–“é•ã£ãŸå®Ÿè£…ï¼ˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ä¿å­˜ã—ãªã„ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ãƒªãƒ—ãƒ¬ã‚¤æ”»æ’ƒã®å±é™ºæ€§</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="webauthnä»•æ§˜æº–æ‹ ">WebAuthnä»•æ§˜æº–æ‹ <a href="#webauthnä»•æ§˜æº–æ‹ " class="hash-link" aria-label="WebAuthnä»•æ§˜æº–æ‹  ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthnä»•æ§˜æº–æ‹  ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="attestation-format">Attestation Format<a href="#attestation-format" class="hash-link" aria-label="Attestation Format ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="Attestation Format ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="https://www.w3.org/TR/webauthn-2/#sctn-attestation" target="_blank" rel="noopener noreferrer">Web Authentication Level 2 - Attestation</a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- packed           : FIDO2æ¨™æº–å½¢å¼ï¼ˆæ¨å¥¨ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- fido-u2f         : FIDO U2Fäº’æ›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- android-key      : Android KeyStore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- android-safetynet: Android SafetyNet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- apple            : Apple Anonymous Attestation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- none             : Attestationãªã—ï¼ˆç¾åœ¨ã®å®Ÿè£…ï¼‰</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>ç¾åœ¨ã®å®Ÿè£…</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jCredentialConverter.java:44</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return new CredentialRecordImpl(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new NoneAttestationStatement(),  // Attestationãªã—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="user-verification">User Verification<a href="#user-verification" class="hash-link" aria-label="User Verification ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="User Verification ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="https://www.w3.org/TR/webauthn-2/#user-verification" target="_blank" rel="noopener noreferrer">Web Authentication Level 2 - User Verification</a></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// User Verification Required</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserVerificationRequirement.REQUIRED  // PIN/ç”Ÿä½“èªè¨¼å¿…é ˆï¼ˆPasskeyæ¨å¥¨ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// User Verification Preferred</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserVerificationRequirement.PREFERRED // å¯èƒ½ãªã‚‰å®Ÿæ–½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// User Verification Discouraged</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserVerificationRequirement.DISCOURAGED // ä¸è¦ï¼ˆå¤šè¦ç´ èªè¨¼æ™‚ï¼‰</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>è¨­å®šæ–¹æ³•</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jConfiguration.java:56-57</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean userVerificationRequired;     // PIN/ç”Ÿä½“èªè¨¼å¿…é ˆã‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean userPresenceRequired;         // ã‚¿ãƒƒãƒ—/ã‚¿ãƒƒãƒå¿…é ˆã‹</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é …">å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é …<a href="#å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é …" class="hash-link" aria-label="å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é … ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…å¿…é ˆ">1. ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…ï¼ˆå¿…é ˆï¼‰<a href="#1-ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…å¿…é ˆ" class="hash-link" aria-label="1. ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…ï¼ˆå¿…é ˆï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="1. ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…ï¼ˆå¿…é ˆï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å„ªå…ˆåº¦</strong>: ğŸ”´ é«˜ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼‰</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jAuthenticationExecutor.execute() ã«è¿½åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">manager.verify(webAuthn4jCredential);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°å‡¦ç†ã‚’è¿½åŠ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">long newSignCount = extractSignCount(manager);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (newSignCount &lt;= webAuthn4jCredential.signCount()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw new WebAuthn4jBadRequestException(&quot;Credential clone detected&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">credentialRepository.updateSignCount(id, newSignCount);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§æ¨å¥¨">2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§ï¼ˆæ¨å¥¨ï¼‰<a href="#2-ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§æ¨å¥¨" class="hash-link" aria-label="2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§ï¼ˆæ¨å¥¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§ï¼ˆæ¨å¥¨ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å„ªå…ˆåº¦</strong>: ğŸŸ¡ ä¸­ï¼ˆå…¬å¼æ¨å¥¨ã«åˆã‚ã›ã‚‹ï¼‰</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// WebAuthn4jChallenge.generate() ã®æ”¹å–„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static WebAuthn4jChallenge generate() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    byte[] value = new byte[32];  // 16 â†’ 32ãƒã‚¤ãƒˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new SecureRandom().nextBytes(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new WebAuthn4jChallenge(value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-attestationæ¤œè¨¼ã®å¼·åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³">3. Attestationæ¤œè¨¼ã®å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰<a href="#3-attestationæ¤œè¨¼ã®å¼·åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³" class="hash-link" aria-label="3. Attestationæ¤œè¨¼ã®å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="3. Attestationæ¤œè¨¼ã®å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>å„ªå…ˆåº¦</strong>: ğŸŸ¢ ä½ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã®ã¿ï¼‰</p>
<p>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç”¨é€”ã§ãƒ‡ãƒã‚¤ã‚¹æ¤œè¨¼ãŒå¿…è¦ãªå ´åˆï¼š</p>
<ul>
<li><code>WebAuthnManager.createNonStrictWebAuthnManager()</code> â†’ Strictãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´</li>
<li>TrustAnchorRepositoryå®Ÿè£…</li>
<li>AttestationStatementVerifieré¸å®š</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£…">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£…<a href="#ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£…" class="hash-link" aria-label="ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£… ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webauthn4jcredentialdatasource">WebAuthn4jCredentialDataSource<a href="#webauthn4jcredentialdatasource" class="hash-link" aria-label="WebAuthn4jCredentialDataSource ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthn4jCredentialDataSource ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<p><strong>æƒ…å ±æº</strong>: <a href="/idp-server/assets/files/WebAuthn4jCredentialDataSource-ad86af65eb0fa4d5fa6326163f57a483.java" target="_blank">WebAuthn4jCredentialDataSource.java</a></p>
<p><strong>DataSource-SqlExecutor ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WebAuthn4jCredentialDataSource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â”œâ”€ PostgresqlExecutor (PostgreSQLç”¨SQL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  â””â”€ MysqlExecutor (MySQLç”¨SQL)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>SQLå®Ÿè£…</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- PostgreSQL: JSONBå‹ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> webauthn4j_credential </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rp_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> credential_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?::jsonb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL: JSONå‹ä½¿ç”¨</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> webauthn4j_credential </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rp_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> credential_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ?</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>JsonConverterä½¿ç”¨</strong>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">JsonConverter jsonConverter = JsonConverter.snakeCaseInstance();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String json = jsonConverter.write(credential.toMap());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³">ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³<a href="#ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³" class="hash-link" aria-label="ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ å›³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ç™»éŒ²ãƒ•ãƒ­ãƒ¼registration">ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆRegistrationï¼‰<a href="#ç™»éŒ²ãƒ•ãƒ­ãƒ¼registration" class="hash-link" aria-label="ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆRegistrationï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆRegistrationï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client                Executor              Manager              Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |--- GET /challenge --&gt;|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- generate() ------&gt;|                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- challenge --------|                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- save challenge -----------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&lt;-- challenge --------|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |--- POST /register --&gt;|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |  (credential data)   |-- load challenge -----------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- challenge ---------------------------- |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- verify(data, challenge) -------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- verified data ------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- create credential --------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- credential ----------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- register(credential) -----------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&lt;-- success ----------|                     |                     |</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="èªè¨¼ãƒ•ãƒ­ãƒ¼authentication">èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆAuthenticationï¼‰<a href="#èªè¨¼ãƒ•ãƒ­ãƒ¼authentication" class="hash-link" aria-label="èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆAuthenticationï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆAuthenticationï¼‰ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Client                Executor              Manager              Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |--- GET /challenge --&gt;|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- generate() ------&gt;|                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- challenge --------|                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- save challenge -----------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&lt;-- challenge --------|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |--- POST /auth ------&gt;|                     |                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |  (assertion)         |-- load challenge -----------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- challenge ---------------------------- |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- get(credentialId) --------------------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- credential ----------------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- verify(assertion, credential) --------&gt;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |&lt;- verification result -------------------|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |                      |-- updateSignCount(id, count) -----------&gt;| âš ï¸ è¦å®Ÿè£…</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |&lt;-- success ----------|                     |                     |</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ã¾ã¨ã‚">ã¾ã¨ã‚<a href="#ã¾ã¨ã‚" class="hash-link" aria-label="ã¾ã¨ã‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã¾ã¨ã‚ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ<a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ" class="hash-link" aria-label="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ol>
<li><strong>WebAuthnManager</strong>: <code>createNonStrictWebAuthnManager()</code>ã‚’ä½¿ç”¨ï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºä»¥å¤–ï¼‰</li>
<li><strong>ãƒãƒ£ãƒ¬ãƒ³ã‚¸</strong>: UUIDãƒ™ãƒ¼ã‚¹ï¼ˆ16ãƒã‚¤ãƒˆï¼‰ã§ç¾åœ¨å®Ÿè£…ã€å…¬å¼æ¨å¥¨ã¯32ãƒã‚¤ãƒˆ</li>
<li><strong>æ¤œè¨¼</strong>: <code>webAuthnManager.verify()</code>ã§è‡ªå‹•çš„ã«RFCæº–æ‹ æ¤œè¨¼</li>
<li><strong>Credentialä¿å­˜</strong>: <code>credentialId</code>ã‚’ã‚­ãƒ¼ã¨ã—ã¦æ°¸ç¶šåŒ–</li>
<li><strong>ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°</strong>: èªè¨¼æˆåŠŸå¾Œã«å¿…ãšæ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰ - âš ï¸ <strong>ç¾åœ¨æœªå®Ÿè£…</strong></li>
<li><strong>ä¾‹å¤–å‡¦ç†</strong>: webauthn4jã®ä¾‹å¤–ã‚’<code>WebAuthn4jBadRequestException</code>ã§ãƒ©ãƒƒãƒ—</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³<a href="#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³" class="hash-link" aria-label="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<ul>
<li><strong>4æ®µéšExecutor</strong>: Registration/Authentication Ã— Challenge/Execution</li>
<li><strong>Managerå±¤</strong>: webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ©ãƒƒãƒ—</li>
<li><strong>Repositoryå±¤</strong>: Credentialæ°¸ç¶šåŒ–ï¼ˆPostgreSQL/MySQLå¯¾å¿œï¼‰</li>
<li><strong>DataSource-SqlExecutor</strong>: DBåˆ¥SQLå®Ÿè£…</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ã‚»ã‚­  ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡<a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡" class="hash-link" aria-label="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h3>
<table><thead><tr><th>é …ç›®</th><th>çŠ¶æ…‹</th><th>è©•ä¾¡</th></tr></thead><tbody><tr><td>WebAuthnManager</td><td>NonStrictãƒ¢ãƒ¼ãƒ‰</td><td>âœ… å…¬å¼æ¨å¥¨é€šã‚Š</td></tr><tr><td>ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</td><td>UUID v4ï¼ˆ16ãƒã‚¤ãƒˆï¼‰</td><td>âš ï¸ å…¬å¼æ¨å¥¨ã¯32ãƒã‚¤ãƒˆ</td></tr><tr><td>ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¿å­˜</td><td>AuthenticationInteractionRepository</td><td>âœ… æ­£ã—ãå®Ÿè£…</td></tr><tr><td>Originæ¤œè¨¼</td><td>ServerPropertyã§è¨­å®š</td><td>âœ… æ­£ã—ãå®Ÿè£…</td></tr><tr><td>ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°</td><td>æœªå®Ÿè£…</td><td>âŒ è¦æ”¹å–„ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼‰</td></tr><tr><td>Credentialæ°¸ç¶šåŒ–</td><td>credentialIdã‚’ã‚­ãƒ¼</td><td>âœ… å…¬å¼æ¨å¥¨é€šã‚Š</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ<a href="#é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="hash-link" aria-label="é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<ul>
<li><a href="/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation">èªè¨¼ãƒ»é€£æºå±¤çµ±åˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a> - WebAuthnã‚’å«ã‚€å…¨èªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</li>
<li><a href="/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation">idp-server-authentication-interactors</a> - èªè¨¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚¿ãƒ¼</li>
<li><a href="/idp-server/docs/content_10_ai_developer/ai-11-core">idp-server-core</a> - OAuth/OIDCã‚³ã‚¢ã‚¨ãƒ³ã‚¸ãƒ³</li>
<li><a href="/idp-server/docs/content_10_ai_developer/ai-12-platform">idp-server-platform</a> - JsonConverter, PluginLoader</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="å‚è€ƒè³‡æ–™">å‚è€ƒè³‡æ–™<a href="#å‚è€ƒè³‡æ–™" class="hash-link" aria-label="å‚è€ƒè³‡æ–™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯" title="å‚è€ƒè³‡æ–™ ã¸ã®ç›´æ¥ãƒªãƒ³ã‚¯">â€‹</a></h2>
<p><strong>å…¬å¼ä»•æ§˜</strong>:</p>
<ul>
<li><a href="https://www.w3.org/TR/webauthn-2/" target="_blank" rel="noopener noreferrer">Web Authentication Level 2</a></li>
<li><a href="https://webauthn4j.github.io/webauthn4j/ja/" target="_blank" rel="noopener noreferrer">WebAuthn4jå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆæ—¥æœ¬èªï¼‰</a></li>
<li><a href="https://fidoalliance.org/specifications/" target="_blank" rel="noopener noreferrer">FIDO Alliance Specifications</a></li>
</ul>
<p><strong>æƒ…å ±æº</strong>:</p>
<ul>
<li><code>libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/</code></li>
<li><code>libs/idp-server-webauthn4j-adapter/build.gradle</code> - <code>com.webauthn4j:webauthn4j-core:0.28.5.RELEASE</code></li>
<li><code>libs/idp-server-database/postgresql/V0_9_1__webauthn4j.sql</code></li>
</ul>
<p><strong>ç¢ºèªæ–¹æ³•</strong>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># WebAuthn4jé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find libs/idp-server-webauthn4j-adapter -name &quot;*.java&quot; -type f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep &quot;webauthn4j&quot; libs/idp-server-webauthn4j-adapter/build.gradle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒç¢ºèª</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep &quot;webauthn4j_credential&quot; libs/idp-server-database/postgresql/*.sql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼" title="ã‚³ãƒ”ãƒ¼" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>æœ€çµ‚æ›´æ–°</strong>: 2025-11-08</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_10_ai_developer/ai-42-webauthn.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ã“ã®ãƒšãƒ¼ã‚¸ã‚’ç·¨é›†</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_10_ai_developer/ai-41-authentication"><div class="pagination-nav__sublabel">å‰ã¸</div><div class="pagination-nav__label">idp-server-authentication-interactors -  èªè¨¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚¿ãƒ¼</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_10_ai_developer/ai-43-federation-oidc"><div class="pagination-nav__sublabel">æ¬¡ã¸</div><div class="pagination-nav__label">idp-server-federation-oidc</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦" class="table-of-contents__link toc-highlight">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¦‚è¦</a><ul><li><a href="#è²¬å‹™" class="table-of-contents__link toc-highlight">è²¬å‹™</a></li><li><a href="#ä¸»è¦æ©Ÿèƒ½" class="table-of-contents__link toc-highlight">ä¸»è¦æ©Ÿèƒ½</a></li></ul></li><li><a href="#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦" class="table-of-contents__link toc-highlight">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦</a><ul><li><a href="#4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼" class="table-of-contents__link toc-highlight">4æ®µéšã®èªè¨¼ãƒ•ãƒ­ãƒ¼</a></li></ul></li><li><a href="#ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ" class="table-of-contents__link toc-highlight">ã‚³ã‚¢ã‚¯ãƒ©ã‚¹æ§‹æˆ</a><ul><li><a href="#1-webauthn4jconfiguration---è¨­å®šç®¡ç†" class="table-of-contents__link toc-highlight">1. WebAuthn4jConfiguration - è¨­å®šç®¡ç†</a></li><li><a href="#2-webauthn4jchallenge---ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="table-of-contents__link toc-highlight">2. WebAuthn4jChallenge - ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</a></li><li><a href="#3-webauthn4jcredential---credentialç®¡ç†" class="table-of-contents__link toc-highlight">3. WebAuthn4jCredential - Credentialç®¡ç†</a></li></ul></li><li><a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³" class="table-of-contents__link toc-highlight">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³</a><ul><li><a href="#1-ç™»éŒ²ãƒ•ãƒ­ãƒ¼---webauthn4jregistrationmanager" class="table-of-contents__link toc-highlight">1. ç™»éŒ²ãƒ•ãƒ­ãƒ¼ - WebAuthn4jRegistrationManager</a></li><li><a href="#2-èªè¨¼ãƒ•ãƒ­ãƒ¼---webauthn4jauthenticationmanager" class="table-of-contents__link toc-highlight">2. èªè¨¼ãƒ•ãƒ­ãƒ¼ - WebAuthn4jAuthenticationManager</a></li><li><a href="#3-webauthn4jcredentialconverter---credentialå¤‰æ›" class="table-of-contents__link toc-highlight">3. WebAuthn4jCredentialConverter - Credentialå¤‰æ›</a></li></ul></li><li><a href="#authenticationexecutorå®Ÿè£…4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚º" class="table-of-contents__link toc-highlight">AuthenticationExecutorå®Ÿè£…ï¼ˆ4ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰</a><ul><li><a href="#1-webauthn4jregistrationchallengeexecutor---ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="table-of-contents__link toc-highlight">1. WebAuthn4jRegistrationChallengeExecutor - ç™»éŒ²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</a></li><li><a href="#2-webauthn4jregistrationexecutor---ç™»éŒ²æ¤œè¨¼" class="table-of-contents__link toc-highlight">2. WebAuthn4jRegistrationExecutor - ç™»éŒ²æ¤œè¨¼</a></li><li><a href="#3-webauthn4jauthenticationchallengeexecutor---èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ" class="table-of-contents__link toc-highlight">3. WebAuthn4jAuthenticationChallengeExecutor - èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆ</a></li><li><a href="#4-webauthn4jauthenticationexecutor---èªè¨¼æ¤œè¨¼" class="table-of-contents__link toc-highlight">4. WebAuthn4jAuthenticationExecutor - èªè¨¼æ¤œè¨¼</a></li></ul></li><li><a href="#pluginç™»éŒ²ã¨factory" class="table-of-contents__link toc-highlight">Pluginç™»éŒ²ã¨Factory</a><ul><li><a href="#pluginç™»éŒ²" class="table-of-contents__link toc-highlight">Pluginç™»éŒ²</a></li><li><a href="#executorfactoryå®Ÿè£…" class="table-of-contents__link toc-highlight">ExecutorFactoryå®Ÿè£…</a></li></ul></li><li><a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹" class="table-of-contents__link toc-highlight">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ­£ã—ã„ä½¿ã„æ–¹</a><ul><li><a href="#webauthnmanagerã®ä½œæˆ" class="table-of-contents__link toc-highlight">WebAuthnManagerã®ä½œæˆ</a></li><li><a href="#ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹" class="table-of-contents__link toc-highlight">ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç”Ÿæˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</a></li><li><a href="#credentialrecordã®æ°¸ç¶šåŒ–" class="table-of-contents__link toc-highlight">CredentialRecordã®æ°¸ç¶šåŒ–</a></li><li><a href="#ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥" class="table-of-contents__link toc-highlight">ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ³æ¤œçŸ¥ï¼‰</a></li><li><a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›®" class="table-of-contents__link toc-highlight">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼é …ç›®</a></li><li><a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é …" class="table-of-contents__link toc-highlight">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„äº‹é …</a></li></ul></li><li><a href="#webauthnä»•æ§˜æº–æ‹ " class="table-of-contents__link toc-highlight">WebAuthnä»•æ§˜æº–æ‹ </a><ul><li><a href="#attestation-format" class="table-of-contents__link toc-highlight">Attestation Format</a></li><li><a href="#user-verification" class="table-of-contents__link toc-highlight">User Verification</a></li></ul></li><li><a href="#å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é …" class="table-of-contents__link toc-highlight">å®Ÿè£…æ”¹å–„æ¨å¥¨äº‹é …</a><ul><li><a href="#1-ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…å¿…é ˆ" class="table-of-contents__link toc-highlight">1. ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã®å®Ÿè£…ï¼ˆå¿…é ˆï¼‰</a></li><li><a href="#2-ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§æ¨å¥¨" class="table-of-contents__link toc-highlight">2. ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚µã‚¤ã‚ºã®æ‹¡å¤§ï¼ˆæ¨å¥¨ï¼‰</a></li><li><a href="#3-attestationæ¤œè¨¼ã®å¼·åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³" class="table-of-contents__link toc-highlight">3. Attestationæ¤œè¨¼ã®å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</a></li></ul></li><li><a href="#ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£…" class="table-of-contents__link toc-highlight">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å±¤å®Ÿè£…</a><ul><li><a href="#webauthn4jcredentialdatasource" class="table-of-contents__link toc-highlight">WebAuthn4jCredentialDataSource</a></li></ul></li><li><a href="#ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³" class="table-of-contents__link toc-highlight">ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³</a><ul><li><a href="#ç™»éŒ²ãƒ•ãƒ­ãƒ¼registration" class="table-of-contents__link toc-highlight">ç™»éŒ²ãƒ•ãƒ­ãƒ¼ï¼ˆRegistrationï¼‰</a></li><li><a href="#èªè¨¼ãƒ•ãƒ­ãƒ¼authentication" class="table-of-contents__link toc-highlight">èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆAuthenticationï¼‰</a></li></ul></li><li><a href="#ã¾ã¨ã‚" class="table-of-contents__link toc-highlight">ã¾ã¨ã‚</a><ul><li><a href="#webauthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ" class="table-of-contents__link toc-highlight">WebAuthn4jãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã®ãƒã‚¤ãƒ³ãƒˆ</a></li><li><a href="#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³" class="table-of-contents__link toc-highlight">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³</a></li><li><a href="#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡" class="table-of-contents__link toc-highlight">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡</a></li></ul></li><li><a href="#é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ" class="table-of-contents__link toc-highlight">é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li><li><a href="#å‚è€ƒè³‡æ–™" class="table-of-contents__link toc-highlight">å‚è€ƒè³‡æ–™</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>