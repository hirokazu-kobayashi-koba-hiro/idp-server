<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_11_learning/os-fundamentals/synchronization" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">同期プリミティブ | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/os-fundamentals/synchronization"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="同期プリミティブ | IdP-Server Documentation"><meta data-rh="true" name="description" content="所要時間: 35分"><meta data-rh="true" property="og:description" content="所要時間: 35分"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/os-fundamentals/synchronization"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/os-fundamentals/synchronization" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/os-fundamentals/synchronization" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.873d0c83.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.0791e485.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">はじめに</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ドキュメントガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">製品紹介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">クイックスタート</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/foundation/concept-01-multi-tenant">コア概念</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">認証・認可プロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_05_how-to/">How-to（設定・運用レシピ）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_06_developer-guide/">開発者ガイド</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference">リファレンス</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">学習（Learning）</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">アイデンティティ管理の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-fundamentals/modern-web-authz-authn">OAuth 2.0の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-tokens/id-token-jwt">OAuth 2.0トークン</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/openid-connect/oauth-oidc-basics">OpenID Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/fido-webauthn/fido2-architecture-rp-browser-authenticator">FIDO2/WebAuthn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/security/glossary">セキュリティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/multi-tenancy/multi-tenancy-basics">マルチテナント</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/advanced-protocols/ciba-basics">高度なプロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/http-rest/http-basics">HTTP/REST</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jwt-jose/jwt-introduction">JWT/JOSE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth/OIDC RFC学習</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/verifiable-credentials/">Verifiable Credentials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/data-formats/">データフォーマット</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/session-management/web-session-basics">セッション管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/postgresql/">PostgreSQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/crypto/">暗号化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/kubernetes/">コンテナ/Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/linux/">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/networking/">ネットワーク</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jvm/">JVM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/">OS基礎</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/">OS基礎 学習ガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/os-overview">基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/file-descriptors">I/O</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/signals">プロセス間通信</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/signals">シグナル</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/synchronization">同期プリミティブ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/os-fundamentals/column-why-4kb-page">コラム</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/ops-01-test-strategy">運用（Ops）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/project-01-faq">プロジェクト</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">AI</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">学習（Learning）</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OS基礎</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">プロセス間通信</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">同期プリミティブ</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>同期プリミティブ</h1></header>
<p><strong>所要時間</strong>: 35分</p>
<p><strong>前提知識</strong>: マルチスレッドプログラミングの基礎</p>
<p><strong>学べること</strong>:</p>
<ul>
<li>競合状態（Race Condition）</li>
<li>mutex、セマフォ、条件変数</li>
<li>デッドロックの原因と回避</li>
<li>Java の synchronized との関係</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="この章で答える疑問">この章で答える疑問<a href="#この章で答える疑問" class="hash-link" aria-label="この章 で答える疑問 への直接リンク" title="この章で答える疑問 への直接リンク">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">「Race Condition って何？」</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">「mutex って何？」</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">「デッドロックはなぜ起きる？」</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">「Java の synchronized は何をしている？」</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-競合状態race-condition">1. 競合状態（Race Condition）<a href="#1-競合状態race-condition" class="hash-link" aria-label="1. 競合状態（Race Condition） への直接リンク" title="1. 競合状態（Race Condition） への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-問題の例">1.1 問題の例<a href="#11-問題の例" class="hash-link" aria-label="1.1 問題の例 への直接リンク" title="1.1 問題の例 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    競合状態の例: カウンターのインクリメント          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  共有変数: counter = 0                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  スレッドA         スレッドB         counter の値                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ─────────        ─────────        ────────────                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  read counter                       0                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  (値は 0)                                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   read counter      0                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   (値は 0)                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  increment                          0 (メモリはまだ 0)              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  (ローカルで 1)                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   increment         0 (メモリはまだ 0)              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   (ローカルで 1)                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  write counter                      1                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                   write counter     1                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  期待値: 2                                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  実際の値: 1  ← 間違い！                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  原因: counter++ は実際には3つの操作                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. メモリから値を読む                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. 値をインクリメント                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. メモリに書き戻す                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → この間に他のスレッドが割り込む可能性                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-java-での再現">1.2 Java での再現<a href="#12-java-での再現" class="hash-link" aria-label="1.2 Java での再現 への直接リンク" title="1.2 Java での再現 への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 競合状態の例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class RaceConditionDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static int counter = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread t1 = new Thread(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            for (int i = 0; i &lt; 100000; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                counter++;  // アトミックではない！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread t2 = new Thread(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            for (int i = 0; i &lt; 100000; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                counter++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t1.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t2.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t1.join();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t2.join();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;Counter: &quot; + counter);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 期待値: 200000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 実際: 100000〜200000 の間のランダムな値</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-クリティカルセクション">1.3 クリティカルセクション<a href="#13-クリティカルセクション" class="hash-link" aria-label="1.3 クリティカルセクション への直接リンク" title="1.3 クリティカルセクション への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    クリティカルセクション                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────  ─────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クリティカルセクション = 共有リソースにアクセスするコード部分       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA                     スレッドB                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  // 非クリティカル              // 非クリティカル            │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  prepare_data();               prepare_data();               │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌─────────────────┐          ┌─────────────────┐           │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ // クリティカル │          │ // クリティカル │           │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ counter++;      │ ←────── │ counter++;      │ 同時実行NG│    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └─────────────────┘          └─────────────────┘           │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  // 非クリティカル              // 非クリティカル            │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  process_result();             process_result();             │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  解決策: クリティカルセクションを相互排他（mutual exclusion）にする │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-mutex相互排他ロック">2. Mutex（相互排他ロック）<a href="#2-mutex相互排他ロック" class="hash-link" aria-label="2. Mutex（相互排他ロック） への直接リンク" title="2. Mutex（相互排他ロック） への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-mutex-の概念">2.1 Mutex の概念<a href="#21-mutex-の概念" class="hash-link" aria-label="2.1 Mutex の概念 への直接リンク" title="2.1 Mutex の概念 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    Mutex (Mutual Exclusion)                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Mutex = 一度に1つのスレッドだけがアクセスできるロック              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  操作:                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── lock(): ロックを取得（他が持っていたら待つ）                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └── unlock(): ロックを解放                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA                     スレッドB                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  mutex.lock()   ←── 取得成功                                 │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │                              mutex.lock()                 │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ counter++                    │                            │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │                              │ (ブロック、待機)           │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  mutex.unlock() ─────────────→ │ ←── 取得成功               │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 │ counter++                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 mutex.unlock()               │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  結果: counter が正しく 2 になる                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-java-での実装">2.2 Java での実装<a href="#22-java-での実装" class="hash-link" aria-label="2.2 Java で の実装 への直接リンク" title="2.2 Java での実装 への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// synchronized キーワード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Counter {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int count = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // メソッド全体を同期</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public synchronized void increment() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        count++;  // これで安全</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // または特定のブロックだけ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void incrementWithBlock() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 他の処理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        synchronized (this) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            count++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 他の処理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ReentrantLock を使う方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.locks.ReentrantLock;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class Counter {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int count = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final ReentrantLock lock = new ReentrantLock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void increment() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lock.lock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            count++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            lock.unlock();  // 必ず unlock する</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-java-の-synchronized-の仕組み">2.3 Java の synchronized の仕組み<a href="#23-java-の-synchronized-の仕組み" class="hash-link" aria-label="2.3 Java の synchronized の仕組み への直接リンク" title="2.3 Java の synchronized の仕組み への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌  ─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    synchronized の内部                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Java のすべてのオブジェクトは「モニター」を持つ                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  synchronized (obj) {                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      // このブロック内では obj のモニターを保持                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  }                                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────────────  ─────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  オブジェクトのヘッダー                                      │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌─────────────────────────────────────────────────────┐    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  Mark Word                                           │    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  ├── ロック状態（無効、バイアス、軽量、重量）        │    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  ├── 所有スレッドID                                  │    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  └── ハッシュコード                                  │    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └─────────────────────────────────────────────────────┘    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ロックの最適化（JVM）:                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── バイアスロック: 単一スレッドなら軽量                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── 軽量ロック: 競合が少ない場合は CAS で                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └── 重量ロック: 競合が多い場合は OS の mutex                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-セマフォ">3. セマフォ<a href="#3-セマフォ" class="hash-link" aria-label="3. セマフォ への直接リンク" title="3. セマフォ への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-セマフォの概念">3.1 セマフォの概念<a href="#31-セマフォの概念" class="hash-link" aria-label="3.1 セマフォの概念 への直接リンク" title="3.1 セマフォの概念 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    セマフォ (Semaphore)                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  セマフォ = カウンター付きの同期プリミティブ                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └── N 個までのスレッドが同時にアクセス可能                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  操作:                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── acquire() (P操作): カウンター減、0なら待つ                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └── release() (V操作): カウンター増                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  セマフォ (permits = 3)                                      │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA: acquire() → permits = 2 → 入場                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドB: acquire() → permits = 1 → 入場                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドC: acquire() → permits = 0 → 入場                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドD: acquire() → permits = 0 → 待機（ブロック）      │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA: release() → permits = 1                         │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドD: → permits = 0 → 入場可能に                      │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Mutex = セマフォ (permits = 1) の特殊ケース                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-使用例-コネクションプール">3.2 使用例: コネクションプール<a href="#32-使用例-コネクションプール" class="hash-link" aria-label="3.2 使用例: コネクションプール への直接リンク" title="3.2 使用例: コネクションプール への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.Semaphore;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ConnectionPool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Semaphore semaphore;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final List&lt;Connection&gt; connections;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ConnectionPool(int maxConnections) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.semaphore = new Semaphore(maxConnections);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.connections = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; maxConnections; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            connections.add(createConnection());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Connection acquire() throws InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        semaphore.acquire();  // 許可を取得（なければ待つ）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return getAvailableConnection();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void release(Connection conn) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        returnConnection(conn);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        semaphore.release();  // 許可を返却</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-条件変数">4. 条件変数<a href="#4-条件変数" class="hash-link" aria-label="4. 条件変数 への直接リンク" title="4. 条件変数 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-条件変数の概念">4.1 条件変数の概念<a href="#41-条件変数の概念" class="hash-link" aria-label="4.1 条件変数の概念 への直接リンク" title="4.1 条件変数の概念 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    条件変数 (Condition Variable)                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  条件変数 = ある条件が満たされるまで待機する仕組み                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  操作:                                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── wait(): 条件が満たされるまで待機（ロックを一時解放）          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├── signal(): 待機中のスレッドを1つ起こす                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └── broadcast(): 待機中のスレッドを全部起こす                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  例: 生産者-消費者問題                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  生産者                     キュー                 消費者    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ───────                   ──────                 ───────    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  データ作成                 [   ]                 wait()     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │       │                    [   ]                    ↑        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │       ▼                    [   ]                    │        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  enqueue()    ───────────→ [データ]                │        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │       │                       │                     │        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │       ▼                       │                     │        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  signal()     ────────────────┼─────────────────────┘        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                               │                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                               ▼                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                            dequeue()  ←─────── データ取得    │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップ ボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-java-での実装">4.2 Java での実装<a href="#42-java-での実装" class="hash-link" aria-label="4.2 Java での実装 への直接リンク" title="4.2 Java での実装 への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.locks.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class BoundedBuffer&lt;T&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Object[] items;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int count, putIndex, getIndex;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Lock lock = new ReentrantLock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Condition notFull = lock.newCondition();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final Condition notEmpty = lock.newCondition();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public BoundedBuffer(int capacity) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        items = new Object[capacity];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void put(T item) throws InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lock.lock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // バッファが満杯なら待つ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (count == items.length) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                notFull.await();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            items[putIndex] = item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            putIndex = (putIndex + 1) % items.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            count++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 消費者に通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            notEmpty.signal();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            lock.unlock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @SuppressWarnings(&quot;unchecked&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public T take() throws InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lock.lock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // バッファが空なら待つ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (count == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                notEmpty.await();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            T item = (T) items[getIndex];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            getIndex = (getIndex + 1) % items.length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            count--;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 生産者に通知</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            notFull.signal();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return item;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            lock.unlock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコ  ードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-デッドロック">5. デッドロック<a href="#5-デッドロック" class="hash-link" aria-label="5. デッドロック への直接リンク" title="5. デッドロック への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-デッドロックとは">5.1 デッドロックとは<a href="#51-デッドロックとは" class="hash-link" aria-label="5.1 デッドロックとは への直接リンク" title="5.1 デッドロックとは への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    デッドロック (Deadlock)                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├───────────────────────────  ──────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  複数のスレッドが互いのリソースを待ち合って永遠に止まる状態         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA                           スレッドB               │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  lock(リソース1)                                             │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓                                   lock(リソース2)         │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  リソース1 を保持                    ↓                       │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓                                   リソース2 を保持        │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  lock(リソース2)                     lock(リソース1)         │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓                                   ↓                       │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  待機...                             待機...                 │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  (Bがリソース2を                     (Aがリソース1を         │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │   解放するまで)                       解放するまで)          │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │         永遠に待ち続ける（デッドロック！）                   │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─────────────────────────────────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-デッドロックの4条件">5.2 デッドロックの4条件<a href="#52-デッドロックの4条件" class="hash-link" aria-label="5.2 デッドロックの4条件 への直接リンク" title="5.2 デッドロックの4条件 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    デッドロック発生の4条件（Coffman条件）            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  以下の4つが全て満たされるとデッドロックが発生する:                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. 相互排他 (Mutual Exclusion)                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── リソースは一度に1つのスレッドだけが使用可能                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. 保持と待機 (Hold and Wait)                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── リソースを保持したまま別のリソースを待つ                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. 横取り不可 (No Preemption)                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── 他スレッドからリソースを奪えない                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. 循環待ち (Circular Wait)                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── A→B→C→A のように循環した待ち関係がある                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → どれか1つでも崩せばデッドロックを防げる                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-デッドロックの回避">5.3 デッドロックの回避<a href="#53-デッドロックの回避" class="hash-link" aria-label="5.3 デッドロックの回避 への直接リンク" title="5.3 デッドロックの回避 への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// ❌ デッドロックが起きるコード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void transfer(Account from, Account to, int amount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    synchronized (from) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        synchronized (to) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            from.withdraw(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            to.deposit(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// スレッドA: transfer(account1, account2, 100)  → account1, account2 の順</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// スレッドB: transfer(account2, account1, 50)   → account2, account1 の順</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// → デッドロック！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ✅ 順序を固定して回避</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void transfer(Account from, Account to, int amount) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 常に ID が小さい方を先にロック</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Account first = from.id &lt; to.id ? from : to;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Account second = from.id &lt; to.id ? to : from;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    synchronized (first) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        synchronized (second) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            from.withdraw(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            to.deposit(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ✅ tryLock でタイムアウト</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void transfer(Account from, Account to, int amount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        throws InterruptedException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (from.lock.tryLock(1, TimeUnit.SECONDS)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (to.lock.tryLock(1, TimeUnit.SECONDS)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        from.withdraw(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        to.deposit(amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        to.lock.unlock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                from.lock.unlock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 取得できなかったらランダムに待ってリトライ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(ThreadLocalRandom.current().nextInt(100));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="54-デッドロックの検出">5.4 デッドロックの検出<a href="#54-デッドロックの検出" class="hash-link" aria-label="5.4 デッドロックの検出 への直接リンク" title="5.4 デッドロックの検出 への直接リンク">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Java スレッドダンプでデッドロック検出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ jstack &lt;pid&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found one Java-level deadlock:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=============================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Thread-1&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  waiting to lock monitor 0x00007f8b5c003e58 (object 0x00000000d7133848, a Account),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  which is held by &quot;Thread-0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Thread-0&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  waiting to lock monitor 0x00007f8b5c003e78 (object 0x00000000d7133868, a Account),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  which is held by &quot;Thread-1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Java stack information for the threads listed above:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Thread-1&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    at transfer(Account.java:25)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - waiting to lock &lt;0x00000000d7133848&gt; (a Account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - locked &lt;0x00000000d7133868&gt; (a Account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Thread-0&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    at transfer(Account.java:25)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - waiting to lock &lt;0x00000000d7133868&gt; (a Account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - locked &lt;0x00000000d7133848&gt; (a Account)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Found 1 deadlock.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-アトミック操作">6. アトミック操作<a href="#6-アトミック操作" class="hash-link" aria-label="6. アトミック操作 への直接リンク" title="6. アトミック操作 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-cascompare-and-swap">6.1 CAS（Compare-And-Swap）<a href="#61-cascompare-and-swap" class="hash-link" aria-label="6.1 CAS（Compare-And-Swap） への直接リンク" title="6.1 CAS（Compare-And-Swap） への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    CAS (Compare-And-Swap)                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ロックを使わずにアトミックな更新を行う仕組み                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  CAS(アドレス, 期待値, 新しい値):                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. アドレスの現在値が期待値と同じか確認                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. 同じなら新しい値に更新（アトミックに）                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. 違ったら失敗（他のスレッドが変更済み）                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌─────────────────────────────────────────────────────────────┐    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  スレッドA                     スレッドB                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  current = 0                                                 │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓                              current = 0                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  CAS(addr, 0, 1)               ↓                             │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓ 成功！                       CAS(addr, 0, 1)              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  (値は 1 に)                    ↓ 失敗！                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 (期待値0 ≠ 現在値1)          │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 ↓                            │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 リトライ                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 current = 1                  │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 CAS(addr, 1, 2)              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                 ↓ 成功！                     │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                              │    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────  ───────────────────────────────────┘    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  利点: ロックを使わないので軽量                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  欠点: 競合が多いとリトライが増える                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-java-のアトミッククラス">6.2 Java のアトミッククラス<a href="#62-java-のアトミッククラス" class="hash-link" aria-label="6.2 Java のアトミッククラス への直接リンク" title="6.2 Java の  アトミッククラス への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.concurrent.atomic.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// AtomicInteger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AtomicInteger counter = new AtomicInteger(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">counter.incrementAndGet();  // アトミックにインクリメント</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">counter.addAndGet(5);       // アトミックに加算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">counter.compareAndSet(5, 10);  // CAS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// AtomicReference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AtomicReference&lt;String&gt; ref = new AtomicReference&lt;&gt;(&quot;initial&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ref.compareAndSet(&quot;initial&quot;, &quot;updated&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// AtomicLong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AtomicLong longCounter = new AtomicLong(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// LongAdder（高競合時に AtomicLong より高速）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LongAdder adder = new LongAdder();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adder.increment();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">adder.sum();  // 値を取得</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-linux-での確認">7. Linux での確認<a href="#7-linux-での確認" class="hash-link" aria-label="7. Linux での確認 への直接リンク" title="7. Linux での確認 への直接リンク">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># プロセスのロック状態を確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cat /proc/locks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1: FLOCK  ADVISORY  WRITE 1234 08:01:12345 0 EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2: POSIX  ADVISORY  WRITE 5678 08:01:67890 0 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># futex（Fast Userspace muTEX）の統計</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cat /proc/vmstat | grep futex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># スレッドの状態を確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ps -eLf | grep myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UID   PID  PPID   LWP  C NLWP STIME TTY      TIME CMD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app  1234  5678  1234  0   10 10:00 ?    00:00:01 myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app  1234  5678  1235  0   10 10:00 ?    00:00:00 myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># LWP = スレッド ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># スレッドのスタックトレース</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cat /proc/1234/task/1235/stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[&lt;0000000000000000&gt;] futex_wait_queue_me+0x...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[&lt;0000000000000000&gt;] futex_wait+0x...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[&lt;0000000000000000&gt;] do_futex+0x...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># futex_wait が見えたらロック待ち</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-まとめ">8. まとめ<a href="#8-まとめ" class="hash-link" aria-label="8. まとめ への直接リンク" title="8. まとめ への直接リンク">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌────────────────────────────────────── ───────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    この章で学んだこと                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. 競合状態（Race Condition）                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── 複数スレッドが同じデータにアクセス                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── 結果が実行順序に依存してしまう                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. Mutex                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── 一度に1スレッドだけがアクセス可能                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── Java: synchronized, ReentrantLock                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. セマフォ                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── N個までのスレッドが同時アクセス可能                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── コネクションプールなどで使用                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. 条件変数                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── 条件が満たされるまで待機                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── 生産者-消費者パターンで使用                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  5. デッドロック                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── 4条件が揃うと発生                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── ロック順序の固定で回避                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── jstack で検出                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  6. アトミック操作                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     ├── CAS で ロックなしの同期                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     └── Java: AtomicInteger, AtomicReference                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="確認問題">確認問題<a href="#確認問題" class="hash-link" aria-label="確認問題 への直接リンク" title="確認問題 への直接リンク">​</a></h2>
<ol>
<li>Race Condition が起きる原因は？</li>
<li>Mutex とセマフォの違いは？</li>
<li>デッドロックの4条件は？</li>
<li>デッドロックを防ぐ方法を2つ挙げてください</li>
<li>CAS はどのような場面で使われますか？</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="関連リソース">関連リソース<a href="#関連リソース" class="hash-link" aria-label="関連リソース への直接リンク" title="関連リソース への直接リンク">​</a></h2>
<ul>
<li><a href="https://jcip.net/" target="_blank" rel="noopener noreferrer">Java Concurrency in Practice</a> - 並行プログラミングのバイブル</li>
<li><a href="https://www.amazon.com/Art-Multiprocessor-Programming-Revised-Reprint/dp/0123973376" target="_blank" rel="noopener noreferrer">The Art of Multiprocessor Programming</a> - 並行アルゴリズムの教科書</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/21-os-fundamentals/synchronization.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_11_learning/os-fundamentals/signals"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">シグナル</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_11_learning/os-fundamentals/column-why-4kb-page"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">コラム: なぜページサイズは4KBなのか</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#この章で答える疑問" class="table-of-contents__link toc-highlight">この章で答える疑問</a></li><li><a href="#1-競合状態race-condition" class="table-of-contents__link toc-highlight">1. 競合状態（Race Condition）</a><ul><li><a href="#11-問題の例" class="table-of-contents__link toc-highlight">1.1 問題の例</a></li><li><a href="#12-java-での再現" class="table-of-contents__link toc-highlight">1.2 Java での再現</a></li><li><a href="#13-クリティカルセクション" class="table-of-contents__link toc-highlight">1.3 クリティカルセクション</a></li></ul></li><li><a href="#2-mutex相互排他ロック" class="table-of-contents__link toc-highlight">2. Mutex（相互排他ロック）</a><ul><li><a href="#21-mutex-の概念" class="table-of-contents__link toc-highlight">2.1 Mutex の概念</a></li><li><a href="#22-java-での実装" class="table-of-contents__link toc-highlight">2.2 Java での実装</a></li><li><a href="#23-java-の-synchronized-の仕組み" class="table-of-contents__link toc-highlight">2.3 Java の synchronized の仕組み</a></li></ul></li><li><a href="#3-セマフォ" class="table-of-contents__link toc-highlight">3. セマフォ</a><ul><li><a href="#31-セマフォの概念" class="table-of-contents__link toc-highlight">3.1 セマフォの概念</a></li><li><a href="#32-使用例-コネクションプール" class="table-of-contents__link toc-highlight">3.2 使用例: コネクションプール</a></li></ul></li><li><a href="#4-条件変数" class="table-of-contents__link toc-highlight">4. 条件変数</a><ul><li><a href="#41-条件変数の概念" class="table-of-contents__link toc-highlight">4.1 条件変数の概念</a></li><li><a href="#42-java-での実装" class="table-of-contents__link toc-highlight">4.2 Java での実装</a></li></ul></li><li><a href="#5-デッドロック" class="table-of-contents__link toc-highlight">5. デッドロック</a><ul><li><a href="#51-デッドロックとは" class="table-of-contents__link toc-highlight">5.1 デッドロックとは</a></li><li><a href="#52-デッドロックの4条件" class="table-of-contents__link toc-highlight">5.2 デッドロックの4条件</a></li><li><a href="#53-デッドロックの回避" class="table-of-contents__link toc-highlight">5.3 デッドロックの回避</a></li><li><a href="#54-デッドロックの検出" class="table-of-contents__link toc-highlight">5.4 デッドロックの検出</a></li></ul></li><li><a href="#6-アトミック操作" class="table-of-contents__link toc-highlight">6. アトミック操作</a><ul><li><a href="#61-cascompare-and-swap" class="table-of-contents__link toc-highlight">6.1 CAS（Compare-And-Swap）</a></li><li><a href="#62-java-のアトミッククラス" class="table-of-contents__link toc-highlight">6.2 Java のアトミッククラス</a></li></ul></li><li><a href="#7-linux-での確認" class="table-of-contents__link toc-highlight">7. Linux での確認</a></li><li><a href="#8-まとめ" class="table-of-contents__link toc-highlight">8. まとめ</a></li><li><a href="#確認問題" class="table-of-contents__link toc-highlight">確認問題</a></li><li><a href="#関連リソース" class="table-of-contents__link toc-highlight">関連リソース</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>