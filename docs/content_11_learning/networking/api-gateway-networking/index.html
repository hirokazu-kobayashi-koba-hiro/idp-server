<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_11_learning/networking/api-gateway-networking" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">API Gatewayとネットワーキング | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/api-gateway-networking"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="API Gatewayとネットワーキング | IdP-Server Documentation"><meta data-rh="true" name="description" content="所要時間"><meta data-rh="true" property="og:description" content="所要時間"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/api-gateway-networking"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/api-gateway-networking" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/api-gateway-networking" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.56457de1.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.eef294f4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ドキュメントガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">content_01_intro</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">content_02_quickstart</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/foundation/concept-01-multi-tenant">content_03_concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">content_04_protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/idp-server/docs/content_05_how-to/">How-to ガイド - 学習ロードマップ</a><button aria-label="&#x27;How-to ガイド - 学習ロードマップ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/idp-server/docs/content_06_developer-guide/">開発者ガイドマップ</a><button aria-label="&#x27;開発者ガイドマップ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference/api-authentication-device-ja">content_07_reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/commercial-deployment/overview">content_08_ops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/analytics-statistics-design">content_09_project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">content_10_ai_developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">content_11_learning</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">identity-basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-fundamentals/modern-web-authz-authn">oauth-fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-tokens/id-token-jwt">oauth-tokens</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/openid-connect/oauth-oidc-basics">openid-connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/fido-webauthn/fido2-architecture-rp-browser-authenticator">fido-webauthn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/security/">セキュリティ学習コンテンツ</a><button aria-label="&#x27;セキュリティ学習コンテンツ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/multi-tenancy/multi-tenancy-basics">multi-tenancy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/advanced-protocols/ciba-basics">advanced-protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/http-rest/http-basics">http-rest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jwt-jose/jwt-introduction">jwt-jose</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/postgresql/">PostgreSQL 学習ガイド</a><button aria-label="&#x27;PostgreSQL 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/crypto/">暗号化（Cryptography）学習ガイド</a><button aria-label="&#x27;暗号化（Cryptography）学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/kubernetes/">コンテナ/Kubernetes 学習ガイド</a><button aria-label="&#x27;コンテナ/Kubernetes 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/linux/">Linux 学習ガイド</a><button aria-label="&#x27;Linux 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/idp-server/docs/content_11_learning/networking/">ネットワーク学習ガイド</a><button aria-label="&#x27;ネットワーク学習ガイド&#x27;の目次を隠す" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/dns-fundamentals">DNS基礎</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/dns-advanced">DNS詳細: CNAME、DNSSECとクラウドDNS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/load-balancing">ロードバランシング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/ssl-tls-certificates">SSL/TLS証明書管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_11_learning/networking/api-gateway-networking">API Gatewayとネットワーキング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/network-troubleshooting">ネットワークトラブルシューティング</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth/OIDC RFC学習</a><button aria-label="&#x27;OAuth/OIDC RFC学習&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/verifiable-credentials/">Verifiable Credentials</a><button aria-label="&#x27;Verifiable Credentials&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/data-formats/">データフォーマット</a><button aria-label="&#x27;データフォーマット&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_20_testing/e2e-test-coverage">content_20_testing</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">はじめに</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">content_11_learning</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/idp-server/docs/content_11_learning/networking/"><span itemprop="name">ネットワーク学習ガイド</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">API Gatewayとネットワーキング</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>API Gatewayとネットワーキング</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所要時間">所要時間<a href="#所要時間" class="hash-link" aria-label="所要時間 への直接リンク" title="所要時間 への直接リンク">​</a></h2>
<p>約45分</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="学べること">学べること<a href="#学べること" class="hash-link" aria-label="学べること への直接リンク" title="学べること への直接リンク">​</a></h2>
<ul>
<li>API Gatewayの基本概念とネットワーク統合</li>
<li>REST API、HTTP API、WebSocket APIの違い</li>
<li>VPC統合とプライベートAPI</li>
<li>カスタムドメインとSSL/TLS設定</li>
<li>スロットリング、キャッシング、認証</li>
<li>CloudFrontとの連携パターン</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前提知識">前提知識<a href="#前提知識" class="hash-link" aria-label="前提知識 への直接リンク" title="前提知識 への直接リンク">​</a></h2>
<ul>
<li><a href="/idp-server/docs/content_11_learning/networking/dns-fundamentals">01-dns-fundamentals.md</a> - DNS基礎</li>
<li><a href="/idp-server/docs/content_11_learning/networking/load-balancing">03-load-balancing.md</a> - ロードバランシング</li>
<li><a href="/idp-server/docs/content_11_learning/networking/ssl-tls-certificates">04-ssl-tls-certificates.md</a> - SSL/TLS証明書</li>
<li>HTTP/RESTの基本</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-api-gatewayの基礎">1. API Gatewayの基礎<a href="#1-api-gatewayの基礎" class="hash-link" aria-label="1. API Gatewayの基礎 への直接リンク" title="1. API Gatewayの基礎 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-api-gatewayとは">1.1 API Gatewayとは<a href="#11-api-gatewayとは" class="hash-link" aria-label="1.1 API Gatewayとは への直接リンク" title="1.1 API Gatewayとは への直接リンク">​</a></h3>
<p><strong>Amazon API Gateway</strong>は、あらゆる規模のREST、HTTP、WebSocket APIを作成、公開、保守、監視、保護するためのフルマネージド型サービスです。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              API Gateway の役割                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント（モバイル、Web、IoT等）                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ HTTPS リクエスト                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────────┐  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │           API Gateway                                │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────────────────────────────────────────────┐  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 1. 認証・認可（IAM、Cognito、Lambda）          │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 2. リクエスト検証                              │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 3. レート制限（スロットリング）                 │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 4. キャッシング                                │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 5. リクエスト/レスポンス変換                   │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ 6. ロギング・モニタリング                      │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └────────────────────────────────────────────────┘  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────────────────┘  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├───► Lambda関数                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├───► EC2/ECS（VPC統合）                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├───► DynamoDB、S3                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      └───► 外部HTTP エンドポイント                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-api-gatewayの種類">1.2 API Gatewayの種類<a href="#12-api-gatewayの種類" class="hash-link" aria-label="1.2 API Gatewayの種類 への直接リンク" title="1.2 API Gatewayの種類 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────── ──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          REST API vs HTTP API vs WebSocket API              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  REST API                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 最も機能豊富                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - API キー、使用量プラン、リクエスト検証                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - モックレスポンス、SDKジェネレーション                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 価格: 高め                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  用途: エンタープライズアプリケーション                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  HTTP API                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - シンプル、低コスト（REST APIの70%安）                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - JWT認証ネイティブサポート                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - OIDC/OAuth 2.0統合                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 価格: 低い                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  用途: マイクロサービス、OAuth/OIDC認証API                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  WebSocket API                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 双方向通信                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - リアルタイムアプリケーション                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 接続管理（@connections）                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  用途: チャット、ゲーム、リアルタイムダッシュボード          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-api-gatewayのネットワーク統合">2. API Gatewayのネットワーク統合<a href="#2-api-gatewayのネットワーク統合" class="hash-link" aria-label="2. API Gatewayのネットワーク統合 への直接リンク" title="2. API Gatewayのネットワーク統合 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-統合タイプ">2.1 統合タイプ<a href="#21-統合タイプ" class="hash-link" aria-label="2.1 統合タイプ への直接リンク" title="2.1 統合タイプ への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────── ──────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              API Gateway 統合タイプ                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. Lambda統合（LAMBDA / LAMBDA_PROXY）                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     API Gateway → Lambda関数                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. HTTP統合（HTTP / HTTP_PROXY）                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     API Gateway → 外部HTTPエンドポイント                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. AWS統合（AWS）                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     API Gateway → AWSサービス（DynamoDB、S3等）             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. VPC Link統合                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     API Gateway → プライベートリソース（NLB経由）           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  5. モック統合（MOCK）                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     API Gateway → 固定レスポンス（バックエンドなし）        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-vpc 統合vpc-link">2.2 VPC統合（VPC Link）<a href="#22-vpc統合vpc-link" class="hash-link" aria-label="2.2 VPC統合（VPC Link） への直接リンク" title="2.2 VPC統合（VPC Link） への直接リンク">​</a></h3>
<p><strong>VPC Link</strong>を使用すると、API GatewayからVPC内のプライベートリソースにアクセスできます。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              VPC Link の仕組み                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  インターネット                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ HTTPS                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────┐                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  API Gateway     │ (パブリック)                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  (REST API)      │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────┘                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ VPC Link (REST API用)                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ または                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ VPC Link (HTTP API用)                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────────┐  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  VPC                                                  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────────────────────────────────────────────┐  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  Network Load Balancer (NLB)                   │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └────────────────────────────────────────────────┘  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      │                                                │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      ├───► EC2 インスタンス (10.0.1.10)               │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      ├───► ECS タスク (10.0.1.20)                     │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      └───► Lambda (VPC内)                             │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │                                                        │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └────────────────────────────────────────────────────────┘  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rest-api用-vpc-link作成">REST API用 VPC Link作成<a href="#rest-api用-vpc-link作成" class="hash-link" aria-label="REST API用 VPC Link作成 への直接リンク" title="REST API用 VPC Link作成 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. NLB作成（VPC内）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws elbv2 create-load-balancer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name internal-nlb \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --subnets subnet-12345678 subnet-87654321 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --scheme internal \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. ターゲットグループ作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws elbv2 create-target-group \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name api-targets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --protocol TCP \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --port 8080 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vpc-id vpc-1234567890abcdef0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. リスナー作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws elbv2 create-listener \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --load-balancer-arn arn:aws:elasticloadbalancing:us-east-1:123456789012:loadbalancer/net/internal-nlb/50dc6c495c0c9188 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --protocol TCP \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --port 80 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --default-actions Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:us-east-1:123456789012:targetgroup/api-targets/50dc6c495c0c9188</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. VPC Link作成（REST API用）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-vpc-link \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name my-vpc-link \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --target-arns arn:aws:elasticloadbalancing:us-east-1:123456789012:loadbalancer/net/internal-nlb/50dc6c495c0c9188</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 5. REST APIにVPC Link統合を設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># API Gateway Console または AWS CLI/CloudFormationで設定</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http-api用-vpc-link作成">HTTP API用 VPC Link作成<a href="#http-api用-vpc-link作成" class="hash-link" aria-label="HTTP API用 VPC Link作成 への直接リンク" title="HTTP API用 VPC Link作成 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># HTTP API用のVPC Linkは異なるコマンド</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigatewayv2 create-vpc-link \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name my-http-vpc-link \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --subnet-ids subnet-12345678 subnet-87654321 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-group-ids sg-12345678</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-プライベートapi">2.3 プライベートAPI<a href="#23-プライベートapi" class="hash-link" aria-label="2.3 プライベートAPI への直接リンク" title="2.3 プライベートAPI への直接リンク">​</a></h3>
<p><strong>プライベートAPI</strong>は、VPCエンドポイント経由でのみアクセス可能なAPIです。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              プライベートAPI の構成                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌────────────────────────────────────────────────────────┐ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  VPC                                                    │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌──────────────────────────────────────────────────┐  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  EC2インスタンス                                  │  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  (10.0.1.10)                                      │  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └──────────────────────────────────────────────────┘  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      │                                                  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      │ HTTPS                                            │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      ▼                                                  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌──────────────────────────────────────────────────┐  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  VPCエンドポイント (execute-api)                  │  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │  vpce-1234567890abcdef0                           │  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └──────────────────────────────────────────────────┘  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │      │                                                  │ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────┼──────────────────────────────────────────────────┘ │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│         │                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│         │ AWS PrivateLink                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│         ▼                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────┐                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  API Gateway     │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  (プライベートAPI)│                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────┘                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  特徴:                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - インターネットからアクセス不可                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - VPC内からのみアクセス可能                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - リソースポリシーで更に制限可能                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="プライベートapi作成例">プライベートAPI作成例<a href="#プライベートapi作成例" class="hash-link" aria-label="プライベートAPI作成例 への直接リンク" title="プライベートAPI作成例 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. VPCエンドポイント作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws ec2 create-vpc-endpoint \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vpc-id vpc-1234567890abcdef0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vpc-endpoint-type Interface \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-name com.amazonaws.us-east-1.execute-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --subnet-ids subnet-12345678 subnet-87654321 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-group-ids sg-12345678</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. プライベートREST API作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-rest-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name private-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --endpoint-configuration types=PRIVATE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. リソースポリシー設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; resource-policy.json &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Principal&quot;: &quot;*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Action&quot;: &quot;execute-api:Invoke&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Resource&quot;: &quot;arn:aws:execute-api:us-east-1:123456789012:api-id/*&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Condition&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;StringEquals&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;aws:SourceVpce&quot;: &quot;vpce-1234567890abcdef0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-rest-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations op=replace,path=/policy,value=file://resource-policy.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-カスタムドメインとssltls">3. カスタムドメインとSSL/TLS<a href="#3-カスタムドメインとssltls" class="hash-link" aria-label="3. カスタムドメインとSSL/TLS への直接リンク" title="3. カスタムドメインとSSL/TLS への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-カスタムドメインの設定">3.1 カスタムドメインの設定<a href="#31-カスタムドメインの設定" class="hash-link" aria-label="3.1 カスタムドメインの設定 への直接リンク" title="3.1 カスタムドメインの設定 への直接リンク">​</a></h3>
<p>デフォルトのAPI Gatewayエンドポイント（例：<code>https://api-id.execute-api.us-east-1.amazonaws.com</code>）を、カスタムドメイン（例：<code>https://api.example.com</code>）に変更できます。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          カスタムドメインの構成                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ https://api.example.com/prod/users                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────┐                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  Route 53        │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  api.example.com │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ↓ ALIAS         │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  d-xxxx.execute-api.us-east-1.amazonaws.com             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────┘                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────────┐  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  CloudFront ディストリビューション                    │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  (API Gateway カスタムドメインが自動作成)             │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  証明書: ACM (us-east-1)                              │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────────────────┘  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────┐                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  API Gateway     │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ステージ: prod   │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  パス: /users     │                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────┘                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="カスタムドメイン作成手順">カスタムドメイン作成手順<a href="#カスタムドメイン作成手順" class="hash-link" aria-label="カスタムドメイン作成手順 への直接リンク" title="カスタムドメイン作成手順 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. ACM証明書作成（us-east-1リージョン必須 - エッジ最適化の場合）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws acm request-certificate \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --validation-method DNS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --region us-east-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. DNS検証完了後、カスタムドメイン作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-domain-name \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --certificate-arn arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --endpoint-configuration types=EDGE \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-policy TLS_1_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># リージョナルエンドポイントの場合（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-domain-name \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --regional-certificate-arn arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --endpoint-configuration types=REGIONAL \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --security-policy TLS_1_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. ベースパスマッピング作成（API ステージとカスタムドメインを紐付け）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-base-path-mapping \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --base-path v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 複数バージョンのAPI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-base-path-mapping \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --base-path v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-base-path-mapping \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --domain-name api.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api789012 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --base-path v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 結  果:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://api.example.com/v1/* → api123456 (prod ステージ)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://api.example.com/v2/* → api789012 (prod ステージ)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. Route 53でDNSレコード作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 change-resource-record-sets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z1234567890ABC \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --change-batch &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Changes&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Action&quot;: &quot;CREATE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ResourceRecordSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Name&quot;: &quot;api.example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Type&quot;: &quot;A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;AliasTarget&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;HostedZoneId&quot;: &quot;Z2FDTNDATAQYW2&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;DNSName&quot;: &quot;d-xxxx.execute-api.us-east-1.amazonaws.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;EvaluateTargetHealth&quot;: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-エッジ最適化-vs-リージョナル">3.2 エッジ最適化 vs リージョナル<a href="#32-エッジ最適化-vs-リージョナル" class="hash-link" aria-label="3.2 エッジ最適化 vs リージョナル への直接リンク" title="3.2 エッジ最適化 vs リージョナル への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌────────────────────────  ─────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          エッジ最適化 vs リージョナルエンドポイント          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  エッジ最適化エンドポイント                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - CloudFront経由でグローバル配信                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 低レイテンシー（エッジロケーション活用）                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - ACM証明書はus-east-1リージョン必須                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 追加コストなし（CloudFront組み込み）                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  用途: グローバルアプリケーション                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  リージョナルエンドポイント                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 特定リージョンにデプロイ                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - CloudFront統合は任意（手動設定）                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - ACM証明書は同一リージョンで取得                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - VPC Link、プライベートAPIで必須                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  用途: 特定リージョンのみ、VPC統合、独自CloudFront設定       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-認証認可">4. 認証・認可<a href="#4-認証認可" class="hash-link" aria-label="4. 認証・認可 への直接リンク" title="4. 認証・認可 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-認証方式の種類">4.1 認証方式の種類<a href="#41-認証方式の種類" class="hash-link" aria-label="4.1 認証方式の種類 への直接リンク" title="4.1 認証方式の種類 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          API Gateway 認証方式                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. IAM認証                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - AWS署名バージョン4（SigV4）                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - AWSサービス間通信に最適                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. Cognito オーソライザー                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - Cognito User Poolsで認証                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - OAuth 2.0 / OIDC                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. Lambda オーソライザー（カスタムオーソライザー）          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - カスタム認証ロジック                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - トークンベース or リクエストパラメータベース           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. API キー                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - シンプルなアクセス制御                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - 使用量プランと組み合わせ                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  5. JWT オーソライザー（HTTP API専用）                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - JWTトークンのネイティブ検証                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - OIDC/OAuth 2.0統合                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-lambda-オーソライザー実装例">4.2 Lambda オーソライザー実装例<a href="#42-lambda-オーソライザー実装例" class="hash-link" aria-label="4.2 Lambda オーソライザー実装例 への直接リンク" title="4.2 Lambda オーソライザー実装例 への直接リンク">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Lambda オーソライザー関数（Node.js）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exports</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">handler</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Event:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// トークン取得（Authorizationヘッダーから）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">authorizationToken</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// トークン検証ロジック（例: JWTトークン検証）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> decoded </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">verifyJwtToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// IAMポリシー生成（Allow）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generatePolicy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">decoded</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sub</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Allow&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">methodArn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Authentication failed:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// IAMポリシー生成（Deny）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generatePolicy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;user&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Deny&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">methodArn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generatePolicy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">principalId</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> effect</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> resource</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> authResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">principalId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> principalId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">effect </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> resource</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> policyDocument </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">Version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2012-10-17&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">Statement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">Action</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;execute-api:Invoke&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">Effect</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> effect</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">Resource</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        authResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">policyDocument</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policyDocument</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// コンテキスト（バックエンドに渡される追加情報）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    authResponse</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">context</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">userId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> principalId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;user@example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> authResponse</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">verifyJwtToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">token</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// JWT検証ロジック（jsonwebtokenライブラリ使用）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> jwt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;jsonwebtoken&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> publicKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">JWT_PUBLIC_KEY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> jwt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">verify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">algorithms</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;RS256&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="lambdaオーソライザー設定aws-cli">Lambdaオーソライザー設定（AWS CLI）<a href="#lambdaオーソライザー設定aws-cli" class="hash-link" aria-label="Lambdaオーソライザー設定（AWS CLI） への直接リンク" title="Lambdaオーソライザー設定（AWS CLI） への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Lambda関数作成（省略）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># REST APIにオーソライザー追加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-authorizer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name my-lambda-authorizer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type TOKEN \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorizer-uri arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:123456789012:function:my-authorizer/invocations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-source method.request.header.Authorization \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorizer-result-ttl-in-seconds 300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># メソッドにオーソライザーを適用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-method \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method GET \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations op=replace,path=/authorizationType,value=CUSTOM \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      op=replace,path=/authorizerId,value=authorizer-id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-http-api-jwtオーソライザー">4.3 HTTP API JWTオーソライザー<a href="#43-http-api-jwtオーソライザー" class="hash-link" aria-label="4.3 HTTP API JWTオーソライザー への直接リンク" title="4.3 HTTP API JWTオーソライザー への直接リンク">​</a></h3>
<p>HTTP APIでは、JWTオーソライザーをネイティブにサポートしています。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># HTTP API作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigatewayv2 create-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name my-http-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --protocol-type HTTP \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --target arn:aws:lambda:us-east-1:123456789012:function:my-function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># JWTオーソライザー作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigatewayv2 create-authorizer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id api-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name jwt-authorizer \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorizer-type JWT \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-source &#x27;$request.header.Authorization&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --jwt-configuration Audience=https://example.com,Issuer=https://cognito-idp.us-east-1.amazonaws.com/us-east-1_XXXXXXXXX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ルートにオーソライザーを適用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigatewayv2 update-route \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id api-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --route-id route-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorization-type JWT \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorizer-id authorizer-id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-スロットリングキャッシングcors">5. スロットリング、キャッシング、CORS<a href="#5-スロットリングキャッシングcors" class="hash-link" aria-label="5. スロットリング、キャッシング、CORS への直接リンク" title="5. スロットリング、キャッシング、CORS への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-スロットリングレート制限">5.1 スロットリング（レート制限）<a href="#51-スロットリングレート制限" class="hash-link" aria-label="5.1 スロットリング（レート制限） への直接リンク" title="5.1 スロットリング（レート制限） への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          API Gateway スロットリング                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【デフォルト制限】                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - リージョンごとのアカウント制限:                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    - 定常レート: 10,000 リクエスト/秒                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    - バースト: 5,000 リクエスト                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【制限の階層】                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. アカウントレベル（リージョンごと）                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. ステージレベル                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. メソッドレベル                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【使用量プラン】                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - APIキーごとのレート制限                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - クォータ（日次/週次/月次）                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="スロットリング設定">スロットリング設定<a href="#スロットリング設定" class="hash-link" aria-label="スロットリング設定 への直接リンク" title="スロットリング設定 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ステージレベルのスロットリング設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-stage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage-name prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/throttle/rateLimit,value=1000 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/throttle/burstLimit,value=2000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># メソッドレベルのスロットリング設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-stage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage-name prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/*/GET/users/throttle/rateLimit,value=500 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/*/GET/users/throttle/burstLimit,value=1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 使用量プラン作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-usage-plan \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name basic-plan \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --throttle rateLimit=100,burstLimit=200 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --quota limit=10000,period=MONTH \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-stages apiId=api123456,stage=prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># APIキー作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-api-key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name customer-api-key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># APIキーを使用量プランに関連付け</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway create-usage-plan-key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --usage-plan-id plan-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key-id api-key-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key-type API_KEY</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-キャッシング">5.2 キャッシング<a href="#52-キャッシング" class="hash-link" aria-label="5.2 キャッシング への直接リンク" title="5.2 キャッシング への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          API Gateway キャッシング                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────  ─────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  リクエスト1 → API Gateway                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               ↓ キャッシュミス                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               Lambda実行 (100ms)                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               ↓                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               キャッシュに保存 (TTL: 300秒)                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               ↓                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│               レスポンス                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  リクエスト2 (同じパラメータ) → API Gateway                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                 ↓ キャッシュヒット           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                 キャッシュから返却 (1ms)     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【キャッシュキー】                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - パス                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - クエリパラメータ                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - ヘッダー（設定可能）                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="キャッシング設定">キャッシング設定<a href="#キャッシング設定" class="hash-link" aria-label="キャッシング設定 への直接リンク" title="キャッシング設定 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ステージでキャッシング有効化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-stage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage-name prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/cacheClusterEnabled,value=true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/cacheClusterSize,value=0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># キャッシュサイズ:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 0.5GB, 1.6GB, 6.1GB, 13.5GB, 28.4GB, 58.2GB, 118GB, 237GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># TTL設定（秒）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-stage \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --stage-name prod \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/methodSettings/*/GET~1users/cacheTtlInSeconds,value=300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># クエリパラメータをキャッシュキーに含める</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway update-method \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method GET \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --patch-operations \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/requestParameters/method.request.querystring.userId,value=true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    op=replace,path=/cacheKeyParameters,value=method.request.querystring.userId</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-cors設定">5.3 CORS設定<a href="#53-cors設定" class="hash-link" aria-label="5.3 CORS設定 への直接リンク" title="5.3 CORS設定 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              CORS (Cross-Origin Resource Sharing)            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ブラウザ (https://example.com)                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ OPTIONS /users (プリフライトリクエスト)              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  API Gateway (https://api.example.com)                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ レスポンスヘッダー:                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ Access-Control-Allow-Origin: https://example.com    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ Access-Control-Allow-Methods: GET,POST,PUT,DELETE   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ Access-Control-Allow-Headers: Content-Type,Authorization │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ Access-Control-Max-Age: 3600                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ 200 OK                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ブラウザ（CORS許可確認）                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ 実際のリクエスト: GET /users                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  API Gateway                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cors設定rest-api">CORS設定（REST API）<a href="#cors設定rest-api" class="hash-link" aria-label="CORS設定（REST API） への直接リンク" title="CORS設定（REST API） への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># OPTIONSメソッド作成（モック統合）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway put-method \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method OPTIONS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --authorization-type NONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway put-integration \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method OPTIONS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --type MOCK \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --request-templates &#x27;{&quot;application/json&quot;: &quot;{\&quot;statusCode\&quot;: 200}&quot;}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway put-method-response \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method OPTIONS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --status-code 200 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --response-parameters \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Headers=true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Methods=true \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Origin=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigateway put-integration-response \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --rest-api-id api123456 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --resource-id abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --http-method OPTIONS \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --status-code 200 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --response-parameters \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Headers=&quot;&#x27;Content-Type,Authorization&#x27;&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Methods=&quot;&#x27;GET,POST,PUT,DELETE&#x27;&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method.response.header.Access-Control-Allow-Origin=&quot;&#x27;https://example.com&#x27;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cors設定http-api---簡単">CORS設定（HTTP API - 簡単）<a href="#cors設定http-api---簡単" class="hash-link" aria-label="CORS設定（HTTP API - 簡単） への直接リンク" title="CORS設定（HTTP API - 簡単） への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># HTTP APIはCORSが簡単に設定可能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws apigatewayv2 update-api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --api-id api-id \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --cors-configuration \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AllowOrigins=https://example.com,AllowMethods=GET,POST,PUT,DELETE,AllowHeaders=Content-Type,Authorization,MaxAge=3600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-cloudfrontとの連携">6. CloudFrontとの連携<a href="#6-cloudfrontとの連携" class="hash-link" aria-label="6. CloudFrontとの連携 への直接リンク" title="6. CloudFrontとの連携 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-cloudfront--api-gateway-パターン">6.1 CloudFront + API Gateway パターン<a href="#61-cloudfront--api-gateway-パターン" class="hash-link" aria-label="6.1 CloudFront + API Gateway パターン への直接リンク" title="6.1 CloudFront + API Gateway パターン への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          CloudFront + API Gateway 構成                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │ https://example.com                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ▼                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ┌──────────────────────────────────────────────────────┐  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  CloudFront                                           │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────────────────────────────────────────────┐  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ ビヘイビア1: /api/*                             │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ → API Gateway (オリジン)                        │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ キャッシュ: 無効 or 短時間                       │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └────────────────────────────────────────────────┘  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────────────────────────────────────────────┐  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ ビヘイビア2: /static/*                          │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ → S3 (オリジン)                                 │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ キャッシュ: 長時間                               │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └ ────────────────────────────────────────────────┘  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  ┌────────────────────────────────────────────────┐  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ デフォルトビヘイビア: /*                        │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  │ → S3 (SPA)                                      │  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  │  └────────────────────────────────────────────────┘  │  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └──────────────────────────────────────────────────────┘  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  利点:                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 単一ドメインでAPI + 静的コンテンツ配信                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - WAF統合（DDoS対策、レート制限）                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - グローバルエッジキャッシング                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - カスタムSSL証明書                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cloudfrontディストリビューション作成例">CloudFrontディストリビューション作成例<a href="#cloudfrontディストリビューション作成例" class="hash-link" aria-label="CloudFrontディストリビューション作成例 への直接リンク" title="CloudFrontディストリビューション作成例 への直接リンク">​</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// cloudfront-config.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;CallerReference&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-12-26-api-cf&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Aliases&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;example.com&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;DefaultRootObject&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;index.html&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Origins&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api-gateway&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;DomainName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api123456.execute-api.us-east-1.amazonaws.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;OriginPath&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/prod&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;CustomOriginConfig&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;HTTPPort&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;HTTPSPort&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;OriginProtocolPolicy&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https-only&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;OriginSslProtocols&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;TLSv1.2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;Id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s3-static&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;DomainName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-bucket.s3.amazonaws.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;S3OriginConfig&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;OriginAccessIdentity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;origin-access-identity/cloudfront/ABCDEFG1234567&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;DefaultCacheBehavior&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;TargetOriginId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;s3-static&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ViewerProtocolPolicy&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;redirect-to-https&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;AllowedMethods&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;GET&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HEAD&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ForwardedValues&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;QueryString&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;Cookies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Forward&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;none&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;MinTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;DefaultTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;MaxTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31536000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;CacheBehaviors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;PathPattern&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/api/*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;TargetOriginId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api-gateway&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;ViewerProtocolPolicy&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https-only&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;AllowedMethods&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;GET&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HEAD&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OPTIONS&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PUT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PATCH&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DELETE&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;ForwardedValues&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;QueryString&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;Cookies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;Forward&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;all&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">&quot;Headers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Quantity&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;Items&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Accept&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;MinTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;DefaultTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;MaxTTL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;ViewerCertificate&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;ACMCertificateArn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;SSLSupportMethod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sni-only&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;MinimumProtocolVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TLSv1.2_2021&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Comment&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;API Gateway + S3 distribution&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;Enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws cloudfront create-distribution \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --distribution-config file://cloudfront-config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="まとめ">まとめ<a href="#まとめ" class="hash-link" aria-label="まとめ への直接リンク" title="まとめ への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="学んだこと">学んだこと<a href="#学んだこと" class="hash-link" aria-label="学んだこと への直接リンク" title="学んだこと への直接リンク">​</a></h3>
<p>本章では、API Gatewayのネットワーキング機能を学びました:</p>
<ul>
<li>API Gatewayの基本概念と統合タイプ（Lambda、HTTP、VPC Link）</li>
<li>VPC統合とプライベートAPIの構成</li>
<li>カスタムドメインとSSL/TLS設定</li>
<li>認証・認可（IAM、Cognito、Lambda オーソライザー、JWT）</li>
<li>スロットリング、キャッシング、CORS設定</li>
<li>CloudFrontとの連携パターン</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="重要なポイント">重要なポイント<a href="#重要なポイント" class="hash-link" aria-label="重要なポイント への直接リンク" title="重要なポイント への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. HTTP API vs REST API の選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - シンプル、低コスト → HTTP API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 豊富な機能 → REST API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. VPC統合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - プライベートリソースへのアクセス</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - NLB経由のVPC Link</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. カスタムドメイン</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - エッジ最適化（グローバル）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - リージョナル（VPC統合、独自CloudFront）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 認証の選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - AWS内部 → IAM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - ユーザー認証 → Cognito / JWT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - カスタムロジック → Lambda オーソライザー</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. パフォーマンス最適化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - キャッシング（適切なTTL設定）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - スロットリング（レート制限）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - CloudFront統合（グローバル配信）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ベストプラクティス">ベストプラクティス<a href="#ベストプラクティス" class="hash-link" aria-label="ベストプラクティス への直接リンク" title="ベストプラクティス への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">□ HTTP APIを優先検討（コスト削減）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ VPC内リソースはVPC Link経由</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ カスタムドメインでブランディング</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ 適切な認証方式の選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ スロットリングで保護</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ CloudWatch Logsで監視</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ X-Rayでトレーシング</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">□ WAF統合（CloudFront経由）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="次のステップ">次のステップ<a href="#次のステップ" class="hash-link" aria-label="次のステップ への直接リンク" title="次のステップ への直接リンク">​</a></h3>
<ul>
<li><a href="/idp-server/docs/content_11_learning/networking/network-troubleshooting">06-network-troubleshooting.md</a> - API Gatewayのトラブルシューティング</li>
<li><a href="/idp-server/docs/content_06_developer-guide/03-application-plane/">content_06_developer-guide/03-application-plane/</a> - idp-serverでのAPI設計</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考リンク">参考リンク<a href="#参考リンク" class="hash-link" aria-label="参考リンク への直接リンク" title="参考リンク への直接リンク">​</a></h3>
<ul>
<li><a href="https://docs.aws.amazon.com/apigateway/" target="_blank" rel="noopener noreferrer">AWS API Gateway Documentation</a></li>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-rest-api.html" target="_blank" rel="noopener noreferrer">API Gateway REST API</a></li>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api.html" target="_blank" rel="noopener noreferrer">API Gateway HTTP API</a></li>
<li><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-vpc-links.html" target="_blank" rel="noopener noreferrer">VPC Link</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/15-networking/05-api-gateway-networking.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_11_learning/networking/ssl-tls-certificates"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">SSL/TLS証明書管理</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_11_learning/networking/network-troubleshooting"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">ネットワークトラブルシューティング</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#所要時間" class="table-of-contents__link toc-highlight">所要時間</a></li><li><a href="#学べること" class="table-of-contents__link toc-highlight">学べること</a></li><li><a href="#前提知識" class="table-of-contents__link toc-highlight">前提知識</a></li><li><a href="#1-api-gatewayの基礎" class="table-of-contents__link toc-highlight">1. API Gatewayの基礎</a><ul><li><a href="#11-api-gatewayとは" class="table-of-contents__link toc-highlight">1.1 API Gatewayとは</a></li><li><a href="#12-api-gatewayの種類" class="table-of-contents__link toc-highlight">1.2 API Gatewayの種類</a></li></ul></li><li><a href="#2-api-gatewayのネットワーク統合" class="table-of-contents__link toc-highlight">2. API Gatewayのネットワーク統合</a><ul><li><a href="#21-統合タイプ" class="table-of-contents__link toc-highlight">2.1 統合タイプ</a></li><li><a href="#22-vpc統合vpc-link" class="table-of-contents__link toc-highlight">2.2 VPC統合（VPC Link）</a></li><li><a href="#23-プライベートapi" class="table-of-contents__link toc-highlight">2.3 プライベートAPI</a></li></ul></li><li><a href="#3-カスタムドメインとssltls" class="table-of-contents__link toc-highlight">3. カスタムドメインとSSL/TLS</a><ul><li><a href="#31-カスタムドメインの設定" class="table-of-contents__link toc-highlight">3.1 カスタムドメインの設定</a></li><li><a href="#32-エッジ最適化-vs-リージョナル" class="table-of-contents__link toc-highlight">3.2 エッジ最適化 vs リージョナル</a></li></ul></li><li><a href="#4-認証認可" class="table-of-contents__link toc-highlight">4. 認証・認可</a><ul><li><a href="#41-認証方式の種類" class="table-of-contents__link toc-highlight">4.1 認証方式の種類</a></li><li><a href="#42-lambda-オーソライザー実装例" class="table-of-contents__link toc-highlight">4.2 Lambda オーソライザー実装例</a></li><li><a href="#43-http-api-jwtオーソライザー" class="table-of-contents__link toc-highlight">4.3 HTTP API JWTオーソライザー</a></li></ul></li><li><a href="#5-スロットリングキャッシングcors" class="table-of-contents__link toc-highlight">5. スロットリング、キャッシング、CORS</a><ul><li><a href="#51-スロットリングレート制限" class="table-of-contents__link toc-highlight">5.1 スロットリング（レート制限）</a></li><li><a href="#52-キャッシング" class="table-of-contents__link toc-highlight">5.2 キャッシング</a></li><li><a href="#53-cors設定" class="table-of-contents__link toc-highlight">5.3 CORS設定</a></li></ul></li><li><a href="#6-cloudfrontとの連携" class="table-of-contents__link toc-highlight">6. CloudFrontとの連携</a><ul><li><a href="#61-cloudfront--api-gateway-パターン" class="table-of-contents__link toc-highlight">6.1 CloudFront + API Gateway パターン</a></li></ul></li><li><a href="#まとめ" class="table-of-contents__link toc-highlight">まとめ</a><ul><li><a href="#学んだこと" class="table-of-contents__link toc-highlight">学んだこと</a></li><li><a href="#重要なポイント" class="table-of-contents__link toc-highlight">重要なポイント</a></li><li><a href="#ベストプラクティス" class="table-of-contents__link toc-highlight">ベ  ストプラクティス</a></li><li><a href="#次のステップ" class="table-of-contents__link toc-highlight">次のステップ</a></li><li><a href="#参考リンク" class="table-of-contents__link toc-highlight">参考リンク</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>