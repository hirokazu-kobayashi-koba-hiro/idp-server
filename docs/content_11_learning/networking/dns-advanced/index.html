<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_11_learning/networking/dns-advanced" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">DNS詳細: CNAME、DNSSECとクラウドDNS | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/dns-advanced"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DNS詳細: CNAME、DNSSECとクラウドDNS | IdP-Server Documentation"><meta data-rh="true" name="description" content="所要時間"><meta data-rh="true" property="og:description" content="所要時間"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/dns-advanced"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/dns-advanced" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/networking/dns-advanced" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.1ebf0894.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.7a8534db.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ドキュメントガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">content_01_intro</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">content_02_quickstart</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/foundation/concept-01-multi-tenant">content_03_concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">content_04_protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/idp-server/docs/content_05_how-to/">How-to ガイド - 学習ロードマップ</a><button aria-label="&#x27;How-to ガイド - 学習ロードマップ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/idp-server/docs/content_06_developer-guide/">開発者ガイドマップ</a><button aria-label="&#x27;開発者ガイドマップ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference/api-authentication-device-ja">content_07_reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/commercial-deployment/overview">content_08_ops</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/analytics-statistics-design">content_09_project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">content_10_ai_developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">content_11_learning</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">identity-basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-fundamentals/modern-web-authz-authn">oauth-fundamentals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-tokens/id-token-jwt">oauth-tokens</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/openid-connect/oauth-oidc-basics">openid-connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/fido-webauthn/fido2-architecture-rp-browser-authenticator">fido-webauthn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/security/">セキュリティ学習コンテンツ</a><button aria-label="&#x27;セキュリティ学習コンテンツ&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/multi-tenancy/multi-tenancy-basics">multi-tenancy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/advanced-protocols/ciba-basics">advanced-protocols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/http-rest/http-basics">http-rest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jwt-jose/jwt-introduction">jwt-jose</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/postgresql/">PostgreSQL 学習ガイド</a><button aria-label="&#x27;PostgreSQL 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/crypto/">暗号化（Cryptography）学習ガイド</a><button aria-label="&#x27;暗号化（Cryptography）学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/kubernetes/">コンテナ/Kubernetes 学習ガイド</a><button aria-label="&#x27;コンテナ/Kubernetes 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/linux/">Linux 学習ガイド</a><button aria-label="&#x27;Linux 学習ガイド&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/idp-server/docs/content_11_learning/networking/">ネットワーク学習ガイド</a><button aria-label="&#x27;ネットワーク学習ガイド&#x27;の目次を隠す" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/dns-fundamentals">DNS基礎</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_11_learning/networking/dns-advanced">DNS詳細: CNAME、DNSSECとクラウドDNS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/load-balancing">ロードバランシング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/ssl-tls-certificates">SSL/TLS証明書管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/api-gateway-networking">API Gatewayとネットワーキング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/networking/network-troubleshooting">ネットワークトラブルシューティング</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth/OIDC RFC学習</a><button aria-label="&#x27;OAuth/OIDC RFC学習&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_20_testing/e2e-test-coverage">content_20_testing</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">はじめに</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">content_11_learning</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/idp-server/docs/content_11_learning/networking/"><span itemprop="name">ネットワーク学習ガイド</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">DNS詳細: CNAME、DNSSECとクラウドDNS</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>DNS詳細: CNAME、DNSSECとクラウドDNS</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="所要時間">所要時間<a href="#所要時間" class="hash-link" aria-label="所要時間 への直接リンク" title="所要時間 への直接リンク">​</a></h2>
<p>約50分</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="学べること">学べること<a href="#学べること" class="hash-link" aria-label="学べること への直接リンク" title="学べること への直接リンク">​</a></h2>
<ul>
<li>CNAMEレコードの詳細仕様と制約</li>
<li>CNAMEに関連する実践的な問題と対策（AWS Advanced JDBC Wrapper含む）</li>
<li>DNSSEC（DNS Security Extensions）の基礎</li>
<li>AWS Route 53の実践的な使い方</li>
<li>クラウド環境でのDNSベストプラクティス</li>
<li>プライベートDNSとサービスディスカバリー</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前提知識">前提知識<a href="#前提知識" class="hash-link" aria-label="前提知識 への直接リンク" title="前提知識 への直接リンク">​</a></h2>
<ul>
<li><a href="/idp-server/docs/content_11_learning/networking/dns-fundamentals">01-dns-fundamentals.md</a> の内容</li>
<li>基本的なクラウドサービスの理解</li>
<li>データベース接続の基礎知識</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-cnameレコードの詳細">1. CNAMEレコードの詳細<a href="#1-cnameレコードの詳細" class="hash-link" aria-label="1. CNAMEレコードの詳細 への直接リンク" title="1. CNAMEレコードの詳細 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-cnameの基本仕様">1.1 CNAMEの基本仕様<a href="#11-cnameの基本仕様" class="hash-link" aria-label="1.1 CNAMEの基本仕様 への直接リンク" title="1.1 CNAMEの基本仕様 への直接リンク">​</a></h3>
<p><strong>CNAME（Canonical Name）レコード</strong>は、一般的なDNS仕様として RFC 1034/1035 で定義されています。AWSやクラウド固有の機能ではなく、<strong>標準的なDNSレコードタイプ</strong>です。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  CNAME の基本動作                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【設定例】                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  www.example.com.    IN  CNAME  example.com.                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  A      93.184.216.34               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【名前解決の流れ】                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント: www.example.com のIPは?                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─► (1) www.example.com を問い合わせ                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │   応答: CNAME → example.com                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─► (2) example.com を問い合わせ                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │   応答: A → 93.184.216.34                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      │                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      └─► 最終結果: 93.184.216.34                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ※ 通常、DNSリゾルバが自動的に(2)まで実行してくれる          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-cnameの重要な制約">1.2 CNAMEの重要な制約<a href="#12-cnameの重要な制約" class="hash-link" aria-label="1.2 CNAMEの重要な制約 への直接リンク" title="1.2 CNAMEの重要な制約 への直接リンク">​</a></h3>
<p>CNAMEには、RFC 1034 で定義された<strong>重要な制約</strong>があります。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="制約1-他のレコードとの共存禁止">制約1: 他のレコードとの共存禁止<a href="#制約1-他のレコードとの共存禁止" class="hash-link" aria-label="制約1: 他のレコードとの共存禁止 への直接リンク" title="制約1: 他のレコードとの共存禁止 への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│            CNAME と他のレコードの共存禁止                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ❌ 禁止例1: CNAMEとAレコードの共存                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  www.example.com.    IN  CNAME  example.com.                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  www.example.com.    IN  A      93.184.216.34               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 設定できない（DNSサーバーがエラー）                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ❌  禁止例2: CNAMEとMXレコードの共存                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  CNAME  other.com.                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  MX     10 mail.example.com.        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 設定できない                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ❌ 禁止例3: ゾーンAPEXにCNAME（後述）                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  CNAME  other.com.                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 技術的に問題あり（NS, SOAレコードと競合）                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ✅ 正しい例: サブドメインにCNAME                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  www.example.com.    IN  CNAME  example.com.                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  A      93.184.216.34               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.        IN  MX     10 mail.example.com.        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → サブドメイン(www)にCNAME、APEXに他のレコード              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="制約2-cnameチェーンの問題">制約2: CNAMEチェーンの問題<a href="#制約2-cnameチェーンの問題" class="hash-link" aria-label="制約2: CNAMEチェーンの問題 への直接リンク" title="制約2: CNAMEチェーンの問題 への直接リンク">​</a></h4>
<p>CNAMEが別のCNAMEを指すことは可能ですが、推奨されません。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># CNAMEチェーンの例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www.example.com.     IN  CNAME  www-prod.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www-prod.example.com. IN CNAME  lb-12345.us-east-1.elb.amazonaws.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lb-12345.us-east-1.elb.amazonaws.com. IN A 52.1.2.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 問題点:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1. DNS問い合わせが複数回発生（パフォーマンス低下）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. TTL管理が複雑になる</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. デバッグが困難</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. RFC 1034では推奨されていない</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-ゾーンapexとcnameの問題">1.3 ゾーンAPEXとCNAMEの問題<a href="#13-ゾーンapexとcnameの問題" class="hash-link" aria-label="1.3 ゾーンAPEXとCNAMEの問題 への直接リンク" title="1.3 ゾーンAPEXとCNAMEの問題 への直接リンク">​</a></h3>
<p><strong>ゾーンAPEX</strong>（zone apex / naked domain / root domain）は、サブドメインを含まないドメイン名（例：example.com）のことです。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              ゾーンAPEXにCNAMEを設定できない理由              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【問題となるシナリオ】                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  CNAME  other.com.                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  NS     ns1.example.com.  ← 必  須         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  SOA    ...               ← 必須         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → CNAMEが存在する名前には、他のレコードを共存させられない   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → しかしNS/SOAレコードはゾーンAPEXに必須                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 矛盾が発生！                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【よくあるニーズ】                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com にアクセスしたユーザーを                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ロードバランサー（lb.cloudprovider.com）に向けたい          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ❌ 解決策1: CNAMEを使う（RFC違反、動作不定）                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  CNAME  lb.cloudprovider.com.           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ✅ 解決策2: Aレコードを使う（推奨）                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  A      52.1.2.3                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ✅ 解決策3: ALIASレコード（Route 53等の拡張機能）           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.    IN  ALIAS  lb.cloudprovider.com.           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 次節で詳述                                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-cnameの実践的な使い方">1.4 CNAMEの実践的な使い方<a href="#14-cnameの実践的な使い方" class="hash-link" aria-label="1.4 CNAMEの実践的な使い方 への直接リンク" title="1.4 CNAMEの実践的な使い方 への直接リンク">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ユースケース1: CDNへのマッピング</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www.example.com.     IN  CNAME  d111111abcdef8.cloudfront.net.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ユースケース2: サブドメインの統合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">blog.example.com.    IN  CNAME  example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">shop.example.com.    IN  CNAME  example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ユースケース3: 複数環境の管理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app-dev.example.com.  IN  CNAME  dev-lb.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app-stg.example.com.  IN  CNAME  stg-lb.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app-prod.example.com. IN  CNAME  prod-lb.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ユースケース4: サービス移行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 旧システムから新システムへの段階的移行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">legacy.example.com.   IN  CNAME  old-server.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 移行後</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">legacy.example.com.   IN  CNAME  new-server.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 確認コマンド</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig www.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 出力例:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ;; ANSWER SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># www.example.com.      300  IN  CNAME  d111111abcdef8.cloudfront.net.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># d111111abcdef8.cloudfront.net. 60 IN A 52.84.123.45</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-cnameに関連する実践的な問題">2. CNAMEに関連する実践的な問題<a href="#2-cnameに関連する実践的な問題" class="hash-link" aria-label="2. CNAMEに関連する実践的な問題 への直接リンク" title="2. CNAMEに関連する実践的な問題 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-aws-advanced-jdbc-wrapperとcnameの問題">2.1 AWS Advanced JDBC WrapperとCNAMEの問題<a href="#21-aws-advanced-jdbc-wrapperとcnameの問題" class="hash-link" aria-label="2.1 AWS Advanced JDBC WrapperとCNAMEの問題 への直接リンク" title="2.1 AWS Advanced JDBC WrapperとCNAMEの問題 への直接リンク">​</a></h3>
<p><strong>AWS Advanced JDBC Wrapper</strong>は、RDS Proxy、Aurora、フェイルオーバー機能を提供するJDBCドライバーのラッパーです。このラッパーには、<strong>CNAMEレコードに対する特殊な動作</strong>があります。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      AWS Advanced JDBC Wrapper の CNAME処理動作              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【問題のシナリオ】                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  DNS設定:                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  db.example.com.  IN  CNAME  my-db.cluster-xxx.us-east-1.   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                               rds.amazonaws.com.             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  アプリケーション設定:                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  jdbc:aws-wrapper:postgresql://db.example.com:5432/mydb     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【何が起こるか】                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. DNS解決: db.example.com → CNAME検出                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. CNAME先を取得: my-db.cluster-xxx.us-east-1.rds.amazonaws.com │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. ⚠️ ラッパーがCNAME先のホスト名を使用                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. SSL証明書検証で、元のホスト名(db.example.com)ではなく   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     CNAME先(*.rds.amazonaws.com)で検証される                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  5. トポロジー検出（クラスタ構成の把握）にも影響             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【問題点】                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - CNAME先のホスト名がアプリケーションに露出                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - フェイルオーバー検知に影響する可能性                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 意図しない動作につながる                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="実際のエラー例">実際のエラー例<a href="#実際のエラー例" class="hash-link" aria-label="実際のエラー例 への直接リンク" title="実際のエラー例 への直接リンク">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Java アプリケ  ーションログ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Caused by: javax.net.ssl.SSLHandshakeException:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  No subject alternative DNS name matching db.example.com found.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Certificate is valid for *.rds.amazonaws.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// または</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FATAL: SSL connection failed:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server certificate for &quot;*.rds.amazonaws.com&quot; does not match host name &quot;db.example.com&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="対策方法">対策方法<a href="#対策方法" class="hash-link" aria-label="対策方法 への直接リンク" title="対策方法 への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">対策1: CNAMEを使わず、Aレコードを使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ❌ db.example.com.  IN  CNAME  my-db.cluster-xxx.us-east-1.rds.amazonaws.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ db.example.com.  IN  A      10.0.1.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  利点: DNS標準に準拠、問題が起きにくい</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  欠点: IPアドレスが変わった場合に手動更新が必要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策2: Route 53 ALIASレコードを使用（AWSの場合）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ db.example.com.  IN  ALIAS  my-db.cluster-xxx.us-east-1.rds.amazonaws.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  利点: 自動的にIPアドレス追従、CNAMEの制約なし</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  欠点: Route 53専用機能（他のDNSサービスでは使えない）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策3: RDS Proxyを使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RDS Proxy経由で接続することで、エンドポイントが安定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ jdbc:aws-wrapper:postgresql://my-rds-proxy.proxy-xxx.us-east-1.rds.amazonaws.com:5432/mydb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策4: JDBC接続パラメータでSSL検証を調整（非推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ⚠️ jdbc:aws-wrapper:postgresql://db.example.com:5432/mydb?ssl=true&amp;sslmode=require&amp;sslrootcert=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  欠点: セキュリティリスク、本質的な解決ではない</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-その他のcname問題例">2.2 その他のCNAME問題例<a href="#22-その他のcname問題例" class="hash-link" aria-label="2.2 その他のCNAME問題例 への直接リンク" title="2.2 その他のCNAME問題例 への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="問題1-メール配送とcname">問題1: メール配送とCNAME<a href="#問題1-メール配送とcname" class="hash-link" aria-label="問題1: メール配送とCNAME への直接リンク" title="問題1: メール配送とCNAME への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ❌ 間違った設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.    IN  CNAME  mail.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.    IN  MX     10 mail.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ CNAMEとMXが共存できないため、メールが届かない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ✅ 正しい設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.    IN  A      93.184.216.34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.    IN  MX     10 mail.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mail.example.com. IN A    93.184.216.35</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコ ピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="問題2-httpリダイレクトとcname">問題2: HTTPリダイレクトとCNAME<a href="#問題2-httpリダイレクトとcname" class="hash-link" aria-label="問題2: HTTPリダイレクトとCNAME への直接リンク" title="問題2: HTTPリダイレクトとCNAME への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># シナリオ: example.com → www.example.com にリダイレクトしたい</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ❌ CNAMEだけでは不可能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.    IN  CNAME  www.example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ DNSレベルではリダイレクトできない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ HTTPレベルの処理が必要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ✅ 正しいアプローチ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 1. DNSで両方のホストを設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.     IN  A      93.184.216.34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www.example.com. IN  A      93.184.216.34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. Webサーバーでリダイレクト設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Nginx例:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return 301 https://www.example.com$request_uri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Apache例:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;VirtualHost *:80&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ServerName example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Redirect permanent / https://www.example.com/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/VirtualHost&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="問題3-cdnとcname設定ミス">問題3: CDNとCNAME設定ミス<a href="#問題3-cdnとcname設定ミス" class="hash-link" aria-label="問題3: CDNとCNAME設定ミス への直接リンク" title="問題3: CDNとCNAME設定ミス への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ❌ よくある間違い</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www.example.com.  IN  CNAME  example.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.      IN  CNAME  d111111abcdef8.cloudfront.net.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ CNAMEチェーンが発生、パフォーマンス低下</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ✅ 正しい設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www.example.com.  IN  CNAME  d111111abcdef8.cloudfront.net.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.      IN  A      52.84.123.45  # CloudFrontのIPまたはALIAS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-aws-route-53">3. AWS Route 53<a href="#3-aws-route-53" class="hash-link" aria-label="3. AWS Route 53 への直接リンク" title="3. AWS Route 53 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-route-53の概要">3.1 Route 53の概要<a href="#31-route-53の概要" class="hash-link" aria-label="3.1 Route 53の概要 への直接リンク" title="3.1 Route 53の概要 への直接リンク">​</a></h3>
<p><strong>Amazon Route 53</strong>は、AWSが提供する高可用性でスケーラブルなDNSサービスです。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  Route 53 の主要機能                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. 権威DNSサービス                                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - ドメインのホストゾーン管理                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - 高可用性（複数のAZに分散）                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - SLA 100%                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. ドメイン登録                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - gTLD/ccTLDの登録・管理                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. ヘルスチェック                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - エンドポイントの監視                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - 障害検知とフェイルオーバー                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. トラフィックポリシー                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - ルーティングポリシー（後述）                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - 地理的ルーティング                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│     - レイテンシーベースルーティング                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-aliasレコードroute-53拡張機能">3.2 ALIASレコード（Route 53拡張機能）<a href="#32-aliasレコードroute-53拡張機能" class="hash-link" aria-label="3.2 ALIASレコード（Route 53拡張機能） への直接リンク" title="3.2 ALIASレコード（Route 53拡張機能） への直接リンク">​</a></h3>
<p><strong>ALIASレコード</strong>は、Route 53独自の機能で、CNAMEの制約を回避しつつ、AWSリソースへのマッピングを提供します。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              ALIAS vs CNAME vs A レコード                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  項目              │ A      │ CNAME  │ ALIAS                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ─────────────────┼────────┼────────┼──────────────────    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ゾーンAPEXで使用  │ ✅     │ ❌     │ ✅                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  他レコードと共存  │ ✅     │ ❌     │ ✅（一部）            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  IPアドレス指定    │ ✅     │ ❌     │ 自動解決              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  DNS問い合わせ回数 │ 1回    │ 2回以上│ 1回                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Route 53課金     │ 有料   │ 有料   │ AWSリソース宛は無料   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  標準DNS仕様      │ ✅     │ ✅     │ ❌（Route 53専用）    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【ALIAS使用例】                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com.  ALIAS  my-alb-123.us-east-1.elb.amazonaws.com │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  内部動作:                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  1. クライアント: example.com のIPは?                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  2. Route 53: ALIASを検出                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  3. Route 53: ELBのIPアドレスを自動取得                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  4. Route 53: Aレコードとして応答（例: 52.1.2.3）           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → クライアントからは通常のAレコードに見える                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aliasレコード対応awsサービス">ALIASレコード対応AWSサービス<a href="#aliasレコード対応awsサービス" class="hash-link" aria-label="ALIASレコード対応AWSサービス への直接リンク" title="ALIASレコード対応AWSサービス への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- CloudFront ディストリビューション</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Elastic Load Balancing (ALB, NLB, CLB)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- API Gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- VPC エンドポイント</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- S3 Webサイトエンドポイント</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 同一ホストゾーン内の他のレコード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Global Accelerator</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="alias設定例aws-cli">ALIAS設定例（AWS CLI）<a href="#alias設定例aws-cli" class="hash-link" aria-label="ALIAS設定例（AWS CLI） への直接リンク" title="ALIAS設定例（AWS CLI） への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ALIASレコードを作成（JSON形式）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; alias-record.json &lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Changes&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Action&quot;: &quot;CREATE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ResourceRecordSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Name&quot;: &quot;example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Type&quot;: &quot;A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;AliasTarget&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;HostedZoneId&quot;: &quot;Z35SXDOTRQ7X7K&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;DNSName&quot;: &quot;my-alb-123.us-east-1.elb.amazonaws.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;EvaluateTargetHealth&quot;: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 change-resource-record-sets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z1234567890ABC \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --change-batch file://alias-record.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig example.com +short</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 52.1.2.3  ← ALBのIPアドレスが直接返される</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-ルーティングポリシー">3.3 ルーティングポリシー<a href="#33-ルーティングポリシー" class="hash-link" aria-label="3.3 ルーティングポリシー への直接リンク" title="3.3 ルーティングポリシー への直接リンク">​</a></h3>
<p>Route 53は、複数の高度なルーティングポリシーをサポートしています。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="シンプルルーティング">シンプルルーティング<a href="#シンプルルーティング" class="hash-link" aria-label="シンプルルーティング への直接リンク" title="シンプルルーティング への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">最も基本的なルーティング。1つのレコードに複数の値を返す。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.  A  192.0.2.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.  A  192.0.2.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">example.com.  A  192.0.2.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ 全てのIPアドレスがランダムな順序でクライアントに返される</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="加重ルーティングweighted-routing">加重ルーティング（Weighted Routing）<a href="#加重ルーティングweighted-routing" class="hash-link" aria-label="加重ルーティング（Weighted Routing） への直接リンク" title="加重ルーティング（Weighted Routing） への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  加重ルーティング                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  トラフィックを重み付けして分散                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  レコード1: example.com  A  192.0.2.1  (重み: 70)           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  レコード2: example.com  A  192.0.2.2  (重み: 20)           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  レコード3: example.com  A  192.0.2.3  (重み: 10)           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  結果:                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  70%のトラフィック → 192.0.2.1                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  20%のトラフィック → 192.0.2.2                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  10%のトラフィック → 192.0.2.3                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ユースケース:                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - カナリアリリース（新バージョンに10%のトラフィック）       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - A/Bテスト                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - サーバー能力に応じた負荷分散                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="レイテンシーベースルーティング">レイテンシーベースルーティング<a href="#レイテンシーベースルーティング" class="hash-link" aria-label="レイテンシーベースルーティング への直接リンク" title="レイテンシーベースルーティング への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              レイテンシーベースルーティング                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアントから最も近い（低レイテンシー）リージョンに      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  トラフィックをルーティング                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  設定例:                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com  A  52.1.2.3   (us-east-1)                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com  A  13.2.3.4   (ap-northeast-1)                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com  A  18.3.4.5   (eu-west-1)                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント              応答                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  東京          →  13.2.3.4  (ap-northeast-1)                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ニューヨーク  →  52.1.2.3  (us-east-1)                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ロンドン      →  18.3.4.5  (eu-west-1)                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="フェイルオーバールーティング">フェイルオーバールーティング<a href="#フェイルオーバールーティング" class="hash-link" aria-label="フェイルオーバールーティング への直接リンク" title="フェイルオーバールーティング への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># プライマリ/セカンダリ構成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ヘルスチェックでプライマリが異常の場合、セカンダリを返す</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># プライマリレコー ド</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 change-resource-record-sets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z1234567890ABC \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --change-batch &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Changes&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Action&quot;: &quot;CREATE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ResourceRecordSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Name&quot;: &quot;example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Type&quot;: &quot;A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;SetIdentifier&quot;: &quot;Primary&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Failover&quot;: &quot;PRIMARY&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;TTL&quot;: 60,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ResourceRecords&quot;: [{&quot;Value&quot;: &quot;192.0.2.1&quot;}],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;HealthCheckId&quot;: &quot;abc-123-def&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># セカンダリレコード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># (同様にFailover: &quot;SECONDARY&quot;で設定)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ヘルスチェック作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 create-health-check \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --health-check-config \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IPAddress=192.0.2.1,Port=443,Type=HTTPS,ResourcePath=/health</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="地理的ルーティングgeolocation">地理的ルーティング（Geolocation）<a href="#地理的ルーティングgeolocation" class="hash-link" aria-label="地理的ルーティング（Geolocation） への直接リンク" title="地理的ルーティング（Geolocation） への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  地理的ルーティング                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアントの地理的位置に基づいてルーティング              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  設定例:                                                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 日本からのアクセス → jp-server.example.com               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 米国からのアクセス → us-server.example.com                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - その他の地域       → default-server.example.com          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ユースケース:                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - コンテンツのローカライゼーション                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - 規制対応（特定国からのアクセス制御）                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  - パフォーマンス最適化                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-route-53プライベートホストゾーン">3.4 Route 53プライベートホストゾーン<a href="#34-route-53プライベートホストゾーン" class="hash-link" aria-label="3.4 Route 53プライベートホストゾーン への直接リンク" title="3.4 Route 53プライベートホストゾーン への直接リンク">​</a></h3>
<p>VPC内でのみ解決可能なプライベートDNSゾーンを作成できます。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># プライベートホストゾーン作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 create-hosted-zone \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name internal.example.com \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vpc VPCRegion=us-east-1,VPCId=vpc-1234567890abcdef0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --caller-reference &quot;$(date +%s)&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-config PrivateZone=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># レコード作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 change-resource-record-sets \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z9876543210ZYX \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --change-batch &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Changes&quot;: [{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;Action&quot;: &quot;CREATE&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ResourceRecordSet&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Name&quot;: &quot;db.internal.example.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;Type&quot;: &quot;A&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;TTL&quot;: 300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;ResourceRecords&quot;: [{&quot;Value&quot;: &quot;10.0.1.10&quot;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># VPC内のEC2インスタンスから解決可能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig db.internal.example.com +short</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 10.0.1.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>プライベートホストゾーンのユースケース</strong>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- RDSエンドポイントのカスタムドメイン</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 内部APIエンドポイント</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 内部マイクロサービス間通信</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 開発/ステージング環境の分離</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-dnssecdns-security-extensions">4. DNSSEC（DNS Security Extensions）<a href="#4-dnssecdns-security-extensions" class="hash-link" aria-label="4. DNSSEC（DNS Security Extensions） への直接リンク" title="4. DNSSEC（DNS Security Extensions） への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-dnssecの基本概念">4.1 DNSSECの基本概念<a href="#41-dnssecの基本概念" class="hash-link" aria-label="4.1 DNSSECの基本概念 への直接リンク" title="4.1 DNSSECの基本概念 への直接リンク">​</a></h3>
<p><strong>DNSSEC</strong>は、DNSレスポンスの真正性と完全性を保証するための拡張機能です。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  DNSSEC の仕組み                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【DNSSECなし】                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント ← [応答] ← DNSサーバー                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 応答が本物か偽物か判断できない                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【DNSSECあり】                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント ← [応答 + デジタル署名] ← DNSサーバー          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → デジタル署名を検証することで、応答の真正性を確認          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【信頼の連鎖（Chain of Trust）】                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  . (ルート)  ← ルートキーで署名                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ├─→ .com  ← ルートが署名                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│         │                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│         ├─→ example.com  ← .comが署名                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              │                                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              ├─→ www.example.com  ← example.comが署名        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  各階層が下位階層の公開鍵に署名することで、                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ルートから葉まで信頼を伝搬                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-dnssecのレコードタイプ">4.2 DNSSECのレコードタイプ<a href="#42-dnssecのレコードタイプ" class="hash-link" aria-label="4.2 DNSSECのレコードタイプ への直接リンク" title="4.2 DNSSECのレコードタイプ への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RRSIG (Resource Record Signature)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - DNSレコードのデジタル署名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNSKEY (DNS Public Key)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ゾーンの公開鍵</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ZSK (Zone Signing Key): レコードに署名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - KSK (Key Signing Key): DNSKEYに署名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DS (Delegation Signer)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 子ゾーン  の公開鍵のハッシュ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 親ゾーンに設定して信頼の連鎖を構築</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NSEC / NSEC3 (Next Secure)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 存在しないドメイン名の証明（NXDOMAIN認証）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-dnssec検証">4.3 DNSSEC検証<a href="#43-dnssec検証" class="hash-link" aria-label="4.3 DNSSEC検証 への直接リンク" title="4.3 DNSSEC検証 への直接リンク">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># DNSSECが有効か確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig example.com +dnssec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 出力例（DNSSEC有効）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ;; ANSWER SECTION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># example.com.    3600  IN  A     93.184.216.34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># example.com.    3600  IN  RRSIG A 13 2 3600 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#                           ↑ デジタル署名が付いている</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DNSSEC検証を有効にしてクエリ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig @8.8.8.8 example.com +dnssec +multiline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DNSSECキーの確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig example.com DNSKEY +short</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DSレコードの確認（親ゾーンに設定されている）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig example.com DS +short</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-route-53でのdnssec設定">4.4 Route 53でのDNSSEC設定<a href="#44-route-53でのdnssec設定" class="hash-link" aria-label="4.4 Route 53でのDNSSEC設定 への直接リンク" title="4.4 Route 53でのDNSSEC設定 への直接リンク">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. ホストゾーンでDNSSECを有効化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 enable-hosted-zone-dnssec \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z1234567890ABC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. KSK（キー署名鍵）を作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws route53 create-key-signing-key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --hosted-zone-id Z1234567890ABC \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name example-ksk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --status ACTIVE \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --key-management-service-arn arn:aws:kms:us-east-1:123456789012:key/...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. 親ゾーン（レジストラ）にDSレコードを設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Route 53コンソールでDSレコード情報を取得し、ドメインレジストラに設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. DNSSEC検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig @8.8.8.8 example.com +dnssec +multiline</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-サービスディスカバリーとプライベートdns">5. サービスディスカバリーとプライベートDNS<a href="#5-サービスディスカバリー とプライベートdns" class="hash-link" aria-label="5. サービスディスカバリーとプライベートDNS への直接リンク" title="5. サービスディスカバリーとプライベートDNS への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-aws-cloud-map">5.1 AWS Cloud Map<a href="#51-aws-cloud-map" class="hash-link" aria-label="5.1 AWS Cloud Map への直接リンク" title="5.1 AWS Cloud Map への直接リンク">​</a></h3>
<p><strong>AWS Cloud Map</strong>は、クラウドリソースのサービスディスカバリーを提供します。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                  AWS Cloud Map の動作                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【サービス登録】                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ECS Task/K8s Pod起動                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ↓                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Cloud Map にサービスインスタンス登録                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ↓                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  DNSレコード自動作成                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  api.service.local  →  10.0.1.10 (Task IP)                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【サービス発見】                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  クライアント: api.service.local のIPは?                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ↓                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  Route 53 / Cloud Map が応答                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ↓                                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  10.0.1.10 に接続                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【ヘルスチェック統合】                                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  不健全なインスタンスは自動的にDNSから除外                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-map設定例">Cloud Map設定例<a href="#cloud-map設定例" class="hash-link" aria-label="Cloud Map設定例 への直接リンク" title="Cloud Map設定例 への直接リンク">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 1. ネームスペース作成（プライベートDNS）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws servicediscovery create-private-dns-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name service.local \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --vpc vpc-1234567890abcdef0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2. サービス作成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws servicediscovery create-service \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name api \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace-id ns-abc123 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dns-config \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;NamespaceId=ns-abc123,DnsRecords=[{Type=A,TTL=60}]&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --health-check-custom-config FailureThreshold=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 3. サービスインスタンス登録（通常はECS/EKSが自動実行）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws servicediscovery register-instance \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-id srv-xyz789 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --instance-id i-1234567890abcdef0 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --attributes \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;AWS_INSTANCE_IPV4=10.0.1.10,AWS_INSTANCE_PORT=8080&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 4. DNSクエリ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dig api.service.local +short</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 10.0.1.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-kubernetesサービスディスカバリー">5.2 Kubernetesサービスディスカバリー<a href="#52-kubernetesサービスディスカバリー" class="hash-link" aria-label="5.2 Kubernetesサービスディスカバリー への直接リンク" title="5.2 Kubernetesサービスディスカバリー への直接リンク">​</a></h3>
<p>Kubernetes（EKS含む ）は、内部DNSベースのサービスディスカバリーを提供します。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          Kubernetes Service Discovery                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【DNS名の形式】                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  &lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  例:                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  api-service.default.svc.cluster.local                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  db-service.production.svc.cluster.local                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【省略形】                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  同一Namespace内:  &lt;service-name&gt;                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  異なるNamespace:  &lt;service-name&gt;.&lt;namespace&gt;                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【SRVレコード】                                             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  _&lt;port-name&gt;._&lt;protocol&gt;.&lt;service&gt;.&lt;namespace&gt;.svc.cluster.local │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  例:                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  _http._tcp.api-service.default.svc.cluster.local            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Kubernetes Service定義</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Podから接続</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> API_URL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://api-service:80&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 同一Namespace内なので省略形</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Pod内からDNS解決テスト</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl exec -it client -- nslookup api-service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Name:      api-service.production.svc.cluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Address 1: 10.100.200.50 api-service.production.svc.cluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># SRVレコード確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl exec -it client -- nslookup -type=SRV _http._tcp.api-service.production.svc.cluster.local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-dns最適化とベストプラクティス">6. DNS最適化とベストプラクティス<a href="#6-dns最適化とベストプラクティス" class="hash-link" aria-label="6. DNS最適化とベストプラクティス への直接リンク" title="6. DNS最適化とベストプラクティス への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-ttl最適化">6.1 TTL最適化<a href="#61-ttl最適化" class="hash-link" aria-label="6.1 TTL最適化 への直接リンク" title="6.1 TTL最適化 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">シナリオ別のTTL推奨値:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌────────────────────┬──────┬─────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 用途               │ TTL  │ 理由                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────┼──────┼─────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 本番Webサイト      │ 3600-│ キャッシュ効率、コスト削減│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ (APEXドメイン)     │86400 │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────┼──────┼─────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 本番API            │ 300- │ 柔軟な変更対応           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │                    │ 3600 │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────┼──────┼─────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ロードバランサー   │ 60-  │ ヘルスチェック連動       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ (ELB等)            │ 300  │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────┼──────┼─────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 開発/検証環境      │ 60-  │ 頻繁な変更対応           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                    │ 300  │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────┼──────┼─────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ フェイルオーバー   │ 60   │ 高速切り替え             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ レコード           │      │                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────────────────┴──────┴─────────────────  ────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-dns問い合わせの削減">6.2 DNS問い合わせの削減<a href="#62-dns問い合わせの削減" class="hash-link" aria-label="6.2 DNS問い合わせの削減 への直接リンク" title="6.2 DNS問い合わせの削減 への直接リンク">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// アプリケーション側のDNSキャッシュ設定例</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Java - JVM DNSキャッシュ設定（システムプロパティ）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 成功時のキャッシュTTL（秒、-1=無期限、0=キャッシュなし）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Dsun.net.inetaddr.ttl=60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 失敗時のキャッシュTTL（秒）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Dsun.net.inetaddr.negative.ttl=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// セキュリティマネージャ有効時のデフォルトTTL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// デフォルト: 30秒（セキュリティ対策でキャッシュを長くしない）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// プログラムから設定（Security.setProperty）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.security.Security;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Security.setProperty(&quot;networkaddress.cache.ttl&quot;, &quot;60&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Security.setProperty(&quot;networkaddress.cache.negative.ttl&quot;, &quot;10&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Python - DNSキャッシュ（aiodns使用例）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> asyncio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> aiodns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DNSリゾルバをアプリケーション起動時に作成（キャッシュ共有）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">resolver </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> aiodns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DNSResolver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">resolve_hostname</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gethostbyname</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> socket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AF_INET</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addresses</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> aiodns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DNSError </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;DNS resolution failed: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコ  ピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-マルチリージョン構成のdns設計">6.3 マルチリージョン構成のDNS設計<a href="#63-マルチリージョン構成のdns設計" class="hash-link" aria-label="6.3 マルチリージョン構成のDNS設計 への直接リンク" title="6.3 マルチリージョン構成のDNS設計 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          マルチリージョンDNS設計パターン                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─────────────────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【パターン1: レイテンシーベースルーティング】               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  example.com                                                 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ├─► us-east-1  (52.1.2.3)   ← 北米ユーザー               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ├─► eu-west-1  (18.2.3.4)   ← ヨーロッパユーザー         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └─► ap-northeast-1 (13.3.4.5) ← アジアユーザー           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【パターン2: フェイルオーバー + レイテンシー】              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  プライマリ: us-east-1 (ヘルスチェックあり)                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  セカンダリ: us-west-2 (プライマリ障害時)                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  【パターン3: 加重 + フェイルオーバー（カナリア）】          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  旧バージ ョン: 90% (ヘルスチェックあり)                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  新バージョン: 10% (ヘルスチェックあり)                      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  → 新バージョンに問題があれば自動的に旧バージョンへ          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-dns監視とアラート">6.4 DNS監視とアラート<a href="#64-dns監視とアラート" class="hash-link" aria-label="6.4 DNS監視とアラート への直接リンク" title="6.4 DNS監視とアラート への直接リンク">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># CloudWatchでRoute 53メトリクスを監視</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># DNSクエリ数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws cloudwatch get-metric-statistics \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace AWS/Route53 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --metric-name Queries \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --dimensions Name=HostedZoneId,Value=Z1234567890ABC \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --start-time 2025-12-26T00:00:00Z \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --end-time 2025-12-26T23:59:59Z \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --period 3600 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --statistics Sum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ヘルスチェック失敗アラート</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aws cloudwatch put-metric-alarm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --alarm-name route53-health-check-failed \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --alarm-description &quot;Route 53 health check failed&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --metric-name HealthCheckStatus \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --namespace AWS/Route53 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --statistic Minimum \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --period 60 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --threshold 1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --comparison-operator LessThanThreshold \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --datapoints-to-alarm 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --evaluation-periods 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --alarm-actions arn:aws:sns:us-east-1:123456789012:alerts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="まとめ">まとめ<a href="#まとめ" class="hash-link" aria-label="まとめ への直接リンク" title="まとめ への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="学んだこと">学んだこと<a href="#学んだこと" class="hash-link" aria-label="学んだこと への直接リンク" title="学んだこと への直接リンク">​</a></h3>
<p>本章では、DNSの高度なトピックを学びました:</p>
<ul>
<li>
<p><strong>CNAMEレコードの詳細</strong></p>
<ul>
<li>CNAMEは標準的なDNS仕様（RFC 1034/1035）</li>
<li>他のレコードとの共存禁止、ゾーンAPEXでの制約</li>
<li>AWS Advanced JDBC WrapperでのCNAME問題と対策</li>
</ul>
</li>
<li>
<p><strong>AWS Route 53</strong></p>
<ul>
<li>ALIASレコード（Route 53独自機能でCNAME制約を回避）</li>
<li>高度なルーティングポリシー（加重、レイテンシー、フェイルオーバー等）</li>
<li>プライベートホストゾーンとVPC統合</li>
</ul>
</li>
<li>
<p><strong>DNSSEC</strong></p>
<ul>
<li>DNS応答の真正性・完全性の保証</li>
<li>信頼の連鎖（Chain of Trust）</li>
<li>Route 53でのDNSSEC有効化</li>
</ul>
</li>
<li>
<p><strong>サービスディスカバリー</strong></p>
<ul>
<li>AWS Cloud Mapによる動的サービス登録</li>
<li>KubernetesのDNSベースサービスディスカバリー</li>
</ul>
</li>
<li>
<p><strong>DNS最適化</strong></p>
<ul>
<li>TTL最適化、アプリケーション側キャッシュ</li>
<li>マルチリージョン構成のDNS設計パターン</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="重要なポイント">重要なポイント<a href="#重要なポイント" class="hash-link" aria-label="重要なポイント への直接リンク" title="重要なポイント への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1. CNAMEの制約を理解する</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - ゾーンAPEXでは使えない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 他のレコードと共存できない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - AWS Advanced JDBC Wrapperでは注意が必要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Route 53 ALIASを活用する</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - CNAMEの制約を回避</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - AWSリソースへの動的マッピング</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - DNS問い合わせが1回で済む</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 適切なルーティングポリシーを選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - レイテンシーベース: グローバルパフォーマンス</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - フェイルオーバー: 高可用性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 加重: カナリアリリース</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. セキュリティとパフォーマンスのバランス</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - DNSSEC: セキュリティ向上</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - TTL最適化: パフォーマンスとコスト削減</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="次のステップ">次のステップ<a href="#次のステップ" class="hash-link" aria-label="次のステップ への直接リンク" title="次のステップ への直接リンク">​</a></h3>
<ul>
<li><a href="/idp-server/docs/content_11_learning/networking/load-balancing">03-load-balancing.md</a> - ロードバランシングとDNSの連携</li>
<li><a href="/idp-server/docs/content_11_learning/networking/ssl-tls-certificates">04-ssl-tls-certificates.md</a> - SSL/TLS証明書管理</li>
<li><a href="/idp-server/docs/content_11_learning/networking/network-troubleshooting">06-network-troubleshooting.md</a> - DNSトラブルシューティング実践</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考リンク">参考リンク<a href="#参考リンク" class="hash-link" aria-label="参考リンク への直接リンク" title="参考リンク への直接リンク">​</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc1034" target="_blank" rel="noopener noreferrer">RFC 1034 - Domain Names - Concepts</a></li>
<li><a href="https://tools.ietf.org/html/rfc4033" target="_blank" rel="noopener noreferrer">RFC 4033-4035 - DNSSEC</a></li>
<li><a href="https://docs.aws.amazon.com/route53/" target="_blank" rel="noopener noreferrer">AWS Route 53 Documentation</a></li>
<li><a href="https://github.com/awslabs/aws-advanced-jdbc-wrapper" target="_blank" rel="noopener noreferrer">AWS Advanced JDBC Wrapper</a></li>
<li><a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/" target="_blank" rel="noopener noreferrer">Kubernetes DNS Specification</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/15-networking/02-dns-advanced.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_11_learning/networking/dns-fundamentals"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">DNS基礎</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_11_learning/networking/load-balancing"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">ロードバランシング</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#所要時間" class="table-of-contents__link toc-highlight">所要時間</a></li><li><a href="#学べること" class="table-of-contents__link toc-highlight">学べること</a></li><li><a href="#前提知識" class="table-of-contents__link toc-highlight">前提知識</a></li><li><a href="#1-cnameレコードの詳細" class="table-of-contents__link toc-highlight">1. CNAMEレコードの詳細</a><ul><li><a href="#11-cnameの基本仕様" class="table-of-contents__link toc-highlight">1.1 CNAMEの基本仕様</a></li><li><a href="#12-cnameの重要な制約" class="table-of-contents__link toc-highlight">1.2 CNAMEの重要な制約</a></li><li><a href="#13-ゾーンapexとcnameの問題" class="table-of-contents__link toc-highlight">1.3 ゾーンAPEXとCNAMEの問題</a></li><li><a href="#14-cnameの実践的な使い方" class="table-of-contents__link toc-highlight">1.4 CNAMEの実践的な使い方</a></li></ul></li><li><a href="#2-cnameに関連する実践的な問題" class="table-of-contents__link toc-highlight">2. CNAMEに関連する実践的な問題</a><ul><li><a href="#21-aws-advanced-jdbc-wrapperとcnameの問題" class="table-of-contents__link toc-highlight">2.1 AWS Advanced JDBC WrapperとCNAMEの問題</a></li><li><a href="#22-その他のcname問題例" class="table-of-contents__link toc-highlight">2.2 その他のCNAME問題例</a></li></ul></li><li><a href="#3-aws-route-53" class="table-of-contents__link toc-highlight">3. AWS Route 53</a><ul><li><a href="#31-route-53の概要" class="table-of-contents__link toc-highlight">3.1 Route 53の概要</a></li><li><a href="#32-aliasレコードroute-53拡張機能" class="table-of-contents__link toc-highlight">3.2 ALIASレコード（Route 53拡張機能）</a></li><li><a href="#33-ルーティングポリシー" class="table-of-contents__link toc-highlight">3.3 ルーティングポリシー</a></li><li><a href="#34-route-53プライベートホストゾーン" class="table-of-contents__link toc-highlight">3.4 Route 53プライベートホストゾーン</a></li></ul></li><li><a href="#4-dnssecdns-security-extensions" class="table-of-contents__link toc-highlight">4. DNSSEC（DNS Security Extensions）</a><ul><li><a href="#41-dnssecの基本概念" class="table-of-contents__link toc-highlight">4.1 DNSSECの基本概念</a></li><li><a href="#42-dnssecのレコードタイプ" class="table-of-contents__link toc-highlight">4.2 DNSSECのレコードタイプ</a></li><li><a href="#43-dnssec検証" class="table-of-contents__link toc-highlight">4.3 DNSSEC検証</a></li><li><a href="#44-route-53でのdnssec設定" class="table-of-contents__link toc-highlight">4.4 Route 53でのDNSSEC設定</a></li></ul></li><li><a href="#5-サービスディスカバリーとプライベートdns" class="table-of-contents__link toc-highlight">5. サービスディスカバリーとプライベートDNS</a><ul><li><a href="#51-aws-cloud-map" class="table-of-contents__link toc-highlight">5.1 AWS Cloud Map</a></li><li><a href="#52-kubernetesサービスディスカバリー" class="table-of-contents__link toc-highlight">5.2 Kubernetesサービスディスカバリー</a></li></ul></li><li><a href="#6-dns最適化とベストプラクティス" class="table-of-contents__link toc-highlight">6. DNS最適化とベストプラクティス</a><ul><li><a href="#61-ttl最適化" class="table-of-contents__link toc-highlight">6.1 TTL最適化</a></li><li><a href="#62-dns問い合わせの削減" class="table-of-contents__link toc-highlight">6.2 DNS問い合わせの削減</a></li><li><a href="#63-マルチリージョン構成のdns設計" class="table-of-contents__link toc-highlight">6.3 マルチリージョン構成のDNS設計</a></li><li><a href="#64-dns監視とアラート" class="table-of-contents__link toc-highlight">6.4 DNS監視とアラート</a></li></ul></li><li><a href="#まとめ" class="table-of-contents__link toc-highlight">まとめ</a><ul><li><a href="#学んだこと" class="table-of-contents__link toc-highlight">学んだこと</a></li><li><a href="#重要なポイント" class="table-of-contents__link toc-highlight">重要なポイント</a></li><li><a href="#次のステップ" class="table-of-contents__link toc-highlight">次のステップ</a></li><li><a href="#参考リンク" class="table-of-contents__link toc-highlight">参考リンク</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>