<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">redirect_uri 検証の仕様比較 | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="redirect_uri 検証の仕様比較 | IdP-Server Documentation"><meta data-rh="true" name="description" content="redirect_uri（リダイレクト URI）の検証方法は、OAuth 2.0 の歴史とともに厳格化されてきました。このドキュメントでは、各仕様における検証ルールの違いを比較し、セキュリティと利便性のバランスを考察します。"><meta data-rh="true" property="og:description" content="redirect_uri（リダイレクト URI）の検証方法は、OAuth 2.0 の歴史とともに厳格化されてきました。このドキュメントでは、各仕様における検証ルールの違いを比較し、セキュリティと利便性のバランスを考察します。"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.2a8c149f.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.e8b245c1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">はじめに</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ドキュメントガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">製品紹介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">クイックスタート</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/foundation/concept-01-multi-tenant">コア概念</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">認証・認可プロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_05_how-to/">How-to（設定・運用レシピ）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_06_developer-guide/">開発者ガイド</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference">リファレンス</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">学習（Learning）</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">アイデンティティ管理の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-fundamentals/modern-web-authz-authn">OAuth 2.0の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-tokens/id-token-jwt">OAuth 2.0トークン</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/openid-connect/oauth-oidc-basics">OpenID Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/fido-webauthn/fido2-architecture-rp-browser-authenticator">FIDO2/WebAuthn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/security/glossary">セキュリティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/multi-tenancy/multi-tenancy-basics">マルチテナント</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/advanced-protocols/ciba-basics">高度なプロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/http-rest/http-basics">HTTP/REST</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jwt-jose/jwt-introduction">JWT/JOSE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth/OIDC RFC学習</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth 2.0 / OpenID Connect RFC 学習ガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/core/rfc6749-oauth2-core">基礎（OAuth 2.0 Core）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/jose/rfc7515-jws">JWT/JOSE（署名・暗号化）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/client-auth/rfc7521-assertion-framework">クライアント認証</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/extensions/rfc7009-revocation">OAuth 2.0 拡張</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/oidc/back-channel-logout">OpenID Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/attack-patterns">セキュリティ</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/attack-patterns">OAuth 2.0 / OIDC 攻撃パターン</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/redirect-uri-validation">redirect_uri 検証の仕様比較</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/rfc9700-security-bcp">RFC 9700: OAuth 2.0 Security Best Current Practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/token-security">トークンセキュリティ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-advanced">高度なプロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced-identity/oid4vci">Advanced Identity</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/verifiable-credentials/">Verifiable Credentials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/data-formats/">データフォーマット</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/session-management/web-session-basics">セッション管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/postgresql/">PostgreSQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/crypto/">暗号化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/kubernetes/">コンテナ/Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/linux/">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/networking/">ネットワーク</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jvm/">JVM</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/ops-01-test-strategy">運用（Ops）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/project-01-faq">プロジェクト</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">AI</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">学習（Learning）</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OAuth/OIDC RFC学習</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">セキュリティ</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">redirect_uri 検証の仕様比較</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>redirect_uri 検証の仕様比較</h1></header>
<p>redirect_uri（リダイレクト URI）の検証方法は、OAuth 2.0 の歴史とともに厳格化されてきました。このドキュメントでは、各仕様における検証ルールの違いを比較し、セキュリティと利便性のバランスを考察します。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第1部-概要">第1部: 概要<a href="#第1部-概要" class="hash-link" aria-label="第1部: 概要 への直接リンク" title="第1部: 概要 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="なぜ-redirect_uri-の検証が重要なのか">なぜ redirect_uri の検証が重要なのか？<a href="#なぜ-redirect_uri-の検証が重要なのか" class="hash-link" aria-label="なぜ redirect_uri の検証が重要なのか？ への直接リンク" title="なぜ redirect_uri の検証が重要なのか？ への直接リンク">​</a></h3>
<p>redirect_uri は認可コードやトークンの送信先です。検証が甘いと、攻撃者が認可コードを自分のサーバーに送らせることができます。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">正常なフロー:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ユーザー → 認可サーバー → https://legitimate-app.com/callback?code=xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">攻撃（オープンリダイレクタ）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ユーザー → 認可サーバー → https://attacker.com/steal?code=xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            ↑ 認可コードが攻撃者に渡る</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="検証の厳格さスペクトラム">検証の厳格さスペクトラム<a href="#検証の厳格さスペクトラム" class="hash-link" aria-label="検証の厳格さスペクトラム への直接リンク" title="検証の厳格さスペクトラム への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">緩い                                                              厳格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> │                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ▼                                                                  ▼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 登録なし  │  │ 部分一致  │  │ 完全一致  │  │ 完全一致  │  │ 完全一致  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ (非推奨)  │  │ (RFC6749) │  │  (OIDC)  │  │ + 制約   │  │ + 制約   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          │  │          │  │          │  │ (BCP)    │  │ (FAPI)   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────┘  └──────────┘  └──────────┘  └──────────┘  └──────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">利便性: 高 ◄─────────────────────────────────────────────────► 低</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">安全性: 低 ◄─────────────────────────────────────────────────► 高</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-3986-uri-比較の基礎">RFC 3986: URI 比較の基礎<a href="#rfc-3986-uri-比較の基礎" class="hash-link" aria-label="RFC 3986: URI 比較の基礎 への直接リンク" title="RFC 3986: URI 比較の基礎 への直接リンク">​</a></h2>
<p>redirect_uri の検証を理解するには、まず URI の仕様である RFC 3986 を理解する必要があります。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uri-の構造">URI の構造<a href="#uri-の構造" class="hash-link" aria-label="URI の構造 への直接リンク" title="URI の構造 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  https://user:pass@example.com:8080/path/to/resource?query=value#fragment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─┬─┘   └───┬───┘ └────┬────┘└─┬┘└──────┬────────┘└─────┬─────┘└───┬───┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> scheme   userinfo     host   port      path           query      fragment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          └──────────┬──────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 authority</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>要素</th><th>説明</th><th>大文字小文字</th><th>RFC 3986 セクション</th></tr></thead><tbody><tr><td>scheme</td><td>プロトコル（http, https）</td><td>区別なし</td><td>3.1</td></tr><tr><td>userinfo</td><td>ユーザー情報（非推奨）</td><td>区別あり</td><td>3.2.1</td></tr><tr><td>host</td><td>ホスト名または IP</td><td>区別なし</td><td>3.2.2</td></tr><tr><td>port</td><td>ポート番号</td><td>-</td><td>3.2.3</td></tr><tr><td>path</td><td>リソースパス</td><td>区別あり</td><td>3.3</td></tr><tr><td>query</td><td>クエリパラメータ</td><td>区別あり</td><td>3.4</td></tr><tr><td>fragment</td><td>フラグメント識別子</td><td>区別あり</td><td>3.5</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uri-の比較方法rfc-3986-section-6">URI の比較方法（RFC 3986 Section 6）<a href="#uri-の比較方法rfc-3986-section-6" class="hash-link" aria-label="URI の比較方法（RFC 3986 Section 6） への直接リンク" title="URI の比較方法（RFC 3986 Section 6） への直接リンク">​</a></h3>
<p>RFC 3986 では URI を比較する 4 つの方法を定義しています。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-simple-string-comparison単純文字列比較">1. Simple String Comparison（単純文字列比較）<a href="#1-simple-string-comparison単純文字列比較" class="hash-link" aria-label="1. Simple String Comparison（単純文字列比較） への直接リンク" title="1. Simple String Comparison（単純文字列比較） への直接リンク">​</a></h4>
<blockquote>
<p>Two URIs are equivalent if they are <strong>identical character-by-character</strong>.</p>
</blockquote>
<p><strong>最も厳格な方法</strong>。文字単位で完全に一致するかを確認。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">比較対象: https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 一致: https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://EXAMPLE.COM/callback     ← 大文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com:443/callback ← デフォルトポート明示</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com/callback/    ← 末尾スラッシュ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com/Callback     ← パスの大文字小文字</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>OAuth 2.0 Security BCP（RFC 9700）はこの方法を要求。</strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-syntax-based-normalization構文ベース正規化">2. Syntax-Based Normalization（構文ベース正規化）<a href="#2-syntax-based-normalization構文ベース正規化" class="hash-link" aria-label="2. Syntax-Based Normalization（構文ベース正規化） への直接リンク" title="2. Syntax-Based Normalization（構文ベース正規化） への直接リンク">​</a></h4>
<p>正規化してから比較。以下の変換を行う：</p>
<table><thead><tr><th>正規化</th><th>例</th></tr></thead><tbody><tr><td>スキームを小文字化</td><td><code>HTTPS:</code> → <code>https:</code></td></tr><tr><td>ホストを小文字化</td><td><code>Example.COM</code> → <code>example.com</code></td></tr><tr><td>パーセントエンコードを大文字化</td><td><code>%2f</code> → <code>%2F</code></td></tr><tr><td>不要なパーセントエンコードを解除</td><td><code>%41</code> → <code>A</code></td></tr><tr><td>空パスを <code>/</code> に</td><td><code>https://example.com</code> → <code>https://example.com/</code></td></tr><tr><td>デフォルトポートを削除</td><td><code>:443</code> → (削除)</td></tr></tbody></table>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">正規化前: HTTPS://Example.COM:443/Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正規化後: https://example.com/Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正規化前: https://example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">正規化後: https://example.com/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>この方法を使うと、以下が同一視される：</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://EXAMPLE.COM/callback      ← ホストは正規化で同一</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://example.com:443/callback  ← デフォルトポートは正規化で削除</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-scheme-based-normalizationスキームベース正規化">3. Scheme-Based Normalization（スキームベース正規化）<a href="#3-scheme-based-normalizationスキームベース正規化" class="hash-link" aria-label="3. Scheme-Based Normalization（スキームベース正規化） への直接リンク" title="3. Scheme-Based Normalization（スキームベース正規化） への直接リンク">​</a></h4>
<p>スキーム固有のルールを適用。例えば HTTP では：</p>
<ul>
<li>空パスを <code>/</code> に変換</li>
<li>デフォルトポート（80/443）を削除</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-protocol-based-normalizationプロトコルベース正規化">4. Protocol-Based Normalization（プロトコルベース正規化）<a href="#4-protocol-based-normalizationプロトコルベース正規化" class="hash-link" aria-label="4. Protocol-Based Normalization（プロトコルベース正規化） への直接リンク" title="4. Protocol-Based Normalization（プロトコルベース正規化） への直接リンク">​</a></h4>
<p>実際にリソースにアクセスして等価性を判断。リダイレクト先が同じなら同一視するなど。</p>
<p><strong>セキュリティ上の理由から、OAuth では使用しない。</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="なぜ-simple-string-comparison-が推奨されるか">なぜ Simple String Comparison が推奨されるか？<a href="#なぜ-simple-string-comparison-が推奨されるか" class="hash-link" aria-label="なぜ Simple String Comparison が推奨されるか？ への直接リンク" title="なぜ Simple String Comparison が推奨されるか？ への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  正規化を行うと...                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  登録:   https://app.example.com/callback                               │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  リクエスト: HTTPS://APP.EXAMPLE.COM/callback                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      ↓ 正規化                                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              https://app.example.com/callback                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      ↓                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│              ✅ 一致（正規化後）                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  これは一見便利だが...                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  攻撃者が細工した URI:                                                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    https://app.example.com%2F..%2F..%2Fattacker.com/callback            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      ↓ 正規化（パーセントデコード）                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    https://app.example.com/../../attacker.com/callback                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                      ↓ パス正規化                                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    https://attacker.com/callback   ← 攻撃者のサーバーに！                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─ ────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>正規化は<strong>予期しない変換</strong>を引き起こす可能性があり、セキュリティリスクになる。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="各仕様での-uri-比較方法">各仕様での URI 比較方法<a href="#各仕様での-uri-比較方法" class="hash-link" aria-label="各仕様での URI 比較方法 への直接リンク" title="各仕様での URI 比較方法 への直接リンク">​</a></h3>
<table><thead><tr><th>仕様</th><th>比較方法</th><th>根拠</th></tr></thead><tbody><tr><td>RFC 6749</td><td>明記なし</td><td>実装依存</td></tr><tr><td>OIDC Core</td><td>明記なし（「identical」とだけ記載）</td><td>解釈の余地あり</td></tr><tr><td>RFC 8252</td><td>Simple String Comparison を推奨</td><td>Section 8.4</td></tr><tr><td>RFC 9700</td><td>Simple String Comparison を<strong>必須</strong></td><td>Section 4.1.3</td></tr><tr><td>FAPI 1.0/2.0</td><td>exact string matching</td><td>プロファイルで規定</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="実装上の注意点">実装上の注意点<a href="#実装上の注意点" class="hash-link" aria-label="実装上の注意点 への直接リンク" title="実装上の注意点 への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="パーセントエンコードの扱い">パーセントエンコードの扱い<a href="#パーセントエンコードの扱い" class="hash-link" aria-label="パーセントエンコードの扱い への直接リンク" title="パーセントエンコードの扱い への直接リンク">​</a></h4>
<p>同じ文字列でもエンコード方法が異なると不一致になる：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録:     https://example.com/callback?state=a b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">リクエスト: https://example.com/callback?state=a%20b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Simple String Comparison では ❌ 不一致</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>対策</strong>: 登録時にパーセントエンコード済みの形式で保存する。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="末尾スラッシュ">末尾スラッシュ<a href="#末尾スラッシュ" class="hash-link" aria-label="末尾スラッシュ への直接リンク" title="末尾スラッシュ への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録:     https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">リクエスト: https://example.com/callback/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Simple String Comparison では ❌ 不一致</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>対策</strong>: 登録時に末尾スラッシュの有無を統一するポリシーを決める。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ipv6-アドレス">IPv6 アドレス<a href="#ipv6-アドレス" class="hash-link" aria-label="IPv6 アドレス への直接リンク" title="IPv6 アドレス への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録:     http://[::1]/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">リクエスト: http://[0:0:0:0:0:0:0:1]/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Simple String Comparison では ❌ 不一致（同じアドレスでも）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>対策</strong>: IPv6 は正規化形式（<code>[::1]</code>）で登録することを推奨。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第2部-仕様別の検証ルール">第2部: 仕様別の検証ルール<a href="#第2部-仕様別の検証ルール" class="hash-link" aria-label="第2部: 仕様別の検証ルール への直接リンク" title="第2部: 仕様別の検証ルール への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-3986uri-仕様-2005年">RFC 3986（URI 仕様, 2005年）<a href="#rfc-3986uri-仕様-2005年" class="hash-link" aria-label="RFC 3986（URI 仕様, 2005年） への直接リンク" title="RFC 3986（URI 仕様, 2005年） への直接リンク">​</a></h3>
<p>redirect_uri 検証の<strong>基礎となる URI 構造と比較方法</strong>を定義。OAuth 関連仕様はすべてこの RFC を参照している。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uri-の構造-1">URI の構造<a href="#uri-の構造-1" class="hash-link" aria-label="URI の構造 への直接リンク" title="URI の構造 への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  https://user:pass@www.example.com:8080/path/to/resource?query=value#fragment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─┬─┘   └───┬──┘ └──────┬───────┘└─┬┘└───────┬───────┘└─────┬────┘└───┬───┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> scheme  userinfo       host      port      path           query     fragment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └──────────────────┬──────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 authority</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<table><thead><tr><th>構成要素</th><th>説明</th><th>大文字小文字</th><th>RFC 3986</th><th>redirect_uri での扱い</th></tr></thead><tbody><tr><td>scheme</td><td>プロトコル</td><td>区別しない</td><td>3.1</td><td>必須（本番は https）</td></tr><tr><td>userinfo</td><td>ユーザー情報</td><td>区別する</td><td>3.2.1</td><td>通常使用しない</td></tr><tr><td>host</td><td>ホスト名</td><td>区別しない</td><td>3.2.2</td><td>必須</td></tr><tr><td>port</td><td>ポート番号</td><td>-</td><td>3.2.3</td><td>省略時はデフォルト</td></tr><tr><td>path</td><td>リソースパス</td><td><strong>区別する</strong></td><td>3.3</td><td>完全一致が求められる</td></tr><tr><td>query</td><td>クエリパラメータ</td><td><strong>区別する</strong></td><td>3.4</td><td>仕様により扱いが異なる</td></tr><tr><td>fragment</td><td>フラグメント</td><td><strong>区別する</strong></td><td>3.5</td><td><strong>禁止</strong>（OAuth/OIDC 共通）</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="uri-比較の-3-つの方式section-6">URI 比較の 3 つの方式（Section 6）<a href="#uri-比較の-3-つの方式section-6" class="hash-link" aria-label="URI 比較の 3 つの方式（Section 6） への直接リンク" title="URI 比較の 3 つの方式（Section 6） への直接リンク">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="621-simple-string-comparison単純文字列比較">6.2.1 Simple String Comparison（単純文字列比較）<a href="#621-simple-string-comparison単純文字列比較" class="hash-link" aria-label="6.2.1 Simple String Comparison（単純文字列比較） への直接リンク" title="6.2.1 Simple String Comparison（単純文字列比較） への直接リンク">​</a></h5>
<p><strong>バイト単位での完全一致</strong>。最も厳格で安全。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">比較対象: https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 一致:   https://example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://EXAMPLE.COM/callback     ← 大文字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com:443/callback ← ポート明示</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com/callback/    ← 末尾スラッシュ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 不一致: https://example.com/Callback     ← パスの大文字</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>RFC 9700（Security BCP）はこの方式を要求。</strong></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="622-syntax-based-normalization構文ベース正規化">6.2.2 Syntax-Based Normalization（構文ベース正規化）<a href="#622-syntax-based-normalization構文ベース正規化" class="hash-link" aria-label="6.2.2 Syntax-Based Normalization（構文ベース正規化） への直接リンク" title="6.2.2 Syntax-Based Normalization（構文ベース正規化） への直接リンク">​</a></h5>
<p>URI 構文ルールに基づいて正規化してから比較。</p>
<table><thead><tr><th>正規化ルール</th><th>変換例</th></tr></thead><tbody><tr><td>スキーム小文字化</td><td><code>HTTPS:</code> → <code>https:</code></td></tr><tr><td>ホスト小文字化</td><td><code>EXAMPLE.COM</code> → <code>example.com</code></td></tr><tr><td>パーセントエンコード大文字化</td><td><code>%2f</code> → <code>%2F</code></td></tr><tr><td>不要なエンコード解除</td><td><code>%41</code> → <code>A</code>（非予約文字）</td></tr><tr><td>空パス正規化</td><td><code>https://example.com</code> → <code>https://example.com/</code></td></tr><tr><td>デフォルトポート削除</td><td><code>:443</code> → (削除)</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="623-scheme-based-normalizationスキームベース正規化">6.2.3 Scheme-Based Normalization（スキームベース正規化）<a href="#623-scheme-based-normalizationスキームベース正規化" class="hash-link" aria-label="6.2.3 Scheme-Based Normalization（スキームベース正規化） への直接リンク" title="6.2.3 Scheme-Based Normalization（スキームベース正規化） への直接リンク">​</a></h5>
<p>スキーム固有のルールを適用。HTTP では末尾スラッシュや <code>/../</code> の解決など。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-方式の比較">3 方式の比較<a href="#3-方式の比較" class="hash-link" aria-label="3 方式の比較 への直接リンク" title="3 方式の比較 への直接リンク">​</a></h4>
<table><thead><tr><th>URI ペア</th><th>Simple String</th><th>Syntax-Based</th><th>Scheme-Based</th></tr></thead><tbody><tr><td><code>http://example.com</code> vs <code>HTTP://example.com</code></td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td><code>http://example.com</code> vs <code>http://example.com/</code></td><td>❌</td><td>❌</td><td>✅</td></tr><tr><td><code>http://example.com:80</code> vs <code>http://example.com</code></td><td>❌</td><td>✅</td><td>✅</td></tr><tr><td><code>http://example.com/~a</code> vs <code>http://example.com/%7Ea</code></td><td>❌</td><td>✅</td><td>✅</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="なぜ-simple-string-comparison-が推奨されるか-1">なぜ Simple String Comparison が推奨されるか？<a href="#なぜ-simple-string-comparison-が推奨されるか-1" class="hash-link" aria-label="なぜ Simple String Comparison が推奨されるか？ への直接リンク" title="なぜ Simple String Comparison が推奨されるか？ への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">正規化を使うと攻撃の余地が生まれる:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">登録: https://app.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">攻撃者が細工した URI:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://app.example.com%2F..%2F..%2Fattacker.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ↓ パーセントデコード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://app.example.com/../../attacker.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ↓ パス正規化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://attacker.com/callback   ← 攻撃者のサーバーに！</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>正規化ロジックの実装差異やバグがセキュリティホールになる。</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-6749oauth-20-core-2012年">RFC 6749（OAuth 2.0 Core, 2012年）<a href="#rfc-6749oauth-20-core-2012年" class="hash-link" aria-label="RFC 6749（OAuth 2.0 Core, 2012年） への直接リンク" title="RFC 6749（OAuth 2.0 Core, 2012年） への直接リンク">​</a></h3>
<p>OAuth 2.0 の基本仕様。<strong>曖昧な表現が多く、実装者の解釈に委ねられる</strong>部分が多い。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="登録要件">登録要件<a href="#登録要件" class="hash-link" aria-label="登録要件 への直接リンク" title="登録要件 への直接リンク">​</a></h4>
<blockquote>
<p>The authorization server MUST require the following clients to register their redirection endpoint:</p>
<ul>
<li>Public clients.</li>
<li>Confidential clients utilizing the implicit grant type.</li>
</ul>
</blockquote>
<table><thead><tr><th>クライアントタイプ</th><th>登録</th></tr></thead><tbody><tr><td>Public クライアント</td><td>必須</td></tr><tr><td>Confidential + Implicit</td><td>必須</td></tr><tr><td>Confidential + Authorization Code</td><td>推奨（SHOULD）</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="検証方法">検証方法<a href="#検証方法" class="hash-link" aria-label="検証方法 への直接リンク" title="検証方法 への直接リンク">​</a></h4>
<blockquote>
<p>If multiple redirection URIs have been registered, if only part of the redirection URI has been registered, or if no redirection URI has been registered, the client MUST include a redirection URI with the authorization request using the &quot;redirect_uri&quot; request parameter.</p>
</blockquote>
<p><strong>解釈の余地がある表現</strong>:</p>
<ul>
<li>「part of the redirection URI」が何を意味するか不明確</li>
<li>前方一致？ドメインのみ？パスの  プレフィックス？</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="クエリパラメータ">クエリパラメータ<a href="#クエリパラメータ" class="hash-link" aria-label="クエリパラメータ への直接リンク" title="クエリパラメータ への直接リンク">​</a></h4>
<blockquote>
<p>The redirection endpoint URI MAY include an &quot;application/x-www-form-urlencoded&quot; formatted query component, which MUST be retained when adding additional response parameters.</p>
</blockquote>
<p>クエリパラメータの<strong>追加は許可</strong>されている。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録: https://app.example.com/callback?client=abc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">許可: https://app.example.com/callback?client=abc&amp;code=xxx&amp;state=yyy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  ↑ 追加される</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-6749-の問題点">RFC 6749 の問題点<a href="#rfc-6749-の問題点" class="hash-link" aria-label="RFC 6749 の問題点 への直接リンク" title="RFC 6749 の問題点 への直接リンク">​</a></h4>
<table><thead><tr><th>問題</th><th>説明</th></tr></thead><tbody><tr><td>部分一致の許容</td><td>パス以下を自由に指定できると攻撃に悪用される可能性</td></tr><tr><td>ワイルドカードの解釈</td><td>仕様に明記なし、実装依存</td></tr><tr><td>フラグメントの扱い</td><td>登録時は禁止だが、検証時の扱いが曖昧</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="openid-connect-core-102014年">OpenID Connect Core 1.0（2014年）<a href="#openid-connect-core-102014年" class="hash-link" aria-label="OpenID Connect Core 1.0（2014年） への直接リンク" title="OpenID Connect Core 1.0（2014年） への直接リンク">​</a></h3>
<p>OAuth 2.0 より<strong>明確に厳格化</strong>された。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="検証方法-1">検証方法<a href="#検証方法-1" class="hash-link" aria-label="検証方法 への直接リンク" title="検証方法 への直接リンク">​</a></h4>
<blockquote>
<p>The Redirection URI MUST NOT use the fragment component.</p>
<p>The Authorization Server MUST require the use of TLS.</p>
<p>The Redirection URI <strong>MUST be an absolute URI</strong> as defined by [RFC3986] Section 4.3.</p>
<p>The Redirection URI <strong>MAY use an application/x-www-form-urlencoded formatted query component</strong>.</p>
</blockquote>
<p>そして重要な一文：</p>
<blockquote>
<p>The Authorization Server <strong>MUST verify</strong> that the value of the redirect_uri parameter is <strong>identical</strong> to the Redirection URI that was pre-registered.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="完全一致exact-match">完全一致（Exact Match）<a href="#完全一致exact-match" class="hash-link" aria-label="完全一致（Exact Match） への直接リンク" title="完全一致（Exact Match） への直接リンク">​</a></h4>
<p>OIDC では<strong>完全一致</strong>が要求される。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録: https://app.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ 許可: https://app.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 拒否: https://app.example.com/callback/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 拒否: https://app.example.com/callback?extra=param</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 拒否: https://app.example.com/callback#fragment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ 拒否: https://APP.example.com/callback  ← スキームとホストは大文字小文字区別なし</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                            だがパスは区別される</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="例外-複数-uri-の登録">例外: 複数 URI の登録<a href="#例外-複数-uri-の登録" class="hash-link" aria-label="例外: 複数 URI の登録 への直接リンク" title="例外: 複数 URI の登録 への直接リンク">​</a></h4>
<p>複数の redirect_uri を登録している場合、リクエストで指定された URI が登録済みリストの<strong>いずれかと完全一致</strong>すればよい。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録済み:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - https://app.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - https://app.example.com/oauth/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - https://staging.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">リクエスト: redirect_uri=https://app.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ ✅ 1番目と完全一致</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-8252oauth-20-for-native-apps-2017年">RFC 8252（OAuth 2.0 for Native Apps, 2017年）<a href="#rfc-8252oauth-20-for-native-apps-2017年" class="hash-link" aria-label="RFC 8252（OAuth 2.0 for Native Apps, 2017年） への直接リンク" title="RFC 8252（OAuth 2.0 for Native Apps, 2017年） への直接リンク">​</a></h3>
<p>ネイティブアプリ（モバイル・デスクトップ）向けの特殊なルール。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3つの-redirect_uri-パターン">3つの redirect_uri パターン<a href="#3つの-redirect_uri-パターン" class="hash-link" aria-label="3つの redirect_uri パターン への直接リンク" title="3つの redirect_uri パターン への直接リンク">​</a></h4>
<table><thead><tr><th>パターン</th><th>形式</th><th>例</th></tr></thead><tbody><tr><td>Private-Use URI Scheme</td><td><code>com.example.app:/callback</code></td><td>カスタムスキーム</td></tr><tr><td>Claimed HTTPS Scheme</td><td><code>https://app.example.com/.well-known/...</code></td><td>Universal Links / App Links</td></tr><tr><td>Loopback Interface</td><td><code>http://127.0.0.1:{port}/callback</code></td><td>ローカルサーバー</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="loopback-の特殊ルール">Loopback の特殊ルール<a href="#loopback-の特殊ルール" class="hash-link" aria-label="Loopback の特殊ルール への直接リンク" title="Loopback の特殊ルール への直接リンク">​</a></h4>
<p><strong>ポート番号は動的に変わることを許容</strong>する必要がある。</p>
<blockquote>
<p>The authorization server MUST allow any port to be specified at the time of the request for loopback IP redirect URIs, to accommodate clients that obtain an available ephemeral port from the operating system at the time of the request.</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録: http://127.0.0.1/callback  または  http://[::1]/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">リクエスト時:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ http://127.0.0.1:51234/callback  ← ポート番号は検証しない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ http://127.0.0.1:8080/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ http://[::1]:3000/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ❌ http://localhost:8080/callback   ← localhost は NG（DNS リバインディング攻撃のリスク）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="private-use-uri-scheme-の推奨事項">Private-Use URI Scheme の推奨事項<a href="#private-use-uri-scheme-の推奨事項" class="hash-link" aria-label="Private-Use URI Scheme の推奨事項 への直接リンク" title="Private-Use URI Scheme の推奨事項 への直接リンク">​</a></h4>
<blockquote>
<p>To avoid clashing with schemes that have a defined meaning, schemes using a domain name based on a domain the app developer controls is recommended.</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">推奨:   com.example.myapp:/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">非推奨: myapp:/callback  ← 他アプリと衝突の可能性</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rfc-9700oauth-20-security-bcp-2024年">RFC 9700（OAuth 2.0 Security BCP, 2024年）<a href="#rfc-9700oauth-20-security-bcp-2024年" class="hash-link" aria-label="RFC 9700（OAuth 2.0 Security BCP, 2024年） への直接リンク" title="RFC 9700（OAuth 2.0 Security BCP, 2024年） への直接リンク">​</a></h3>
<p>セキュリティベストプラクティス。<strong>最も厳格な推奨事項</strong>を提示。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="完全一致の強制">完全一致の強制<a href="#完全一致の強制" class="hash-link" aria-label="完全一致の強制 への直接リンク" title="完全一致の強制 への直接リンク">​</a></h4>
<blockquote>
<p>Authorization servers MUST compare URIs using <strong>exact string matching</strong> as per Section 6.2.1 of [RFC3986] (Simple String Comparison).</p>
</blockquote>
<p>Simple String Comparison = バイト単位での完全一致。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="パターンマッチングの禁止">パターンマッチングの禁止<a href="#パターンマッチングの禁止" class="hash-link" aria-label="パターンマッチングの禁止 への直接リンク" title="パターンマッチングの禁止 への直接リンク">​</a></h4>
<blockquote>
<p>Authorization servers <strong>SHOULD NOT</strong> allow clients to register redirect URI patterns.</p>
</blockquote>
<p>ワイルドカードやプレフィックスマッチングは禁止。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❌ https://app.example.com/callback/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ https://*.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❌ https://app.example.com/callback?*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="なぜパターンマッチングが危険か">なぜパターンマッチングが危険か？<a href="#なぜパターンマッチングが危険か" class="hash-link" aria-label="なぜパターンマッチングが危険か？ への直接リンク" title="なぜパターンマッチングが危険か？ への直接リンク">​</a></h4>
<blockquote>
<p>Such patterns could inadvertently match malicious URIs that are controlled by attackers.</p>
</blockquote>
<p>例：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">登録: https://app.example.com/callback/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">攻撃者が悪用:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://app.example.com/callback/../../../attacker/steal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  https://app.example.com/callback/../../.well-known/webfinger?...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>パストラバーサルやオープンリダイレクタの脆弱性と組み合わせて攻撃される。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="localhost-の禁止">localhost の禁止<a href="#localhost-の禁止" class="hash-link" aria-label="localhost の禁止 への直接リンク" title="localhost の禁止 への直接リンク">​</a></h4>
<blockquote>
<p>Clients <strong>SHOULD NOT</strong> use <code>localhost</code> as the hostname in loopback redirect URIs.</p>
</blockquote>
<p>理由：DNS リバインディング攻撃のリスク。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❌ http://localhost:8080/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ http://127.0.0.1:8080/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✅ http://[::1]:8080/callback</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fapi-10-baseline--advanced2021年">FAPI 1.0 Baseline / Advanced（2021年）<a href="#fapi-10-baseline--advanced2021年" class="hash-link" aria-label="FAPI 1.0 Baseline / Advanced（2021年） への直接リンク" title="FAPI 1.0 Baseline / Advanced（2021年） への直接リンク">​</a></h3>
<p>金融グレード。<strong>最も厳格</strong>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="baseline-profile">Baseline Profile<a href="#baseline-profile" class="hash-link" aria-label="Baseline Profile への直接リンク" title="Baseline Profile への直接リンク">​</a></h4>
<blockquote>
<p>The authorization server shall require redirect URIs to be pre-registered.
The authorization server shall require the redirect_uri in the authorization request.
The authorization server shall require <strong>exact matching</strong> of redirect URIs.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-profile">Advanced Profile<a href="#advanced-profile" class="hash-link" aria-label="Advanced Profile への直接リンク" title="Advanced Profile への直接リンク">​</a></h4>
<p>追加で以下を要求：</p>
<blockquote>
<p>The authorization server shall require that the value of redirect_uri is <strong>exactly equal</strong> to one of the pre-registered redirect URIs.</p>
</blockquote>
<p>さらに <strong>JAR（JWT-Secured Authorization Request）</strong> または <strong>PAR（Pushed Authorization Requests）</strong> を要求：</p>
<blockquote>
<p>The client shall send the authorization request as a signed JWT (request object).</p>
</blockquote>
<p>JAR: 認可リクエストパラメータを署名付き JWT にして送信（フロントチャネル経由だが改ざん検知可能）
PAR: 認可リクエストパラメータをバックチャネルで事前送信</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fapi-での追加制約">FAPI での追加制約<a href="#fapi-での追加制約" class="hash-link" aria-label="FAPI での追加制約 への直接リンク" title="FAPI での追加制約 への直接リンク">​</a></h4>
<table><thead><tr><th>制約</th><th>理由</th></tr></thead><tbody><tr><td>HTTPS 必須（localhost 除く）</td><td>通信の盗聴防止</td></tr><tr><td>localhost 非推奨</td><td>DNS リバインディング対策</td></tr><tr><td>フラグメント禁止</td><td>仕様上の制約</td></tr><tr><td>動的パラメータ禁止</td><td>予測可能性の確保</td></tr></tbody></table>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fapi-20-security-profile2023年">FAPI 2.0 Security Profile（2023年）<a href="#fapi-20-security-profile2023年" class="hash-link" aria-label="FAPI 2.0 Security Profile（2023年） への直接リンク" title="FAPI 2.0 Security Profile（2023年） への直接リンク">​</a></h3>
<p>FAPI 1.0 をさらに簡素化・強化。</p>
<blockquote>
<p>The authorization server shall compare the redirect_uri parameter value with the pre-registered redirect URIs using <strong>exact string matching</strong>.</p>
</blockquote>
<p>PAR が<strong>必須</strong>となり、redirect_uri を含む認可リクエストパラメータはバックチャネルで送信される。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">従来（FAPI 1.0 without PAR）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ブラウザ → 認可サーバー（フロントチャネル）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  redirect_uri が URL に露出</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAPI 2.0 + PAR:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  クライアント → 認可サーバー（バックチャネル）で認可リクエストパラメータを送信</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ブラウザ → 認可サーバー（フロントチャネル）は request_uri のみ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ※ 認可レスポンス（認可コード）はフロントチャネルで返る</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第3部-比較表">第3部: 比較表<a href="#第3部-比較表" class="hash-link" aria-label="第3部: 比較表 への直接リンク" title="第3部: 比較表 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="検証方法の比較">検証方法の比較<a href="#検証方法の比較" class="hash-link" aria-label="検証方法の比較 への直接リンク" title="検証方法の比較 への直接リンク">​</a></h3>
<table><thead><tr><th>仕様</th><th>一致方式</th><th>クエリパラメータ</th><th>ポート</th><th>ワイルドカード</th></tr></thead><tbody><tr><td>RFC 6749</td><td>部分一致可</td><td>追加許可</td><td>固定</td><td>実装依存</td></tr><tr><td>OIDC Core</td><td>完全一致</td><td>登録済みのみ</td><td>固定</td><td>禁止</td></tr><tr><td>RFC 8252</td><td>完全一致</td><td>固定</td><td>Loopback は動的許可</td><td>禁止</td></tr><tr><td>RFC 9700</td><td>完全一致</td><td>固定</td><td>Loopback は動的許可</td><td>禁止</td></tr><tr><td>FAPI 1.0</td><td>完全一致</td><td>固定</td><td>固定</td><td>禁止</td></tr><tr><td>FAPI 2.0</td><td>完全一致</td><td>固定</td><td>固定</td><td>禁止</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="許容される-uri-の例">許容される URI の例<a href="#許容される-uri-の例" class="hash-link" aria-label="許容される URI の例 への直接リンク" title="許容される URI の例 への直接リンク">​</a></h3>
<table><thead><tr><th>登録 URI</th><th>リクエスト URI</th><th>RFC6749</th><th>OIDC</th><th>FAPI</th></tr></thead><tbody><tr><td><code>https://app.example.com/cb</code></td><td><code>https://app.example.com/cb</code></td><td>✅</td><td>✅</td><td>✅</td></tr><tr><td><code>https://app.example.com/cb</code></td><td><code>https://app.example.com/cb?foo=bar</code></td><td>✅</td><td>❌</td><td>❌</td></tr><tr><td><code>https://app.example.com/cb</code></td><td><code>https://app.example.com/cb/</code></td><td>⚠️</td><td>❌</td><td>❌</td></tr><tr><td><code>https://app.example.com/</code></td><td><code>https://app.example.com/cb</code></td><td>⚠️</td><td>❌</td><td>❌</td></tr><tr><td><code>http://127.0.0.1/cb</code></td><td><code>http://127.0.0.1:8080/cb</code></td><td>❌</td><td>❌</td><td>❌</td></tr><tr><td><code>http://127.0.0.1/cb</code> (Native)</td><td><code>http://127.0.0.1:8080/cb</code></td><td>✅*</td><td>✅*</td><td>N/A</td></tr></tbody></table>
<p>*RFC 8252 に従う場合</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="セキュリティと利便性のトレードオフ">セキュリティと利便性のトレードオフ<a href="#セキュリティと利便性のトレードオフ" class="hash-link" aria-label="セキュリティと利便性のトレードオフ への直接リンク" title="セキュリティと利便性のトレードオフ への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─────────────────────────────────────────────────────────────────────────  ┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  利便性                                                                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    ▲                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  ┌─────────┐                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  │ RFC6749 │ ← 複数パターン登録可、開発が楽                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  └─────────┘                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       │                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       ▼                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  ┌─────────┐                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  │  OIDC   │ ← 完全一致だが複数 URI 登録可                          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  └─────────┘                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       │                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       ▼                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  ┌─────────┐                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  │RFC 9700 │ ← パターンマッチ禁止、localhost 非推奨                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  └─────────┘                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       │                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │       ▼                                                            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  ┌─────────┐                                                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  │  FAPI   │ ← 1.0: JAR or PAR、2.0: PAR 必須                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │  └─────────┘   認可リクエストのパラメータをバックチャネル化           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    │                                                                    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│    └────────────────────────────────────────────────────────────►       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                         セキュリティ     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                                                                         │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────────────────────────────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第4部-実装上の推奨事項">第4部: 実装上の推奨事項<a href="#第4部-実装上の推奨事項" class="hash-link" aria-label="第4部: 実装上の推奨事項 への直接リンク" title="第4部: 実装上の推奨事項 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="認可サーバー実装者向け">認可サーバー実装者向け<a href="#認可サーバー実装者向け" class="hash-link" aria-label="認可サーバー実装者向け への直接リンク" title="認可サーバー実装者向け への直接リンク">​</a></h3>
<table><thead><tr><th>推奨レベル</th><th>内容</th></tr></thead><tbody><tr><td>必須</td><td>redirect_uri の事前登録を必須にする</td></tr><tr><td>必須</td><td>完全一致（exact string match）で検証する</td></tr><tr><td>必須</td><td>フラグメント（#）を含む URI を拒否する</td></tr><tr><td>強く推奨</td><td>パターンマッチング（ワイルドカード）を許可しない</td></tr><tr><td>強く推奨</td><td>HTTP スキームは Loopback IP のみ許可</td></tr><tr><td>推奨</td><td>PAR をサポートして redirect_uri をバックチャネル化</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="クライアント開発者向け">クライアント開発者向け<a href="#クライアント開発者向け" class="hash-link" aria-label="クライアント開発者向け への直接リンク" title="クライアント開発者向け への直接リンク">​</a></h3>
<table><thead><tr><th>推奨レベル</th><th>内容</th></tr></thead><tbody><tr><td>必須</td><td>本番環境では HTTPS を使用</td></tr><tr><td>必須</td><td>redirect_uri は固定値を使用（動的生成しない）</td></tr><tr><td>強く推奨</td><td>開発環境でも <code>127.0.0.1</code> を使用（<code>localhost</code> ではなく）</td></tr><tr><td>推奨</td><td>環境ごとに別々の redirect_uri を登録（dev, staging, prod）</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="まとめ">まとめ<a href="#まとめ" class="hash-link" aria-label="まとめ への直接リンク" title="まとめ への直接リンク">  ​</a></h2>
<p>redirect_uri の検証ルールは、OAuth 2.0 の進化とともに厳格化されてきました。</p>
<table><thead><tr><th>時期</th><th>仕様</th><th>特徴</th></tr></thead><tbody><tr><td>2012年</td><td>RFC 6749</td><td>曖昧、実装依存</td></tr><tr><td>2014年</td><td>OIDC Core</td><td>完全一致を明記</td></tr><tr><td>2017年</td><td>RFC 8252</td><td>ネイティブアプリ向けルール追加</td></tr><tr><td>2021年</td><td>FAPI 1.0</td><td>金融グレードの厳格化</td></tr><tr><td>2023年</td><td>FAPI 2.0</td><td>PAR 必須化</td></tr><tr><td>2024年</td><td>RFC 9700</td><td>BCP として完全一致を推奨</td></tr></tbody></table>
<p><strong>新規実装では RFC 9700 / FAPI 2.0 レベルの厳格さを採用することを推奨します。</strong></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考リンク">参考リンク<a href="#参考リンク" class="hash-link" aria-label="参考リンク への直接リンク" title="参考リンク への直接リンク">​</a></h2>
<ul>
<li><a href="https://datatracker.ietf.org/doc/html/rfc3986" target="_blank" rel="noopener noreferrer">RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc6749" target="_blank" rel="noopener noreferrer">RFC 6749 - OAuth 2.0 Authorization Framework</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_blank" rel="noopener noreferrer">OpenID Connect Core 1.0</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc8252" target="_blank" rel="noopener noreferrer">RFC 8252 - OAuth 2.0 for Native Apps</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc9700" target="_blank" rel="noopener noreferrer">RFC 9700 - OAuth 2.0 Security Best Current Practice</a></li>
<li><a href="https://openid.net/specs/openid-financial-api-part-2-1_0.html" target="_blank" rel="noopener noreferrer">FAPI 1.0 Security Profile</a></li>
<li><a href="https://openid.net/specs/fapi-2_0-security-profile.html" target="_blank" rel="noopener noreferrer">FAPI 2.0 Security Profile</a></li>
<li><a href="https://oauth.net/2/redirect-uri/" target="_blank" rel="noopener noreferrer">OAuth 2.0 Redirect URI Validation (oauth.net)</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/16-oauth-oidc-rfc/security/redirect-uri-validation.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/attack-patterns"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">OAuth 2.0 / OIDC 攻撃パターン</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/rfc9700-security-bcp"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">RFC 9700: OAuth 2.0 Security Best Current Practice</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#第1部-概要" class="table-of-contents__link toc-highlight">第1部: 概要</a><ul><li><a href="#なぜ-redirect_uri-の検証が重要なのか" class="table-of-contents__link toc-highlight">なぜ redirect_uri の検証が重要なのか？</a></li><li><a href="#検証の厳格さスペクトラム" class="table-of-contents__link toc-highlight">検証の厳格さスペクトラム</a></li></ul></li><li><a href="#rfc-3986-uri-比較の基礎" class="table-of-contents__link toc-highlight">RFC 3986: URI 比較の基礎</a><ul><li><a href="#uri-の構造" class="table-of-contents__link toc-highlight">URI の構造</a></li><li><a href="#uri-の比較方法rfc-3986-section-6" class="table-of-contents__link toc-highlight">URI の比較方法（RFC 3986 Section 6）</a></li><li><a href="#なぜ-simple-string-comparison-が推奨されるか" class="table-of-contents__link toc-highlight">なぜ Simple String Comparison が推奨されるか？</a></li><li><a href="#各仕様での-uri-比較方法" class="table-of-contents__link toc-highlight">各仕様での URI 比較方法</a></li><li><a href="#実装上の注意点" class="table-of-contents__link toc-highlight">実装上の注意点</a></li></ul></li><li><a href="#第2部-仕様別の検証ルール" class="table-of-contents__link toc-highlight">第2部: 仕様別の検証ルール</a><ul><li><a href="#rfc-3986uri-仕様-2005年" class="table-of-contents__link toc-highlight">RFC 3986（URI 仕様, 2005年）</a></li><li><a href="#rfc-6749oauth-20-core-2012年" class="table-of-contents__link toc-highlight">RFC 6749（OAuth 2.0 Core, 2012年）</a></li><li><a href="#openid-connect-core-102014年" class="table-of-contents__link toc-highlight">OpenID Connect Core 1.0（2014年）</a></li><li><a href="#rfc-8252oauth-20-for-native-apps-2017年" class="table-of-contents__link toc-highlight">RFC 8252（OAuth 2.0 for Native Apps, 2017年）</a></li><li><a href="#rfc-9700oauth-20-security-bcp-2024年" class="table-of-contents__link toc-highlight">RFC 9700（OAuth 2.0 Security BCP, 2024年）</a></li><li><a href="#fapi-10-baseline--advanced2021年" class="table-of-contents__link toc-highlight">FAPI 1.0 Baseline / Advanced（2021年）</a></li><li><a href="#fapi-20-security-profile2023年" class="table-of-contents__link toc-highlight">FAPI 2.0 Security Profile（2023年）</a></li></ul></li><li><a href="#第3部-比較表" class="table-of-contents__link toc-highlight">第3部: 比較表</a><ul><li><a href="#検証方法の比較" class="table-of-contents__link toc-highlight">検証方法の比較</a></li><li><a href="#許容される-uri-の例" class="table-of-contents__link toc-highlight">許容される URI の例</a></li><li><a href="#セキュリティと利便性のトレードオフ" class="table-of-contents__link toc-highlight">セキュリティと利便性のトレードオフ</a></li></ul></li><li><a href="#第4部-実装上の推奨事項" class="table-of-contents__link toc-highlight">第4部: 実装上の推奨事項</a><ul><li><a href="#認可サーバー実装者向け" class="table-of-contents__link toc-highlight">認可サーバー実装者向け</a></li><li><a href="#クライアント開発者向け" class="table-of-contents__link toc-highlight">クライアント開発者向け</a></li></ul></li><li><a href="#まとめ" class="table-of-contents__link toc-highlight">まとめ</a></li><li><a href="#参考リンク" class="table-of-contents__link toc-highlight">参考リンク</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>