<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">FAPI 1.0 Baseline Profile | IdP-Server Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FAPI 1.0 Baseline Profile | IdP-Server Documentation"><meta data-rh="true" name="description" content="FAPI 1.0 Baseline Profile は、金融 API 向けの OAuth 2.0 / OIDC セキュリティプロファイルの基本レベルです。"><meta data-rh="true" property="og:description" content="FAPI 1.0 Baseline Profile は、金融 API 向けの OAuth 2.0 / OIDC セキュリティプロファイルの基本レベルです。"><link data-rh="true" rel="icon" href="/idp-server/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline" hreflang="ja"><link data-rh="true" rel="alternate" href="https://hirokazu-kobayashi-koba-hiro.github.io/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/idp-server/blog/rss.xml" title="IdP-Server Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/idp-server/blog/atom.xml" title="IdP-Server Documentation Atom Feed"><link rel="stylesheet" href="/idp-server/assets/css/styles.f434a3d5.css">
<script src="/idp-server/assets/js/runtime~main.f8b18ea6.js" defer="defer"></script>
<script src="/idp-server/assets/js/main.572985b2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/idp-server/"><div class="navbar__logo"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/idp-server/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IdP-Server</b></a><a class="navbar__item navbar__link" href="/idp-server/docs/introduction">Docs</a><a class="navbar__item navbar__link" href="/idp-server/docs/content_07_reference/api-reference">Api Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hirokazu-kobayashi-koba-hiro/idp-server" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/introduction">はじめに</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/idp-server/docs/document-index">ドキュメントガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_01_intro/intro-01-tech-overview">製品紹介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_02_quickstart/quickstart-01-getting-started">クイックスタート</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_03_concepts/foundation/concept-01-multi-tenant">コア概念</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_04_protocols/protocol-01-authorization-code-flow">認証・認可プロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_05_how-to/">How-to（設定・運用レシピ）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_06_developer-guide/">開発者ガイド</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_07_reference/api-reference">リファレンス</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">学習（Learning）</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/identity-basics/identity-management-basics">アイデンティティ管理の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-fundamentals/modern-web-authz-authn">OAuth 2.0の基礎</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-tokens/id-token-jwt">OAuth 2.0トークン</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/openid-connect/oauth-oidc-basics">OpenID Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/fido-webauthn/fido2-architecture-rp-browser-authenticator">FIDO2/WebAuthn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/security/glossary">セキュリティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/multi-tenancy/multi-tenancy-basics">マルチテナント</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/advanced-protocols/ciba-basics">高度なプロトコル</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/http-rest/http-basics">HTTP/REST</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/jwt-jose/jwt-introduction">JWT/JOSE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth/OIDC RFC学習</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/">OAuth 2.0 / OpenID Connect RFC 学習ガイド</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/core/rfc6749-oauth2-core">基礎（OAuth 2.0 Core）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/jose/rfc7515-jws">JWT/JOSE（署名・暗号化）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/client-auth/rfc7521-assertion-framework">クライアント認証</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/extensions/rfc7009-revocation">OAuth 2.0 拡張</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/oidc/back-channel-logout">OpenID Connect</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/security/attack-patterns">セキュリティ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-advanced">高度なプロトコル</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-advanced">FAPI 1.0 Advanced Profile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-baseline">FAPI 1.0 Baseline Profile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi2-security">FAPI 2.0 Security Profile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/grant-management">OAuth 2.0 Grant Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/oidc-ciba">OpenID Connect CIBA（Client-Initiated Backchannel Authentication）</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced-identity/oid4vci">Advanced Identity</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/verifiable-credentials/">Verifiable Credentials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/data-formats/">データフォーマット</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/session-management/web-session-basics">セッション管理</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/postgresql/">PostgreSQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/crypto/">暗号化</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/kubernetes/">コンテナ/Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/idp-server/docs/content_11_learning/linux/">Linux</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_08_ops/ops-01-test-strategy">運用（Ops）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_09_project/project-01-faq">プロジェクト</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/idp-server/docs/content_10_ai_developer/ai-01-index">AI</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/idp-server/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">学習（Learning）</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OAuth/OIDC RFC学習</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">高度なプロトコル</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">FAPI 1.0 Baseline Profile</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>FAPI 1.0 Baseline Profile</h1></header>
<p>FAPI 1.0 Baseline Profile は、金融 API 向けの OAuth 2.0 / OIDC セキュリティプロファイルの基本レベルです。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="目次">目次<a href="#目次" class="hash-link" aria-label="目次 への直接リンク" title="目次 への直接リンク">​</a></h2>
<ol>
<li><a href="#%E7%AC%AC1%E9%83%A8-%E6%A6%82%E8%A6%81%E7%B7%A8">第1部: 概要編</a></li>
<li><a href="#%E7%AC%AC2%E9%83%A8-%E8%A9%B3%E7%B4%B0%E7%B7%A8">第2部: 詳細編</a></li>
<li><a href="#%E7%AC%AC3%E9%83%A8-%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3">第3部: セキュリティ</a></li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第1部-概要編">第1部: 概要編<a href="#第1部-概要編" class="hash-link" aria-label="第1部: 概要編 への直接リンク" title="第1部: 概要編 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fapi-とは">FAPI とは？<a href="#fapi-とは" class="hash-link" aria-label="FAPI とは？ への直接リンク" title="FAPI とは？ への直接リンク"> ​</a></h3>
<p>FAPI（Financial-grade API）は、OpenID Foundation が策定した<strong>金融グレード</strong>のセキュリティプロファイルです。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FAPI の目的:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 金融機関の API を安全に公開</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - オープンバンキング、PSD2 への対応</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 高度なセキュリティ要件の標準化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAPI 1.0 の構成:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┌─────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │        FAPI 1.0 Advanced            │ ← より高いセキュリティ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │        FAPI 1.0 Baseline            │ ← 基本レベル</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │     OAuth 2.0 / OpenID Connect      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─────────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="なぜ-fapi-が必要なのか">なぜ FAPI が必要なのか？<a href="#なぜ-fapi-が必要なのか" class="hash-link" aria-label="なぜ FAPI が必要なのか？ への直接リンク" title="なぜ FAPI が必要なのか？ への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="背景と歴史">背景と歴史<a href="#背景と歴史" class="hash-link" aria-label="背景と歴史 への直接リンク" title="背景と歴史 への直接リンク">​</a></h4>
<p>2015年頃、欧州でPSD2（決済サービス指令第2版）が制定され、銀行にサードパーティへのAPI公開が義務付けられました。しかし、標準的なOAuth 2.0 / OpenID Connectでは、金融業界の厳しいセキュリティ要件を満たすには不十分でした。</p>
<table><thead><tr><th>課題</th><th>標準 OAuth 2.0</th><th>FAPI の解決策</th></tr></thead><tbody><tr><td>認可コードインターセプション</td><td>脆弱</td><td>PKCE 必須</td></tr><tr><td>クライアント認証の弱さ</td><td>client_secret（静的）</td><td>private_key_jwt / mTLS 推奨</td></tr><tr><td>ID Token の署名アルゴリズム</td><td>RS256 許可</td><td>PS256 / ES256 推奨</td></tr><tr><td>redirect_uri の曖昧な検証</td><td>部分一致許可の実装あり</td><td>完全一致必須</td></tr><tr><td>CSRF 対策</td><td>state 推奨</td><td>state 必須</td></tr></tbody></table>
<p>FAPI 1.0 は 2017年から策定が始まり、2021年に Final 仕様として承認されました。現在、世界中のオープンバンキング規制（PSD2、Open Banking UK、CDR等）でFAPIが採用されています。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="脅威モデル">脅威モデル<a href="#脅威モデル" class="hash-link" aria-label="脅威モデル への直接リンク" title="脅威モデル への直接リンク">​</a></h4>
<p>FAPI Baseline が対処する主な脅威：</p>
<ol>
<li>
<p><strong>認可コードインターセプション攻撃</strong></p>
<ul>
<li>攻撃者がネットワーク上で認可コードを傍受</li>
<li>対策: PKCE（Proof Key for Code Exchange）を必須化</li>
</ul>
</li>
<li>
<p><strong>CSRF（Cross-Site Request Forgery）</strong></p>
<ul>
<li>攻撃者が被害者のブラウザを使って不正なリクエストを実行</li>
<li>対策: state パラメータを必須化</li>
</ul>
</li>
<li>
<p><strong>ID Token リプレイ攻撃</strong></p>
<ul>
<li>攻撃者が古い ID Token を再利用</li>
<li>対策: nonce クレームの検証を必須化</li>
</ul>
</li>
<li>
<p><strong>クライアント認証情報の漏洩</strong></p>
<ul>
<li>client_secret がネットワーク上で漏洩</li>
<li>対策: private_key_jwt または mTLS を推奨</li>
</ul>
</li>
<li>
<p><strong>redirect_uri の操作</strong></p>
<ul>
<li>攻撃者が似た URL   にリダイレクトさせる</li>
<li>対策: redirect_uri の完全一致検証を必須化</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="baseline-vs-advanced">Baseline vs Advanced<a href="#baseline-vs-advanced" class="hash-link" aria-label="Baseline vs Advanced への直接リンク" title="Baseline vs Advanced への直接リンク">​</a></h3>
<table><thead><tr><th>項目</th><th>Baseline</th><th>Advanced</th></tr></thead><tbody><tr><td><strong>リスクレベル</strong></td><td>中程度</td><td>高</td></tr><tr><td><strong>用途</strong></td><td>読み取り専用 API（残高照会、取引履歴）</td><td>書き込み/決済 API（送金、決済）</td></tr><tr><td><strong>クライアント認証</strong></td><td>機密クライアント推奨</td><td>private_key_jwt/mTLS 必須</td></tr><tr><td><strong>レスポンス保護</strong></td><td>なし</td><td>JARM または PAR+FAPI</td></tr><tr><td><strong>ID トークン署名</strong></td><td>PS256/ES256 推奨</td><td>PS256/ES256 必須</td></tr><tr><td><strong>PKCE</strong></td><td>推奨</td><td>必須</td></tr><tr><td><strong>Request Object</strong></td><td>任意</td><td>必須</td></tr><tr><td><strong>Sender-Constrained Tokens</strong></td><td>任意</td><td>必須（mTLS）</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="実際のユースケース">実際のユースケース<a href="#実際のユースケース" class="hash-link" aria-label="実際のユースケース への直接リンク" title="実際のユースケース への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ユースケース1-残高照会アプリbaseline-適用">ユースケース1: 残高照会アプリ（Baseline 適用）<a href="#ユースケース1-残高照会アプリbaseline-適用" class="hash-link" aria-label="ユースケース1: 残高照会アプリ（Baseline 適用） への直接リンク" title="ユースケース1: 残高照会アプリ（Baseline 適用）  への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">シナリオ:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ユーザーが家計簿アプリを使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - アプリが銀行 API で口座残高を取得（読み取り専用）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - リスクレベル: 中程度（情報漏洩のリスク）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Baseline が適している理由:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 読み取り専用のため、金銭的損失のリスクが低い</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - PKCE で認可コードインターセプションを防止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - private_key_jwt で強固なクライアント認証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - PS256 で改ざんを防止</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ユースケース2-送金アプリadvanced-必要">ユースケース2: 送金アプリ（Advanced 必要）<a href="#ユースケース2-送金アプリadvanced-必要" class="hash-link" aria-label="ユースケース2: 送金アプリ（Advanced 必要） への直接リンク" title="ユースケース2: 送金アプリ（Advanced 必要） への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">シナリオ:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ユーザーが送金アプリを使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - アプリが銀行 API で送金を実行（書き込み）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - リスクレベル: 高（金銭的損失のリスク）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Advanced が必要な理由:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 書き込み操作のため、より高いセキュリティが必要</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - Request Object で認可リクエストの改ざんを防止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - JARM で認可レスポンスの改ざんを防止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - mTLS でトークンをクライアントにバインド</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fapi-10-と他の仕様との関係">FAPI 1.0 と他の仕様との関係<a href="#fapi-10-と他の仕様との関係" class="hash-link" aria-label="FAPI 1.0 と他の仕様との関係 への直接リンク" title="FAPI 1.0 と他の仕様との関係 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FAPI 1.0 のベース仕様:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ┌───  ──────────────────────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │              FAPI 1.0 Baseline                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─────────────────────────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │  RFC 7636 (PKCE)                                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │  OpenID Connect Core 1.0                        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │  OAuth 2.0 (RFC 6749)                           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAPI 1.0 の追加セキュリティ:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - PKCE 必須化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - state 必須化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - nonce 必須化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - redirect_uri 完全一致</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - クライアント認証強化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 署名アルゴリズム制限</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第2部-詳細編">第2部: 詳細編<a href="#第2部-詳細編" class="hash-link" aria-label="第2部: 詳細編 への直接リンク" title="第2部: 詳細編 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="認可サーバーの要件">認可サーバーの要件<a href="#認可サーバーの要件" class="hash-link" aria-label="認可サーバーの要件 への直接リンク" title="認可サーバーの要件 への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="必須要件">必須要件<a href="#必須要件" class="hash-link" aria-label="必須要件 への直接リンク" title="必須要件 への直接リンク">​</a></h4>
<table><thead><tr><th>要件</th><th>説明</th><th>技術詳細</th></tr></thead><tbody><tr><td><strong>TLS 1.2+</strong></td><td>すべての通信を暗号化</td><td>TLS 1.2 以上、強力な暗号スイート</td></tr><tr><td><strong>PKCE</strong></td><td>パブリッククライアントに必須</td><td>S256 メソッドのみ許可</td></tr><tr><td><strong>redirect_uri 完全一致</strong></td><td>ワイルドカード禁止</td><td>文字列の完全一致（大文字小文字区別）</td></tr><tr><td><strong>state の検証</strong></td><td>CSRF 防止</td><td>十分なエントロピー（128ビット以上）</td></tr><tr><td><strong>nonce の検証</strong></td><td>リプレイ防止</td><td>ID Token に含め、検証必須</td></tr><tr><td><strong>認可コード有効期限</strong></td><td>短い有効期限</td><td>推奨: 10分以内、理想: 1分以内</td></tr><tr><td><strong>s_hash 検証</strong></td><td>state の整合性確認</td><td>Implicit Flow / Hybrid Flow で必須</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="推奨要件">推奨要件<a href="#推奨要件" class="hash-link" aria-label="推奨要件 への直接リンク" title="推奨要件 への直接リンク">​</a></h4>
<table><thead><tr><th>要件</th><th>説明</th><th>メリット</th></tr></thead><tbody><tr><td><strong>機密クライアント</strong></td><td>クライアント認証を推奨</td><td>セキュリティ向上</td></tr><tr><td><strong>リフレッシュトークンローテーション</strong></td><td>漏洩対策</td><td>トークン盗難の影響を最小化</td></tr><tr><td><strong>短いトークン有効期限</strong></td><td>アクセストークン: 1時間</td><td>攻撃の時間窓を制限</td></tr><tr><td><strong>private_key_jwt / mTLS</strong></td><td>強固なクライアント認証</td><td>client_secret より安全</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="クライアント認証">クライアント認証<a href="#クライアント認証" class="hash-link" aria-label="クライアント認証 への直接リンク" title="クライアント認証 への直接リンク">​</a></h3>
<p>FAPI Baseline では、以下のクライアント認証方式が許可されます：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Baseline で許可されるクライアント認証:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. client_secret_basic / client_secret_post</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 許可されるが非推奨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 秘密がネットワークを流れる</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - HTTPS 必須だが、盗聴リスクあり</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   POST /token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   (client_id:client_secret を Base64 エンコード)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. client_secret_jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 対称鍵 JWT で認証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 秘密は直接送信されない</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - client_secret から署名を生成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;iss&quot;: &quot;s6BhdRkqt3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;sub&quot;: &quot;s6BhdRkqt3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;aud&quot;: &quot;https://auth.example.com/token&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;jti&quot;: &quot;unique-jwt-id&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;exp&quot;: 1704150300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;iat&quot;: 1704150000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   署名アルゴリズム: HS256, HS384, HS512</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. private_key_jwt（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 非対称鍵 JWT で認証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 最も安全</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 秘密鍵はクライアントのみが保持</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;iss&quot;: &quot;s6BhdRkqt3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;sub&quot;: &quot;s6BhdRkqt3&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;aud&quot;: &quot;https://auth.example.com/token&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;jti&quot;: &quot;unique-jwt-id&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;exp&quot;: 1704150300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &quot;iat&quot;: 1704150000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   署名アルゴリズム: PS256, PS384, PS512, ES256, ES384, ES512, RS256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. tls_client_auth / self_signed_tls_client_auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - mTLS で認証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 証明書ベース</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - PKI インフラが必要</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="private_key_jwt-の詳細">private_key_jwt の詳細<a href="#private_key_jwt-の詳細" class="hash-link" aria-label="private_key_jwt の詳細 への直接リンク" title="private_key_jwt の詳細 への直接リンク">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pkceproof-key-for-code-exchange">PKCE（Proof Key for Code Exchange）<a href="#pkceproof-key-for-code-exchange" class="hash-link" aria-label="PKCE（Proof Key for Code Exchange） への直接リンク" title="PKCE（Proof Key for Code Exchange） への直接リンク">​</a></h3>
<p>PKCEは、認可コードインターセプション攻撃を防ぐための仕組みです。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pkceの仕組み">PKCEの仕組み<a href="#pkceの仕組み" class="hash-link" aria-label="PKCEの仕組み への直接リンク" title="PKCEの仕組み への直接リンク">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PKCE のフロー:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Code Verifier 生成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - ランダムな文字列（43-128文字）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - [A-Z][a-z][0-9]-._~ のみ使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   例: dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Code Challenge 生成</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - S256 メソッド: SHA256(code_verifier) を Base64URL エンコード</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Plain メソッド: code_verifier そのまま（FAPI では禁止）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   code_challenge = BASE64URL(SHA256(code_verifier))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   例: E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 認可リクエスト</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   GET /authorize?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     response_type=code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;client_id=s6BhdRkqt3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;redirect_uri=https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;scope=openid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;state=af0ifjsldkj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     &amp;code_challenge_method=S256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 認可コード発行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   AS が code_challenge を保存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. トークンリクエスト</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   POST /token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   grant_type=authorization_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &amp;code=SplxlOBeZQQYbYS6WxSbIA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &amp;redirect_uri=https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &amp;client_id=s6BhdRkqt3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &amp;code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. AS が検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   BASE64URL(SHA256(code_verifier)) == code_challenge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   一致すればトークン発行</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pkce-の実装例">PKCE の実装例<a href="#pkce-の実装例" class="hash-link" aria-label="PKCE の実装例 への直接リンク" title="PKCE の実装例 への直接リンク">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-トークンの要件">ID トークンの要件<a href="#id-トークンの要件" class="hash-link" aria-label="ID トークンの要件 への直接リンク" title="ID トークンの要件 への直接リンク">​</a></h3>
<p>FAPI Baseline では、ID Token に特定のクレームが必要です。</p>
<table><thead><tr><th>クレーム</th><th>必須</th><th>説明</th><th>計算方法</th></tr></thead><tbody><tr><td><code>iss</code></td><td>✅</td><td>発行者（AS の URL）</td><td>固定値</td></tr><tr><td><code>sub</code></td><td>✅</td><td>ユーザーの一意識別子</td><td>ユーザーID</td></tr><tr><td><code>aud</code></td><td>✅</td><td>対象者（client_id）</td><td>配列または文字列</td></tr><tr><td><code>exp</code></td><td>✅</td><td>有効  期限（UNIX タイムスタンプ）</td><td>現在時刻 + 有効期限</td></tr><tr><td><code>iat</code></td><td>✅</td><td>発行時刻（UNIX タイムスタンプ）</td><td>現在時刻</td></tr><tr><td><code>nonce</code></td><td>条件付き</td><td>リプレイ防止（認可リクエストで提供された場合）</td><td>そのまま含める</td></tr><tr><td><code>s_hash</code></td><td>条件付き</td><td>state のハッシュ（response_type に token/id_token 含む場合）</td><td>SHA256(state) の左半分を Base64URL</td></tr><tr><td><code>c_hash</code></td><td>条件付き</td><td>code のハッシュ（response_type に code 含む場合）</td><td>SHA256(code) の左半分を Base64URL</td></tr><tr><td><code>auth_time</code></td><td>推奨</td><td>認証時刻</td><td>ユーザーが認証した時刻</td></tr><tr><td><code>acr</code></td><td>推奨</td><td>認証コンテキストクラス</td><td>認証レベル</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="s_hash-と-c_hash-の計算">s_hash と c_hash の計算<a href="#s_hash-と-c_hash-の計算" class="hash-link" aria-label="s_hash と c_hash の計算 への直接リンク" title="s_hash と c_hash の計算 への直接リンク">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="署名アルゴリズム">署名アルゴリズム<a href="#署名アルゴリズム" class="hash-link" aria-label="署名アルゴリズム への直接リンク" title="署名アルゴリズム への直接リンク">​</a></h3>
<p>FAPI Baseline では、使用できる署名アルゴリズムが制限されています。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Baseline で許可される署名アルゴリズム:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ID トークン:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ PS256, PS384, PS512  - RSASSA-PSS（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ ES256, ES384, ES512  - ECDSA（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ⚠️ RS256, RS384, RS512  - 許可されるが非推奨</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ❌ none                 - 禁止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ❌ HS256, HS384, HS512  - 禁止（対称鍵）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">トークンエンドポイント認証（client_secret_jwt）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ HS256, HS384, HS512  - 対称鍵</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">トークンエンドポイント認証（private_key_jwt）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ PS256, PS384, PS512  - RSASSA-PSS（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✅ ES256, ES384, ES512  - ECDSA（推奨）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ⚠️ RS256, RS384, RS512  - 許可されるが非推奨</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="なぜ-ps256--es256-が推奨されるか">なぜ PS256 / ES256 が推奨されるか？<a href="#なぜ-ps256--es256-が推奨されるか" class="hash-link" aria-label="なぜ PS256 / ES256 が推奨されるか？ への直接リンク" title="なぜ PS256 / ES256 が推奨されるか？ への直接リンク">​</a></h4>
<table><thead><tr><th>アルゴリズム</th><th>タイプ</th><th>セキュリティレベル</th><th>署名サイズ</th><th>推奨理由</th></tr></thead><tbody><tr><td><strong>PS256</strong></td><td>RSASSA-PSS</td><td>高</td><td>大</td><td>RS256 より安全、業界標準</td></tr><tr><td><strong>ES256</strong></td><td>ECDSA</td><td>高</td><td>小</td><td>高速、署名サイズが小さい</td></tr><tr><td>RS256</td><td>RSASSA-PKCS1-v1_5</td><td>中</td><td>大</td><td>脆弱性の可能性（Bleichenbacher 攻撃等）</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redirect_uri-の検証">redirect_uri の検証<a href="#redirect_uri-の検証" class="hash-link" aria-label="redirect_uri の検証 への直接リンク" title="redirect_uri の検証 への直接リンク">​</a></h3>
<p>FAPI Baseline では、redirect_uri の検証が厳格です。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">要件:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 完全一致での検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ワイルドカード禁止</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ローカルホストは許可されない（本番環境）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - HTTPS 必須（localhost を除く）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 大文字小文字を区別</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  登録: https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  リクエスト: https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → ✅ OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  リクエスト: https://client.example.com/callback?extra=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → ❌ NG（クエリパラメータが異なる）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  リクエスト: https://client.example.com/Callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → ❌ NG（大文字小文字が異なる）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  リクエスト: https://client.example.com/callback/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → ❌ NG（末尾のスラッシュが異なる）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  リクエスト: http://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → ❌ NG（HTTP は禁止）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="実装例">実装例<a href="#実装例" class="hash-link" aria-label="実装例 への直接リンク" title="実装例 への直接リンク">​</a></h4>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="認可リクエストの例">認可リクエストの例<a href="#認可リクエストの例" class="hash-link" aria-label="認可リクエストの例 への直接リンク" title="認可リクエストの例 への直接リンク">​</a></h3>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET /authorize?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response_type=code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;client_id=s6BhdRkqt3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;redirect_uri=https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;scope=openid accounts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;state=af0ifjsldkj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;nonce=n-0S6_WzA2Mj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;code_challenge_method=S256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;acr_values=urn:example:acr:loa2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>パラメータの詳細：</p>
<table><thead><tr><th>パラメータ</th><th>必須</th><th>説明</th><th>例</th></tr></thead><tbody><tr><td><code>response_type</code></td><td>✅</td><td>レスポンスタイプ</td><td><code>code</code></td></tr><tr><td><code>client_id</code></td><td>✅</td><td>クライアント ID</td><td><code>s6BhdRkqt3</code></td></tr><tr><td><code>redirect_uri</code></td><td>✅</td><td>リダイレクト URI</td><td><code>https://client.example.com/callback</code></td></tr><tr><td><code>scope</code></td><td>✅</td><td>スコープ（openid 必須）</td><td><code>openid accounts</code></td></tr><tr><td><code>state</code></td><td>✅</td><td>CSRF 対策</td><td>128ビット以上のランダム値</td></tr><tr><td><code>nonce</code></td><td>✅</td><td>リプレイ防止</td><td>128ビット以上のランダム値</td></tr><tr><td><code>code_challenge</code></td><td>✅</td><td>PKCE</td><td>SHA256(code_verifier) の Base64URL</td></tr><tr><td><code>code_challenge_method</code></td><td>✅</td><td>PKCE メソッド</td><td><code>S256</code> 固定</td></tr><tr><td><code>acr_values</code></td><td>△</td><td>認証レベル</td><td><code>urn:example:acr:loa2</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="トークンリクエストの例">トークンリクエストの例<a href="#トークンリクエストの例" class="hash-link" aria-label="トークンリクエストの例 への直接リンク" title="トークンリクエストの例 への直接リンク">​</a></h3>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /token HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: auth.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grant_type=authorization_code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;code=SplxlOBeZQQYbYS6WxSbIA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;redirect_uri=https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_id=s6BhdRkqt3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;client_assertion=eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="リソースサーバーの要件">リソースサーバーの要件<a href="#リソースサーバーの要件" class="hash-link" aria-label="リソースサーバーの要件 への直接リンク" title="リソースサーバーの要件 への直接リンク">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">アクセストークンの検証:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. トークンの形式検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - JWT の場合は署名を検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 参照トークンの場合はイントロスペクション</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 有効期限の検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - exp クレームを確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 現在時刻 &lt; exp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 発行者の検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - iss が信頼された認可サーバーか</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - ホワイトリストで管理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 対象者の検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - aud が自分（リソースサーバー）を含むか</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 複数の aud がある場合、いずれかに含まれるか</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. スコープの検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 要求されたアクションが許可されているか</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - scope クレームを確認</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. クレームの検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 必要なクレームが含まれているか</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - sub, client_id 等</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="アクセストークン検証の実装例">アクセストークン検証の実装例<a href="#アクセストークン検証の実装例" class="hash-link" aria-label="アクセストークン検証の実装例 への直接リンク" title="アクセストークン検証の実装例 への直接リンク">​</a></h4>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="第3部-セキュリティ">第3部: セキュリティ<a href="#第3部-セキュリティ" class="hash-link" aria-label="第3部: セキュリティ への直接リンク" title="第3部: セキュリティ への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="脅威モデルと攻撃シナリオ">脅威モデルと攻撃シナリオ<a href="#脅威モデルと攻撃シナリオ" class="hash-link" aria-label="脅威モデルと攻撃シナリオ への直接リンク" title="脅威モデルと攻撃シナリオ への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-pkce-の必須化">1. PKCE の必須化<a href="#1-pkce-の必須化" class="hash-link" aria-label="1. PKCE の必須化 への直接リンク" title="1. PKCE の必 須化 への直接リンク">​</a></h4>
<p><strong>なぜ必要か？</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">攻撃シナリオ（PKCE なし）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. ユーザーが公衆 Wi-Fi で認可フローを開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 攻撃者がネットワークを盗聴</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. AS からのリダイレクトで認可コード（code）を傍受</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   https://client.example.com/callback?code=STOLEN_CODE&amp;state=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 攻撃者が盗んだ code でトークンを取得</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. 攻撃者がユーザーのアカウントにアクセス</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策（PKCE あり）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. クライアントが code_verifier を生成（攻撃者は知らない）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 攻撃者が code を傍受</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 攻撃者がトークンリクエストを送信</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   → code_verifier がないため失敗</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 攻撃失敗</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-state-の検証">2. state の検証<a href="#2-state-の検証" class="hash-link" aria-label="2. state の検証 への直接リンク" title="2. state の検証 への直接リンク">​</a></h4>
<p><strong>なぜ必要か？</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CSRF 攻撃シナリオ（state なし）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 攻撃者が自分のアカウントで認可フローを開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. AS からのリダイレクトで認可コードを取得</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   https://attacker.com/callback?code=ATTACKER_CODE&amp;state=...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 攻撃者がコールバック URL を被害者に送信</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   https://client.example.com/callback?code=ATTACKER_CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 被害者がリンクをクリック</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. クライアントが攻撃者の code でトークンを取得</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6. 被害者が攻撃者のアカウントでログイン</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   → 被害者の情報が攻撃者のアカウントに保存される</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策（state あり）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. クライアントがセッションに state を保存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. コールバックで state を検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. state が一致しない場合は拒否</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 攻撃失敗</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-nonce-の検証">3. nonce の検証<a href="#3-nonce-の検証" class="hash-link" aria-label="3. nonce の検証 への直接リンク" title="3. nonce の検証 への直接リンク">​</a></h4>
<p><strong>なぜ必要か？</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">リプレイ攻撃シナリオ（nonce なし）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. 攻撃者が古い ID Token を入手</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 攻撃者が ID Token を再利用してログイン</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 成功（ リプレイ攻撃）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">対策（nonce あり）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. クライアントが認可リクエストに nonce を含める</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. AS が ID Token に nonce を含める</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. クライアントが ID Token の nonce を検証</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. 一度使用した nonce は無効化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. リプレイ攻撃失敗</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-redirect_uri-の完全一致検証">4. redirect_uri の完全一致検証<a href="#4-redirect_uri-の完全一致検証" class="hash-link" aria-label="4. redirect_uri の完全一致検証 への直接リンク" title="4. redirect_uri の完全一致検証 への直接リンク"> ​</a></h4>
<p><strong>なぜ必要か？</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">オープンリダイレクト攻撃（部分一致の場合）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">登録された redirect_uri: https://client.example.com/callback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">攻撃者のリクエスト:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  redirect_uri=https://client.example.com/callback@attacker.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">部分一致検証（脆弱）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;https://client.example.com/callback&quot; in &quot;https://client.example.com/callback@attacker.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → True（攻撃成功）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">完全一致検証（安全）:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;https://client.example.com/callback&quot; == &quot;https://client.example.com/callback@attacker.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  → False（攻撃失敗）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="よくあるfapi要件違反とエラー">よくあるFAPI要件違反とエラー<a href="#よくあるfapi要件違反とエラー" class="hash-link" aria-label="よくあるFAPI要件違反とエラー への直接リンク" title="よくあるFAPI要件違反とエラー への直接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="違反1-pkce-plain-メソッドの使用">違反1: PKCE Plain メソッドの使用<a href="#違反1-pkce-plain-メソッドの使用" class="hash-link" aria-label="違反1: PKCE Plain メソッドの使用 への直接リンク" title="違反1: PKCE Plain メソッドの使用 への直接リンク">​</a></h4>
<p><strong>エラー:</strong> <code>invalid_request</code> または要件不適合
<strong>セキュリティリスク:</strong> 認可コードインターセプション攻撃、code_verifierの盗聴
<strong>FAPI要件:</strong> PKCE S256メソッドのみが許可される。Plainメソッドは禁止
<strong>対策:</strong> <code>code_challenge_method=S256</code>を使用し、code_challengeをSHA-256でハッシュ化する</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="違反2-state-パラメータの未検証">違反2: state パラメータの未検証<a href="#違反2-state-パラメータの未検証" class="hash-link" aria-label="違反2: state パラメータの未検証 への直接リンク" title="違反2: state パラメータの未検証 への直接リンク">​</a></h4>
<p><strong>エラー:</strong> なし（セキュリティ脅威のみ）
<strong>セキュリティリスク:</strong> CSRF攻撃、セッション固定攻撃
<strong>FAPI要件:</strong> <code>state</code>パラメータは必須で、コールバック時に元のリクエストで生成した値と一致することを検証しなければならない
<strong>対策:</strong> 認可リクエスト時にセッションに<code>state</code>を保存し、コールバック時に一致を確認。不一致の場合は処理を中断する</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="違反3-nonce-パラメータの未検証">違反3: nonce パラメータの未検証<a href="#違反3-nonce-パラメータの未検証" class="hash-link" aria-label="違反3: nonce パラメータの未検証 への直接リンク" title="違反3: nonce パラメータの未検証 への直接リンク">​</a></h4>
<p><strong>エラー:</strong> なし（セキュリティ脅威のみ）
<strong>セキュリティリスク:</strong> ID Tokenリプレイ攻撃、古いトークンの再利用
<strong>FAPI要件:</strong> OpenID Connect使用時、<code>nonce</code>パラメータは必須で、ID Token内の<code>nonce</code>クレームと元のリクエストの値が一致することを検証しなければならない
<strong>対策:</strong> 認可リクエスト時にセッションに<code>nonce</code>を保存し、ID Token受信時に<code>nonce</code>クレームとの一致を確認する</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="違反4-redirect_uri-の部分一致検証">違反4: redirect_uri の部分一致検証<a href="#違反4-redirect_uri-の部分一致検証" class="hash-link" aria-label="違反4: redirect_uri の部分一致検証 への直接リンク" title="違反4: redirect_uri の部分一致検証 への直接リンク">​</a></h4>
<p><strong>エラー:</strong> <code>invalid_request</code>
<strong>セキュリティリスク:</strong> オープンリダイレクト攻撃、認可コードの窃取
<strong>FAPI要件:</strong> <code>redirect_uri</code>は登録された値と完全一致で検証しなければならない。部分一致やワイルドカードは禁止
<strong>対策:</strong> 登録されたredirect_uriとリクエストのredirect_uriを完全一致（文字列比較）で検証する</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="違反5-client_secret-のurlパラメータ送信">違反5: client_secret のURLパラメータ送信<a href="#違反5-client_secret-のurlパラメータ送信" class="hash-link" aria-label="違反5: client_secret のURLパラメータ送信 への直接リンク" title="違反5: client_secret のURLパラメータ送信 への直接リンク">​</a></h4>
<p><strong>エラー:</strong> なし（セキュリティ脅威のみ）
<strong>セキュリティリスク:</strong> ログ漏洩、プロキシでの盗聴、リファラーヘッダーでの漏洩
<strong>FAPI要件:</strong> クライアント認証情報はHTTPヘッダー（Authorization）またはリクエストボディで送信しなければならない
<strong>対策:</strong> <code>Authorization: Basic</code>ヘッダーまたは<code>client_secret_jwt</code>/<code>private_key_jwt</code>を使用する</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="セキュリティベストプラクティス">セキュリティベストプラクティス<a href="#セキュリティベストプラクティス" class="hash-link" aria-label="セキュリティベストプラクティス への直接リンク" title="セキュリティベストプラクティス への直  接リンク">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-pkce-の適切な実装">1. PKCE の適切な実装<a href="#1-pkce-の適切な実装" class="hash-link" aria-label="1. PKCE の適切な実装 への直接リンク" title="1. PKCE の適切な実装 への直接リンク">​</a></h4>
<p><strong>推奨事項:</strong></p>
<ul>
<li>S256メソッドのみ使用</li>
<li>code_verifierは43-128文字のランダム値</li>
<li>暗号学的に安全な乱数生成器を使用</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-トークン有効期限の設定">2. トークン有効期限の設定<a href="#2-トークン有効期限の設定" class="hash-link" aria-label="2. トークン有効期限の設定 への直接リンク" title="2. トークン有効期限の設定 への直接リンク">​</a></h4>
<p><strong>推奨値:</strong></p>
<table><thead><tr><th>トークン</th><th>推奨有効期限</th><th>理由</th></tr></thead><tbody><tr><td>認可コード</td><td>10分以内、理想は1分</td><td>攻撃の時間窓を最小化</td></tr><tr><td>アクセストークン</td><td>1時間</td><td>リフレッシュトークンで更新</td></tr><tr><td>リフレッシュトークン</td><td>ローテーション</td><td>盗難時の影響を最小化</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-クライアント認証の強化">3. クライアント認証の強化<a href="#3-クライアント認証の強化" class="hash-link" aria-label="3. クライアント認証の強化 への直接リンク" title="3. クライアント認証の強化 への直接リンク">​</a></h4>
<p><strong>推奨:</strong></p>
<ul>
<li>private_key_jwt または mTLS を使用</li>
<li>client_secret は最終手段</li>
<li>定期的な認証情報のローテーション</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-監査とログ">4. 監査とログ<a href="#4-監査とログ" class="hash-link" aria-label="4. 監査とログ への 直接リンク" title="4. 監査とログ への直接リンク">​</a></h4>
<p><strong>記録すべき項目:</strong></p>
<ul>
<li>すべての認可リクエスト</li>
<li>トークン発行・拒否</li>
<li>認証失敗</li>
<li>セキュリティエラー</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="セキュリティ理解度チェック">セキュリティ理解度チェック<a href="#セキュリティ理解度チェック" class="hash-link" aria-label="セキュリティ理解度チェック への直接リンク" title="セキュリティ理解度チェック への直接リンク">​</a></h3>
<p>この章を学習した後、以下を理解できているか確認してください：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="認可サーバーas">認可サーバー（AS）<a href="#認可サーバーas" class="hash-link" aria-label="認可サーバー（AS） への直接リンク" title="認可サーバー（AS） への直接リンク">​</a></h4>
<p>□ PKCE S256が認可コードインターセプション攻撃を防ぐ仕組みを説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>仕組み</strong>:</p><ol>
<li>クライアントがcode_verifier（ランダム値）を生成</li>
<li>code_challengeをSHA-256でハッシュ化して認可リクエストに含める</li>
<li>認可コードを取得</li>
<li>トークンリクエストで元のcode_verifierを送信</li>
<li>ASがcode_verifierをSHA-256ハッシュしてcode_challengeと一致するか検証</li>
</ol><p><strong>防ぐ脅威</strong>:
攻撃者が認可コードを傍受しても、code_verifierを持っていないためトークンを取得できない。</p><p><strong>FAPI Baseline要件</strong>:</p><ul>
<li>S256メソッドのみ許可（Plainメソッドは禁止）</li>
<li>パブリッククライアントには必須</li>
</ul></div></div></details>
<p>  □ stateパラメータがCSRF攻撃を防ぐ仕組みを説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>CSRF攻撃シナリオ（stateなし）</strong>:</p><ol>
<li>攻撃者が自分のアカウントで認可フローを開始</li>
<li>ASからのリダイレクトで認可コードを取得</li>
<li>攻撃者がコールバックURLを被害者に送信</li>
<li>被害者がリンクをクリック</li>
<li>クライアントが攻撃者のcodeでトークンを取得</li>
<li>被害者が攻撃者のアカウントでログイン
→ 被害者の情報が攻撃者のアカウントに保存される</li>
</ol><p><strong>対策（stateあり）</strong>:</p><ol>
<li>クライアントがセッションにstateを保存</li>
<li>コールバックでstateを検証</li>
<li>stateが一致しない場合は拒否</li>
<li>攻撃失敗</li>
</ol><p><strong>FAPI要件</strong>:</p><ul>
<li>128ビット以上のエントロピー</li>
<li>セッションとの紐付け必須</li>
<li>一度のみ使用</li>
</ul></div></div></details>
<p>□ nonceパラメータがID Tokenリプレイ攻撃を防ぐ仕組みを説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>リプレイ攻撃シナリオ（nonceなし）</strong>:</p><ol>
<li>攻撃者が古いID Tokenを入手</li>
<li>攻撃者がID Tokenを再利用してログイン</li>
<li>成功（リプレイ攻撃）</li>
</ol><p><strong>対策（nonceあり）</strong>:</p><ol>
<li>クライアントが認可リクエストにnonceを含める</li>
<li>ASがID Tokenにnonceを含める</li>
<li>クライアントがID Tokenのnonceを検証</li>
<li>一度使用したnonceは無効化</li>
<li>リプレイ攻撃失敗</li>
</ol><p><strong>実装のポイント</strong>:</p><ul>
<li>128ビット以上のランダム値</li>
<li>セッションに保存</li>
<li>ID Token受信時に一致を確認</li>
<li>一度使用したら削除</li>
</ul></div></div></details>
<p>□ redirect_uriの完全一致検証が必要な理由を、オープンリダイレクト攻撃の例とともに説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>オープンリダイレクト攻撃（部分一致の場合）</strong>:</p><p>登録されたredirect_uri: <code>https://client.example.com/callback</code></p><p>攻撃者のリクエスト:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">redirect_uri=https://client.example.com/callback@attacker.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>部分一致検証（脆弱）:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;https://client.example.com/callback&quot; in &quot;https://client.example.com/callback@attacker.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ True（攻撃成功）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>完全一致検証（安全）:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;https://client.example.com/callback&quot; == &quot;https://client.example.com/callback@attacker.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">→ False（攻撃失敗）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>FAPI要件</strong>:</p><ul>
<li>文字列の完全一致（大文字小文字区別）</li>
<li>ワイルドカード禁止</li>
<li>クエリパラメータやフラグメントも含めて完全一致</li>
</ul></div></div></details>
<p>□ PS256/ES256がRS256より推奨される理由を説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>署名アルゴリズムの比較</strong>:</p><table><thead><tr><th>アルゴリズム</th><th>タイプ</th><th>セキュリティレベル</th><th>推奨理由/リスク</th></tr></thead><tbody><tr><td><strong>PS256</strong></td><td>RSASSA-PSS</td><td>高</td><td>RS256より安全、業界標準</td></tr><tr><td><strong>ES256</strong></td><td>ECDSA</td><td>高</td><td>高速、署名サイズが小さい</td></tr><tr><td>RS256</td><td>RSASSA-PKCS1-v1_5</td><td>中</td><td>Bleichenbacher攻撃等の脆弱性の可能性</td></tr></tbody></table><p><strong>FAPI Baseline要件</strong>:</p><ul>
<li>PS256/ES256を推奨</li>
<li>RS256は許可されるが非推奨</li>
<li>HS256等の対称鍵アルゴリズムは禁止（ID Tokenの場合）</li>
</ul><p><strong>理由</strong>:</p><ul>
<li>PSS（Probabilistic Signature Scheme）パディングはPKCS#1 v1.5より安全</li>
<li>ECDSAは高速で署名サイズが小さい</li>
<li>金融業界の標準</li>
</ul></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="クライアントrp">クライアント（RP）<a href="#クライアントrp" class="hash-link" aria-label="クライアント（RP） への直接リンク" title="クライアント（RP） への直接リンク">​</a></h4>
<p>□ private_key_jwtがclient_secret_basicより安全な理由を説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>client_secret_basicのリスク</strong>:</p><ul>
<li>クライアントシークレットがネットワークを流れる</li>
<li>Authorization: Basic ヘッダーでBase64エンコード（暗号化ではない）</li>
<li>プロキシログやサーバーログに記録される可能性</li>
<li>HTTPS必須だが、TLS脆弱性のリスクあり</li>
</ul><p><strong>private_key_jwtの利点</strong>:</p><ol>
<li>
<p><strong>非対称鍵</strong></p>
<ul>
<li>秘密鍵はクライアントのみが保持</li>
<li>公開鍵のみをASに登録</li>
<li>秘密鍵がネットワークを流れない</li>
</ul>
</li>
<li>
<p><strong>署名ベース認証</strong></p>
<ul>
<li>クライアントがJWTを秘密鍵で署名</li>
<li>ASが公開鍵で検証</li>
<li>リプレイ攻撃防止（jti, exp）</li>
</ul>
</li>
<li>
<p><strong>監査可能</strong></p>
<ul>
<li>JWTに含まれるクレーム（iat, jti等）で追跡可能</li>
</ul>
</li>
</ol><p><strong>FAPI推奨</strong>:</p><ul>
<li>Baseline: private_key_jwt推奨、client_secret許可</li>
<li>Advanced: private_key_jwtまたはmTLS必須</li>
</ul></div></div></details>
<p>□ s_hashとc_hashの計算方法と検証目的を説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>s_hash（stateのハッシュ）</strong>:</p><p>計算方法:</p><ol>
<li>stateをASCIIオクテットとして取得</li>
<li>SHA-256でハッシュ</li>
<li>左半分（128ビット）をBase64URLエンコード</li>
</ol><p>目的:</p><ul>
<li>Implicit FlowまたはHybrid Flowで、レスポンスのstateが改ざんされていないことを検証</li>
<li>ID Token内のs_hashとstateを比較</li>
</ul><p><strong>c_hash（codeのハッシュ）</strong>:</p><p>計算方法:</p><ol>
<li>codeをASCIIオクテットとして取得</li>
<li>SHA-256でハッシュ</li>
<li>左半分（128ビット）をBase64URLエンコード</li>
</ol><p>目的:</p><ul>
<li>Hybrid Flowで、認可コードが改ざんされていないことを検証</li>
<li>ID Token内のc_hashとcodeを比較</li>
</ul><p><strong>使用場面</strong>:</p><ul>
<li>s_hash: response_typeにtokenまたはid_token含む場合（Implicit/Hybrid）</li>
<li>c_hash: response_typeにcode含む場合（Hybrid）</li>
<li>Authorization Code Flowのみの場合は不要</li>
</ul></div></div></details>
<p>□ 認可コードの有効期限を短く設定する理由と推奨値を説明できる</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>解答例</summary><div><div class="collapsibleContent_i85q"><p><strong>短い有効期限が必要な理由</strong>:</p><ol>
<li>
<p><strong>攻撃の時間窓を最小化</strong></p>
<ul>
<li>認可コードが傍受されても、短時間で無効化</li>
<li>攻撃者がトークンを取得する時間を制限</li>
</ul>
</li>
<li>
<p><strong>リプレイ攻撃の防止</strong></p>
<ul>
<li>期限切れのコードは使用不可</li>
<li>一度使用したコードは即座に無効化</li>
</ul>
</li>
<li>
<p><strong>セキュリティインシデントの影響範囲を限定</strong></p>
<ul>
<li>漏洩しても短期間で無効化</li>
</ul>
</li>
</ol><p><strong>FAPI Baseline推奨値</strong>:</p><ul>
<li>推奨: 10分以内</li>
<li>理想: 1分以内</li>
</ul><p><strong>実装のポイント</strong>:</p><ul>
<li>コードは一度のみ使用可能</li>
<li>使用後は即座に削除</li>
<li>タイムスタンプで厳密に検証</li>
<li>クロックスキューを考慮（±数秒の余裕）</li>
</ul></div></div></details>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考リンク">参考リンク<a href="#参考リンク" class="hash-link" aria-label="参考リンク への直接リンク" title="参考リンク への直接リンク">​</a></h2>
<ul>
<li><a href="https://openid.net/specs/openid-financial-api-part-1-1_0.html" target="_blank" rel="noopener noreferrer">FAPI 1.0 Baseline Profile</a></li>
<li><a href="https://openid.net/specs/openid-financial-api-part-2-1_0.html" target="_blank" rel="noopener noreferrer">FAPI 1.0 Advanced Profile</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7636" target="_blank" rel="noopener noreferrer">RFC 7636 - PKCE</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_blank" rel="noopener noreferrer">OpenID Connect Core 1.0</a></li>
<li><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics" target="_blank" rel="noopener noreferrer">OAuth 2.0 Security Best Current Practice</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="まとめ">まとめ<a href="#まとめ" class="hash-link" aria-label="まとめ への直接リンク" title="まとめ への直接リンク">​</a></h2>
<p>FAPI 1.0 Baseline Profile は、金融グレードの API を安全に提供するための基本レベルのセキュリティプロファイルです。以下のポイントを押さえて実装してください：</p>
<ol>
<li>
<p><strong>必須要件の遵守</strong></p>
<ul>
<li>PKCE（S256 メソッド）を必須化</li>
<li>state と nonce を必須化</li>
<li>redirect_uri の完全一致検証</li>
</ul>
</li>
<li>
<p><strong>クライアント認証の強化</strong></p>
<ul>
<li>private_key_jwt または mTLS を推奨</li>
<li>client_secret は非推奨</li>
</ul>
</li>
<li>
<p><strong>署名アルゴリズム</strong></p>
<ul>
<li>PS256 または ES256 を推奨</li>
<li>RS256 は非推奨</li>
</ul>
</li>
<li>
<p><strong>テストの徹底</strong></p>
<ul>
<li>正常フロー、攻撃シナリオをテスト</li>
<li>セキュリティチェックリストを活用</li>
</ul>
</li>
</ol>
<p>FAPI Baseline は読み取り専 用 API に適していますが、書き込み操作や決済には FAPI Advanced Profile の使用を検討してください。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/16-oauth-oidc-rfc/advanced/fapi1-baseline.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi1-advanced"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">FAPI 1.0 Advanced Profile</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/idp-server/docs/content_11_learning/oauth-oidc-rfc/advanced/fapi2-security"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">FAPI 2.0 Security Profile</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#目次" class="table-of-contents__link toc-highlight">目次</a></li><li><a href="#第1部-概要編" class="table-of-contents__link toc-highlight">第1部: 概要編</a><ul><li><a href="#fapi-とは" class="table-of-contents__link toc-highlight">FAPI とは？</a></li><li><a href="#なぜ-fapi-が必要なのか" class="table-of-contents__link toc-highlight">なぜ FAPI が必要なのか？</a></li><li><a href="#baseline-vs-advanced" class="table-of-contents__link toc-highlight">Baseline vs Advanced</a></li><li><a href="#実際のユースケース" class="table-of-contents__link toc-highlight">実際のユースケース</a></li><li><a href="#fapi-10-と他の仕様との関係" class="table-of-contents__link toc-highlight">FAPI 1.0 と他の仕様との関係</a></li></ul></li><li><a href="#第2部-詳細編" class="table-of-contents__link toc-highlight">第2部: 詳細編</a><ul><li><a href="#認可サーバーの要件" class="table-of-contents__link toc-highlight">認可サーバーの要件</a></li><li><a href="#クライアント認証" class="table-of-contents__link toc-highlight">クライアント認証</a></li><li><a href="#pkceproof-key-for-code-exchange" class="table-of-contents__link toc-highlight">PKCE（Proof Key for Code Exchange）</a></li><li><a href="#id-トークンの要件" class="table-of-contents__link toc-highlight">ID トークンの要件</a></li><li><a href="#署名アルゴリズム" class="table-of-contents__link toc-highlight">署名アルゴリズム</a></li><li><a href="#redirect_uri-の検証" class="table-of-contents__link toc-highlight">redirect_uri の検証</a></li><li><a href="#認可リクエストの例" class="table-of-contents__link toc-highlight">認可リクエストの例</a></li><li><a href="#トークンリクエストの例" class="table-of-contents__link toc-highlight">トークンリクエストの例</a></li><li><a href="#リソースサーバーの要件" class="table-of-contents__link toc-highlight">リソースサーバーの要件</a></li></ul></li><li><a href="#第3部-セキュリティ" class="table-of-contents__link toc-highlight">第3部: セキュリティ</a><ul><li><a href="#脅威モデルと攻撃シナリオ" class="table-of-contents__link toc-highlight">脅威モデルと攻撃シナリオ</a></li><li><a href="#よくあるfapi要件違反とエラー" class="table-of-contents__link toc-highlight">よくあるFAPI要件違反とエラー</a></li><li><a href="#セキュリティベストプラクティス" class="table-of-contents__link toc-highlight">セキュリティベストプラクティス</a></li><li><a href="#セキュリティ理解度チェック" class="table-of-contents__link toc-highlight">セキュリティ理解度チェック</a></li></ul></li><li><a href="#参考リンク" class="table-of-contents__link toc-highlight">参考リンク</a></li><li><a href="#まとめ" class="table-of-contents__link toc-highlight">まとめ</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/docs/introduction">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/idp-server/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>