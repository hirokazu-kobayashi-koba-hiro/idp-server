"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6175],{30392:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>s,contentTitle:()=>l,default:()=>o,frontMatter:()=>d,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"content_11_learning/crypto/symmetric-encryption","title":"\u5171\u901a\u9375\u6697\u53f7\uff08\u5bfe\u79f0\u6697\u53f7\uff09","description":"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684","source":"@site/docs/content_11_learning/12-crypto/symmetric-encryption.md","sourceDirName":"content_11_learning/12-crypto","slug":"/content_11_learning/crypto/symmetric-encryption","permalink":"/idp-server/docs/content_11_learning/crypto/symmetric-encryption","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/12-crypto/symmetric-encryption.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u6697\u53f7\u5316\u5165\u9580 - \u306a\u305c\u6697\u53f7\u5316\u304c\u5fc5\u8981\u306a\u306e\u304b","permalink":"/idp-server/docs/content_11_learning/crypto/crypto-introduction"},"next":{"title":"\u516c\u958b\u9375\u6697\u53f7\uff08\u975e\u5bfe\u79f0\u6697\u53f7\uff09","permalink":"/idp-server/docs/content_11_learning/crypto/asymmetric-encryption"}}');var i=t(74848),c=t(28453);const d={},l="\u5171\u901a\u9375\u6697\u53f7\uff08\u5bfe\u79f0\u6697\u53f7\uff09",s={},h=[{value:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",level:2},{value:"\u5171\u901a\u9375\u6697\u53f7\u3068\u306f",id:"\u5171\u901a\u9375\u6697\u53f7\u3068\u306f",level:2},{value:"\u4ee3\u8868\u7684\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",id:"\u4ee3\u8868\u7684\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",level:2},{value:"AES\uff08Advanced Encryption Standard\uff09",id:"aesadvanced-encryption-standard",level:3},{value:"\u9375\u9577\u306b\u3088\u308b\u5f37\u5ea6",id:"\u9375\u9577\u306b\u3088\u308b\u5f37\u5ea6",level:4},{value:"ChaCha20",id:"chacha20",level:3},{value:"\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9",id:"\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9",level:2},{value:"ECB\uff08Electronic Codebook\uff09- \u4f7f\u7528\u7981\u6b62",id:"ecbelectronic-codebook--\u4f7f\u7528\u7981\u6b62",level:3},{value:"CBC\uff08Cipher Block Chaining\uff09",id:"cbccipher-block-chaining",level:3},{value:"GCM\uff08Galois/Counter Mode\uff09- \u63a8\u5968",id:"gcmgaloiscounter-mode--\u63a8\u5968",level:3},{value:"AEAD\uff08Authenticated Encryption with Associated Data\uff09",id:"aeadauthenticated-encryption-with-associated-data",level:2},{value:"\u5b9f\u88c5\u4f8b",id:"\u5b9f\u88c5\u4f8b",level:2},{value:"Java\uff08AES-GCM\uff09",id:"javaaes-gcm",level:3},{value:"JavaScript\uff08Web Crypto API\uff09",id:"javascriptweb-crypto-api",level:3},{value:"\u9375\u306e\u8ab2\u984c",id:"\u9375\u306e\u8ab2\u984c",level:2},{value:"\u9375\u914d\u9001\u554f\u984c",id:"\u9375\u914d\u9001\u554f\u984c",level:3},{value:"\u9375\u306e\u7ba1\u7406",id:"\u9375\u306e\u7ba1\u7406",level:3},{value:"\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u7ba1\u7406\u3067\u306e\u4f7f\u7528\u4f8b",id:"\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u7ba1\u7406\u3067\u306e\u4f7f\u7528\u4f8b",level:2},{value:"1. \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6697\u53f7\u5316",id:"1-\u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6697\u53f7\u5316",level:3},{value:"2. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6697\u53f7\u5316",id:"2-\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6697\u53f7\u5316",level:3},{value:"3. \u30c8\u30fc\u30af\u30f3\u306e\u6697\u53f7\u5316",id:"3-\u30c8\u30fc\u30af\u30f3\u306e\u6697\u53f7\u5316",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u6ce8\u610f\u70b9",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u6ce8\u610f\u70b9",level:2},{value:"\u3084\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3053\u3068",id:"\u3084\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3053\u3068",level:3},{value:"IV\u306e\u518d\u5229\u7528\u306f\u81f4\u547d\u7684",id:"iv\u306e\u518d\u5229\u7528\u306f\u81f4\u547d\u7684",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u5171\u901a\u9375\u6697\u53f7\u5bfe\u79f0\u6697\u53f7",children:"\u5171\u901a\u9375\u6697\u53f7\uff08\u5bfe\u79f0\u6697\u53f7\uff09"})}),"\n",(0,i.jsx)(e.h2,{id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5171\u901a\u9375\u6697\u53f7\uff08Symmetric Encryption\uff09"})," \u306e\u4ed5\u7d44\u307f\u3092\u7406\u89e3\u3057\u3001\u4ee3\u8868\u7684\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3068\u5b9f\u969b\u306e\u4f7f\u7528\u4f8b\u3092\u5b66\u3073\u307e\u3059\u3002"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5171\u901a\u9375\u6697\u53f7\u3068\u306f",children:"\u5171\u901a\u9375\u6697\u53f7\u3068\u306f"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5171\u901a\u9375\u6697\u53f7\uff08\u5bfe\u79f0\u6697\u53f7\uff09"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u6697\u53f7\u5316\u3068\u5fa9\u53f7\u306b",(0,i.jsx)(e.strong,{children:"\u540c\u3058\u9375"}),"\u3092\u4f7f\u7528\u3059\u308b"]}),"\n",(0,i.jsx)(e.li,{children:"\u51e6\u7406\u304c\u9ad8\u901f\u3067\u3001\u5927\u91cf\u306e\u30c7\u30fc\u30bf\u6697\u53f7\u5316\u306b\u9069\u3057\u3066\u3044\u308b"}),"\n",(0,i.jsx)(e.li,{children:"\u9375\u306e\u5b89\u5168\u306a\u5171\u6709\u304c\u8ab2\u984c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"[\u9001\u4fe1\u8005]                           [\u53d7\u4fe1\u8005]\n   \u2502                                   \u2502\n   \u2502 \u2500\u2500\u2500\u2500 \u540c\u3058\u79d8\u5bc6\u9375\u3092\u5171\u6709 \u2500\u2500\u2500\u2500\u2192       \u2502\n   \u2502                                   \u2502\n   \u2502 \u300cHello\u300d                         \u2502\n   \u2502    \u2193 \u6697\u53f7\u5316\uff08\u79d8\u5bc6\u9375\u4f7f\u7528\uff09         \u2502\n   \u2502 \u300cX8f2kL9\u300d                       \u2502\n   \u2502 \u2500\u2500\u2500\u2500 \u6697\u53f7\u6587\u3092\u9001\u4fe1 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192       \u2502\n   \u2502                                   \u2502\n   \u2502                          \u300cX8f2kL9\u300d\n   \u2502                             \u2193 \u5fa9\u53f7\uff08\u540c\u3058\u79d8\u5bc6\u9375\uff09\n   \u2502                          \u300cHello\u300d\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u4ee3\u8868\u7684\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",children:"\u4ee3\u8868\u7684\u306a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),"\n",(0,i.jsx)(e.h3,{id:"aesadvanced-encryption-standard",children:"AES\uff08Advanced Encryption Standard\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6700\u3082\u5e83\u304f\u4f7f\u308f\u308c\u3066\u3044\u308b\u5171\u901a\u9375\u6697\u53f7"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7279\u5fb4:\n- 2001\u5e74\u306bNIST\u304c\u6a19\u6e96\u5316\n- \u30d6\u30ed\u30c3\u30af\u30b5\u30a4\u30ba: 128\u30d3\u30c3\u30c8\n- \u9375\u9577: 128/192/256\u30d3\u30c3\u30c8\n- \u9ad8\u901f\u3067\u5b89\u5168\u6027\u304c\u9ad8\u3044\n\n\u4f7f\u7528\u4f8b:\n- HTTPS/TLS\u901a\u4fe1\n- \u30d5\u30a1\u30a4\u30eb\u6697\u53f7\u5316\n- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6697\u53f7\u5316\n- VPN\n"})}),"\n",(0,i.jsx)(e.h4,{id:"\u9375\u9577\u306b\u3088\u308b\u5f37\u5ea6",children:"\u9375\u9577\u306b\u3088\u308b\u5f37\u5ea6"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u9375\u9577"}),(0,i.jsx)(e.th,{children:"\u5b89\u5168\u6027"}),(0,i.jsx)(e.th,{children:"\u7528\u9014"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"AES-128"}),(0,i.jsx)(e.td,{children:"\u9ad8\u3044"}),(0,i.jsx)(e.td,{children:"\u4e00\u822c\u7684\u306a\u7528\u9014"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"AES-192"}),(0,i.jsx)(e.td,{children:"\u3088\u308a\u9ad8\u3044"}),(0,i.jsx)(e.td,{children:"\u6a5f\u5bc6\u6027\u306e\u9ad8\u3044\u30c7\u30fc\u30bf"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"AES-256"}),(0,i.jsx)(e.td,{children:"\u6700\u3082\u9ad8\u3044"}),(0,i.jsx)(e.td,{children:"\u653f\u5e9c\u30fb\u8ecd\u4e8b\u30ec\u30d9\u30eb"})]})]})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"chacha20",children:"ChaCha20"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u30e2\u30d0\u30a4\u30eb\u74b0\u5883\u3067\u4eba\u6c17\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u6697\u53f7"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7279\u5fb4:\n- Google\u958b\u767a\n- \u30b9\u30c8\u30ea\u30fc\u30e0\u6697\u53f7\uff08\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u3067\u306f\u306a\u3044\uff09\n- \u30cf\u30fc\u30c9\u30a6\u30a7\u30a2\u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30b7\u30e7\u30f3\u306a\u3057\u3067\u3082\u9ad8\u901f\n- TLS 1.3\u3067\u63a1\u7528\n\nAES\u3068\u306e\u6bd4\u8f03:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502             \u2502      AES        \u2502    ChaCha20     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u7a2e\u985e        \u2502 \u30d6\u30ed\u30c3\u30af\u6697\u53f7    \u2502 \u30b9\u30c8\u30ea\u30fc\u30e0\u6697\u53f7  \u2502\n\u2502 HW\u652f\u63f4      \u2502 \u5fc5\u8981\uff08\u9ad8\u901f\u5316\uff09  \u2502 \u4e0d\u8981            \u2502\n\u2502 \u30e2\u30d0\u30a4\u30eb    \u2502 \u3084\u3084\u9045\u3044        \u2502 \u9ad8\u901f            \u2502\n\u2502 \u63a1\u7528        \u2502 TLS, IPsec\u7b49    \u2502 TLS 1.3, WireGuard \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9",children:"\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u306e\u52d5\u4f5c\u30e2\u30fc\u30c9"}),"\n",(0,i.jsx)(e.p,{children:"AES\u306e\u3088\u3046\u306a\u30d6\u30ed\u30c3\u30af\u6697\u53f7\u306f\u3001\u56fa\u5b9a\u30b5\u30a4\u30ba\uff08128\u30d3\u30c3\u30c8\uff09\u306e\u30d6\u30ed\u30c3\u30af\u5358\u4f4d\u3067\u51e6\u7406\u3057\u307e\u3059\u3002\n\u9577\u3044\u30c7\u30fc\u30bf\u3092\u6697\u53f7\u5316\u3059\u308b\u306b\u306f\u300c\u52d5\u4f5c\u30e2\u30fc\u30c9\u300d\u304c\u5fc5\u8981\u3067\u3059\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"ecbelectronic-codebook--\u4f7f\u7528\u7981\u6b62",children:"ECB\uff08Electronic Codebook\uff09- \u4f7f\u7528\u7981\u6b62"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u274c ECB\u30e2\u30fc\u30c9\uff08\u4f7f\u3063\u3066\u306f\u3044\u3051\u306a\u3044\uff09\n\n\u540c\u3058\u5e73\u6587\u30d6\u30ed\u30c3\u30af \u2192 \u540c\u3058\u6697\u53f7\u6587\u30d6\u30ed\u30c3\u30af\n\n\u5e73\u6587:  [\u30d6\u30ed\u30c3\u30af1][\u30d6\u30ed\u30c3\u30af1][\u30d6\u30ed\u30c3\u30af2]\n\u6697\u53f7\u6587: [\u6697\u53f7A   ][\u6697\u53f7A   ][\u6697\u53f7B   ]\n                 \u2191 \u540c\u3058\u306b\u306a\u3063\u3066\u3057\u307e\u3046\uff01\n\n\u554f\u984c\u70b9:\n- \u30d1\u30bf\u30fc\u30f3\u304c\u6f0f\u308c\u308b\n- \u6709\u540d\u306a\u300c\u30da\u30f3\u30ae\u30f3\u554f\u984c\u300d\uff1a\u753b\u50cf\u3092\u6697\u53f7\u5316\u3057\u3066\u3082\u8f2a\u90ed\u304c\u898b\u3048\u308b\n"})}),"\n",(0,i.jsx)(e.h3,{id:"cbccipher-block-chaining",children:"CBC\uff08Cipher Block Chaining\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u26a0\ufe0f CBC\u30e2\u30fc\u30c9\uff08\u30ec\u30ac\u30b7\u30fc\u3001\u65b0\u898f\u3067\u306f\u975e\u63a8\u5968\uff09\n\n\u524d\u306e\u30d6\u30ed\u30c3\u30af\u306e\u6697\u53f7\u6587\u3092\u6b21\u306e\u30d6\u30ed\u30c3\u30af\u306e\u6697\u53f7\u5316\u306b\u4f7f\u7528\n\n\u5e73\u65871 \u2500\u2500\u2192 XOR \u2500\u2500\u2192 \u6697\u53f7\u5316 \u2500\u2500\u2192 \u6697\u53f7\u65871\n            \u2191                      \u2502\n           IV                      \u2193\n\u5e73\u65872 \u2500\u2500\u2192 XOR \u2500\u2500\u2192 \u6697\u53f7\u5316 \u2500\u2500\u2192 \u6697\u53f7\u65872\n            \u2191                      \u2502\n        \u6697\u53f7\u65871                    \u2193\n                              ...\n\nIV (Initialization Vector):\n- \u6700\u521d\u306e\u30d6\u30ed\u30c3\u30af\u7528\u306e\u30e9\u30f3\u30c0\u30e0\u5024\n- \u6697\u53f7\u6587\u3068\u4e00\u7dd2\u306b\u9001\u4fe1\n- \u79d8\u5bc6\u306b\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u304c\u3001\u4e88\u6e2c\u4e0d\u53ef\u80fd\u3067\u3042\u308b\u3053\u3068\n\n\u554f\u984c\u70b9:\n- \u30d1\u30c7\u30a3\u30f3\u30b0\u30aa\u30e9\u30af\u30eb\u653b\u6483\u306b\u8106\u5f31\n- \u4e26\u5217\u51e6\u7406\u304c\u3067\u304d\u306a\u3044\n"})}),"\n",(0,i.jsx)(e.h3,{id:"gcmgaloiscounter-mode--\u63a8\u5968",children:"GCM\uff08Galois/Counter Mode\uff09- \u63a8\u5968"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u2b55 GCM\u30e2\u30fc\u30c9\uff08\u73fe\u5728\u306e\u63a8\u5968\uff09\n\n\u6697\u53f7\u5316 + \u8a8d\u8a3c\u3092\u540c\u6642\u306b\u884c\u3046\uff08AEAD\uff09\n\n\u7279\u5fb4:\n- \u6697\u53f7\u5316\u3068\u540c\u6642\u306bMAC\uff08\u8a8d\u8a3c\u30bf\u30b0\uff09\u3092\u751f\u6210\n- \u6539\u3056\u3093\u691c\u77e5\u304c\u53ef\u80fd\n- \u4e26\u5217\u51e6\u7406\u304c\u53ef\u80fd\u3067\u9ad8\u901f\n\n\u69cb\u6210:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              AES-GCM                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u5165\u529b: \u5e73\u6587 + \u8ffd\u52a0\u8a8d\u8a3c\u30c7\u30fc\u30bf(AAD)       \u2502\n\u2502  \u51fa\u529b: \u6697\u53f7\u6587 + \u8a8d\u8a3c\u30bf\u30b0(128\u30d3\u30c3\u30c8)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u8ffd\u52a0\u8a8d\u8a3c\u30c7\u30fc\u30bf(AAD):\n- \u6697\u53f7\u5316\u3057\u306a\u3044\u304c\u8a8d\u8a3c\u3057\u305f\u3044\u30c7\u30fc\u30bf\n- \u4f8b: HTTP\u30d8\u30c3\u30c0\u30fc\u3001\u30e1\u30bf\u30c7\u30fc\u30bf\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"aeadauthenticated-encryption-with-associated-data",children:"AEAD\uff08Authenticated Encryption with Associated Data\uff09"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u73fe\u4ee3\u306e\u6697\u53f7\u5316\u3067\u306f\u5fc5\u9808\u306e\u6982\u5ff5"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u5f93\u6765\u306e\u6697\u53f7\u5316:\n  \u6697\u53f7\u5316\u306e\u307f \u2192 \u6539\u3056\u3093\u3055\u308c\u3066\u3082\u6c17\u3065\u304b\u306a\u3044\n\nAEAD:\n  \u6697\u53f7\u5316 + \u8a8d\u8a3c \u2192 \u6539\u3056\u3093\u3092\u691c\u77e5\u3067\u304d\u308b\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   AEAD                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u6a5f\u5bc6\u6027: \u30c7\u30fc\u30bf\u3092\u8aad\u3081\u306a\u304f\u3059\u308b               \u2502\n\u2502  \u5b8c\u5168\u6027: \u30c7\u30fc\u30bf\u304c\u6539\u3056\u3093\u3055\u308c\u3066\u3044\u306a\u3044\u3053\u3068\u3092\u78ba\u8a8d \u2502\n\u2502  \u8a8d\u8a3c:   \u6b63\u3057\u3044\u9001\u4fe1\u8005\u304b\u3089\u306e\u30c7\u30fc\u30bf\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u4ee3\u8868\u7684\u306aAEAD:\n- AES-GCM\uff08\u6700\u3082\u4e00\u822c\u7684\uff09\n- ChaCha20-Poly1305\uff08\u30e2\u30d0\u30a4\u30eb\u5411\u3051\uff09\n- AES-CCM\uff08IoT\u5411\u3051\u3001\u30e1\u30e2\u30ea\u52b9\u7387\u304c\u826f\u3044\uff09\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u5b9f\u88c5\u4f8b",children:"\u5b9f\u88c5\u4f8b"}),"\n",(0,i.jsx)(e.h3,{id:"javaaes-gcm",children:"Java\uff08AES-GCM\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'import javax.crypto.Cipher;\nimport javax.crypto.KeyGenerator;\nimport javax.crypto.SecretKey;\nimport javax.crypto.spec.GCMParameterSpec;\nimport java.security.SecureRandom;\n\npublic class AesGcmExample {\n\n    private static final int GCM_IV_LENGTH = 12;  // 96\u30d3\u30c3\u30c8\uff08\u63a8\u5968\uff09\n    private static final int GCM_TAG_LENGTH = 128; // \u8a8d\u8a3c\u30bf\u30b0\u9577\n\n    // \u6697\u53f7\u5316\n    public static byte[] encrypt(byte[] plaintext, SecretKey key) throws Exception {\n        // \u30e9\u30f3\u30c0\u30e0\u306aIV\u3092\u751f\u6210\n        byte[] iv = new byte[GCM_IV_LENGTH];\n        SecureRandom random = new SecureRandom();\n        random.nextBytes(iv);\n\n        // \u6697\u53f7\u5316\n        Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");\n        GCMParameterSpec spec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);\n        cipher.init(Cipher.ENCRYPT_MODE, key, spec);\n\n        byte[] ciphertext = cipher.doFinal(plaintext);\n\n        // IV + \u6697\u53f7\u6587\u3092\u7d50\u5408\u3057\u3066\u8fd4\u3059\n        byte[] result = new byte[iv.length + ciphertext.length];\n        System.arraycopy(iv, 0, result, 0, iv.length);\n        System.arraycopy(ciphertext, 0, result, iv.length, ciphertext.length);\n\n        return result;\n    }\n\n    // \u5fa9\u53f7\n    public static byte[] decrypt(byte[] ciphertextWithIv, SecretKey key) throws Exception {\n        // IV\u3092\u62bd\u51fa\n        byte[] iv = new byte[GCM_IV_LENGTH];\n        System.arraycopy(ciphertextWithIv, 0, iv, 0, iv.length);\n\n        // \u6697\u53f7\u6587\u3092\u62bd\u51fa\n        byte[] ciphertext = new byte[ciphertextWithIv.length - iv.length];\n        System.arraycopy(ciphertextWithIv, iv.length, ciphertext, 0, ciphertext.length);\n\n        // \u5fa9\u53f7\n        Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");\n        GCMParameterSpec spec = new GCMParameterSpec(GCM_TAG_LENGTH, iv);\n        cipher.init(Cipher.DECRYPT_MODE, key, spec);\n\n        return cipher.doFinal(ciphertext);\n    }\n\n    // \u9375\u751f\u6210\n    public static SecretKey generateKey() throws Exception {\n        KeyGenerator keyGen = KeyGenerator.getInstance("AES");\n        keyGen.init(256); // AES-256\n        return keyGen.generateKey();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"javascriptweb-crypto-api",children:"JavaScript\uff08Web Crypto API\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-javascript",children:'// \u9375\u751f\u6210\nasync function generateKey() {\n    return await crypto.subtle.generateKey(\n        { name: "AES-GCM", length: 256 },\n        true,  // extractable\n        ["encrypt", "decrypt"]\n    );\n}\n\n// \u6697\u53f7\u5316\nasync function encrypt(plaintext, key) {\n    const iv = crypto.getRandomValues(new Uint8Array(12)); // 96\u30d3\u30c3\u30c8IV\n    const encoded = new TextEncoder().encode(plaintext);\n\n    const ciphertext = await crypto.subtle.encrypt(\n        { name: "AES-GCM", iv: iv },\n        key,\n        encoded\n    );\n\n    // IV + \u6697\u53f7\u6587\u3092\u7d50\u5408\n    const result = new Uint8Array(iv.length + ciphertext.byteLength);\n    result.set(iv);\n    result.set(new Uint8Array(ciphertext), iv.length);\n\n    return result;\n}\n\n// \u5fa9\u53f7\nasync function decrypt(ciphertextWithIv, key) {\n    const iv = ciphertextWithIv.slice(0, 12);\n    const ciphertext = ciphertextWithIv.slice(12);\n\n    const decrypted = await crypto.subtle.decrypt(\n        { name: "AES-GCM", iv: iv },\n        key,\n        ciphertext\n    );\n\n    return new TextDecoder().decode(decrypted);\n}\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u9375\u306e\u8ab2\u984c",children:"\u9375\u306e\u8ab2\u984c"}),"\n",(0,i.jsx)(e.h3,{id:"\u9375\u914d\u9001\u554f\u984c",children:"\u9375\u914d\u9001\u554f\u984c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u5171\u901a\u9375\u6697\u53f7\u306e\u6700\u5927\u306e\u8ab2\u984c: \u3069\u3046\u3084\u3063\u3066\u9375\u3092\u5b89\u5168\u306b\u5171\u6709\u3059\u308b\u304b\uff1f\n\n[\u9001\u4fe1\u8005]                           [\u53d7\u4fe1\u8005]\n   \u2502                                   \u2502\n   \u2502 \u2500\u2500\u2500 \u79d8\u5bc6\u9375\u3092\u3069\u3046\u9001\u308b\uff1f \u2500\u2500\u2500\u2192      \u2502\n   \u2502        \u2191                          \u2502\n   \u2502    [\u653b\u6483\u8005] \u2190 \u508d\u53d7\u3055\u308c\u305f\u3089\u7d42\u308f\u308a\uff01 \u2502\n\n\u89e3\u6c7a\u7b56:\n1. \u516c\u958b\u9375\u6697\u53f7\u3067\u9375\u4ea4\u63db\uff08\u6b21\u7ae0\u3067\u8aac\u660e\uff09\n2. \u4e8b\u524d\u306b\u5b89\u5168\u306a\u65b9\u6cd5\u3067\u5171\u6709\uff08\u7269\u7406\u7684\u306a\u53d7\u3051\u6e21\u3057\u306a\u3069\uff09\n3. \u9375\u5c0e\u51fa\u95a2\u6570\uff08KDF\uff09\u3067\u5171\u6709\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u304b\u3089\u751f\u6210\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u9375\u306e\u7ba1\u7406",children:"\u9375\u306e\u7ba1\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'\u26a0\ufe0f \u91cd\u8981\u306a\u6ce8\u610f\u70b9\n\n1. \u9375\u3092\u30b3\u30fc\u30c9\u306b\u30cf\u30fc\u30c9\u30b3\u30fc\u30c9\u3057\u306a\u3044\n   \u274c private static final String KEY = "mysecretkey123";\n   \u2b55 \u74b0\u5883\u5909\u6570\u3084\u9375\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0\u304b\u3089\u53d6\u5f97\n\n2. \u9375\u3092\u5b9a\u671f\u7684\u306b\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\n   - \u6697\u53f7\u5316\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306b\u9375ID\u3092\u542b\u3081\u308b\n   - \u53e4\u3044\u30c7\u30fc\u30bf\u306f\u518d\u6697\u53f7\u5316\u3059\u308b\u304b\u3001\u53e4\u3044\u9375\u3082\u4fdd\u6301\n\n3. \u5b89\u5168\u306a\u4e71\u6570\u751f\u6210\u5668\u3092\u4f7f\u7528\n   \u274c new Random()\n   \u2b55 new SecureRandom()\n'})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u7ba1\u7406\u3067\u306e\u4f7f\u7528\u4f8b",children:"\u30a2\u30a4\u30c7\u30f3\u30c6\u30a3\u30c6\u30a3\u7ba1\u7406\u3067\u306e\u4f7f\u7528\u4f8b"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6697\u53f7\u5316",children:"1. \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6697\u53f7\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3059\u308b\u30bb\u30c3\u30b7\u30e7\u30f3\u60c5\u5831\u3092\u6697\u53f7\u5316\n\n[\u30b5\u30fc\u30d0\u30fc]\n   \u2502\n   \u2502 \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092AES-GCM\u3067\u6697\u53f7\u5316\n   \u2502 \u6697\u53f7\u5316\u3055\u308c\u305fCookie\u3092\u9001\u4fe1\n   \u2502\n   \u2193\n[\u30d6\u30e9\u30a6\u30b6] \u2190 Cookie\u3092\u4fdd\u5b58\uff08\u8aad\u3081\u306a\u3044\uff09\n   \u2502\n   \u2502 \u30ea\u30af\u30a8\u30b9\u30c8\u6642\u306bCookie\u3092\u9001\u4fe1\n   \u2502\n   \u2193\n[\u30b5\u30fc\u30d0\u30fc]\n   \u2502\n   \u2502 AES-GCM\u3067\u5fa9\u53f7\n   \u2502 \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6697\u53f7\u5316",children:"2. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u6697\u53f7\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u4fdd\u5b58\u6642\u306b\u6697\u53f7\u5316\u3001\u8aad\u307f\u53d6\u308a\u6642\u306b\u5fa9\u53f7\n\n[\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3]\n   \u2502\n   \u2502 \u500b\u4eba\u60c5\u5831\u3092AES\u3067\u6697\u53f7\u5316\n   \u2502\n   \u2193\n[\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9]\n   \u2502\n   \u2502 \u6697\u53f7\u5316\u3055\u308c\u305f\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\n   \u2502 \uff08\u6d41\u51fa\u3057\u3066\u3082\u8aad\u3081\u306a\u3044\uff09\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u30c8\u30fc\u30af\u30f3\u306e\u6697\u53f7\u5316",children:"3. \u30c8\u30fc\u30af\u30f3\u306e\u6697\u53f7\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"JWE\uff08JSON Web Encryption\uff09\n\n\u30d8\u30c3\u30c0\u30fc.\u6697\u53f7\u5316\u30ad\u30fc.IV.\u6697\u53f7\u6587.\u8a8d\u8a3c\u30bf\u30b0\n\nContent Encryption Key (CEK)\u3092AES-GCM\u3067\u6697\u53f7\u5316\n\u30da\u30a4\u30ed\u30fc\u30c9\u3092CEK\u3067\u6697\u53f7\u5316\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u6ce8\u610f\u70b9",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u6ce8\u610f\u70b9"}),"\n",(0,i.jsx)(e.h3,{id:"\u3084\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3053\u3068",children:"\u3084\u3063\u3066\u306f\u3044\u3051\u306a\u3044\u3053\u3068"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u274c \u60aa\u3044\u4f8b"}),(0,i.jsx)(e.th,{children:"\u2b55 \u826f\u3044\u4f8b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ECB\u30e2\u30fc\u30c9\u3092\u4f7f\u7528"}),(0,i.jsx)(e.td,{children:"GCM\u30e2\u30fc\u30c9\u3092\u4f7f\u7528"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u56fa\u5b9aIV\u3092\u4f7f\u7528"}),(0,i.jsx)(e.td,{children:"\u6bce\u56de\u30e9\u30f3\u30c0\u30e0IV\u3092\u751f\u6210"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5f31\u3044\u9375\uff08\u77ed\u3044\u3001\u4e88\u6e2c\u53ef\u80fd\uff09"}),(0,i.jsx)(e.td,{children:"256\u30d3\u30c3\u30c8\u306e\u30e9\u30f3\u30c0\u30e0\u9375"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:"Random"}),"\u3067\u9375\u751f\u6210"]}),(0,i.jsxs)(e.td,{children:[(0,i.jsx)(e.code,{children:"SecureRandom"}),"\u3067\u9375\u751f\u6210"]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u9375\u3092\u30ed\u30b0\u306b\u51fa\u529b"}),(0,i.jsx)(e.td,{children:"\u9375\u306f\u7d76\u5bfe\u306b\u30ed\u30b0\u306b\u51fa\u3055\u306a\u3044"})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"iv\u306e\u518d\u5229\u7528\u306f\u81f4\u547d\u7684",children:"IV\u306e\u518d\u5229\u7528\u306f\u81f4\u547d\u7684"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u26a0\ufe0f AES-GCM\u3067IV\u3092\u518d\u5229\u7528\u3059\u308b\u3068:\n\n\u540c\u3058\u9375 + \u540c\u3058IV + \u7570\u306a\u308b\u5e73\u6587\n   \u2193\n\u6697\u53f7\u6587\u306eXOR\u3067\u5e73\u6587\u306eXOR\u304c\u5f97\u3089\u308c\u308b\n   \u2193\n\u60c5\u5831\u6f0f\u6d29\uff01\n\n\u5bfe\u7b56:\n- \u6697\u53f7\u5316\u3054\u3068\u306b\u65b0\u3057\u3044IV\u3092\u751f\u6210\n- \u30ab\u30a6\u30f3\u30bf\u30fc\u30d9\u30fc\u30b9IV\uff08\u9069\u5207\u306b\u7ba1\u7406\u3059\u308b\u5834\u5408\uff09\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,i.jsx)(e.p,{children:"\u5171\u901a\u9375\u6697\u53f7\u306e\u30dd\u30a4\u30f3\u30c8:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"AES-GCM\u304c\u73fe\u5728\u306e\u63a8\u5968"})," - \u6697\u53f7\u5316\u3068\u8a8d\u8a3c\u3092\u540c\u6642\u306b\u884c\u3046"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"ECB\u306f\u4f7f\u7528\u7981\u6b62"})," - \u30d1\u30bf\u30fc\u30f3\u304c\u6f0f\u308c\u308b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"IV\u306f\u6bce\u56de\u65b0\u3057\u304f\u751f\u6210"})," - \u518d\u5229\u7528\u306f\u81f4\u547d\u7684"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9375\u914d\u9001\u304c\u8ab2\u984c"})," - \u516c\u958b\u9375\u6697\u53f7\u3068\u7d44\u307f\u5408\u308f\u305b\u308b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9375\u7ba1\u7406\u3092\u614e\u91cd\u306b"})," - \u30cf\u30fc\u30c9\u30b3\u30fc\u30c9\u7981\u6b62\u3001\u30ed\u30fc\u30c6\u30fc\u30b7\u30e7\u30f3\u5fc5\u9808"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6b21\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u9375\u914d\u9001\u554f\u984c\u3092\u89e3\u6c7a\u3059\u308b\u516c\u958b\u9375\u6697\u53f7\u306b\u3064\u3044\u3066\u5b66\u3073\u307e\u3059\u3002"})]})}function o(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>d,x:()=>l});var r=t(96540);const i={},c=r.createContext(i);function d(n){const e=r.useContext(c);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:d(n.components),r.createElement(c.Provider,{value:e},n.children)}}}]);