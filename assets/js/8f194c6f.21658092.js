"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[70028],{55531:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content_11_learning/jvm/jvm-11-io-resources","title":"I/O \u3068\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","description":"\u306f\u3058\u3081\u306b","source":"@site/docs/content_11_learning/20-jvm/jvm-11-io-resources.md","sourceDirName":"content_11_learning/20-jvm","slug":"/content_11_learning/jvm/jvm-11-io-resources","permalink":"/idp-server/docs/content_11_learning/jvm/jvm-11-io-resources","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/20-jvm/jvm-11-io-resources.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Java\u30b3\u30f3\u30d1\u30a4\u30eb","permalink":"/idp-server/docs/content_11_learning/jvm/jvm-10-compilation"},"next":{"title":"OS\u57fa\u790e \u5b66\u7fd2\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/"}}');var r=t(74848),l=t(28453);const s={},a="I/O \u3068\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406",c={},o=[{value:"\u306f\u3058\u3081\u306b",id:"\u306f\u3058\u3081\u306b",level:2},{value:"\u30d2\u30fc\u30d7\u3068\u30d2\u30fc\u30d7\u5916\u30ea\u30bd\u30fc\u30b9",id:"\u30d2\u30fc\u30d7\u3068\u30d2\u30fc\u30d7\u5916\u30ea\u30bd\u30fc\u30b9",level:2},{value:"\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e",id:"\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e",level:3},{value:"\u306a\u305c GC \u3067\u306f\u56de\u53ce\u3055\u308c\u306a\u3044\u306e\u304b",id:"\u306a\u305c-gc-\u3067\u306f\u56de\u53ce\u3055\u308c\u306a\u3044\u306e\u304b",level:2},{value:"Finalizer \u306e\u554f\u984c",id:"finalizer-\u306e\u554f\u984c",level:3},{value:"try-with-resources",id:"try-with-resources",level:2},{value:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",id:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",level:3},{value:"\u8907\u6570\u30ea\u30bd\u30fc\u30b9\u306e\u9806\u5e8f",id:"\u8907\u6570\u30ea\u30bd\u30fc\u30b9\u306e\u9806\u5e8f",level:3},{value:"Suppressed Exceptions",id:"suppressed-exceptions",level:3},{value:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30ea\u30f3\u30b0",id:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30ea\u30f3\u30b0",level:2},{value:"\u306a\u305c\u30d7\u30fc\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u304b",id:"\u306a\u305c\u30d7\u30fc\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u304b",level:3},{value:"HikariCP\uff08JDBC \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\uff09",id:"hikaricpjdbc-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",level:3},{value:"\u9069\u5207\u306a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba",id:"\u9069\u5207\u306a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba",level:3},{value:"HTTP \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u7ba1\u7406",id:"http-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u7ba1\u7406",level:2},{value:"HttpClient\uff08Java 11+\uff09",id:"httpclientjava-11",level:3},{value:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528\u306e\u91cd\u8981\u6027",id:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528\u306e\u91cd\u8981\u6027",level:3},{value:"Apache HttpClient\uff08\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\uff09",id:"apache-httpclient\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea",level:3},{value:"HttpClient \u3092\u518d\u5229\u7528\u3057\u306a\u3044\u3068\u3069\u3046\u306a\u308b\u304b",id:"httpclient-\u3092\u518d\u5229\u7528\u3057\u306a\u3044\u3068\u3069\u3046\u306a\u308b\u304b",level:3},{value:"Virtual Threads \u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",id:"virtual-threads-\u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",level:2},{value:"\u554f\u984c\uff1a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u304c\u30dc\u30c8\u30eb\u30cd\u30c3\u30af",id:"\u554f\u984c\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u304c\u30dc\u30c8\u30eb\u30cd\u30c3\u30af",level:3},{value:"\u89e3\u6c7a\u7b56",id:"\u89e3\u6c7a\u7b56",level:3},{value:"1. Semaphore \u3067\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",id:"1-semaphore-\u3067\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",level:4},{value:"2. Bulkhead \u30d1\u30bf\u30fc\u30f3",id:"2-bulkhead-\u30d1\u30bf\u30fc\u30f3",level:4},{value:"3. \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u9069\u5207\u306a\u8a2d\u5b9a",id:"3-\u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u9069\u5207\u306a\u8a2d\u5b9a",level:4},{value:"\u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u306e\u691c\u51fa",id:"\u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u306e\u691c\u51fa",level:2},{value:"HikariCP \u306e\u30ea\u30fc\u30af\u691c\u51fa",id:"hikaricp-\u306e\u30ea\u30fc\u30af\u691c\u51fa",level:3},{value:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u76e3\u8996",id:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u76e3\u8996",level:3},{value:"JMX \u306b\u3088\u308b\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",id:"jmx-\u306b\u3088\u308b\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",level:3},{value:"OS \u30ea\u30bd\u30fc\u30b9\u5236\u9650",id:"os-\u30ea\u30bd\u30fc\u30b9\u5236\u9650",level:2},{value:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u4e0a\u9650",id:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u4e0a\u9650",level:3},{value:"Docker \u3067\u306e\u8a2d\u5b9a",id:"docker-\u3067\u306e\u8a2d\u5b9a",level:3},{value:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",level:3},{value:"Direct Buffer \u306e\u30e1\u30e2\u30ea\u7ba1\u7406",id:"direct-buffer-\u306e\u30e1\u30e2\u30ea\u7ba1\u7406",level:2},{value:"NIO \u3068 Direct Buffer",id:"nio-\u3068-direct-buffer",level:3},{value:"Direct Memory \u306e\u5236\u9650",id:"direct-memory-\u306e\u5236\u9650",level:3},{value:"Direct Buffer \u306e\u30ea\u30fc\u30af",id:"direct-buffer-\u306e\u30ea\u30fc\u30af",level:3},{value:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",id:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",level:2},{value:"1. \u5e38\u306b try-with-resources \u3092\u4f7f\u7528",id:"1-\u5e38\u306b-try-with-resources-\u3092\u4f7f\u7528",level:3},{value:"2. \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u9069\u5207\u306b\u8a2d\u5b9a",id:"2-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u9069\u5207\u306b\u8a2d\u5b9a",level:3},{value:"3. HttpClient \u3092\u518d\u5229\u7528",id:"3-httpclient-\u3092\u518d\u5229\u7528",level:3},{value:"4. Virtual Threads \u4f7f\u7528\u6642\u306f\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",id:"4-virtual-threads-\u4f7f\u7528\u6642\u306f\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",level:3},{value:"5. \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3092\u8a2d\u5b9a",id:"5-\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3092\u8a2d\u5b9a",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"io-\u3068\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406",children:"I/O \u3068\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406"})}),"\n",(0,r.jsx)(e.h2,{id:"\u306f\u3058\u3081\u306b",children:"\u306f\u3058\u3081\u306b"}),"\n",(0,r.jsxs)(e.p,{children:["JVM\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001HTTP\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u3084JDBC\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306a\u3069\u3001OS\u30ec\u30d9\u30eb\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u6271\u3044\u307e\u3059\u3002\u3053\u308c\u3089\u306f",(0,r.jsx)(e.strong,{children:"GC\u306e\u7ba1\u7406\u5bfe\u8c61\u5916"}),"\u3067\u3042\u308a\u3001\u9069\u5207\u306a\u7ba1\u7406\u304c\u5fc5\u8981\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u30d2\u30fc\u30d7\u3068\u30d2\u30fc\u30d7\u5916\u30ea\u30bd\u30fc\u30b9",children:"\u30d2\u30fc\u30d7\u3068\u30d2\u30fc\u30d7\u5916\u30ea\u30bd\u30fc\u30b9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    JVM\u30ea\u30bd\u30fc\u30b9\u306e\u5206\u985e                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  JVM\u30d2\u30fc\u30d7\uff08GC\u7ba1\u7406\uff09                 \u30d2\u30fc\u30d7\u5916\uff08GC\u7ba1\u7406\u5916\uff09            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502 \u30fbJava\u30aa\u30d6\u30b8\u30a7\u30af\u30c8  \u2502            \u2502 \u30fbTCP\u30bd\u30b1\u30c3\u30c8       \u2502         \u2502\n\u2502  \u2502 \u30fb\u914d\u5217              \u2502            \u2502 \u30fb\u30d5\u30a1\u30a4\u30eb\u30cf\u30f3\u30c9\u30eb  \u2502         \u2502\n\u2502  \u2502 \u30fb\u6587\u5b57\u5217            \u2502            \u2502 \u30fbDirect Buffer     \u2502         \u2502\n\u2502  \u2502 \u30fb\u30b3\u30ec\u30af\u30b7\u30e7\u30f3      \u2502            \u2502 \u30fb\u30cd\u30a4\u30c6\u30a3\u30d6\u30e1\u30e2\u30ea  \u2502         \u2502\n\u2502  \u2502                     \u2502            \u2502 \u30fbDB\u30b3\u30cd\u30af\u30b7\u30e7\u30f3    \u2502         \u2502\n\u2502  \u2502  \u53c2\u7167\u304c\u306a\u304f\u306a\u308b\u3068   \u2502            \u2502                     \u2502         \u2502\n\u2502  \u2502  GC\u304c\u81ea\u52d5\u56de\u53ce       \u2502            \u2502  \u660e\u793a\u7684\u306b close()   \u2502         \u2502\n\u2502  \u2502                     \u2502            \u2502  \u3057\u306a\u3044\u3068\u89e3\u653e\u3055\u308c\u306a\u3044\u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e",children:"\u30ea\u30bd\u30fc\u30b9\u306e\u7a2e\u985e"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u30ea\u30bd\u30fc\u30b9"}),(0,r.jsx)(e.th,{children:"Java \u3067\u306e\u8868\u73fe"}),(0,r.jsx)(e.th,{children:"OS \u30ea\u30bd\u30fc\u30b9"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30d5\u30a1\u30a4\u30eb"}),(0,r.jsx)(e.td,{children:"FileInputStream, FileChannel"}),(0,r.jsx)(e.td,{children:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af"}),(0,r.jsx)(e.td,{children:"Socket, ServerSocket"}),(0,r.jsx)(e.td,{children:"TCP\u30bd\u30b1\u30c3\u30c8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"HTTP"}),(0,r.jsx)(e.td,{children:"HttpURLConnection, HttpClient"}),(0,r.jsx)(e.td,{children:"TCP\u30bd\u30b1\u30c3\u30c8 + SSL/TLS"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9"}),(0,r.jsx)(e.td,{children:"Connection, Statement"}),(0,r.jsx)(e.td,{children:"TCP + DB\u30bb\u30c3\u30b7\u30e7\u30f3"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30d7\u30ed\u30bb\u30b9"}),(0,r.jsx)(e.td,{children:"Process"}),(0,r.jsx)(e.td,{children:"\u30d7\u30ed\u30bb\u30b9ID, \u30d1\u30a4\u30d7"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u306a\u305c-gc-\u3067\u306f\u56de\u53ce\u3055\u308c\u306a\u3044\u306e\u304b",children:"\u306a\u305c GC \u3067\u306f\u56de\u53ce\u3055\u308c\u306a\u3044\u306e\u304b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u306e\u554f\u984c                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Connection conn = dataSource.getConnection();                       \u2502\n\u2502                                                                      \u2502\n\u2502  JVM\u30d2\u30fc\u30d7                          OS / \u30cd\u30a4\u30c6\u30a3\u30d6                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 Connection obj  \u2502 \u2500\u2500\u2500\u53c2\u7167\u2500\u2500\u2500\u2192  \u2502 TCP Socket      \u2502              \u2502\n\u2502  \u2502 (HikariProxyConn\u2502               \u2502 File Descriptor \u2502              \u2502\n\u2502  \u2502  ection)        \u2502               \u2502 DB Session      \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502          \u2502                                  \u2502                        \u2502\n\u2502          \u2193                                  \u2193                        \u2502\n\u2502    GC\u3067\u56de\u53ce\u53ef\u80fd                      GC\u3067\u306f\u56de\u53ce\u3067\u304d\u306a\u3044              \u2502\n\u2502    \uff08\u53c2\u7167\u304c\u306a\u304f\u306a\u308c\u3070\uff09              \uff08OS\u306b\u8fd4\u5374\u304c\u5fc5\u8981\uff09              \u2502\n\u2502                                                                      \u2502\n\u2502  \u554f\u984c: Connection \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304cGC\u3055\u308c\u3066\u3082\u3001                         \u2502\n\u2502        OS\u306e\u30bd\u30b1\u30c3\u30c8\u306f\u89e3\u653e\u3055\u308c\u306a\u3044 \u2192 \u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af                   \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"finalizer-\u306e\u554f\u984c",children:"Finalizer \u306e\u554f\u984c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u6614\u306e\u30a2\u30d7\u30ed\u30fc\u30c1\uff08\u975e\u63a8\u5968\uff09\npublic class OldConnection {\n    private int socketFd;\n\n    @Override\n    protected void finalize() throws Throwable {\n        // GC\u6642\u306b\u547c\u3070\u308c\u308b\u3053\u3068\u3092\u671f\u5f85\n        closeNativeSocket(socketFd);\n    }\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Finalizer \u304c\u5371\u967a\u306a\u7406\u7531\uff1a"})}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u554f\u984c"}),(0,r.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5b9f\u884c\u30bf\u30a4\u30df\u30f3\u30b0\u4e0d\u5b9a"}),(0,r.jsx)(e.td,{children:"GC\u304c\u3044\u3064\u8d70\u308b\u304b\u308f\u304b\u3089\u306a\u3044"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5b9f\u884c\u4fdd\u8a3c\u306a\u3057"}),(0,r.jsx)(e.td,{children:"finalize \u304c\u547c\u3070\u308c\u306a\u3044\u3053\u3068\u3082\u3042\u308b"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u52a3\u5316"}),(0,r.jsx)(e.td,{children:"Finalizer \u30ad\u30e5\u30fc\u306e\u51e6\u7406\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30ea\u30bd\u30fc\u30b9\u67af\u6e07"}),(0,r.jsx)(e.td,{children:"GC\u524d\u306bOS\u30ea\u30bd\u30fc\u30b9\u304c\u67af\u6e07\u3059\u308b\u53ef\u80fd\u6027"})]})]})]}),"\n",(0,r.jsx)(e.admonition,{type:"warning",children:(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Java 9+ \u3067\u975e\u63a8\u5968"}),": ",(0,r.jsx)(e.code,{children:"finalize()"})," \u306f Java 9 \u3067\u975e\u63a8\u5968\u3001Java 18 \u3067\u524a\u9664\u4e88\u5b9a\u3067\u3059\u3002\u4ee3\u308f\u308a\u306b ",(0,r.jsx)(e.code,{children:"try-with-resources"})," \u3084 ",(0,r.jsx)(e.code,{children:"Cleaner"})," \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"try-with-resources",children:"try-with-resources"}),"\n",(0,r.jsx)(e.h3,{id:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",children:"\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u63a8\u5968\uff1atry-with-resources\ntry (Connection conn = dataSource.getConnection();\n     PreparedStatement stmt = conn.prepareStatement(sql);\n     ResultSet rs = stmt.executeQuery()) {\n\n    while (rs.next()) {\n        // \u30c7\u30fc\u30bf\u51e6\u7406\n    }\n}  // \u2190 \u81ea\u52d5\u7684\u306b rs.close(), stmt.close(), conn.close() \u304c\u547c\u3070\u308c\u308b\n   //   \u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3082\u78ba\u5b9f\u306b\u30af\u30ed\u30fc\u30ba\u3055\u308c\u308b\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u8907\u6570\u30ea\u30bd\u30fc\u30b9\u306e\u9806\u5e8f",children:"\u8907\u6570\u30ea\u30bd\u30fc\u30b9\u306e\u9806\u5e8f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"try (\n    Connection conn = getConnection();      // 1\u756a\u76ee\u306b\u958b\u304f\n    PreparedStatement stmt = prepare(conn); // 2\u756a\u76ee\u306b\u958b\u304f\n    ResultSet rs = stmt.executeQuery()      // 3\u756a\u76ee\u306b\u958b\u304f\n) {\n    // \u51e6\u7406\n}\n// \u30af\u30ed\u30fc\u30ba\u306f\u9006\u9806: rs \u2192 stmt \u2192 conn\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              try-with-resources \u306e\u30af\u30ed\u30fc\u30ba\u9806\u5e8f                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u958b\u304f\u9806\u5e8f                         \u9589\u3058\u308b\u9806\u5e8f                         \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                          \u2502\n\u2502  1. Connection                    3. Connection.close()              \u2502\n\u2502  2. PreparedStatement             2. PreparedStatement.close()       \u2502\n\u2502  3. ResultSet                     1. ResultSet.close()               \u2502\n\u2502                                                                      \u2502\n\u2502  \u2192 \u4f9d\u5b58\u95a2\u4fc2\u3092\u8003\u616e\u3057\u305f\u6b63\u3057\u3044\u9806\u5e8f\u3067\u81ea\u52d5\u30af\u30ed\u30fc\u30ba                        \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"suppressed-exceptions",children:"Suppressed Exceptions"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'try (Resource r = new Resource()) {\n    throw new RuntimeException("\u30e1\u30a4\u30f3\u51e6\u7406\u3067\u4f8b\u5916");\n}  // close() \u3067\u3082\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u5834\u5408\n\n// \u7d50\u679c:\n// RuntimeException: \u30e1\u30a4\u30f3\u51e6\u7406\u3067\u4f8b\u5916\n//   Suppressed: IOException: \u30af\u30ed\u30fc\u30ba\u4e2d\u306e\u4f8b\u5916\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// Suppressed Exception \u306e\u53d6\u5f97\ntry {\n    // ...\n} catch (Exception e) {\n    for (Throwable suppressed : e.getSuppressed()) {\n        System.out.println("Suppressed: " + suppressed);\n    }\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30ea\u30f3\u30b0",children:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30ea\u30f3\u30b0"}),"\n",(0,r.jsx)(e.h3,{id:"\u306a\u305c\u30d7\u30fc\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u304b",children:"\u306a\u305c\u30d7\u30fc\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u304b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u4f5c\u6210\u306e\u30b3\u30b9\u30c8                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u6bce\u56de\u65b0\u898f\u4f5c\u6210\u306e\u5834\u5408:                                                 \u2502\n\u2502                                                                      \u2502\n\u2502  \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3              \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502 Request 1   \u2502\u2500\u2500TCP\u63a5\u7d9a\u2500\u2500\u2500\u2500\u2192\u2502             \u2502  50-100ms             \u2502\n\u2502  \u2502             \u2502\u2190\u2500\u8a8d\u8a3c\u5b8c\u4e86\u2500\u2500\u2500\u2500\u2502             \u2502                       \u2502\n\u2502  \u2502             \u2502\u2500\u2500\u30af\u30a8\u30ea\u2500\u2500\u2500\u2500\u2500\u2192\u2502             \u2502  1-10ms               \u2502\n\u2502  \u2502             \u2502\u2190\u2500\u7d50\u679c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502             \u2502                       \u2502\n\u2502  \u2502             \u2502\u2500\u2500\u5207\u65ad\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502             \u2502  10ms                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                                                                      \u2502\n\u2502  \u30d7\u30fc\u30eb\u4f7f\u7528\u306e\u5834\u5408:                                                   \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502  \u2502 Request 1   \u2502\u2500\u2500\u2502  Pool  \u2502\u2500\u2500\u2502             \u2502                       \u2502\n\u2502  \u2502             \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2510 \u2502  \u2502             \u2502  \u30d7\u30fc\u30eb\u304b\u3089\u53d6\u5f97: 0.1ms\u2502\n\u2502  \u2502             \u2502  \u2502 \u2502conn\u2502 \u2502  \u2502             \u2502  \u30af\u30a8\u30ea\u5b9f\u884c: 1-10ms   \u2502\n\u2502  \u2502             \u2502  \u2502 \u2514\u2500\u2500\u2500\u2500\u2518 \u2502  \u2502             \u2502  \u30d7\u30fc\u30eb\u306b\u8fd4\u5374: 0.1ms  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502                                                                      \u2502\n\u2502  \u2192 \u63a5\u7d9a\u78ba\u7acb\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3092\u524a\u6e1b                                    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"hikaricpjdbc-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",children:"HikariCP\uff08JDBC \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// HikariCP \u8a2d\u5b9a\nHikariConfig config = new HikariConfig();\nconfig.setJdbcUrl("jdbc:postgresql://localhost:5432/mydb");\nconfig.setUsername("user");\nconfig.setPassword("password");\n\n// \u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u8a2d\u5b9a\nconfig.setMaximumPoolSize(10);      // \u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\nconfig.setMinimumIdle(5);            // \u6700\u5c0f\u30a2\u30a4\u30c9\u30eb\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\nconfig.setIdleTimeout(300000);       // \u30a2\u30a4\u30c9\u30eb\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff085\u5206\uff09\nconfig.setConnectionTimeout(30000);  // \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff0830\u79d2\uff09\nconfig.setMaxLifetime(1800000);      // \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6700\u5927\u751f\u5b58\u6642\u9593\uff0830\u5206\uff09\n\n// \u30ea\u30fc\u30af\u691c\u51fa\nconfig.setLeakDetectionThreshold(60000);  // 60\u79d2\u4ee5\u4e0a\u4f7f\u7528\u3067\u30ea\u30fc\u30af\u8b66\u544a\n\nHikariDataSource dataSource = new HikariDataSource(config);\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u9069\u5207\u306a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba",children:"\u9069\u5207\u306a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8003\u3048\u65b9                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u516c\u5f0f: connections = (core_count * 2) + effective_spindle_count     \u2502\n\u2502                                                                      \u2502\n\u2502  \u4f8b: 4\u30b3\u30a2CPU\u3001SSD\uff08spindle=1\uff09\u306e\u5834\u5408                               \u2502\n\u2502      connections = (4 * 2) + 1 = 9                                  \u2502\n\u2502                                                                      \u2502\n\u2502  \u30dd\u30a4\u30f3\u30c8:                                                           \u2502\n\u2502  \u30fb\u5927\u304d\u3059\u304e\u308b\u30d7\u30fc\u30eb = \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30b9\u30a4\u30c3\u30c1\u5897\u52a0\u3001\u6027\u80fd\u4f4e\u4e0b             \u2502\n\u2502  \u30fb\u5c0f\u3055\u3059\u304e\u308b\u30d7\u30fc\u30eb = \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u5f85\u3061\u3001\u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u4f4e\u4e0b             \u2502\n\u2502  \u30fbI/O\u5f85\u3061\u304c\u591a\u3044\u5834\u5408\u306f\u82e5\u5e72\u5927\u304d\u3081\u306b                                   \u2502\n\u2502                                                                      \u2502\n\u2502  \u63a8\u5968: 10-20 \u7a0b\u5ea6\u304b\u3089\u59cb\u3081\u3066\u3001\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3057\u306a\u304c\u3089\u8abf\u6574                \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"http-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u7ba1\u7406",children:"HTTP \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u7ba1\u7406"}),"\n",(0,r.jsx)(e.h3,{id:"httpclientjava-11",children:"HttpClient\uff08Java 11+\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// HttpClient \u306f\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u5185\u8535\nHttpClient client = HttpClient.newBuilder()\n    .version(HttpClient.Version.HTTP_2)\n    .connectTimeout(Duration.ofSeconds(10))\n    .executor(Executors.newVirtualThreadPerTaskExecutor())  // Virtual Threads\n    .build();\n\n// \u540c\u3058 HttpClient \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u518d\u5229\u7528 \u2192 \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528\nHttpRequest request = HttpRequest.newBuilder()\n    .uri(URI.create("https://api.example.com/data"))\n    .timeout(Duration.ofSeconds(30))\n    .GET()\n    .build();\n\nHttpResponse<String> response = client.send(request,\n    HttpResponse.BodyHandlers.ofString());\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528\u306e\u91cd\u8981\u6027",children:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528\u306e\u91cd\u8981\u6027"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              HTTP \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u518d\u5229\u7528                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Keep-Alive \u306a\u3057:                                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502Request1\u2502\u2500\u2500TCP\u63a5\u7d9a+TLS\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502        \u2502  200ms          \u2502\n\u2502  \u2502        \u2502\u2190\u2500Response\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502        \u2502                 \u2502\n\u2502  \u2502        \u2502\u2500\u2500\u5207\u65ad\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502        \u2502                 \u2502\n\u2502  \u2502Request2\u2502\u2500\u2500TCP\u63a5\u7d9a+TLS\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502 Server \u2502  200ms          \u2502\n\u2502  \u2502        \u2502\u2190\u2500Response\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502        \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                                                      \u2502\n\u2502  Keep-Alive \u3042\u308a\uff08HTTP/1.1\uff09/ HTTP/2:                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502Request1\u2502\u2500\u2500TCP\u63a5\u7d9a+TLS\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502        \u2502  200ms\uff08\u521d\u56de\uff09  \u2502\n\u2502  \u2502        \u2502\u2190\u2500Response\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502        \u2502                 \u2502\n\u2502  \u2502Request2\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502 Server \u2502  10ms\uff08\u518d\u5229\u7528\uff09 \u2502\n\u2502  \u2502        \u2502\u2190\u2500Response\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502        \u2502                 \u2502\n\u2502  \u2502Request3\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192\u2502        \u2502  10ms\uff08\u518d\u5229\u7528\uff09 \u2502\n\u2502  \u2502        \u2502\u2190\u2500Response\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502        \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"apache-httpclient\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea",children:"Apache HttpClient\uff08\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u660e\u793a\u7684\u306a\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u7ba1\u7406\nPoolingHttpClientConnectionManager connectionManager =\n    new PoolingHttpClientConnectionManager();\nconnectionManager.setMaxTotal(100);           // \u5168\u4f53\u306e\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\nconnectionManager.setDefaultMaxPerRoute(20);  // \u30db\u30b9\u30c8\u3054\u3068\u306e\u6700\u5927\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u6570\n\nCloseableHttpClient httpClient = HttpClients.custom()\n    .setConnectionManager(connectionManager)\n    .setKeepAliveStrategy((response, context) -> 30 * 1000)  // 30\u79d2\n    .build();\n\n// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7d42\u4e86\u6642\u306b\u30af\u30ed\u30fc\u30ba\n// httpClient.close();\n"})}),"\n",(0,r.jsx)(e.h3,{id:"httpclient-\u3092\u518d\u5229\u7528\u3057\u306a\u3044\u3068\u3069\u3046\u306a\u308b\u304b",children:"HttpClient \u3092\u518d\u5229\u7528\u3057\u306a\u3044\u3068\u3069\u3046\u306a\u308b\u304b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// \u5371\u967a\uff1a\u6bce\u56de\u65b0\u3057\u3044 HttpClient \u3092\u4f5c\u6210\npublic String fetchData(String url) {\n    HttpClient client = HttpClient.newHttpClient();  // \u6bce\u56de\u4f5c\u6210\n    HttpRequest request = HttpRequest.newBuilder()\n        .uri(URI.create(url))\n        .build();\n    return client.send(request, HttpResponse.BodyHandlers.ofString()).body();\n}\n\n// 1000\u56de\u547c\u3073\u51fa\u3059\u3068...\nfor (int i = 0; i < 1000; i++) {\n    fetchData("https://api.example.com/data");  // 1000\u500b\u306e HttpClient \u4f5c\u6210\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u767a\u751f\u3059\u308b\u554f\u984c\uff1a"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              HttpClient \u518d\u5229\u7528\u3057\u306a\u3044\u5834\u5408\u306e\u554f\u984c                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  1. \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u4f4e\u4e0b                                               \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502     \u2502  \u6bce\u56de\u306e\u51e6\u7406:                                                 \u2502 \u2502\n\u2502     \u2502  \u30fbTCP 3-way handshake: 50-100ms                            \u2502 \u2502\n\u2502     \u2502  \u30fbTLS handshake: 100-200ms                                 \u2502 \u2502\n\u2502     \u2502  \u30fb\u5b9f\u969b\u306e\u30ea\u30af\u30a8\u30b9\u30c8: 10-50ms                                 \u2502 \u2502\n\u2502     \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                           \u2502 \u2502\n\u2502     \u2502  \u5408\u8a08: 160-350ms/\u30ea\u30af\u30a8\u30b9\u30c8                                  \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  \u518d\u5229\u7528\u3057\u305f\u5834\u5408:                                             \u2502 \u2502\n\u2502     \u2502  \u30fb\u5b9f\u969b\u306e\u30ea\u30af\u30a8\u30b9\u30c8: 10-50ms                                 \u2502 \u2502\n\u2502     \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                           \u2502 \u2502\n\u2502     \u2502  \u5408\u8a08: 10-50ms/\u30ea\u30af\u30a8\u30b9\u30c8\uff083-10\u500d\u9ad8\u901f\uff09                      \u2502 \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                      \u2502\n\u2502  2. \u30bd\u30b1\u30c3\u30c8\u67af\u6e07\uff08TIME_WAIT \u84c4\u7a4d\uff09                                   \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502     \u2502  \u5207\u65ad\u3055\u308c\u305f\u30bd\u30b1\u30c3\u30c8\u306f TIME_WAIT \u72b6\u614b\u3067 60-120\u79d2 \u6b8b\u7559         \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  $ netstat -an | grep TIME_WAIT | wc -l                     \u2502 \u2502\n\u2502     \u2502  28547  \u2190 \u5927\u91cf\u306e TIME_WAIT \u30bd\u30b1\u30c3\u30c8                         \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  \u30a8\u30e9\u30fc: java.net.BindException:                            \u2502 \u2502\n\u2502     \u2502          Address already in use (Bind failed)               \u2502 \u2502\n\u2502     \u2502  \u307e\u305f\u306f: Cannot assign requested address                    \u2502 \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                      \u2502\n\u2502  3. \u30b9\u30ec\u30c3\u30c9\u30d7\u30fc\u30eb\u30fb\u30e1\u30e2\u30ea\u30ea\u30fc\u30af                                     \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502     \u2502  HttpClient \u306f\u5185\u90e8\u3067\u30b9\u30ec\u30c3\u30c9\u30d7\u30fc\u30eb\u3092\u6301\u3064                     \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  HttpClient 1 \u2500\u2192 Executor (\u30b9\u30ec\u30c3\u30c9\u6570\u500b)                    \u2502 \u2502\n\u2502     \u2502  HttpClient 2 \u2500\u2192 Executor (\u30b9\u30ec\u30c3\u30c9\u6570\u500b)                    \u2502 \u2502\n\u2502     \u2502  HttpClient 3 \u2500\u2192 Executor (\u30b9\u30ec\u30c3\u30c9\u6570\u500b)                    \u2502 \u2502\n\u2502     \u2502  ...                                                         \u2502 \u2502\n\u2502     \u2502  HttpClient 1000 \u2500\u2192 Executor (\u30b9\u30ec\u30c3\u30c9\u6570\u500b)                 \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  \u2192 \u6570\u5343\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u4f5c\u6210\u3055\u308c\u308b                                \u2502 \u2502\n\u2502     \u2502  \u2192 OutOfMemoryError: unable to create native thread         \u2502 \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                      \u2502\n\u2502  4. \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u67af\u6e07                                       \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502     \u2502  $ ulimit -n                                                 \u2502 \u2502\n\u2502     \u2502  1024  \u2190 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u4e0a\u9650                                   \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  1000\u500b\u306e\u30bd\u30b1\u30c3\u30c8 + \u5185\u90e8\u30ea\u30bd\u30fc\u30b9 \u2192 \u4e0a\u9650\u8d85\u904e                  \u2502 \u2502\n\u2502     \u2502                                                              \u2502 \u2502\n\u2502     \u2502  \u30a8\u30e9\u30fc: java.io.IOException: Too many open files           \u2502 \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6b63\u3057\u3044\u4f7f\u3044\u65b9\uff1a"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5168\u4f53\u30671\u3064\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3092\u5171\u6709\npublic class HttpClientProvider {\n    private static final HttpClient CLIENT = HttpClient.newBuilder()\n        .version(HttpClient.Version.HTTP_2)\n        .connectTimeout(Duration.ofSeconds(10))\n        .build();\n\n    public static HttpClient getClient() {\n        return CLIENT;\n    }\n}\n\n// \u4f7f\u7528\u5074\npublic String fetchData(String url) {\n    HttpClient client = HttpClientProvider.getClient();  // \u518d\u5229\u7528\n    HttpRequest request = HttpRequest.newBuilder()\n        .uri(URI.create(url))\n        .build();\n    return client.send(request, HttpResponse.BodyHandlers.ofString()).body();\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Spring Boot \u3067\u306e\u8a2d\u5b9a\uff1a"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"@Configuration\npublic class HttpClientConfig {\n\n    @Bean\n    public HttpClient httpClient() {\n        return HttpClient.newBuilder()\n            .version(HttpClient.Version.HTTP_2)\n            .connectTimeout(Duration.ofSeconds(10))\n            .followRedirects(HttpClient.Redirect.NORMAL)\n            .build();\n    }\n}\n\n@Service\npublic class ExternalApiService {\n    private final HttpClient httpClient;\n\n    public ExternalApiService(HttpClient httpClient) {\n        this.httpClient = httpClient;  // DI \u3067\u6ce8\u5165\u3001\u518d\u5229\u7528\u3055\u308c\u308b\n    }\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"virtual-threads-\u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",children:"Virtual Threads \u3068\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb"}),"\n",(0,r.jsx)(e.h3,{id:"\u554f\u984c\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u304c\u30dc\u30c8\u30eb\u30cd\u30c3\u30af",children:"\u554f\u984c\uff1a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u304c\u30dc\u30c8\u30eb\u30cd\u30c3\u30af"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Virtual Threads \u3068\u30d7\u30fc\u30eb\u306e\u554f\u984c                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u5f93\u6765\uff08Platform Threads\uff09:                                           \u2502\n\u2502  \u30fb\u30b9\u30ec\u30c3\u30c9\u6570: 200                                                   \u2502\n\u2502  \u30fb\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb: 20                                            \u2502\n\u2502  \u2192 200\u30b9\u30ec\u30c3\u30c9\u4e2d\u3001\u6700\u592720\u30b9\u30ec\u30c3\u30c9\u304cDB\u30a2\u30af\u30bb\u30b9\u53ef\u80fd                     \u2502\n\u2502  \u2192 \u6b8b\u308a180\u30b9\u30ec\u30c3\u30c9\u306f\u4ed6\u306e\u51e6\u7406 or \u5f85\u6a5f                                \u2502\n\u2502                                                                      \u2502\n\u2502  Virtual Threads \u5c0e\u5165\u5f8c:                                             \u2502\n\u2502  \u30fbVirtual Threads \u6570: 100,000+                                      \u2502\n\u2502  \u30fb\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb: 20\uff08\u5909\u66f4\u306a\u3057\uff09                                \u2502\n\u2502  \u2192 100,000\u30b9\u30ec\u30c3\u30c9\u304c\u540c\u6642\u306bDB\u63a5\u7d9a\u3092\u8981\u6c42                              \u2502\n\u2502  \u2192 99,980\u30b9\u30ec\u30c3\u30c9\u304c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u5f85\u3061 \u2192 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u7d9a\u51fa              \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502  Virtual Thread 1  \u2500\u2510                                         \u2502   \u2502\n\u2502  \u2502  Virtual Thread 2  \u2500\u2524                                         \u2502   \u2502\n\u2502  \u2502  Virtual Thread 3  \u2500\u2524     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502   \u2502\n\u2502  \u2502  ...               \u2500\u253c\u2500\u2500\u2500\u2500\u2192\u2502 Pool (20)   \u2502\u2500\u2500\u2500\u2500\u2192 Database       \u2502   \u2502\n\u2502  \u2502  Virtual Thread N  \u2500\u2524     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502   \u2502\n\u2502  \u2502                     \u2502            \u2191                             \u2502   \u2502\n\u2502  \u2502  (100,000\u30b9\u30ec\u30c3\u30c9)  \u2502      \u30dc\u30c8\u30eb\u30cd\u30c3\u30af\uff01                      \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u89e3\u6c7a\u7b56",children:"\u89e3\u6c7a\u7b56"}),"\n",(0,r.jsx)(e.h4,{id:"1-semaphore-\u3067\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",children:"1. Semaphore \u3067\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public class DatabaseService {\n    private final DataSource dataSource;\n    private final Semaphore semaphore;\n\n    public DatabaseService(DataSource dataSource, int maxConcurrent) {\n        this.dataSource = dataSource;\n        this.semaphore = new Semaphore(maxConcurrent);  // \u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650\n    }\n\n    public Result query(String sql) throws Exception {\n        semaphore.acquire();  // \u8a31\u53ef\u3092\u53d6\u5f97\uff08\u5f85\u6a5f\u3059\u308b\u53ef\u80fd\u6027\u3042\u308a\uff09\n        try (Connection conn = dataSource.getConnection()) {\n            // \u30af\u30a8\u30ea\u5b9f\u884c\n            return executeQuery(conn, sql);\n        } finally {\n            semaphore.release();  // \u8a31\u53ef\u3092\u8fd4\u5374\n        }\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"2-bulkhead-\u30d1\u30bf\u30fc\u30f3",children:"2. Bulkhead \u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// Resilience4j \u306e Bulkhead\nBulkheadConfig config = BulkheadConfig.custom()\n    .maxConcurrentCalls(20)           // \u6700\u5927\u540c\u6642\u5b9f\u884c\u6570\n    .maxWaitDuration(Duration.ofMillis(500))  // \u5f85\u6a5f\u6642\u9593\n    .build();\n\nBulkhead bulkhead = Bulkhead.of("database", config);\n\nSupplier<Result> decoratedSupplier = Bulkhead.decorateSupplier(\n    bulkhead,\n    () -> databaseService.query(sql)\n);\n'})}),"\n",(0,r.jsx)(e.h4,{id:"3-\u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u9069\u5207\u306a\u8a2d\u5b9a",children:"3. \u63a5\u7d9a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u9069\u5207\u306a\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// HikariCP \u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\nHikariConfig config = new HikariConfig();\nconfig.setConnectionTimeout(5000);   // 5\u79d2\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff08\u9577\u3059\u304e\u306a\u3044\uff09\nconfig.setMaximumPoolSize(20);\n\n// \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\ntry (Connection conn = dataSource.getConnection()) {\n    // ...\n} catch (SQLTransientConnectionException e) {\n    // \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u53d6\u5f97\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\n    return fallbackResult();\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u306e\u691c\u51fa",children:"\u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u306e\u691c\u51fa"}),"\n",(0,r.jsx)(e.h3,{id:"hikaricp-\u306e\u30ea\u30fc\u30af\u691c\u51fa",children:"HikariCP \u306e\u30ea\u30fc\u30af\u691c\u51fa"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u30ea\u30fc\u30af\u691c\u51fa\u3092\u6709\u52b9\u5316\nconfig.setLeakDetectionThreshold(60000);  // 60\u79d2\u4ee5\u4e0a\u501f\u308a\u3066\u3044\u305f\u3089\u8b66\u544a\n\n// \u30ed\u30b0\u51fa\u529b\u4f8b:\n// WARN  - Connection leak detection triggered for conn0:\n//         ProxyConnection@12345\n//         java.lang.Exception: Apparent connection leak detected\n//         at com.example.UserService.findUser(UserService.java:42)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u76e3\u8996",children:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u76e3\u8996"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Linux: \u30d7\u30ed\u30bb\u30b9\u306e\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u6570\u3092\u78ba\u8a8d\nls -la /proc/<pid>/fd | wc -l\n\n# \u307e\u305f\u306f lsof\nlsof -p <pid> | wc -l\n\n# macOS\nlsof -p <pid> | wc -l\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// Java \u304b\u3089 OS \u306e\u30ea\u30bd\u30fc\u30b9\u72b6\u6cc1\u3092\u78ba\u8a8d\nOperatingSystemMXBean os = ManagementFactory.getOperatingSystemMXBean();\nif (os instanceof UnixOperatingSystemMXBean unixOs) {\n    long openFds = unixOs.getOpenFileDescriptorCount();\n    long maxFds = unixOs.getMaxFileDescriptorCount();\n    System.out.println("Open FDs: " + openFds + " / " + maxFds);\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"jmx-\u306b\u3088\u308b\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0",children:"JMX \u306b\u3088\u308b\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// HikariCP \u306e\u30e1\u30c8\u30ea\u30af\u30b9\nHikariPoolMXBean poolMXBean = dataSource.getHikariPoolMXBean();\n\nSystem.out.println("Active: " + poolMXBean.getActiveConnections());\nSystem.out.println("Idle: " + poolMXBean.getIdleConnections());\nSystem.out.println("Total: " + poolMXBean.getTotalConnections());\nSystem.out.println("Waiting: " + poolMXBean.getThreadsAwaitingConnection());\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"os-\u30ea\u30bd\u30fc\u30b9\u5236\u9650",children:"OS \u30ea\u30bd\u30fc\u30b9\u5236\u9650"}),"\n",(0,r.jsx)(e.h3,{id:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u4e0a\u9650",children:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u306e\u4e0a\u9650"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u73fe\u5728\u306e\u5236\u9650\u3092\u78ba\u8a8d\nulimit -n        # soft limit\nulimit -Hn       # hard limit\n\n# \u5236\u9650\u3092\u5909\u66f4\uff08\u4e00\u6642\u7684\uff09\nulimit -n 65535\n\n# \u6c38\u7d9a\u7684\u306a\u5909\u66f4\uff08/etc/security/limits.conf\uff09\n# appuser soft nofile 65535\n# appuser hard nofile 65535\n"})}),"\n",(0,r.jsx)(e.h3,{id:"docker-\u3067\u306e\u8a2d\u5b9a",children:"Docker \u3067\u306e\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.yml\nservices:\n  app:\n    image: myapp\n    ulimits:\n      nofile:\n        soft: 65535\n        hard: 65535\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",children:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u30ea\u30bd\u30fc\u30b9\u67af\u6e07\u306e\u30a8\u30e9\u30fc\u4f8b                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u67af\u6e07:                                         \u2502\n\u2502  java.io.IOException: Too many open files                            \u2502\n\u2502                                                                      \u2502\n\u2502  \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u67af\u6e07:                                             \u2502\n\u2502  java.sql.SQLTransientConnectionException:                           \u2502\n\u2502    HikariPool-1 - Connection is not available,                       \u2502\n\u2502    request timed out after 30000ms                                   \u2502\n\u2502                                                                      \u2502\n\u2502  \u30bd\u30b1\u30c3\u30c8\u67af\u6e07:                                                       \u2502\n\u2502  java.net.BindException: Address already in use                      \u2502\n\u2502  java.net.ConnectException: Cannot assign requested address          \u2502\n\u2502                                                                      \u2502\n\u2502  \u5bfe\u51e6:                                                               \u2502\n\u2502  1. \u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u3092\u4fee\u6b63\uff08try-with-resources \u306e\u5fb9\u5e95\uff09               \u2502\n\u2502  2. \u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u9069\u6b63\u5316                                             \u2502\n\u2502  3. OS \u306e\u5236\u9650\u5024\u3092\u4e0a\u3052\u308b\uff08ulimit\uff09                                    \u2502\n\u2502  4. TIME_WAIT \u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\uff08net.ipv4.tcp_tw_reuse\uff09               \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"direct-buffer-\u306e\u30e1\u30e2\u30ea\u7ba1\u7406",children:"Direct Buffer \u306e\u30e1\u30e2\u30ea\u7ba1\u7406"}),"\n",(0,r.jsx)(e.h3,{id:"nio-\u3068-direct-buffer",children:"NIO \u3068 Direct Buffer"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// Heap Buffer\uff08GC\u5bfe\u8c61\uff09\nByteBuffer heapBuffer = ByteBuffer.allocate(1024);\n\n// Direct Buffer\uff08GC\u5bfe\u8c61\u5916\uff09\nByteBuffer directBuffer = ByteBuffer.allocateDirect(1024);\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Heap Buffer vs Direct Buffer                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Heap Buffer:                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  JVM Heap                              OS                    \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502    \u2502\n\u2502  \u2502  \u2502 ByteBuffer  \u2502 \u2500\u2500\u30b3\u30d4\u30fc\u2500\u2500\u2192 \u4e00\u6642\u9818\u57df \u2192 \u2502 \u30bd\u30b1\u30c3\u30c8    \u2502       \u2502    \u2502\n\u2502  \u2502  \u2502 (\u30c7\u30fc\u30bf)    \u2502                       \u2502             \u2502       \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502    \u2502\n\u2502  \u2502                                                               \u2502    \u2502\n\u2502  \u2502  \u2192 I/O\u6642\u306b\u30d2\u30fc\u30d7\u304b\u3089\u30cd\u30a4\u30c6\u30a3\u30d6\u9818\u57df\u3078\u306e\u30b3\u30d4\u30fc\u304c\u767a\u751f            \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  Direct Buffer:                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Native Memory                         OS                    \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502    \u2502\n\u2502  \u2502  \u2502 ByteBuffer  \u2502 \u2500\u2500\u76f4\u63a5\u53c2\u7167\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u2502 \u30bd\u30b1\u30c3\u30c8    \u2502       \u2502    \u2502\n\u2502  \u2502  \u2502 (\u30c7\u30fc\u30bf)    \u2502                       \u2502             \u2502       \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502    \u2502\n\u2502  \u2502                                                               \u2502    \u2502\n\u2502  \u2502  \u2192 \u30bc\u30ed\u30b3\u30d4\u30fc\uff08\u30b3\u30d4\u30fc\u306a\u3057\u3067 I/O\uff09\u3001\u9ad8\u901f                       \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"direct-memory-\u306e\u5236\u9650",children:"Direct Memory \u306e\u5236\u9650"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Direct Memory \u306e\u6700\u5927\u30b5\u30a4\u30ba\njava -XX:MaxDirectMemorySize=512m -jar app.jar\n\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306f -Xmx \u3068\u540c\u3058\u5024\n"})}),"\n",(0,r.jsx)(e.h3,{id:"direct-buffer-\u306e\u30ea\u30fc\u30af",children:"Direct Buffer \u306e\u30ea\u30fc\u30af"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u5371\u967a\uff1aDirect Buffer \u3092\u5927\u91cf\u306b\u4f5c\u6210\npublic void processData(List<byte[]> dataList) {\n    for (byte[] data : dataList) {\n        // \u6bce\u56de\u65b0\u3057\u3044 Direct Buffer \u3092\u4f5c\u6210 \u2192 \u30e1\u30e2\u30ea\u30ea\u30fc\u30af\n        ByteBuffer buffer = ByteBuffer.allocateDirect(data.length);\n        buffer.put(data);\n        // buffer \u306f GC \u3055\u308c\u306b\u304f\u3044\uff01\n    }\n}\n\n// \u6539\u5584\uff1a\u30d7\u30fc\u30eb\u3092\u4f7f\u7528 or \u518d\u5229\u7528\npublic class BufferPool {\n    private final Queue<ByteBuffer> pool = new ConcurrentLinkedQueue<>();\n    private final int bufferSize;\n\n    public ByteBuffer acquire() {\n        ByteBuffer buffer = pool.poll();\n        if (buffer == null) {\n            buffer = ByteBuffer.allocateDirect(bufferSize);\n        }\n        return buffer;\n    }\n\n    public void release(ByteBuffer buffer) {\n        buffer.clear();\n        pool.offer(buffer);\n    }\n}\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u5e38\u306b-try-with-resources-\u3092\u4f7f\u7528",children:"1. \u5e38\u306b try-with-resources \u3092\u4f7f\u7528"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// Good\ntry (Connection conn = dataSource.getConnection();\n     PreparedStatement stmt = conn.prepareStatement(sql)) {\n    // ...\n}\n\n// Bad\nConnection conn = dataSource.getConnection();\ntry {\n    // ...\n} finally {\n    conn.close();  // \u4f8b\u5916\u3067 close \u3055\u308c\u306a\u3044\u53ef\u80fd\u6027\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"2-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u9069\u5207\u306b\u8a2d\u5b9a",children:"2. \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u9069\u5207\u306b\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"HikariConfig config = new HikariConfig();\nconfig.setMaximumPoolSize(10);              // \u5c11\u306a\u3081\u306b\u958b\u59cb\nconfig.setMinimumIdle(5);                   // \u30a2\u30a4\u30c9\u30eb\u7dad\u6301\nconfig.setConnectionTimeout(5000);          // 5\u79d2\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\nconfig.setLeakDetectionThreshold(30000);    // \u30ea\u30fc\u30af\u691c\u51fa\n"})}),"\n",(0,r.jsx)(e.h3,{id:"3-httpclient-\u3092\u518d\u5229\u7528",children:"3. HttpClient \u3092\u518d\u5229\u7528"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5168\u4f53\u30671\u3064\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\n@Bean\npublic HttpClient httpClient() {\n    return HttpClient.newBuilder()\n        .connectTimeout(Duration.ofSeconds(10))\n        .build();\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"4-virtual-threads-\u4f7f\u7528\u6642\u306f\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650",children:"4. Virtual Threads \u4f7f\u7528\u6642\u306f\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"private final Semaphore dbSemaphore = new Semaphore(20);\n\npublic Result executeQuery(String sql) throws Exception {\n    dbSemaphore.acquire();\n    try {\n        return doQuery(sql);\n    } finally {\n        dbSemaphore.release();\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"5-\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3092\u8a2d\u5b9a",children:"5. \u30e2\u30cb\u30bf\u30ea\u30f3\u30b0\u3092\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// JMX \u3067\u30d7\u30fc\u30eb\u72b6\u614b\u3092\u76e3\u8996\n@Scheduled(fixedRate = 60000)\npublic void logPoolStats() {\n    HikariPoolMXBean pool = dataSource.getHikariPoolMXBean();\n    log.info("DB Pool - Active: {}, Idle: {}, Waiting: {}",\n        pool.getActiveConnections(),\n        pool.getIdleConnections(),\n        pool.getThreadsAwaitingConnection());\n}\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u9805\u76ee"}),(0,r.jsx)(e.th,{children:"\u30dd\u30a4\u30f3\u30c8"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30d2\u30fc\u30d7\u5916\u30ea\u30bd\u30fc\u30b9"}),(0,r.jsx)(e.td,{children:"GC \u3067\u56de\u53ce\u3055\u308c\u306a\u3044\u3001\u660e\u793a\u7684\u306a close \u304c\u5fc5\u8981"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"try-with-resources"}),(0,r.jsx)(e.td,{children:"\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u306e\u57fa\u672c\u3001\u5fc5\u305a\u4f7f\u7528\u3059\u308b"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb"}),(0,r.jsx)(e.td,{children:"\u4f5c\u6210\u30b3\u30b9\u30c8\u524a\u6e1b\u3001\u30b5\u30a4\u30ba\u306f\u63a7\u3048\u3081\u306b"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Virtual Threads"}),(0,r.jsx)(e.td,{children:"\u30d7\u30fc\u30eb\u304c\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u3001Semaphore \u3067\u5236\u9650"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Direct Buffer"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f\u3060\u304c\u30ea\u30fc\u30af\u6ce8\u610f\u3001\u30d7\u30fc\u30eb\u3067\u518d\u5229\u7528"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30e2\u30cb\u30bf\u30ea\u30f3\u30b0"}),(0,r.jsx)(e.td,{children:"JMX\u3001\u30ea\u30fc\u30af\u691c\u51fa\u3092\u6709\u52b9\u5316"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/jvm/jvm-03-memory",children:"\u30e1\u30e2\u30ea\u7ba1\u7406"})," - Direct Memory \u306e\u8a73\u7d30"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/jvm/jvm-07-troubleshooting",children:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"})," - \u30ea\u30bd\u30fc\u30b9\u30ea\u30fc\u30af\u306e\u8abf\u67fb\u65b9\u6cd5"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/jvm/jvm-05-gc-tuning",children:"GC\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0"})," - \u30d2\u30fc\u30d7\u5916\u30e1\u30e2\u30ea\u3068\u306e\u95a2\u4fc2"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var i=t(96540);const r={},l=i.createContext(r);function s(n){const e=i.useContext(l);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);