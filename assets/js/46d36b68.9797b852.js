"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[47560],{75975:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"content_11_learning/kubernetes/kubernetes-scaling","title":"Kubernetes \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0","description":"Horizontal Pod Autoscaler\uff08HPA\uff09\u3001Vertical Pod Autoscaler\uff08VPA\uff09\u3001Cluster Autoscaler\u3092\u4f7f\u7528\u3057\u305f\u81ea\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002","source":"@site/docs/content_11_learning/13-kubernetes/kubernetes-scaling.md","sourceDirName":"content_11_learning/13-kubernetes","slug":"/content_11_learning/kubernetes/kubernetes-scaling","permalink":"/idp-server/docs/content_11_learning/kubernetes/kubernetes-scaling","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/13-kubernetes/kubernetes-scaling.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Kubernetes \u8a2d\u5b9a\u7ba1\u7406","permalink":"/idp-server/docs/content_11_learning/kubernetes/kubernetes-configuration"},"next":{"title":"Kubernetes \u53ef\u89b3\u6e2c\u6027","permalink":"/idp-server/docs/content_11_learning/kubernetes/kubernetes-observability"}}');var a=r(74848),t=r(28453);const l={},i="Kubernetes \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",d={},o=[{value:"\u76ee\u6b21",id:"\u76ee\u6b21",level:2},{value:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e",id:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e",level:2},{value:"\u6c34\u5e73 vs \u5782\u76f4\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",id:"\u6c34\u5e73-vs-\u5782\u76f4\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",level:3},{value:"\u624b\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",id:"\u624b\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",level:2},{value:"Deployment\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",id:"deployment\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",level:3},{value:"\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3067\u306e\u6307\u5b9a",id:"\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3067\u306e\u6307\u5b9a",level:3},{value:"Horizontal Pod Autoscaler",id:"horizontal-pod-autoscaler",level:2},{value:"\u57fa\u672c\u6982\u5ff5",id:"\u57fa\u672c\u6982\u5ff5",level:3},{value:"HPA v2\u306e\u5b9a\u7fa9",id:"hpa-v2\u306e\u5b9a\u7fa9",level:3},{value:"\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3092\u4f7f\u7528\u3057\u305fHPA",id:"\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3092\u4f7f\u7528\u3057\u305fhpa",level:3},{value:"HPA\u306e\u78ba\u8a8d",id:"hpa\u306e\u78ba\u8a8d",level:3},{value:"Vertical Pod Autoscaler",id:"vertical-pod-autoscaler",level:2},{value:"VPA\u306e\u52d5\u4f5c",id:"vpa\u306e\u52d5\u4f5c",level:3},{value:"VPA\u5b9a\u7fa9",id:"vpa\u5b9a\u7fa9",level:3},{value:"\u66f4\u65b0\u30e2\u30fc\u30c9",id:"\u66f4\u65b0\u30e2\u30fc\u30c9",level:3},{value:"VPA\u306e\u78ba\u8a8d",id:"vpa\u306e\u78ba\u8a8d",level:3},{value:"HPA\u3068VPA\u306e\u4f75\u7528",id:"hpa\u3068vpa\u306e\u4f75\u7528",level:3},{value:"Cluster Autoscaler",id:"cluster-autoscaler",level:2},{value:"\u52d5\u4f5c\u6982\u5ff5",id:"\u52d5\u4f5c\u6982\u5ff5",level:3},{value:"AWS EKS \u3067\u306e\u8a2d\u5b9a",id:"aws-eks-\u3067\u306e\u8a2d\u5b9a",level:3},{value:"Karpenter\uff08AWS\u63a8\u5968\uff09",id:"karpenteraws\u63a8\u5968",level:3},{value:"KEDA",id:"keda",level:2},{value:"KEDA\u306e\u6982\u8981",id:"keda\u306e\u6982\u8981",level:3},{value:"KEDA ScaledObject",id:"keda-scaledobject",level:3},{value:"ID\u30b5\u30fc\u30d3\u30b9\u3067\u306e\u69cb\u6210\u4f8b",id:"id\u30b5\u30fc\u30d3\u30b9\u3067\u306e\u69cb\u6210\u4f8b",level:2},{value:"\u5b8c\u5168\u306a\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u69cb\u6210",id:"\u5b8c\u5168\u306a\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u69cb\u6210",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u624b\u6cd5\u306e\u9078\u629e",id:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u624b\u6cd5\u306e\u9078\u629e",level:3},{value:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:3},{value:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",id:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"kubernetes-\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",children:"Kubernetes \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"})}),"\n",(0,a.jsx)(n.p,{children:"Horizontal Pod Autoscaler\uff08HPA\uff09\u3001Vertical Pod Autoscaler\uff08VPA\uff09\u3001Cluster Autoscaler\u3092\u4f7f\u7528\u3057\u305f\u81ea\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002"}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\u76ee\u6b21",children:"\u76ee\u6b21"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0%E3%81%AE%E7%A8%AE%E9%A1%9E",children:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#%E6%89%8B%E5%8B%95%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%B0",children:"\u624b\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#horizontal-pod-autoscaler",children:"Horizontal Pod Autoscaler"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#vertical-pod-autoscaler",children:"Vertical Pod Autoscaler"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#cluster-autoscaler",children:"Cluster Autoscaler"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#keda",children:"KEDA"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#id%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%A7%E3%81%AE%E6%A7%8B%E6%88%90%E4%BE%8B",children:"ID\u30b5\u30fc\u30d3\u30b9\u3067\u306e\u69cb\u6210\u4f8b"})}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e",children:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e"}),"\n",(0,a.jsx)(n.h3,{id:"\u6c34\u5e73-vs-\u5782\u76f4\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",children:"\u6c34\u5e73 vs \u5782\u76f4\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u306e\u7a2e\u985e                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u6c34\u5e73\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\uff08Horizontal Scaling\uff09                       \u2502\n\u2502  \u2514\u2500\u2500 Pod\u6570\u3092\u5897\u6e1b                                             \u2502\n\u2502  \u2514\u2500\u2500 HPA\uff08Horizontal Pod Autoscaler\uff09                        \u2502\n\u2502                                                              \u2502\n\u2502  Before:  [Pod] [Pod]                                        \u2502\n\u2502  After:   [Pod] [Pod] [Pod] [Pod]                            \u2502\n\u2502                                                              \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502                                                              \u2502\n\u2502  \u5782\u76f4\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\uff08Vertical Scaling\uff09                         \u2502\n\u2502  \u2514\u2500\u2500 Pod\u5358\u4f4d\u306e\u30ea\u30bd\u30fc\u30b9\uff08CPU/\u30e1\u30e2\u30ea\uff09\u3092\u5897\u6e1b                    \u2502\n\u2502  \u2514\u2500\u2500 VPA\uff08Vertical Pod Autoscaler\uff09                          \u2502\n\u2502                                                              \u2502\n\u2502  Before:  [Pod 256Mi]                                        \u2502\n\u2502  After:   [Pod 512Mi]                                        \u2502\n\u2502                                                              \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2502\n\u2502                                                              \u2502\n\u2502  \u30af\u30e9\u30b9\u30bf\u30fc\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\uff08Cluster Scaling\uff09                    \u2502\n\u2502  \u2514\u2500\u2500 \u30ce\u30fc\u30c9\u6570\u3092\u5897\u6e1b                                          \u2502\n\u2502  \u2514\u2500\u2500 Cluster Autoscaler                                      \u2502\n\u2502                                                              \u2502\n\u2502  Before:  [Node1] [Node2]                                    \u2502\n\u2502  After:   [Node1] [Node2] [Node3]                            \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\u624b\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",children:"\u624b\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"}),"\n",(0,a.jsx)(n.h3,{id:"deployment\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0",children:"Deployment\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u30ec\u30d7\u30ea\u30ab\u6570\u306e\u5909\u66f4\nkubectl scale deployment idp-server --replicas=5\n\n# \u73fe\u5728\u306e\u72b6\u614b\u78ba\u8a8d\nkubectl get deployment idp-server\n\n# \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u72b6\u6cc1\u306e\u76e3\u8996\nkubectl rollout status deployment/idp-server\n\n# Pod\u306e\u72b6\u614b\u78ba\u8a8d\nkubectl get pods -l app=idp-server\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3067\u306e\u6307\u5b9a",children:"\u30de\u30cb\u30d5\u30a7\u30b9\u30c8\u3067\u306e\u6307\u5b9a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: idp-server\nspec:\n  replicas: 3  # \u56fa\u5b9a\u30ec\u30d7\u30ea\u30ab\u6570\n  selector:\n    matchLabels:\n      app: idp-server\n  template:\n    spec:\n      containers:\n        - name: idp-server\n          resources:\n            requests:\n              memory: "512Mi"\n              cpu: "250m"\n            limits:\n              memory: "1Gi"\n              cpu: "500m"\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"horizontal-pod-autoscaler",children:"Horizontal Pod Autoscaler"}),"\n",(0,a.jsx)(n.h3,{id:"\u57fa\u672c\u6982\u5ff5",children:"\u57fa\u672c\u6982\u5ff5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Horizontal Pod Autoscaler                   \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                   Metrics Server                      \u2502   \u2502\n\u2502  \u2502              (CPU/\u30e1\u30e2\u30ea\u4f7f\u7528\u7387\u306e\u53ce\u96c6)                  \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                  \u2502\n\u2502                           \u25bc                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                        HPA                           \u2502   \u2502\n\u2502  \u2502   Target: 50% CPU                                    \u2502   \u2502\n\u2502  \u2502   Min: 2, Max: 10                                    \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                  \u2502\n\u2502           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502           \u25bc               \u25bc               \u25bc                 \u2502\n\u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u2502\n\u2502      \u2502   Pod   \u2502     \u2502   Pod   \u2502     \u2502   Pod   \u2502          \u2502\n\u2502      \u2502  CPU:30% \u2502     \u2502  CPU:40% \u2502     \u2502  CPU:35% \u2502          \u2502\n\u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502\n\u2502                                                              \u2502\n\u2502      \u5e73\u5747: 35% < 50% \u2192 \u30b9\u30b1\u30fc\u30eb\u30c0\u30a6\u30f3\u53ef\u80fd                     \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h3,{id:"hpa-v2\u306e\u5b9a\u7fa9",children:"HPA v2\u306e\u5b9a\u7fa9"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: idp-server-hpa\n  namespace: production\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: idp-server\n\n  # \u30ec\u30d7\u30ea\u30ab\u6570\u306e\u7bc4\u56f2\n  minReplicas: 2\n  maxReplicas: 10\n\n  # \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u30e1\u30c8\u30ea\u30af\u30b9\n  metrics:\n    # CPU\u4f7f\u7528\u7387\u30d9\u30fc\u30b9\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n\n    # \u30e1\u30e2\u30ea\u4f7f\u7528\u7387\u30d9\u30fc\u30b9\n    - type: Resource\n      resource:\n        name: memory\n        target:\n          type: Utilization\n          averageUtilization: 80\n\n  # \u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u52d5\u4f5c\u306e\u5236\u5fa1\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300  # 5\u5206\u9593\u5b89\u5b9a\u3057\u3066\u304b\u3089\n      policies:\n        - type: Percent\n          value: 10\n          periodSeconds: 60  # 1\u5206\u6bce\u306b\u6700\u592710%\u524a\u6e1b\n        - type: Pods\n          value: 1\n          periodSeconds: 60  # \u307e\u305f\u306f1\u5206\u6bce\u306b1Pod\u524a\u6e1b\n      selectPolicy: Min  # \u6700\u5c0f\u306e\u524a\u6e1b\u3092\u9078\u629e\n\n    scaleUp:\n      stabilizationWindowSeconds: 0  # \u5373\u5ea7\u306b\u30b9\u30b1\u30fc\u30eb\u30a2\u30c3\u30d7\n      policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15  # 15\u79d2\u6bce\u306b\u6700\u5927100%\u5897\u52a0\n        - type: Pods\n          value: 4\n          periodSeconds: 15  # \u307e\u305f\u306f15\u79d2\u6bce\u306b4Pod\u5897\u52a0\n      selectPolicy: Max  # \u6700\u5927\u306e\u5897\u52a0\u3092\u9078\u629e\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3092\u4f7f\u7528\u3057\u305fhpa",children:"\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\u3092\u4f7f\u7528\u3057\u305fHPA"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: idp-server-hpa-custom\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: idp-server\n  minReplicas: 2\n  maxReplicas: 20\n  metrics:\n    # Prometheus\u30ab\u30b9\u30bf\u30e0\u30e1\u30c8\u30ea\u30af\u30b9\n    - type: Pods\n      pods:\n        metric:\n          name: http_requests_per_second\n        target:\n          type: AverageValue\n          averageValue: "1000"\n\n    # \u5916\u90e8\u30e1\u30c8\u30ea\u30af\u30b9\uff08SQS\u30ad\u30e5\u30fc\u9577\u306a\u3069\uff09\n    - type: External\n      external:\n        metric:\n          name: sqs_messages_visible\n          selector:\n            matchLabels:\n              queue: idp-events\n        target:\n          type: AverageValue\n          averageValue: "30"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"hpa\u306e\u78ba\u8a8d",children:"HPA\u306e\u78ba\u8a8d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# HPA\u4e00\u89a7\nkubectl get hpa\n\n# HPA\u8a73\u7d30\nkubectl describe hpa idp-server-hpa\n\n# \u51fa\u529b\u4f8b\n# NAME             REFERENCE               TARGETS   MINPODS   MAXPODS   REPLICAS\n# idp-server-hpa   Deployment/idp-server   45%/70%   2         10        3\n\n# \u30e1\u30c8\u30ea\u30af\u30b9\u306e\u78ba\u8a8d\nkubectl top pods -l app=idp-server\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"vertical-pod-autoscaler",children:"Vertical Pod Autoscaler"}),"\n",(0,a.jsx)(n.h3,{id:"vpa\u306e\u52d5\u4f5c",children:"VPA\u306e\u52d5\u4f5c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Vertical Pod Autoscaler                     \u2502\n\u2502                                                              \u2502\n\u2502  \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8:                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502 Recommender \u2502  \u2502   Updater   \u2502  \u2502  Admission  \u2502         \u2502\n\u2502  \u2502             \u2502  \u2502             \u2502  \u2502 Controller  \u2502         \u2502\n\u2502  \u2502 \u63a8\u5968\u5024\u8a08\u7b97   \u2502  \u2502 Pod\u518d\u4f5c\u6210   \u2502  \u2502 \u65b0Pod\u8a2d\u5b9a   \u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502         \u2502                \u2502                \u2502                  \u2502\n\u2502         \u25bc                \u25bc                \u25bc                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                      VPA                             \u2502   \u2502\n\u2502  \u2502   \u63a8\u5968: CPU 500m, Memory 1Gi                         \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                         \u2502                                    \u2502\n\u2502                         \u25bc                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                     Pod                              \u2502   \u2502\n\u2502  \u2502   \u73fe\u5728: CPU 250m, Memory 512Mi                       \u2502   \u2502\n\u2502  \u2502   \u2192 \u518d\u4f5c\u6210\u5f8c: CPU 500m, Memory 1Gi                   \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h3,{id:"vpa\u5b9a\u7fa9",children:"VPA\u5b9a\u7fa9"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: autoscaling.k8s.io/v1\nkind: VerticalPodAutoscaler\nmetadata:\n  name: idp-server-vpa\nspec:\n  targetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: idp-server\n\n  # \u66f4\u65b0\u30e2\u30fc\u30c9\n  updatePolicy:\n    updateMode: "Auto"  # Off, Initial, Recreate, Auto\n\n  # \u30ea\u30bd\u30fc\u30b9\u30dd\u30ea\u30b7\u30fc\n  resourcePolicy:\n    containerPolicies:\n      - containerName: idp-server\n        minAllowed:\n          cpu: 100m\n          memory: 256Mi\n        maxAllowed:\n          cpu: 2\n          memory: 4Gi\n        controlledResources: ["cpu", "memory"]\n        controlledValues: RequestsAndLimits\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u66f4\u65b0\u30e2\u30fc\u30c9",children:"\u66f4\u65b0\u30e2\u30fc\u30c9"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"\u30e2\u30fc\u30c9"}),(0,a.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Off"}),(0,a.jsx)(n.td,{children:"\u63a8\u5968\u5024\u306e\u8a08\u7b97\u306e\u307f\uff08\u9069\u7528\u3057\u306a\u3044\uff09"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Initial"}),(0,a.jsx)(n.td,{children:"\u65b0\u898fPod\u4f5c\u6210\u6642\u306e\u307f\u9069\u7528"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Recreate"}),(0,a.jsx)(n.td,{children:"Pod\u3092\u518d\u4f5c\u6210\u3057\u3066\u9069\u7528"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Auto"}),(0,a.jsx)(n.td,{children:"\u81ea\u52d5\u3067\u6700\u9069\u306a\u65b9\u6cd5\u3092\u9078\u629e"})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"vpa\u306e\u78ba\u8a8d",children:"VPA\u306e\u78ba\u8a8d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# VPA\u4e00\u89a7\nkubectl get vpa\n\n# \u63a8\u5968\u5024\u306e\u78ba\u8a8d\nkubectl describe vpa idp-server-vpa\n\n# \u51fa\u529b\u4f8b\n# Recommendation:\n#   Container Recommendations:\n#     Container Name:  idp-server\n#     Lower Bound:\n#       Cpu:     250m\n#       Memory:  512Mi\n#     Target:\n#       Cpu:     500m\n#       Memory:  1Gi\n#     Upper Bound:\n#       Cpu:     1\n#       Memory:  2Gi\n"})}),"\n",(0,a.jsx)(n.h3,{id:"hpa\u3068vpa\u306e\u4f75\u7528",children:"HPA\u3068VPA\u306e\u4f75\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# HPA\u3068VPA\u3092\u4f75\u7528\u3059\u308b\u5834\u5408\u306e\u6ce8\u610f\u70b9\n# - VPA\u306fCPU\u3092\u5236\u5fa1\u3057\u306a\u3044\u8a2d\u5b9a\u306b\u3059\u308b\n# - \u30e1\u30e2\u30ea\u306e\u307fVPA\u3067\u5236\u5fa1\n\napiVersion: autoscaling.k8s.io/v1\nkind: VerticalPodAutoscaler\nmetadata:\n  name: idp-server-vpa\nspec:\n  targetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: idp-server\n  updatePolicy:\n    updateMode: "Auto"\n  resourcePolicy:\n    containerPolicies:\n      - containerName: idp-server\n        # CPU\u306fHPA\u3067\u5236\u5fa1\u3059\u308b\u305f\u3081\u9664\u5916\n        controlledResources: ["memory"]\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"cluster-autoscaler",children:"Cluster Autoscaler"}),"\n",(0,a.jsx)(n.h3,{id:"\u52d5\u4f5c\u6982\u5ff5",children:"\u52d5\u4f5c\u6982\u5ff5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Cluster Autoscaler                         \u2502\n\u2502                                                              \u2502\n\u2502  \u30b9\u30b1\u30fc\u30eb\u30a2\u30c3\u30d7:                                              \u2502\n\u2502  Pod\u4f5c\u6210 \u2192 \u30ea\u30bd\u30fc\u30b9\u4e0d\u8db3\u3067Pending \u2192 \u30ce\u30fc\u30c9\u8ffd\u52a0                 \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510  Pending   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502  \u2502 Pod  \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502 Cluster         \u2502 \u2500\u2500\u25ba [New Node]    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502 Autoscaler      \u2502                    \u2502\n\u2502                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2502                                                              \u2502\n\u2502  \u30b9\u30b1\u30fc\u30eb\u30c0\u30a6\u30f3:                                              \u2502\n\u2502  \u4f4e\u4f7f\u7528\u7387\u30ce\u30fc\u30c9 \u2192 Pod\u79fb\u52d5 \u2192 \u30ce\u30fc\u30c9\u524a\u9664                        \u2502\n\u2502                                                              \u2502\n\u2502  [Node 20%] \u2500\u2500\u25ba \u6761\u4ef6:                                       \u2502\n\u2502  \u4f7f\u7528\u7387\u3001\u672a\u30b9\u30b1\u30b8\u30e5\u30fc\u30ebPod\u306a\u3057\u3001PDB\u8003\u616e \u2192 \u30ce\u30fc\u30c9\u524a\u9664           \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h3,{id:"aws-eks-\u3067\u306e\u8a2d\u5b9a",children:"AWS EKS \u3067\u306e\u8a2d\u5b9a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# Cluster Autoscaler Deployment\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cluster-autoscaler\n  namespace: kube-system\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cluster-autoscaler\n  template:\n    metadata:\n      labels:\n        app: cluster-autoscaler\n    spec:\n      serviceAccountName: cluster-autoscaler\n      containers:\n        - name: cluster-autoscaler\n          image: registry.k8s.io/autoscaling/cluster-autoscaler:v1.28.0\n          command:\n            - ./cluster-autoscaler\n            - --v=4\n            - --stderrthreshold=info\n            - --cloud-provider=aws\n            - --skip-nodes-with-local-storage=false\n            - --expander=least-waste\n            - --node-group-auto-discovery=asg:tag=k8s.io/cluster-autoscaler/enabled,k8s.io/cluster-autoscaler/my-cluster\n            - --balance-similar-node-groups\n            - --scale-down-delay-after-add=10m\n            - --scale-down-unneeded-time=10m\n          resources:\n            limits:\n              cpu: 100m\n              memory: 600Mi\n            requests:\n              cpu: 100m\n              memory: 600Mi\n"})}),"\n",(0,a.jsx)(n.h3,{id:"karpenteraws\u63a8\u5968",children:"Karpenter\uff08AWS\u63a8\u5968\uff09"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# Karpenter NodePool\napiVersion: karpenter.sh/v1beta1\nkind: NodePool\nmetadata:\n  name: default\nspec:\n  template:\n    spec:\n      requirements:\n        - key: kubernetes.io/arch\n          operator: In\n          values: ["amd64"]\n        - key: kubernetes.io/os\n          operator: In\n          values: ["linux"]\n        - key: karpenter.sh/capacity-type\n          operator: In\n          values: ["spot", "on-demand"]\n        - key: node.kubernetes.io/instance-type\n          operator: In\n          values: ["m5.large", "m5.xlarge", "m5.2xlarge"]\n\n      nodeClassRef:\n        name: default\n\n  limits:\n    cpu: 1000\n    memory: 1000Gi\n\n  disruption:\n    consolidationPolicy: WhenUnderutilized\n    consolidateAfter: 30s\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"keda",children:"KEDA"}),"\n",(0,a.jsx)(n.h3,{id:"keda\u306e\u6982\u8981",children:"KEDA\u306e\u6982\u8981"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          KEDA                                \u2502\n\u2502            (Kubernetes Event-driven Autoscaling)             \u2502\n\u2502                                                              \u2502\n\u2502  \u7279\u5fb4:                                                       \u2502\n\u2502  - \u30a4\u30d9\u30f3\u30c8\u99c6\u52d5\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0                                 \u2502\n\u2502  - 0\u304b\u3089N\u307e\u3067\u30b9\u30b1\u30fc\u30eb\u53ef\u80fd                                     \u2502\n\u2502  - \u591a\u69d8\u306a\u30b9\u30b1\u30fc\u30e9\u30fc\uff08AWS SQS, Kafka, Prometheus\u7b49\uff09           \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  Event Source  \u2502     \u2502     KEDA       \u2502                 \u2502\n\u2502  \u2502  (SQS, Kafka)  \u2502\u2500\u2500\u2500\u2500\u25ba\u2502    Operator    \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                 \u2502                            \u2502\n\u2502                                 \u25bc                            \u2502\n\u2502                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u2502\n\u2502                         \u2502   Deployment   \u2502                  \u2502\n\u2502                         \u2502  replicas: 0\u2192N \u2502                  \u2502\n\u2502                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h3,{id:"keda-scaledobject",children:"KEDA ScaledObject"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'apiVersion: keda.sh/v1alpha1\nkind: ScaledObject\nmetadata:\n  name: idp-event-processor\nspec:\n  scaleTargetRef:\n    name: event-processor\n  pollingInterval: 30\n  cooldownPeriod: 300\n  minReplicaCount: 0   # 0\u307e\u3067\u30b9\u30b1\u30fc\u30eb\u30c0\u30a6\u30f3\u53ef\u80fd\n  maxReplicaCount: 100\n  triggers:\n    # AWS SQS\u30ad\u30e5\u30fc\n    - type: aws-sqs-queue\n      metadata:\n        queueURL: https://sqs.ap-northeast-1.amazonaws.com/123456789/idp-events\n        queueLength: "5"\n        awsRegion: ap-northeast-1\n      authenticationRef:\n        name: keda-aws-credentials\n\n    # Prometheus \u30e1\u30c8\u30ea\u30af\u30b9\n    - type: prometheus\n      metadata:\n        serverAddress: http://prometheus:9090\n        metricName: http_requests_total\n        threshold: "100"\n        query: |\n          sum(rate(http_requests_total{app="idp-server"}[2m]))\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"id\u30b5\u30fc\u30d3\u30b9\u3067\u306e\u69cb\u6210\u4f8b",children:"ID\u30b5\u30fc\u30d3\u30b9\u3067\u306e\u69cb\u6210\u4f8b"}),"\n",(0,a.jsx)(n.h3,{id:"\u5b8c\u5168\u306a\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u69cb\u6210",children:"\u5b8c\u5168\u306a\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u69cb\u6210"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# deployment.yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: idp-server\n  namespace: production\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: idp-server\n  template:\n    metadata:\n      labels:\n        app: idp-server\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            - weight: 100\n              podAffinityTerm:\n                labelSelector:\n                  matchLabels:\n                    app: idp-server\n                topologyKey: topology.kubernetes.io/zone\n      containers:\n        - name: idp-server\n          image: ghcr.io/myorg/idp-server:v1.0.0\n          resources:\n            requests:\n              memory: "512Mi"\n              cpu: "250m"\n            limits:\n              memory: "1Gi"\n              cpu: "500m"\n\n---\n# hpa.yaml\napiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: idp-server-hpa\n  namespace: production\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: idp-server\n  minReplicas: 3\n  maxReplicas: 20\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n    - type: Resource\n      resource:\n        name: memory\n        target:\n          type: Utilization\n          averageUtilization: 80\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300\n      policies:\n        - type: Percent\n          value: 10\n          periodSeconds: 60\n    scaleUp:\n      stabilizationWindowSeconds: 0\n      policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15\n\n---\n# pdb.yaml (Pod Disruption Budget)\napiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: idp-server-pdb\n  namespace: production\nspec:\n  minAvailable: 2  # \u6700\u4f4e2Pod\u306f\u7dad\u6301\n  selector:\n    matchLabels:\n      app: idp-server\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,a.jsx)(n.h3,{id:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u624b\u6cd5\u306e\u9078\u629e",children:"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u624b\u6cd5\u306e\u9078\u629e"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"\u624b\u6cd5"}),(0,a.jsx)(n.th,{children:"\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9"}),(0,a.jsx)(n.th,{children:"\u7279\u5fb4"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"HPA"}),(0,a.jsx)(n.td,{children:"Web\u30a2\u30d7\u30ea\u3001API"}),(0,a.jsx)(n.td,{children:"\u8ca0\u8377\u306b\u5fdc\u3058\u3066Pod\u6570\u3092\u5897\u6e1b"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"VPA"}),(0,a.jsx)(n.td,{children:"\u30d0\u30c3\u30c1\u51e6\u7406"}),(0,a.jsx)(n.td,{children:"Pod\u5358\u4f4d\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u6700\u9069\u5316"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Cluster Autoscaler"}),(0,a.jsx)(n.td,{children:"\u6c4e\u7528"}),(0,a.jsx)(n.td,{children:"\u30ce\u30fc\u30c9\u6570\u3092\u81ea\u52d5\u8abf\u6574"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"KEDA"}),(0,a.jsx)(n.td,{children:"\u30a4\u30d9\u30f3\u30c8\u99c6\u52d5"}),(0,a.jsx)(n.td,{children:"\u30ad\u30e5\u30fc\u30d9\u30fc\u30b9\u306e\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,a.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30ea\u30bd\u30fc\u30b9\u306erequests/limits\u3092\u8a2d\u5b9a"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HPA\u306emin/max\u3092\u9069\u5207\u306b\u8a2d\u5b9a"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30b9\u30b1\u30fc\u30eb\u30c0\u30a6\u30f3\u306e\u5b89\u5b9a\u5316\u6642\u9593\u3092\u8a2d\u5b9a"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," ","PodDisruptionBudget\u3092\u8a2d\u5b9a"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Pod\u30a2\u30f3\u30c1\u30a2\u30d5\u30a3\u30cb\u30c6\u30a3\u3067\u5206\u6563\u914d\u7f6e"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/kubernetes/kubernetes-observability",children:"Kubernetes\u53ef\u89b3\u6e2c\u6027"})," - \u30ed\u30b0\u3001\u30e1\u30c8\u30ea\u30af\u30b9\u3001\u30c8\u30ec\u30fc\u30b9"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/kubernetes/kubernetes-security",children:"Kubernetes\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"})," - RBAC\u3001PodSecurity"]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",children:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/",children:"Horizontal Pod Autoscaling"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler",children:"Vertical Pod Autoscaler"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/kubernetes/autoscaler/tree/master/cluster-autoscaler",children:"Cluster Autoscaler"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://keda.sh/",children:"KEDA"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://karpenter.sh/",children:"Karpenter"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var s=r(96540);const a={},t=s.createContext(a);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);