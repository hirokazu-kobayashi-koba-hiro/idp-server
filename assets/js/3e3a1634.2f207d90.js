"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[599],{12958:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"content_11_learning/os-fundamentals/synchronization","title":"\u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6","description":"\u6240\u8981\u6642\u9593: 35\u5206","source":"@site/docs/content_11_learning/21-os-fundamentals/synchronization.md","sourceDirName":"content_11_learning/21-os-fundamentals","slug":"/content_11_learning/os-fundamentals/synchronization","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/synchronization","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/21-os-fundamentals/synchronization.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u30b7\u30b0\u30ca\u30eb","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/signals"},"next":{"title":"\u30b3\u30e9\u30e0: \u306a\u305c\u30da\u30fc\u30b8\u30b5\u30a4\u30ba\u306f4KB\u306a\u306e\u304b","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/column-why-4kb-page"}}');var c=t(74848),r=t(28453);const o={},a="\u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6",l={},d=[{value:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",id:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",level:2},{value:"1. \u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09",id:"1-\u7af6\u5408\u72b6\u614brace-condition",level:2},{value:"1.1 \u554f\u984c\u306e\u4f8b",id:"11-\u554f\u984c\u306e\u4f8b",level:3},{value:"1.2 Java \u3067\u306e\u518d\u73fe",id:"12-java-\u3067\u306e\u518d\u73fe",level:3},{value:"1.3 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3",id:"13-\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3",level:3},{value:"2. Mutex\uff08\u76f8\u4e92\u6392\u4ed6\u30ed\u30c3\u30af\uff09",id:"2-mutex\u76f8\u4e92\u6392\u4ed6\u30ed\u30c3\u30af",level:2},{value:"2.1 Mutex \u306e\u6982\u5ff5",id:"21-mutex-\u306e\u6982\u5ff5",level:3},{value:"2.2 Java \u3067\u306e\u5b9f\u88c5",id:"22-java-\u3067\u306e\u5b9f\u88c5",level:3},{value:"2.3 Java \u306e synchronized \u306e\u4ed5\u7d44\u307f",id:"23-java-\u306e-synchronized-\u306e\u4ed5\u7d44\u307f",level:3},{value:"3. \u30bb\u30de\u30d5\u30a9",id:"3-\u30bb\u30de\u30d5\u30a9",level:2},{value:"3.1 \u30bb\u30de\u30d5\u30a9\u306e\u6982\u5ff5",id:"31-\u30bb\u30de\u30d5\u30a9\u306e\u6982\u5ff5",level:3},{value:"3.2 \u4f7f\u7528\u4f8b: \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",id:"32-\u4f7f\u7528\u4f8b-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",level:3},{value:"4. \u6761\u4ef6\u5909\u6570",id:"4-\u6761\u4ef6\u5909\u6570",level:2},{value:"4.1 \u6761\u4ef6\u5909\u6570\u306e\u6982\u5ff5",id:"41-\u6761\u4ef6\u5909\u6570\u306e\u6982\u5ff5",level:3},{value:"4.2 Java \u3067\u306e\u5b9f\u88c5",id:"42-java-\u3067\u306e\u5b9f\u88c5",level:3},{value:"5. \u30c7\u30c3\u30c9\u30ed\u30c3\u30af",id:"5-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af",level:2},{value:"5.1 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",id:"51-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",level:3},{value:"5.2 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e4\u6761\u4ef6",id:"52-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e4\u6761\u4ef6",level:3},{value:"5.3 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f",id:"53-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f",level:3},{value:"5.4 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u691c\u51fa",id:"54-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u691c\u51fa",level:3},{value:"6. \u30a2\u30c8\u30df\u30c3\u30af\u64cd\u4f5c",id:"6-\u30a2\u30c8\u30df\u30c3\u30af\u64cd\u4f5c",level:2},{value:"6.1 CAS\uff08Compare-And-Swap\uff09",id:"61-cascompare-and-swap",level:3},{value:"6.2 Java \u306e\u30a2\u30c8\u30df\u30c3\u30af\u30af\u30e9\u30b9",id:"62-java-\u306e\u30a2\u30c8\u30df\u30c3\u30af\u30af\u30e9\u30b9",level:3},{value:"7. Linux \u3067\u306e\u78ba\u8a8d",id:"7-linux-\u3067\u306e\u78ba\u8a8d",level:2},{value:"8. \u307e\u3068\u3081",id:"8-\u307e\u3068\u3081",level:2},{value:"\u78ba\u8a8d\u554f\u984c",id:"\u78ba\u8a8d\u554f\u984c",level:2},{value:"\u95a2\u9023\u30ea\u30bd\u30fc\u30b9",id:"\u95a2\u9023\u30ea\u30bd\u30fc\u30b9",level:2}];function s(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"\u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6",children:"\u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u6240\u8981\u6642\u9593"}),": 35\u5206"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u524d\u63d0\u77e5\u8b58"}),": \u30de\u30eb\u30c1\u30b9\u30ec\u30c3\u30c9\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u5b66\u3079\u308b\u3053\u3068"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09"}),"\n",(0,c.jsx)(e.li,{children:"mutex\u3001\u30bb\u30de\u30d5\u30a9\u3001\u6761\u4ef6\u5909\u6570"}),"\n",(0,c.jsx)(e.li,{children:"\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u539f\u56e0\u3068\u56de\u907f"}),"\n",(0,c.jsx)(e.li,{children:"Java \u306e synchronized \u3068\u306e\u95a2\u4fc2"}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",children:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u300cRace Condition \u3063\u3066\u4f55\uff1f\u300d\n\u300cmutex \u3063\u3066\u4f55\uff1f\u300d\n\u300c\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306f\u306a\u305c\u8d77\u304d\u308b\uff1f\u300d\n\u300cJava \u306e synchronized \u306f\u4f55\u3092\u3057\u3066\u3044\u308b\uff1f\u300d\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"1-\u7af6\u5408\u72b6\u614brace-condition",children:"1. \u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09"}),"\n",(0,c.jsx)(e.h3,{id:"11-\u554f\u984c\u306e\u4f8b",children:"1.1 \u554f\u984c\u306e\u4f8b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u7af6\u5408\u72b6\u614b\u306e\u4f8b: \u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u5171\u6709\u5909\u6570: counter = 0                                              \u2502\n\u2502                                                                      \u2502\n\u2502  \u30b9\u30ec\u30c3\u30c9A         \u30b9\u30ec\u30c3\u30c9B         counter \u306e\u5024                   \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                     \u2502\n\u2502  read counter                       0                               \u2502\n\u2502  (\u5024\u306f 0)                                                           \u2502\n\u2502                   read counter      0                               \u2502\n\u2502                   (\u5024\u306f 0)                                          \u2502\n\u2502  increment                          0 (\u30e1\u30e2\u30ea\u306f\u307e\u3060 0)              \u2502\n\u2502  (\u30ed\u30fc\u30ab\u30eb\u3067 1)                                                     \u2502\n\u2502                   increment         0 (\u30e1\u30e2\u30ea\u306f\u307e\u3060 0)              \u2502\n\u2502                   (\u30ed\u30fc\u30ab\u30eb\u3067 1)                                    \u2502\n\u2502  write counter                      1                               \u2502\n\u2502                   write counter     1                               \u2502\n\u2502                                                                      \u2502\n\u2502  \u671f\u5f85\u5024: 2                                                          \u2502\n\u2502  \u5b9f\u969b\u306e\u5024: 1  \u2190 \u9593\u9055\u3044\uff01                                            \u2502\n\u2502                                                                      \u2502\n\u2502  \u539f\u56e0: counter++ \u306f\u5b9f\u969b\u306b\u306f3\u3064\u306e\u64cd\u4f5c                                \u2502\n\u2502  1. \u30e1\u30e2\u30ea\u304b\u3089\u5024\u3092\u8aad\u3080                                              \u2502\n\u2502  2. \u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8                                              \u2502\n\u2502  3. \u30e1\u30e2\u30ea\u306b\u66f8\u304d\u623b\u3059                                                \u2502\n\u2502  \u2192 \u3053\u306e\u9593\u306b\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u5272\u308a\u8fbc\u3080\u53ef\u80fd\u6027                            \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"12-java-\u3067\u306e\u518d\u73fe",children:"1.2 Java \u3067\u306e\u518d\u73fe"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:'// \u7af6\u5408\u72b6\u614b\u306e\u4f8b\npublic class RaceConditionDemo {\n    private static int counter = 0;\n\n    public static void main(String[] args) throws Exception {\n        Thread t1 = new Thread(() -> {\n            for (int i = 0; i < 100000; i++) {\n                counter++;  // \u30a2\u30c8\u30df\u30c3\u30af\u3067\u306f\u306a\u3044\uff01\n            }\n        });\n\n        Thread t2 = new Thread(() -> {\n            for (int i = 0; i < 100000; i++) {\n                counter++;\n            }\n        });\n\n        t1.start();\n        t2.start();\n        t1.join();\n        t2.join();\n\n        System.out.println("Counter: " + counter);\n        // \u671f\u5f85\u5024: 200000\n        // \u5b9f\u969b: 100000\u301c200000 \u306e\u9593\u306e\u30e9\u30f3\u30c0\u30e0\u306a\u5024\n    }\n}\n'})}),"\n",(0,c.jsx)(e.h3,{id:"13-\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3",children:"1.3 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3 = \u5171\u6709\u30ea\u30bd\u30fc\u30b9\u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b\u30b3\u30fc\u30c9\u90e8\u5206       \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A                     \u30b9\u30ec\u30c3\u30c9B                     \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  // \u975e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb              // \u975e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb            \u2502    \u2502\n\u2502  \u2502  prepare_data();               prepare_data();               \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502    \u2502\n\u2502  \u2502  \u2502 // \u30af\u30ea\u30c6\u30a3\u30ab\u30eb \u2502          \u2502 // \u30af\u30ea\u30c6\u30a3\u30ab\u30eb \u2502           \u2502    \u2502\n\u2502  \u2502  \u2502 counter++;      \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2500 \u2502 counter++;      \u2502 \u540c\u6642\u5b9f\u884cNG\u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  // \u975e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb              // \u975e\u30af\u30ea\u30c6\u30a3\u30ab\u30eb            \u2502    \u2502\n\u2502  \u2502  process_result();             process_result();             \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  \u89e3\u6c7a\u7b56: \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30bb\u30af\u30b7\u30e7\u30f3\u3092\u76f8\u4e92\u6392\u4ed6\uff08mutual exclusion\uff09\u306b\u3059\u308b \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"2-mutex\u76f8\u4e92\u6392\u4ed6\u30ed\u30c3\u30af",children:"2. Mutex\uff08\u76f8\u4e92\u6392\u4ed6\u30ed\u30c3\u30af\uff09"}),"\n",(0,c.jsx)(e.h3,{id:"21-mutex-\u306e\u6982\u5ff5",children:"2.1 Mutex \u306e\u6982\u5ff5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Mutex (Mutual Exclusion)                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Mutex = \u4e00\u5ea6\u306b1\u3064\u306e\u30b9\u30ec\u30c3\u30c9\u3060\u3051\u304c\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30ed\u30c3\u30af              \u2502\n\u2502                                                                      \u2502\n\u2502  \u64cd\u4f5c:                                                               \u2502\n\u2502  \u251c\u2500\u2500 lock(): \u30ed\u30c3\u30af\u3092\u53d6\u5f97\uff08\u4ed6\u304c\u6301\u3063\u3066\u3044\u305f\u3089\u5f85\u3064\uff09                  \u2502\n\u2502  \u2514\u2500\u2500 unlock(): \u30ed\u30c3\u30af\u3092\u89e3\u653e                                        \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A                     \u30b9\u30ec\u30c3\u30c9B                     \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  mutex.lock()   \u2190\u2500\u2500 \u53d6\u5f97\u6210\u529f                                 \u2502    \u2502\n\u2502  \u2502  \u2502                              mutex.lock()                 \u2502    \u2502\n\u2502  \u2502  \u2502 counter++                    \u2502                            \u2502    \u2502\n\u2502  \u2502  \u2502                              \u2502 (\u30d6\u30ed\u30c3\u30af\u3001\u5f85\u6a5f)           \u2502    \u2502\n\u2502  \u2502  mutex.unlock() \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u2502 \u2190\u2500\u2500 \u53d6\u5f97\u6210\u529f               \u2502    \u2502\n\u2502  \u2502                                 \u2502 counter++                  \u2502    \u2502\n\u2502  \u2502                                 mutex.unlock()               \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  \u7d50\u679c: counter \u304c\u6b63\u3057\u304f 2 \u306b\u306a\u308b                                    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"22-java-\u3067\u306e\u5b9f\u88c5",children:"2.2 Java \u3067\u306e\u5b9f\u88c5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"// synchronized \u30ad\u30fc\u30ef\u30fc\u30c9\npublic class Counter {\n    private int count = 0;\n\n    // \u30e1\u30bd\u30c3\u30c9\u5168\u4f53\u3092\u540c\u671f\n    public synchronized void increment() {\n        count++;  // \u3053\u308c\u3067\u5b89\u5168\n    }\n\n    // \u307e\u305f\u306f\u7279\u5b9a\u306e\u30d6\u30ed\u30c3\u30af\u3060\u3051\n    public void incrementWithBlock() {\n        // \u4ed6\u306e\u51e6\u7406\n\n        synchronized (this) {\n            count++;\n        }\n\n        // \u4ed6\u306e\u51e6\u7406\n    }\n}\n\n// ReentrantLock \u3092\u4f7f\u3046\u65b9\u6cd5\nimport java.util.concurrent.locks.ReentrantLock;\n\npublic class Counter {\n    private int count = 0;\n    private final ReentrantLock lock = new ReentrantLock();\n\n    public void increment() {\n        lock.lock();\n        try {\n            count++;\n        } finally {\n            lock.unlock();  // \u5fc5\u305a unlock \u3059\u308b\n        }\n    }\n}\n"})}),"\n",(0,c.jsx)(e.h3,{id:"23-java-\u306e-synchronized-\u306e\u4ed5\u7d44\u307f",children:"2.3 Java \u306e synchronized \u306e\u4ed5\u7d44\u307f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    synchronized \u306e\u5185\u90e8                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Java \u306e\u3059\u3079\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u300c\u30e2\u30cb\u30bf\u30fc\u300d\u3092\u6301\u3064                    \u2502\n\u2502                                                                      \u2502\n\u2502  synchronized (obj) {                                                \u2502\n\u2502      // \u3053\u306e\u30d6\u30ed\u30c3\u30af\u5185\u3067\u306f obj \u306e\u30e2\u30cb\u30bf\u30fc\u3092\u4fdd\u6301                     \u2502\n\u2502  }                                                                   \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d8\u30c3\u30c0\u30fc                                      \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502    \u2502\n\u2502  \u2502  \u2502  Mark Word                                           \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u251c\u2500\u2500 \u30ed\u30c3\u30af\u72b6\u614b\uff08\u7121\u52b9\u3001\u30d0\u30a4\u30a2\u30b9\u3001\u8efd\u91cf\u3001\u91cd\u91cf\uff09        \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u251c\u2500\u2500 \u6240\u6709\u30b9\u30ec\u30c3\u30c9ID                                  \u2502    \u2502    \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500 \u30cf\u30c3\u30b7\u30e5\u30b3\u30fc\u30c9                                  \u2502    \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  \u30ed\u30c3\u30af\u306e\u6700\u9069\u5316\uff08JVM\uff09:                                             \u2502\n\u2502  \u251c\u2500\u2500 \u30d0\u30a4\u30a2\u30b9\u30ed\u30c3\u30af: \u5358\u4e00\u30b9\u30ec\u30c3\u30c9\u306a\u3089\u8efd\u91cf                          \u2502\n\u2502  \u251c\u2500\u2500 \u8efd\u91cf\u30ed\u30c3\u30af: \u7af6\u5408\u304c\u5c11\u306a\u3044\u5834\u5408\u306f CAS \u3067                         \u2502\n\u2502  \u2514\u2500\u2500 \u91cd\u91cf\u30ed\u30c3\u30af: \u7af6\u5408\u304c\u591a\u3044\u5834\u5408\u306f OS \u306e mutex                      \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"3-\u30bb\u30de\u30d5\u30a9",children:"3. \u30bb\u30de\u30d5\u30a9"}),"\n",(0,c.jsx)(e.h3,{id:"31-\u30bb\u30de\u30d5\u30a9\u306e\u6982\u5ff5",children:"3.1 \u30bb\u30de\u30d5\u30a9\u306e\u6982\u5ff5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30bb\u30de\u30d5\u30a9 (Semaphore)                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30bb\u30de\u30d5\u30a9 = \u30ab\u30a6\u30f3\u30bf\u30fc\u4ed8\u304d\u306e\u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6                        \u2502\n\u2502  \u2514\u2500\u2500 N \u500b\u307e\u3067\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u540c\u6642\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd                        \u2502\n\u2502                                                                      \u2502\n\u2502  \u64cd\u4f5c:                                                               \u2502\n\u2502  \u251c\u2500\u2500 acquire() (P\u64cd\u4f5c): \u30ab\u30a6\u30f3\u30bf\u30fc\u6e1b\u30010\u306a\u3089\u5f85\u3064                    \u2502\n\u2502  \u2514\u2500\u2500 release() (V\u64cd\u4f5c): \u30ab\u30a6\u30f3\u30bf\u30fc\u5897                               \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  \u30bb\u30de\u30d5\u30a9 (permits = 3)                                      \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A: acquire() \u2192 permits = 2 \u2192 \u5165\u5834                  \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9B: acquire() \u2192 permits = 1 \u2192 \u5165\u5834                  \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9C: acquire() \u2192 permits = 0 \u2192 \u5165\u5834                  \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9D: acquire() \u2192 permits = 0 \u2192 \u5f85\u6a5f\uff08\u30d6\u30ed\u30c3\u30af\uff09      \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A: release() \u2192 permits = 1                         \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9D: \u2192 permits = 0 \u2192 \u5165\u5834\u53ef\u80fd\u306b                      \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  Mutex = \u30bb\u30de\u30d5\u30a9 (permits = 1) \u306e\u7279\u6b8a\u30b1\u30fc\u30b9                        \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"32-\u4f7f\u7528\u4f8b-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",children:"3.2 \u4f7f\u7528\u4f8b: \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"import java.util.concurrent.Semaphore;\n\npublic class ConnectionPool {\n    private final Semaphore semaphore;\n    private final List<Connection> connections;\n\n    public ConnectionPool(int maxConnections) {\n        this.semaphore = new Semaphore(maxConnections);\n        this.connections = new ArrayList<>();\n        for (int i = 0; i < maxConnections; i++) {\n            connections.add(createConnection());\n        }\n    }\n\n    public Connection acquire() throws InterruptedException {\n        semaphore.acquire();  // \u8a31\u53ef\u3092\u53d6\u5f97\uff08\u306a\u3051\u308c\u3070\u5f85\u3064\uff09\n        return getAvailableConnection();\n    }\n\n    public void release(Connection conn) {\n        returnConnection(conn);\n        semaphore.release();  // \u8a31\u53ef\u3092\u8fd4\u5374\n    }\n}\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"4-\u6761\u4ef6\u5909\u6570",children:"4. \u6761\u4ef6\u5909\u6570"}),"\n",(0,c.jsx)(e.h3,{id:"41-\u6761\u4ef6\u5909\u6570\u306e\u6982\u5ff5",children:"4.1 \u6761\u4ef6\u5909\u6570\u306e\u6982\u5ff5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u6761\u4ef6\u5909\u6570 (Condition Variable)                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u6761\u4ef6\u5909\u6570 = \u3042\u308b\u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u308b\u307e\u3067\u5f85\u6a5f\u3059\u308b\u4ed5\u7d44\u307f                  \u2502\n\u2502                                                                      \u2502\n\u2502  \u64cd\u4f5c:                                                               \u2502\n\u2502  \u251c\u2500\u2500 wait(): \u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u308b\u307e\u3067\u5f85\u6a5f\uff08\u30ed\u30c3\u30af\u3092\u4e00\u6642\u89e3\u653e\uff09          \u2502\n\u2502  \u251c\u2500\u2500 signal(): \u5f85\u6a5f\u4e2d\u306e\u30b9\u30ec\u30c3\u30c9\u30921\u3064\u8d77\u3053\u3059                         \u2502\n\u2502  \u2514\u2500\u2500 broadcast(): \u5f85\u6a5f\u4e2d\u306e\u30b9\u30ec\u30c3\u30c9\u3092\u5168\u90e8\u8d77\u3053\u3059                     \u2502\n\u2502                                                                      \u2502\n\u2502  \u4f8b: \u751f\u7523\u8005-\u6d88\u8cbb\u8005\u554f\u984c                                               \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u751f\u7523\u8005                     \u30ad\u30e5\u30fc                 \u6d88\u8cbb\u8005    \u2502    \u2502\n\u2502  \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500                   \u2500\u2500\u2500\u2500\u2500\u2500                 \u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30c7\u30fc\u30bf\u4f5c\u6210                 [   ]                 wait()     \u2502    \u2502\n\u2502  \u2502       \u2502                    [   ]                    \u2191        \u2502    \u2502\n\u2502  \u2502       \u25bc                    [   ]                    \u2502        \u2502    \u2502\n\u2502  \u2502  enqueue()    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 [\u30c7\u30fc\u30bf]                \u2502        \u2502    \u2502\n\u2502  \u2502       \u2502                       \u2502                     \u2502        \u2502    \u2502\n\u2502  \u2502       \u25bc                       \u2502                     \u2502        \u2502    \u2502\n\u2502  \u2502  signal()     \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502    \u2502\n\u2502  \u2502                               \u2502                              \u2502    \u2502\n\u2502  \u2502                               \u25bc                              \u2502    \u2502\n\u2502  \u2502                            dequeue()  \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u30c7\u30fc\u30bf\u53d6\u5f97    \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"42-java-\u3067\u306e\u5b9f\u88c5",children:"4.2 Java \u3067\u306e\u5b9f\u88c5"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.locks.*;\n\npublic class BoundedBuffer<T> {\n    private final Object[] items;\n    private int count, putIndex, getIndex;\n\n    private final Lock lock = new ReentrantLock();\n    private final Condition notFull = lock.newCondition();\n    private final Condition notEmpty = lock.newCondition();\n\n    public BoundedBuffer(int capacity) {\n        items = new Object[capacity];\n    }\n\n    public void put(T item) throws InterruptedException {\n        lock.lock();\n        try {\n            // \u30d0\u30c3\u30d5\u30a1\u304c\u6e80\u676f\u306a\u3089\u5f85\u3064\n            while (count == items.length) {\n                notFull.await();\n            }\n\n            items[putIndex] = item;\n            putIndex = (putIndex + 1) % items.length;\n            count++;\n\n            // \u6d88\u8cbb\u8005\u306b\u901a\u77e5\n            notEmpty.signal();\n\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    @SuppressWarnings("unchecked")\n    public T take() throws InterruptedException {\n        lock.lock();\n        try {\n            // \u30d0\u30c3\u30d5\u30a1\u304c\u7a7a\u306a\u3089\u5f85\u3064\n            while (count == 0) {\n                notEmpty.await();\n            }\n\n            T item = (T) items[getIndex];\n            getIndex = (getIndex + 1) % items.length;\n            count--;\n\n            // \u751f\u7523\u8005\u306b\u901a\u77e5\n            notFull.signal();\n\n            return item;\n\n        } finally {\n            lock.unlock();\n        }\n    }\n}\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"5-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af",children:"5. \u30c7\u30c3\u30c9\u30ed\u30c3\u30af"}),"\n",(0,c.jsx)(e.h3,{id:"51-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",children:"5.1 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30c7\u30c3\u30c9\u30ed\u30c3\u30af (Deadlock)                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u8907\u6570\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u4e92\u3044\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u5f85\u3061\u5408\u3063\u3066\u6c38\u9060\u306b\u6b62\u307e\u308b\u72b6\u614b         \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A                           \u30b9\u30ec\u30c3\u30c9B               \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  lock(\u30ea\u30bd\u30fc\u30b91)                                             \u2502    \u2502\n\u2502  \u2502  \u2193                                   lock(\u30ea\u30bd\u30fc\u30b92)         \u2502    \u2502\n\u2502  \u2502  \u30ea\u30bd\u30fc\u30b91 \u3092\u4fdd\u6301                    \u2193                       \u2502    \u2502\n\u2502  \u2502  \u2193                                   \u30ea\u30bd\u30fc\u30b92 \u3092\u4fdd\u6301        \u2502    \u2502\n\u2502  \u2502  lock(\u30ea\u30bd\u30fc\u30b92)                     lock(\u30ea\u30bd\u30fc\u30b91)         \u2502    \u2502\n\u2502  \u2502  \u2193                                   \u2193                       \u2502    \u2502\n\u2502  \u2502  \u5f85\u6a5f...                             \u5f85\u6a5f...                 \u2502    \u2502\n\u2502  \u2502  (B\u304c\u30ea\u30bd\u30fc\u30b92\u3092                     (A\u304c\u30ea\u30bd\u30fc\u30b91\u3092         \u2502    \u2502\n\u2502  \u2502   \u89e3\u653e\u3059\u308b\u307e\u3067)                       \u89e3\u653e\u3059\u308b\u307e\u3067)          \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502         \u6c38\u9060\u306b\u5f85\u3061\u7d9a\u3051\u308b\uff08\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\uff01\uff09                   \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"52-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e4\u6761\u4ef6",children:"5.2 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e4\u6761\u4ef6"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u767a\u751f\u306e4\u6761\u4ef6\uff08Coffman\u6761\u4ef6\uff09            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u4ee5\u4e0b\u306e4\u3064\u304c\u5168\u3066\u6e80\u305f\u3055\u308c\u308b\u3068\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u304c\u767a\u751f\u3059\u308b:                 \u2502\n\u2502                                                                      \u2502\n\u2502  1. \u76f8\u4e92\u6392\u4ed6 (Mutual Exclusion)                                      \u2502\n\u2502     \u2514\u2500\u2500 \u30ea\u30bd\u30fc\u30b9\u306f\u4e00\u5ea6\u306b1\u3064\u306e\u30b9\u30ec\u30c3\u30c9\u3060\u3051\u304c\u4f7f\u7528\u53ef\u80fd                \u2502\n\u2502                                                                      \u2502\n\u2502  2. \u4fdd\u6301\u3068\u5f85\u6a5f (Hold and Wait)                                       \u2502\n\u2502     \u2514\u2500\u2500 \u30ea\u30bd\u30fc\u30b9\u3092\u4fdd\u6301\u3057\u305f\u307e\u307e\u5225\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u5f85\u3064                   \u2502\n\u2502                                                                      \u2502\n\u2502  3. \u6a2a\u53d6\u308a\u4e0d\u53ef (No Preemption)                                       \u2502\n\u2502     \u2514\u2500\u2500 \u4ed6\u30b9\u30ec\u30c3\u30c9\u304b\u3089\u30ea\u30bd\u30fc\u30b9\u3092\u596a\u3048\u306a\u3044                           \u2502\n\u2502                                                                      \u2502\n\u2502  4. \u5faa\u74b0\u5f85\u3061 (Circular Wait)                                         \u2502\n\u2502     \u2514\u2500\u2500 A\u2192B\u2192C\u2192A \u306e\u3088\u3046\u306b\u5faa\u74b0\u3057\u305f\u5f85\u3061\u95a2\u4fc2\u304c\u3042\u308b                    \u2502\n\u2502                                                                      \u2502\n\u2502  \u2192 \u3069\u308c\u304b1\u3064\u3067\u3082\u5d29\u305b\u3070\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3092\u9632\u3052\u308b                         \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"53-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f",children:"5.3 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:"// \u274c \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u304c\u8d77\u304d\u308b\u30b3\u30fc\u30c9\npublic void transfer(Account from, Account to, int amount) {\n    synchronized (from) {\n        synchronized (to) {\n            from.withdraw(amount);\n            to.deposit(amount);\n        }\n    }\n}\n\n// \u30b9\u30ec\u30c3\u30c9A: transfer(account1, account2, 100)  \u2192 account1, account2 \u306e\u9806\n// \u30b9\u30ec\u30c3\u30c9B: transfer(account2, account1, 50)   \u2192 account2, account1 \u306e\u9806\n// \u2192 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\uff01\n\n// \u2705 \u9806\u5e8f\u3092\u56fa\u5b9a\u3057\u3066\u56de\u907f\npublic void transfer(Account from, Account to, int amount) {\n    // \u5e38\u306b ID \u304c\u5c0f\u3055\u3044\u65b9\u3092\u5148\u306b\u30ed\u30c3\u30af\n    Account first = from.id < to.id ? from : to;\n    Account second = from.id < to.id ? to : from;\n\n    synchronized (first) {\n        synchronized (second) {\n            from.withdraw(amount);\n            to.deposit(amount);\n        }\n    }\n}\n\n// \u2705 tryLock \u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\npublic void transfer(Account from, Account to, int amount)\n        throws InterruptedException {\n    while (true) {\n        if (from.lock.tryLock(1, TimeUnit.SECONDS)) {\n            try {\n                if (to.lock.tryLock(1, TimeUnit.SECONDS)) {\n                    try {\n                        from.withdraw(amount);\n                        to.deposit(amount);\n                        return;\n                    } finally {\n                        to.lock.unlock();\n                    }\n                }\n            } finally {\n                from.lock.unlock();\n            }\n        }\n        // \u53d6\u5f97\u3067\u304d\u306a\u304b\u3063\u305f\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u5f85\u3063\u3066\u30ea\u30c8\u30e9\u30a4\n        Thread.sleep(ThreadLocalRandom.current().nextInt(100));\n    }\n}\n"})}),"\n",(0,c.jsx)(e.h3,{id:"54-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u691c\u51fa",children:"5.4 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u691c\u51fa"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'# Java \u30b9\u30ec\u30c3\u30c9\u30c0\u30f3\u30d7\u3067\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\n$ jstack <pid>\n\nFound one Java-level deadlock:\n=============================\n"Thread-1":\n  waiting to lock monitor 0x00007f8b5c003e58 (object 0x00000000d7133848, a Account),\n  which is held by "Thread-0"\n"Thread-0":\n  waiting to lock monitor 0x00007f8b5c003e78 (object 0x00000000d7133868, a Account),\n  which is held by "Thread-1"\n\nJava stack information for the threads listed above:\n===================================================\n"Thread-1":\n    at transfer(Account.java:25)\n    - waiting to lock <0x00000000d7133848> (a Account)\n    - locked <0x00000000d7133868> (a Account)\n"Thread-0":\n    at transfer(Account.java:25)\n    - waiting to lock <0x00000000d7133868> (a Account)\n    - locked <0x00000000d7133848> (a Account)\n\nFound 1 deadlock.\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"6-\u30a2\u30c8\u30df\u30c3\u30af\u64cd\u4f5c",children:"6. \u30a2\u30c8\u30df\u30c3\u30af\u64cd\u4f5c"}),"\n",(0,c.jsx)(e.h3,{id:"61-cascompare-and-swap",children:"6.1 CAS\uff08Compare-And-Swap\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    CAS (Compare-And-Swap)                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30ed\u30c3\u30af\u3092\u4f7f\u308f\u305a\u306b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u66f4\u65b0\u3092\u884c\u3046\u4ed5\u7d44\u307f                       \u2502\n\u2502                                                                      \u2502\n\u2502  CAS(\u30a2\u30c9\u30ec\u30b9, \u671f\u5f85\u5024, \u65b0\u3057\u3044\u5024):                                   \u2502\n\u2502  1. \u30a2\u30c9\u30ec\u30b9\u306e\u73fe\u5728\u5024\u304c\u671f\u5f85\u5024\u3068\u540c\u3058\u304b\u78ba\u8a8d                            \u2502\n\u2502  2. \u540c\u3058\u306a\u3089\u65b0\u3057\u3044\u5024\u306b\u66f4\u65b0\uff08\u30a2\u30c8\u30df\u30c3\u30af\u306b\uff09                          \u2502\n\u2502  3. \u9055\u3063\u305f\u3089\u5931\u6557\uff08\u4ed6\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u5909\u66f4\u6e08\u307f\uff09                          \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u30b9\u30ec\u30c3\u30c9A                     \u30b9\u30ec\u30c3\u30c9B                     \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  current = 0                                                 \u2502    \u2502\n\u2502  \u2502  \u2193                              current = 0                  \u2502    \u2502\n\u2502  \u2502  CAS(addr, 0, 1)               \u2193                             \u2502    \u2502\n\u2502  \u2502  \u2193 \u6210\u529f\uff01                       CAS(addr, 0, 1)              \u2502    \u2502\n\u2502  \u2502  (\u5024\u306f 1 \u306b)                    \u2193 \u5931\u6557\uff01                     \u2502    \u2502\n\u2502  \u2502                                 (\u671f\u5f85\u50240 \u2260 \u73fe\u5728\u50241)          \u2502    \u2502\n\u2502  \u2502                                 \u2193                            \u2502    \u2502\n\u2502  \u2502                                 \u30ea\u30c8\u30e9\u30a4                     \u2502    \u2502\n\u2502  \u2502                                 current = 1                  \u2502    \u2502\n\u2502  \u2502                                 CAS(addr, 1, 2)              \u2502    \u2502\n\u2502  \u2502                                 \u2193 \u6210\u529f\uff01                     \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  \u5229\u70b9: \u30ed\u30c3\u30af\u3092\u4f7f\u308f\u306a\u3044\u306e\u3067\u8efd\u91cf                                     \u2502\n\u2502  \u6b20\u70b9: \u7af6\u5408\u304c\u591a\u3044\u3068\u30ea\u30c8\u30e9\u30a4\u304c\u5897\u3048\u308b                                 \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.h3,{id:"62-java-\u306e\u30a2\u30c8\u30df\u30c3\u30af\u30af\u30e9\u30b9",children:"6.2 Java \u306e\u30a2\u30c8\u30df\u30c3\u30af\u30af\u30e9\u30b9"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-java",children:'import java.util.concurrent.atomic.*;\n\n// AtomicInteger\nAtomicInteger counter = new AtomicInteger(0);\ncounter.incrementAndGet();  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\ncounter.addAndGet(5);       // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u52a0\u7b97\ncounter.compareAndSet(5, 10);  // CAS\n\n// AtomicReference\nAtomicReference<String> ref = new AtomicReference<>("initial");\nref.compareAndSet("initial", "updated");\n\n// AtomicLong\nAtomicLong longCounter = new AtomicLong(0);\n\n// LongAdder\uff08\u9ad8\u7af6\u5408\u6642\u306b AtomicLong \u3088\u308a\u9ad8\u901f\uff09\nLongAdder adder = new LongAdder();\nadder.increment();\nadder.sum();  // \u5024\u3092\u53d6\u5f97\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"7-linux-\u3067\u306e\u78ba\u8a8d",children:"7. Linux \u3067\u306e\u78ba\u8a8d"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"# \u30d7\u30ed\u30bb\u30b9\u306e\u30ed\u30c3\u30af\u72b6\u614b\u3092\u78ba\u8a8d\n$ cat /proc/locks\n1: FLOCK  ADVISORY  WRITE 1234 08:01:12345 0 EOF\n2: POSIX  ADVISORY  WRITE 5678 08:01:67890 0 0\n\n# futex\uff08Fast Userspace muTEX\uff09\u306e\u7d71\u8a08\n$ cat /proc/vmstat | grep futex\n\n# \u30b9\u30ec\u30c3\u30c9\u306e\u72b6\u614b\u3092\u78ba\u8a8d\n$ ps -eLf | grep myapp\nUID   PID  PPID   LWP  C NLWP STIME TTY      TIME CMD\napp  1234  5678  1234  0   10 10:00 ?    00:00:01 myapp\napp  1234  5678  1235  0   10 10:00 ?    00:00:00 myapp\n# LWP = \u30b9\u30ec\u30c3\u30c9 ID\n\n# \u30b9\u30ec\u30c3\u30c9\u306e\u30b9\u30bf\u30c3\u30af\u30c8\u30ec\u30fc\u30b9\n$ cat /proc/1234/task/1235/stack\n[<0000000000000000>] futex_wait_queue_me+0x...\n[<0000000000000000>] futex_wait+0x...\n[<0000000000000000>] do_futex+0x...\n# futex_wait \u304c\u898b\u3048\u305f\u3089\u30ed\u30c3\u30af\u5f85\u3061\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"8-\u307e\u3068\u3081",children:"8. \u307e\u3068\u3081"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  1. \u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09                                      \u2502\n\u2502     \u251c\u2500\u2500 \u8907\u6570\u30b9\u30ec\u30c3\u30c9\u304c\u540c\u3058\u30c7\u30fc\u30bf\u306b\u30a2\u30af\u30bb\u30b9                         \u2502\n\u2502     \u2514\u2500\u2500 \u7d50\u679c\u304c\u5b9f\u884c\u9806\u5e8f\u306b\u4f9d\u5b58\u3057\u3066\u3057\u307e\u3046                             \u2502\n\u2502                                                                      \u2502\n\u2502  2. Mutex                                                            \u2502\n\u2502     \u251c\u2500\u2500 \u4e00\u5ea6\u306b1\u30b9\u30ec\u30c3\u30c9\u3060\u3051\u304c\u30a2\u30af\u30bb\u30b9\u53ef\u80fd                          \u2502\n\u2502     \u2514\u2500\u2500 Java: synchronized, ReentrantLock                          \u2502\n\u2502                                                                      \u2502\n\u2502  3. \u30bb\u30de\u30d5\u30a9                                                         \u2502\n\u2502     \u251c\u2500\u2500 N\u500b\u307e\u3067\u306e\u30b9\u30ec\u30c3\u30c9\u304c\u540c\u6642\u30a2\u30af\u30bb\u30b9\u53ef\u80fd                        \u2502\n\u2502     \u2514\u2500\u2500 \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u306a\u3069\u3067\u4f7f\u7528                               \u2502\n\u2502                                                                      \u2502\n\u2502  4. \u6761\u4ef6\u5909\u6570                                                         \u2502\n\u2502     \u251c\u2500\u2500 \u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u308b\u307e\u3067\u5f85\u6a5f                                   \u2502\n\u2502     \u2514\u2500\u2500 \u751f\u7523\u8005-\u6d88\u8cbb\u8005\u30d1\u30bf\u30fc\u30f3\u3067\u4f7f\u7528                                \u2502\n\u2502                                                                      \u2502\n\u2502  5. \u30c7\u30c3\u30c9\u30ed\u30c3\u30af                                                     \u2502\n\u2502     \u251c\u2500\u2500 4\u6761\u4ef6\u304c\u63c3\u3046\u3068\u767a\u751f                                          \u2502\n\u2502     \u251c\u2500\u2500 \u30ed\u30c3\u30af\u9806\u5e8f\u306e\u56fa\u5b9a\u3067\u56de\u907f                                     \u2502\n\u2502     \u2514\u2500\u2500 jstack \u3067\u691c\u51fa                                              \u2502\n\u2502                                                                      \u2502\n\u2502  6. \u30a2\u30c8\u30df\u30c3\u30af\u64cd\u4f5c                                                   \u2502\n\u2502     \u251c\u2500\u2500 CAS \u3067 \u30ed\u30c3\u30af\u306a\u3057\u306e\u540c\u671f                                    \u2502\n\u2502     \u2514\u2500\u2500 Java: AtomicInteger, AtomicReference                       \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u78ba\u8a8d\u554f\u984c",children:"\u78ba\u8a8d\u554f\u984c"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsx)(e.li,{children:"Race Condition \u304c\u8d77\u304d\u308b\u539f\u56e0\u306f\uff1f"}),"\n",(0,c.jsx)(e.li,{children:"Mutex \u3068\u30bb\u30de\u30d5\u30a9\u306e\u9055\u3044\u306f\uff1f"}),"\n",(0,c.jsx)(e.li,{children:"\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e4\u6761\u4ef6\u306f\uff1f"}),"\n",(0,c.jsx)(e.li,{children:"\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3092\u9632\u3050\u65b9\u6cd5\u30922\u3064\u6319\u3052\u3066\u304f\u3060\u3055\u3044"}),"\n",(0,c.jsx)(e.li,{children:"CAS \u306f\u3069\u306e\u3088\u3046\u306a\u5834\u9762\u3067\u4f7f\u308f\u308c\u307e\u3059\u304b\uff1f"}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u95a2\u9023\u30ea\u30bd\u30fc\u30b9",children:"\u95a2\u9023\u30ea\u30bd\u30fc\u30b9"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"https://jcip.net/",children:"Java Concurrency in Practice"})," - \u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30d0\u30a4\u30d6\u30eb"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"https://www.amazon.com/Art-Multiprocessor-Programming-Revised-Reprint/dp/0123973376",children:"The Art of Multiprocessor Programming"})," - \u4e26\u884c\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u6559\u79d1\u66f8"]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(s,{...n})}):s(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>a});var i=t(96540);const c={},r=i.createContext(c);function o(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:o(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);