"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[9331],{75339:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>o,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"content_10_ai_developer/ai-42-webauthn","title":"idp-server-webauthn4j-adapter - WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408","description":"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981","source":"@site/docs/content_10_ai_developer/ai-42-webauthn.md","sourceDirName":"content_10_ai_developer","slug":"/content_10_ai_developer/ai-42-webauthn","permalink":"/idp-server/docs/content_10_ai_developer/ai-42-webauthn","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_10_ai_developer/ai-42-webauthn.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"idp-server-authentication-interactors - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc","permalink":"/idp-server/docs/content_10_ai_developer/ai-41-authentication"},"next":{"title":"idp-server-federation-oidc","permalink":"/idp-server/docs/content_10_ai_developer/ai-43-federation-oidc"}}');var r=t(74848),a=t(28453);const s={},l="idp-server-webauthn4j-adapter - WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408",c={},d=[{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",level:2},{value:"\u8cac\u52d9",id:"\u8cac\u52d9",level:3},{value:"\u4e3b\u8981\u6a5f\u80fd",id:"\u4e3b\u8981\u6a5f\u80fd",level:3},{value:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",level:2},{value:"4\u6bb5\u968e\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc",id:"4\u6bb5\u968e\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc",level:3},{value:"\u30b3\u30a2\u30af\u30e9\u30b9\u69cb\u6210",id:"\u30b3\u30a2\u30af\u30e9\u30b9\u69cb\u6210",level:2},{value:"1. WebAuthn4jConfiguration - \u8a2d\u5b9a\u7ba1\u7406",id:"1-webauthn4jconfiguration---\u8a2d\u5b9a\u7ba1\u7406",level:3},{value:"2. WebAuthn4jChallenge - \u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",id:"2-webauthn4jchallenge---\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",level:3},{value:"3. WebAuthn4jCredential - Credential\u7ba1\u7406",id:"3-webauthn4jcredential---credential\u7ba1\u7406",level:3},{value:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408\u30d1\u30bf\u30fc\u30f3",id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408\u30d1\u30bf\u30fc\u30f3",level:2},{value:"1. \u767b\u9332\u30d5\u30ed\u30fc - WebAuthn4jRegistrationManager",id:"1-\u767b\u9332\u30d5\u30ed\u30fc---webauthn4jregistrationmanager",level:3},{value:"2. \u8a8d\u8a3c\u30d5\u30ed\u30fc - WebAuthn4jAuthenticationManager",id:"2-\u8a8d\u8a3c\u30d5\u30ed\u30fc---webauthn4jauthenticationmanager",level:3},{value:"3. WebAuthn4jCredentialConverter - Credential\u5909\u63db",id:"3-webauthn4jcredentialconverter---credential\u5909\u63db",level:3},{value:"AuthenticationExecutor\u5b9f\u88c5\uff084\u3064\u306e\u30d5\u30a7\u30fc\u30ba\uff09",id:"authenticationexecutor\u5b9f\u88c54\u3064\u306e\u30d5\u30a7\u30fc\u30ba",level:2},{value:"1. WebAuthn4jRegistrationChallengeExecutor - \u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",id:"1-webauthn4jregistrationchallengeexecutor---\u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",level:3},{value:"2. WebAuthn4jRegistrationExecutor - \u767b\u9332\u691c\u8a3c",id:"2-webauthn4jregistrationexecutor---\u767b\u9332\u691c\u8a3c",level:3},{value:"3. WebAuthn4jAuthenticationChallengeExecutor - \u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",id:"3-webauthn4jauthenticationchallengeexecutor---\u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",level:3},{value:"4. WebAuthn4jAuthenticationExecutor - \u8a8d\u8a3c\u691c\u8a3c",id:"4-webauthn4jauthenticationexecutor---\u8a8d\u8a3c\u691c\u8a3c",level:3},{value:"Plugin\u767b\u9332\u3068Factory",id:"plugin\u767b\u9332\u3068factory",level:2},{value:"Plugin\u767b\u9332",id:"plugin\u767b\u9332",level:3},{value:"ExecutorFactory\u5b9f\u88c5",id:"executorfactory\u5b9f\u88c5",level:3},{value:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u6b63\u3057\u3044\u4f7f\u3044\u65b9",id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u6b63\u3057\u3044\u4f7f\u3044\u65b9",level:2},{value:"WebAuthnManager\u306e\u4f5c\u6210",id:"webauthnmanager\u306e\u4f5c\u6210",level:3},{value:"NonStrict\u30e2\u30fc\u30c9\uff08\u63a8\u5968\uff09",id:"nonstrict\u30e2\u30fc\u30c9\u63a8\u5968",level:4},{value:"Strict\u30e2\u30fc\u30c9\uff08\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u306e\u307f\uff09",id:"strict\u30e2\u30fc\u30c9\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u306e\u307f",level:4},{value:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",id:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",level:3},{value:"CredentialRecord\u306e\u6c38\u7d9a\u5316",id:"credentialrecord\u306e\u6c38\u7d9a\u5316",level:3},{value:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09",id:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u30af\u30ed\u30fc\u30f3\u691c\u77e5",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u691c\u8a3c\u9805\u76ee",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u691c\u8a3c\u9805\u76ee",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u6ce8\u610f\u4e8b\u9805",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u6ce8\u610f\u4e8b\u9805",level:3},{value:"1. Attestation\u691c\u8a3c\u306e\u6df7\u5728\u7981\u6b62",id:"1-attestation\u691c\u8a3c\u306e\u6df7\u5728\u7981\u6b62",level:4},{value:"2. WebAuthn4J\u306e\u30b9\u30b3\u30fc\u30d7\u5916\u306e\u5b9f\u88c5",id:"2-webauthn4j\u306e\u30b9\u30b3\u30fc\u30d7\u5916\u306e\u5b9f\u88c5",level:4},{value:"3. \u30c1\u30e3\u30ec\u30f3\u30b8\u4fdd\u5b58\u306e\u91cd\u8981\u6027",id:"3-\u30c1\u30e3\u30ec\u30f3\u30b8\u4fdd\u5b58\u306e\u91cd\u8981\u6027",level:4},{value:"WebAuthn\u4ed5\u69d8\u6e96\u62e0",id:"webauthn\u4ed5\u69d8\u6e96\u62e0",level:2},{value:"Attestation Format",id:"attestation-format",level:3},{value:"User Verification",id:"user-verification",level:3},{value:"\u5b9f\u88c5\u6539\u5584\u63a8\u5968\u4e8b\u9805",id:"\u5b9f\u88c5\u6539\u5584\u63a8\u5968\u4e8b\u9805",level:2},{value:"1. \u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u306e\u5b9f\u88c5\uff08\u5fc5\u9808\uff09",id:"1-\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u306e\u5b9f\u88c5\u5fc5\u9808",level:3},{value:"2. \u30c1\u30e3\u30ec\u30f3\u30b8\u30b5\u30a4\u30ba\u306e\u62e1\u5927\uff08\u63a8\u5968\uff09",id:"2-\u30c1\u30e3\u30ec\u30f3\u30b8\u30b5\u30a4\u30ba\u306e\u62e1\u5927\u63a8\u5968",level:3},{value:"3. Attestation\u691c\u8a3c\u306e\u5f37\u5316\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09",id:"3-attestation\u691c\u8a3c\u306e\u5f37\u5316\u30aa\u30d7\u30b7\u30e7\u30f3",level:3},{value:"\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u5c64\u5b9f\u88c5",id:"\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u5c64\u5b9f\u88c5",level:2},{value:"WebAuthn4jCredentialDataSource",id:"webauthn4jcredentialdatasource",level:3},{value:"\u30b7\u30fc\u30b1\u30f3\u30b9\u56f3",id:"\u30b7\u30fc\u30b1\u30f3\u30b9\u56f3",level:2},{value:"\u767b\u9332\u30d5\u30ed\u30fc\uff08Registration\uff09",id:"\u767b\u9332\u30d5\u30ed\u30fcregistration",level:3},{value:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\uff08Authentication\uff09",id:"\u8a8d\u8a3c\u30d5\u30ed\u30fcauthentication",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u306e\u30dd\u30a4\u30f3\u30c8",id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u306e\u30dd\u30a4\u30f3\u30c8",level:3},{value:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30d1\u30bf\u30fc\u30f3",id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30d1\u30bf\u30fc\u30f3",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a55\u4fa1",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a55\u4fa1",level:3},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2},{value:"\u53c2\u8003\u8cc7\u6599",id:"\u53c2\u8003\u8cc7\u6599",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"idp-server-webauthn4j-adapter---webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408",children:"idp-server-webauthn4j-adapter - WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408"})}),"\n",(0,r.jsx)(n.h2,{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",children:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.code,{children:"libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/"}),"\n",(0,r.jsx)(n.strong,{children:"\u78ba\u8a8d\u65e5"}),": 2025-11-08\n",(0,r.jsx)(n.strong,{children:"\u30e9\u30a4\u30d6\u30e9\u30ea"}),": ",(0,r.jsx)(n.code,{children:"com.webauthn4j:webauthn4j-core:0.28.5.RELEASE"})]}),"\n",(0,r.jsx)(n.h3,{id:"\u8cac\u52d9",children:"\u8cac\u52d9"}),"\n",(0,r.jsx)(n.p,{children:"WebAuthn/FIDO2\u5b9f\u88c5\uff08webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408\uff09\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u4ed5\u69d8"}),": ",(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/webauthn-2/",children:"Web Authentication Level 2"})]}),"\n",(0,r.jsx)(n.h3,{id:"\u4e3b\u8981\u6a5f\u80fd",children:"\u4e3b\u8981\u6a5f\u80fd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Registration Challenge"}),": \u8a8d\u8a3c\u5668\u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\uff08Passkey\u4f5c\u6210\u958b\u59cb\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Registration"}),": \u8a8d\u8a3c\u5668\u767b\u9332\u691c\u8a3c\uff08Passkey\u4f5c\u6210\u5b8c\u4e86\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication Challenge"}),": \u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\uff08\u8a8d\u8a3c\u958b\u59cb\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication"}),": \u8a8d\u8a3c\u5668\u691c\u8a3c\uff08\u8a8d\u8a3c\u5b8c\u4e86\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Attestation"}),": \u8a8d\u8a3c\u5668\u8a3c\u660e\uff08\u30c7\u30d0\u30a4\u30b9\u4fe1\u983c\u6027\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User Verification"}),": \u30e6\u30fc\u30b6\u30fc\u691c\u8a3c\uff08PIN/\u751f\u4f53\u8a8d\u8a3c\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",children:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981"}),"\n",(0,r.jsx)(n.h3,{id:"4\u6bb5\u968e\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc",children:"4\u6bb5\u968e\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc"}),"\n",(0,r.jsx)(n.p,{children:"WebAuthn4j\u306f\u4ee5\u4e0b\u306e4\u3064\u306eExecutor\u3067\u69cb\u6210\u3055\u308c\u3001AuthenticationExecutor\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RegistrationChallengeExecutor"}),": \u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RegistrationExecutor"}),": \u767b\u9332\u691c\u8a3c\u30fbCredential\u4fdd\u5b58"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AuthenticationChallengeExecutor"}),": \u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AuthenticationExecutor"}),": \u8a8d\u8a3c\u691c\u8a3c"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.code,{children:"libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/"})]}),"\n",(0,r.jsx)(n.h2,{id:"\u30b3\u30a2\u30af\u30e9\u30b9\u69cb\u6210",children:"\u30b3\u30a2\u30af\u30e9\u30b9\u69cb\u6210"}),"\n",(0,r.jsx)(n.h3,{id:"1-webauthn4jconfiguration---\u8a2d\u5b9a\u7ba1\u7406",children:"1. WebAuthn4jConfiguration - \u8a2d\u5b9a\u7ba1\u7406"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(58336).A+"#L25",children:"WebAuthn4jConfiguration.java:25-110"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"/**\n * WebAuthn\u8a2d\u5b9a\uff08RP\u60c5\u5831\u30fb\u691c\u8a3c\u8981\u4ef6\uff09\n */\npublic class WebAuthn4jConfiguration {\n  String rpId;                          // Relying Party ID (\u4f8b: example.com)\n  String rpName;                        // Relying Party\u540d\n  String origin;                        // \u30aa\u30ea\u30b8\u30f3\uff08\u4f8b: https://example.com\uff09\n  byte[] tokenBindingId;                // Token Binding ID\uff08\u901a\u5e38null\uff09\n  String attestationPreference;         // Attestation\u8a2d\u5b9a\uff08none/indirect/direct\uff09\n  String authenticatorAttachment;       // \u8a8d\u8a3c\u5668\u30bf\u30a4\u30d7\uff08platform/cross-platform\uff09\n\n  boolean requireResidentKey;           // Resident Key\u5fc5\u9808\u304b\n  boolean userVerificationRequired;     // \u30e6\u30fc\u30b6\u30fc\u691c\u8a3c\uff08PIN/\u751f\u4f53\u8a8d\u8a3c\uff09\u5fc5\u9808\u304b\n  boolean userPresenceRequired;         // \u30e6\u30fc\u30b6\u30fc\u5b58\u5728\u78ba\u8a8d\u5fc5\u9808\u304b\n\n  // webauthn4j\u306eRegistrationParameters\u306b\u5909\u63db\n  RegistrationParameters toRegistrationParameters(WebAuthn4jChallenge challenge) {\n    Origin origin = Origin.create(this.origin);\n    ServerProperty serverProperty =\n        new ServerProperty(origin, rpId, challenge, tokenBindingId);\n\n    return new RegistrationParameters(\n        serverProperty,\n        null, // pubKeyCredParams\n        userVerificationRequired,\n        userPresenceRequired);\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u91cd\u8981\u8a2d\u5b9a\u9805\u76ee"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rpId"}),": WebAuthn\u306e\u30b9\u30b3\u30fc\u30d7\uff08\u901a\u5e38\u306f\u30c9\u30e1\u30a4\u30f3\u540d\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"origin"}),": \u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u306eURL\uff08https\u5fc5\u9808\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"userVerificationRequired"}),": PIN/\u751f\u4f53\u8a8d\u8a3c\u306e\u8981\u5426"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"userPresenceRequired"}),": \u30bf\u30c3\u30d7/\u30bf\u30c3\u30c1\u306e\u8981\u5426"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-webauthn4jchallenge---\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",children:"2. WebAuthn4jChallenge - \u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(99243).A+"#L29",children:"WebAuthn4jChallenge.java:29-82"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"/**\n * WebAuthn\u30c1\u30e3\u30ec\u30f3\u30b8\uff08Challenge\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u5b9f\u88c5\uff09\n */\npublic class WebAuthn4jChallenge implements Challenge {\n  byte[] value;\n\n  // UUID v4\u30d9\u30fc\u30b9\u306e16\u30d0\u30a4\u30c8\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\n  public static WebAuthn4jChallenge generate() {\n    UUID uuid = UUID.randomUUID();\n    long hi = uuid.getMostSignificantBits();\n    long lo = uuid.getLeastSignificantBits();\n    byte[] value = ByteBuffer.allocate(16).putLong(hi).putLong(lo).array();\n    return new WebAuthn4jChallenge(value);\n  }\n\n  // Base64URL\u6587\u5b57\u5217\u3068\u3057\u3066\u53d6\u5f97\n  public String challengeAsString() {\n    return Base64.getUrlEncoder().encodeToString(value);\n  }\n\n  // FIDO2Challenge\uff08\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5c64\uff09\u306b\u5909\u63db\n  public Fido2Challenge toWebAuthnChallenge() {\n    return new Fido2Challenge(challengeAsString());\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u8a2d\u8a08"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"UUIDv4\u30d9\u30fc\u30b9\uff08128bit = 16\u30d0\u30a4\u30c8\uff09"}),"\n",(0,r.jsx)(n.li,{children:"Base64URL\u30a8\u30f3\u30b3\u30fc\u30c9"}),"\n",(0,r.jsx)(n.li,{children:"\u30ea\u30d7\u30ec\u30a4\u653b\u6483\u9632\u6b62\u306e\u305f\u3081\u3001\u5404\u64cd\u4f5c\u3067\u4e00\u610f"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-webauthn4jcredential---credential\u7ba1\u7406",children:"3. WebAuthn4jCredential - Credential\u7ba1\u7406"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(37323).A+"#L23",children:"WebAuthn4jCredential.java:23-95"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * WebAuthn\u8a8d\u8a3c\u60c5\u5831\uff08Passkey\uff09\n */\npublic class WebAuthn4jCredential {\n  String id;                  // Credential ID\uff08Base64URL\uff09\n  String userId;              // \u30e6\u30fc\u30b6\u30fcID\n  String rpId;                // Relying Party ID\n  String publicKey;           // \u516c\u958b\u9375\uff08Base64URL\uff09\n  String attestationObject;   // Attestation\u30c7\u30fc\u30bf\uff08Base64URL\uff09\n  long signCount;             // \u7f72\u540d\u30ab\u30a6\u30f3\u30bf\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09\n\n  // \u30d0\u30a4\u30c8\u914d\u5217\u3068\u3057\u3066\u53d6\u5f97\uff08webauthn4j\u691c\u8a3c\u7528\uff09\n  public byte[] idAsBytes() {\n    return Base64.getUrlDecoder().decode(id);\n  }\n\n  public byte[] attestationObjectAsBytes() {\n    return Base64.getUrlDecoder().decode(attestationObject);\n  }\n\n  // \u30b9\u30cd\u30fc\u30af\u30b1\u30fc\u30b9Map\u306b\u5909\u63db\uff08JSON\u4fdd\u5b58\u7528\uff09\n  public Map<String, Object> toMap() {\n    Map<String, Object> result = new HashMap<>();\n    result.put("id", id);\n    result.put("user_id", userId);\n    result.put("rp_id", rpId);\n    result.put("public_key", publicKey);\n    result.put("attestation_object", attestationObject);\n    result.put("sign_count", signCount);\n    return result;\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Credential\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Registration\u6642\u306b\u4f5c\u6210\uff08",(0,r.jsx)(n.code,{children:"WebAuthn4jRegistrationManager"}),"\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WebAuthn4jCredentialRepository.register()"}),"\u3067\u4fdd\u5b58"]}),"\n",(0,r.jsxs)(n.li,{children:["Authentication\u6642\u306b",(0,r.jsx)(n.code,{children:"get(id)"}),"\u3067\u53d6\u5f97"]}),"\n",(0,r.jsxs)(n.li,{children:["\u691c\u8a3c\u6210\u529f\u5f8c\u306b",(0,r.jsx)(n.code,{children:"updateSignCount()"}),"\u3067\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408\u30d1\u30bf\u30fc\u30f3",children:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u767b\u9332\u30d5\u30ed\u30fc---webauthn4jregistrationmanager",children:"1. \u767b\u9332\u30d5\u30ed\u30fc - WebAuthn4jRegistrationManager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(58138).A+"#L27",children:"WebAuthn4jRegistrationManager.java:27-104"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * webauthn4j\u3092\u4f7f\u3063\u305f\u767b\u9332\u691c\u8a3c\u30fbCredential\u4f5c\u6210\n */\npublic class WebAuthn4jRegistrationManager {\n  WebAuthnManager webAuthnManager;           // webauthn4j\u30b3\u30a2\u30de\u30cd\u30fc\u30b8\u30e3\u30fc\n  WebAuthn4jConfiguration configuration;\n  WebAuthn4jChallenge webAuthn4jChallenge;\n  String request;                            // \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306eJSON\n  String userId;\n\n  public WebAuthn4jRegistrationManager(...) {\n    // NonStrict\u30e2\u30fc\u30c9\uff08\u672c\u756a\u306fStrict\u30e2\u30fc\u30c9\u63a8\u5968\uff09\n    this.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();\n  }\n\n  public WebAuthn4jCredential verifyAndCreateCredential() {\n    // 1. JSON\u3092RegistrationData\u306b\u30d1\u30fc\u30b9\n    RegistrationData registrationData = parseRequest();\n\n    // 2. \u691c\u8a3c\u30d1\u30e9\u30e1\u30fc\u30bf\u69cb\u7bc9\n    RegistrationParameters registrationParameters =\n        configuration.toRegistrationParameters(webAuthn4jChallenge);\n\n    // 3. webauthn4j\u3067\u691c\u8a3c\n    RegistrationData verified =\n        webAuthnManager.verify(registrationData, registrationParameters);\n\n    // 4. Credential ID\u62bd\u51fa\n    byte[] credentialId = Objects.requireNonNull(\n        verified.getAttestationObject()\n            .getAuthenticatorData()\n            .getAttestedCredentialData()\n    ).getCredentialId();\n\n    // 5. AttestedCredentialData\u3092\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\n    ObjectConverter objectConverter = new ObjectConverter();\n    AttestedCredentialDataConverter converter =\n        new AttestedCredentialDataConverter(objectConverter);\n    byte[] attestedCredentialData =\n        converter.convert(verified.getAttestationObject()\n            .getAuthenticatorData()\n            .getAttestedCredentialData());\n\n    // 6. WebAuthn4jCredential\u4f5c\u6210\n    String id = Base64.getUrlEncoder().withoutPadding()\n        .encodeToString(credentialId);\n    String attestationDataString = Base64.getUrlEncoder().withoutPadding()\n        .encodeToString(attestedCredentialData);\n\n    return new WebAuthn4jCredential(\n        id, userId, configuration.rpId(), "", attestationDataString, 0);\n  }\n\n  private RegistrationData parseRequest() {\n    try {\n      return webAuthnManager.parseRegistrationResponseJSON(request);\n    } catch (Exception e) {\n      throw new WebAuthn4jBadRequestException(\n          "webauthn registration request is invalid", e);\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u767b\u9332\u51e6\u7406\u306e\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"webauthn4j\u691c\u8a3c"}),": ",(0,r.jsx)(n.code,{children:"WebAuthnManager.verify()"}),"\u3067RFC\u6e96\u62e0\u691c\u8a3c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"AttestedCredentialData\u4fdd\u5b58"}),": \u516c\u958b\u9375\u30fbCredential ID\u3092\u542b\u3080"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Base64URL\u30a8\u30f3\u30b3\u30fc\u30c9"}),": \u3059\u3079\u3066\u306e\u30d0\u30a4\u30ca\u30ea\u30c7\u30fc\u30bf\u3092Base64URL\u5316"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f8b\u5916\u51e6\u7406"}),": webauthn4j\u306e\u4f8b\u5916\u3092",(0,r.jsx)(n.code,{children:"WebAuthn4jBadRequestException"}),"\u3067\u30e9\u30c3\u30d7"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-\u8a8d\u8a3c\u30d5\u30ed\u30fc---webauthn4jauthenticationmanager",children:"2. \u8a8d\u8a3c\u30d5\u30ed\u30fc - WebAuthn4jAuthenticationManager"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(83705).A+"#L29",children:"WebAuthn4jAuthenticationManager.java:29-102"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * webauthn4j\u3092\u4f7f\u3063\u305f\u8a8d\u8a3c\u691c\u8a3c\n */\npublic class WebAuthn4jAuthenticationManager {\n  WebAuthnManager webAuthnManager;\n  WebAuthn4jConfiguration configuration;\n  WebAuthn4jChallenge challenge;\n  String request;\n\n  public WebAuthn4jAuthenticationManager(...) {\n    this.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();\n  }\n\n  // UserHandle\uff08userID\uff09\u3092\u62bd\u51fa\n  public String extractUserId() {\n    AuthenticationData authenticationData = parseAuthenticationData();\n    return new String(\n        Objects.requireNonNull(authenticationData.getUserHandle()),\n        StandardCharsets.UTF_8);\n  }\n\n  // \u8a8d\u8a3c\u691c\u8a3c\n  public void verify(WebAuthn4jCredential credential) {\n    // 1. JSON\u3092AuthenticationData\u306b\u30d1\u30fc\u30b9\n    AuthenticationData authenticationData = parseAuthenticationData();\n\n    // 2. Credential\u3092CredentialRecord\u306b\u5909\u63db\n    WebAuthn4jCredentialConverter converter =\n        new WebAuthn4jCredentialConverter(credential);\n    CredentialRecordImpl credentialRecord = converter.convert();\n\n    // 3. \u691c\u8a3c\u30d1\u30e9\u30e1\u30fc\u30bf\u69cb\u7bc9\n    AuthenticationParameters authenticationParameters =\n        toAuthenticationParameters(credentialRecord);\n\n    // 4. webauthn4j\u3067\u691c\u8a3c\n    AuthenticationData verifiedData =\n        webAuthnManager.verify(authenticationData, authenticationParameters);\n\n    // \u691c\u8a3c\u6210\u529f\uff08\u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u306a\u3051\u308c\u3070OK\uff09\n  }\n\n  private AuthenticationParameters toAuthenticationParameters(\n      CredentialRecordImpl credentialRecord) {\n    // Server properties\n    Origin origin = Origin.create(configuration.origin());\n    ServerProperty serverProperty =\n        new ServerProperty(origin, configuration.rpId(), challenge, null);\n\n    // expectations\n    boolean userVerificationRequired = configuration.userVerificationRequired();\n    boolean userPresenceRequired = configuration.userPresenceRequired();\n\n    return new AuthenticationParameters(\n        serverProperty,\n        credentialRecord,\n        null,  // allowCredentials\n        userVerificationRequired,\n        userPresenceRequired);\n  }\n\n  private AuthenticationData parseAuthenticationData() {\n    try {\n      return webAuthnManager.parseAuthenticationResponseJSON(request);\n    } catch (Exception e) {\n      throw new WebAuthn4jBadRequestException(\n          "Failed to parse authentication response", e);\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u8a8d\u8a3c\u51e6\u7406\u306e\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Credential\u5909\u63db"}),": \u4fdd\u5b58\u3055\u308c\u305f",(0,r.jsx)(n.code,{children:"WebAuthn4jCredential"}),"\u3092",(0,r.jsx)(n.code,{children:"CredentialRecordImpl"}),"\u306b\u5909\u63db"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"UserHandle\u62bd\u51fa"}),": \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u9001\u4fe1\u3057\u305fUserID\u3092\u62bd\u51fa"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u691c\u8a3c\u6210\u529f\u5224\u5b9a"}),": \u4f8b\u5916\u304c\u6295\u3052\u3089\u308c\u306a\u3051\u308c\u3070\u8a8d\u8a3c\u6210\u529f"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SignCount\u66f4\u65b0"}),": \u691c\u8a3c\u5f8c\u306b\u5225\u9014\u66f4\u65b0\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-webauthn4jcredentialconverter---credential\u5909\u63db",children:"3. WebAuthn4jCredentialConverter - Credential\u5909\u63db"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(93473).A+"#L27",children:"WebAuthn4jCredentialConverter.java:27-56"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"/**\n * WebAuthn4jCredential \u2192 CredentialRecordImpl\u5909\u63db\n */\npublic class WebAuthn4jCredentialConverter {\n  WebAuthn4jCredential credential;\n  AttestedCredentialDataConverter attestedCredentialDataConverter;\n\n  public CredentialRecordImpl convert() {\n    Base64.Decoder urlDecoder = Base64.getUrlDecoder();\n\n    // AttestedCredentialData\u3092\u30c7\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\n    AttestedCredentialData deserializedAttestedCredentialData =\n        attestedCredentialDataConverter.convert(\n            urlDecoder.decode(credential.attestationObject()));\n\n    // CredentialRecordImpl\u4f5c\u6210\n    return new CredentialRecordImpl(\n        new NoneAttestationStatement(),        // Attestation\uff08none\uff09\n        null,                                  // isBackupEligible\n        null,                                  // isBackedUp\n        null,                                  // attestedCredentialData\n        credential.signCount(),                // signCount\n        deserializedAttestedCredentialData,    // attestedCredentialData\n        new AuthenticationExtensionsAuthenticatorOutputs<>(),\n        null,                                  // clientExtensions\n        null,                                  // authenticatorExtensions\n        null                                   // transports\n    );\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Credential\u5909\u63db\u306e\u5f79\u5272"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4fdd\u5b58\u3055\u308c\u305fBase64URL\u6587\u5b57\u5217\u3092\u30d0\u30a4\u30ca\u30ea\u306b\u5909\u63db"}),"\n",(0,r.jsxs)(n.li,{children:["webauthn4j\u306e",(0,r.jsx)(n.code,{children:"CredentialRecordImpl"}),"\u306b\u518d\u69cb\u7bc9"]}),"\n",(0,r.jsx)(n.li,{children:"\u8a8d\u8a3c\u691c\u8a3c\u6642\u306b\u4f7f\u7528"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"authenticationexecutor\u5b9f\u88c54\u3064\u306e\u30d5\u30a7\u30fc\u30ba",children:"AuthenticationExecutor\u5b9f\u88c5\uff084\u3064\u306e\u30d5\u30a7\u30fc\u30ba\uff09"}),"\n",(0,r.jsx)(n.h3,{id:"1-webauthn4jregistrationchallengeexecutor---\u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",children:"1. WebAuthn4jRegistrationChallengeExecutor - \u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(9289).A+"#L33",children:"WebAuthn4jRegistrationChallengeExecutor.java:33-78"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * \u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210Executor\n * function: "webauthn4j_registration_challenge"\n */\npublic class WebAuthn4jRegistrationChallengeExecutor implements AuthenticationExecutor {\n\n  AuthenticationInteractionCommandRepository transactionCommandRepository;\n  AuthenticationInteractionQueryRepository transactionQueryRepository;\n  WebAuthn4jCredentialRepository credentialRepository;\n  JsonConverter jsonConverter;\n\n  @Override\n  public String function() {\n    return "webauthn4j_registration_challenge";\n  }\n\n  public Fido2ExecutorType type() {\n    return new Fido2ExecutorType("webauthn4j");\n  }\n\n  @Override\n  public AuthenticationExecutionResult execute(\n      Tenant tenant,\n      AuthenticationTransactionIdentifier identifier,\n      AuthenticationExecutionRequest request,\n      RequestAttributes requestAttributes,\n      AuthenticationExecutionConfig configuration) {\n\n    // 1. \u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\uff08UUID\u30d9\u30fc\u30b9\uff09\n    WebAuthn4jChallenge webAuthn4jChallenge = WebAuthn4jChallenge.generate();\n    Fido2Challenge fido2Challenge = webAuthn4jChallenge.toWebAuthnChallenge();\n\n    // 2. \u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u4e00\u6642\u4fdd\u5b58\uff08Redis/DB\u306b\u4fdd\u5b58\uff09\n    transactionCommandRepository.register(\n        tenant, identifier, type().value(), fido2Challenge);\n\n    // 3. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u8fd4\u3059\n    Map<String, Object> contents = new HashMap<>();\n    contents.put("challenge", webAuthn4jChallenge.challengeAsString());\n    Map<String, Object> response = new HashMap<>();\n    response.put("execution_webauthn4j", contents);\n\n    return AuthenticationExecutionResult.success(response);\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u51e6\u7406\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"UUID v4\u30d9\u30fc\u30b9\u306e16\u30d0\u30a4\u30c8\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),"\n",(0,r.jsx)(n.li,{children:"AuthenticationInteractionRepository\u306b\u4e00\u6642\u4fdd\u5b58"}),"\n",(0,r.jsx)(n.li,{children:"Base64URL\u6587\u5b57\u5217\u3068\u3057\u3066\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u5374"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-webauthn4jregistrationexecutor---\u767b\u9332\u691c\u8a3c",children:"2. WebAuthn4jRegistrationExecutor - \u767b\u9332\u691c\u8a3c"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(88746).A+"#L35",children:"WebAuthn4jRegistrationExecutor.java:35-91"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * \u767b\u9332\u691c\u8a3cExecutor\n * function: "webauthn4j_registration"\n */\npublic class WebAuthn4jRegistrationExecutor implements AuthenticationExecutor {\n\n  @Override\n  public String function() {\n    return "webauthn4j_registration";\n  }\n\n  @Override\n  public AuthenticationExecutionResult execute(\n      Tenant tenant,\n      AuthenticationTransactionIdentifier identifier,\n      AuthenticationExecutionRequest request,\n      RequestAttributes requestAttributes,\n      AuthenticationExecutionConfig configuration) {\n\n    // 1. \u4fdd\u5b58\u3055\u308c\u305f\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u53d6\u5f97\n    Fido2Challenge fido2Challenge =\n        transactionQueryRepository.get(\n            tenant, identifier, type().value(), Fido2Challenge.class);\n\n    WebAuthn4jChallenge webAuthn4jChallenge =\n        new WebAuthn4jChallenge(fido2Challenge.challenge());\n\n    // 2. \u30ea\u30af\u30a8\u30b9\u30c8\u3092JSON\u6587\u5b57\u5217\u306b\u5909\u63db\n    String requestString = jsonConverter.write(request.toMap());\n\n    // 3. \u8a2d\u5b9a\u3092\u53d6\u5f97\n    WebAuthn4jConfiguration webAuthn4jConfiguration =\n        jsonConverter.read(configuration.details(), WebAuthn4jConfiguration.class);\n\n    // 4. userId\u751f\u6210\uff08UUID v4\uff09\n    String userId = UUID.randomUUID().toString();\n\n    // 5. WebAuthn4jRegistrationManager\u3067\u691c\u8a3c\u30fbCredential\u4f5c\u6210\n    WebAuthn4jRegistrationManager manager =\n        new WebAuthn4jRegistrationManager(\n            webAuthn4jConfiguration, webAuthn4jChallenge, requestString, userId);\n\n    WebAuthn4jCredential webAuthn4jCredential = manager.verifyAndCreateCredential();\n\n    // 6. Credential\u3092\u6c38\u7d9a\u5316\n    credentialRepository.register(webAuthn4jCredential);\n\n    // 7. \u7d50\u679c\u3092\u8fd4\u3059\n    Map<String, Object> response = new HashMap<>();\n    response.put("execution_webauthn4j", webAuthn4jCredential.toMap());\n\n    return AuthenticationExecutionResult.success(response);\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u51e6\u7406\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u4fdd\u5b58\u3055\u308c\u305f\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u53d6\u5f97"}),"\n",(0,r.jsx)(n.li,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092JSON\u5316"}),"\n",(0,r.jsx)(n.li,{children:"WebAuthn4jRegistrationManager\u3067\u691c\u8a3c"}),"\n",(0,r.jsx)(n.li,{children:"Credential\u3092\u6c38\u7d9a\u5316\uff08PostgreSQL/MySQL\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u6210\u529f\u7d50\u679c\u3092\u8fd4\u5374"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-webauthn4jauthenticationchallengeexecutor---\u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210",children:"3. WebAuthn4jAuthenticationChallengeExecutor - \u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(83614).A+"#L34",children:"WebAuthn4jAuthenticationChallengeExecutor.java:34-79"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * \u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210Executor\n * function: "webauthn4j_authentication_challenge"\n */\npublic class WebAuthn4jAuthenticationChallengeExecutor implements AuthenticationExecutor {\n\n  @Override\n  public String function() {\n    return "webauthn4j_authentication_challenge";\n  }\n\n  @Override\n  public AuthenticationExecutionResult execute(\n      Tenant tenant,\n      AuthenticationTransactionIdentifier identifier,\n      AuthenticationExecutionRequest request,\n      RequestAttributes requestAttributes,\n      AuthenticationExecutionConfig configuration) {\n\n    // 1. \u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\n    WebAuthn4jChallenge webAuthn4jChallenge = WebAuthn4jChallenge.generate();\n    Fido2Challenge fido2Challenge = webAuthn4jChallenge.toWebAuthnChallenge();\n\n    // 2. \u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u4e00\u6642\u4fdd\u5b58\n    transactionCommandRepository.register(\n        tenant, identifier, type().value(), fido2Challenge);\n\n    // 3. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u8fd4\u3059\n    Map<String, Object> contents = new HashMap<>();\n    contents.put("challenge", webAuthn4jChallenge.challengeAsString());\n    Map<String, Object> response = new HashMap<>();\n    response.put("execution_webauthn4j", contents);\n\n    return AuthenticationExecutionResult.success(response);\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u767b\u9332\u30c1\u30e3\u30ec\u30f3\u30b8\u3068\u306e\u9055\u3044"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u57fa\u672c\u7684\u306a\u30d5\u30ed\u30fc\u306f\u540c\u3058"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"function()"}),"\u304c",(0,r.jsx)(n.code,{children:"webauthn4j_authentication_challenge"})]}),"\n",(0,r.jsx)(n.li,{children:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\u7528\u306e\u30c1\u30e3\u30ec\u30f3\u30b8"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-webauthn4jauthenticationexecutor---\u8a8d\u8a3c\u691c\u8a3c",children:"4. WebAuthn4jAuthenticationExecutor - \u8a8d\u8a3c\u691c\u8a3c"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(70123).A+"#L34",children:"WebAuthn4jAuthenticationExecutor.java:34-92"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'/**\n * \u8a8d\u8a3c\u691c\u8a3cExecutor\n * function: "webauthn4j_authentication"\n */\npublic class WebAuthn4jAuthenticationExecutor implements AuthenticationExecutor {\n\n  @Override\n  public String function() {\n    return "webauthn4j_authentication";\n  }\n\n  @Override\n  public AuthenticationExecutionResult execute(\n      Tenant tenant,\n      AuthenticationTransactionIdentifier identifier,\n      AuthenticationExecutionRequest request,\n      RequestAttributes requestAttributes,\n      AuthenticationExecutionConfig configuration) {\n\n    // 1. \u4fdd\u5b58\u3055\u308c\u305f\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u53d6\u5f97\n    Fido2Challenge fido2Challenge =\n        transactionQueryRepository.get(\n            tenant, identifier, type().value(), Fido2Challenge.class);\n\n    WebAuthn4jChallenge webAuthn4jChallenge =\n        new WebAuthn4jChallenge(fido2Challenge.challenge());\n\n    // 2. \u30ea\u30af\u30a8\u30b9\u30c8\u3092JSON\u6587\u5b57\u5217\u306b\u5909\u63db\n    String requestString = jsonConverter.write(request.toMap());\n\n    // 3. \u8a2d\u5b9a\u3092\u53d6\u5f97\n    WebAuthn4jConfiguration webAuthn4jConfiguration =\n        jsonConverter.read(configuration.details(), WebAuthn4jConfiguration.class);\n\n    // 4. WebAuthn4jAuthenticationManager\u3067\u691c\u8a3c\n    WebAuthn4jAuthenticationManager manager =\n        new WebAuthn4jAuthenticationManager(\n            webAuthn4jConfiguration, webAuthn4jChallenge, requestString);\n\n    // 5. Credential ID\u53d6\u5f97\u30fb\u691c\u8a3c\n    String id = request.optValueAsString("id", "");\n    WebAuthn4jCredential webAuthn4jCredential = credentialRepository.get(id);\n\n    manager.verify(webAuthn4jCredential);\n\n    // 6. \u6210\u529f\u7d50\u679c\u3092\u8fd4\u3059\n    Map<String, Object> contents = new HashMap<>();\n    contents.put("id", id);\n    contents.put("status", "ok");\n    Map<String, Object> response = new HashMap<>();\n    response.put("execution_webauthn4j", contents);\n\n    return AuthenticationExecutionResult.success(response);\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u51e6\u7406\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u4fdd\u5b58\u3055\u308c\u305f\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u53d6\u5f97"}),"\n",(0,r.jsx)(n.li,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092JSON\u5316"}),"\n",(0,r.jsx)(n.li,{children:"Credential ID\u3067\u4fdd\u5b58\u3055\u308c\u305fCredential\u3092\u53d6\u5f97"}),"\n",(0,r.jsx)(n.li,{children:"WebAuthn4jAuthenticationManager\u3067\u691c\u8a3c"}),"\n",(0,r.jsx)(n.li,{children:"\u6210\u529f\u7d50\u679c\u3092\u8fd4\u5374"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u91cd\u8981"}),": ",(0,r.jsx)(n.code,{children:"verify()"}),"\u304c\u4f8b\u5916\u3092\u6295\u3052\u306a\u3044 = \u8a8d\u8a3c\u6210\u529f"]}),"\n",(0,r.jsx)(n.h2,{id:"plugin\u767b\u9332\u3068factory",children:"Plugin\u767b\u9332\u3068Factory"}),"\n",(0,r.jsx)(n.h3,{id:"plugin\u767b\u9332",children:"Plugin\u767b\u9332"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.code,{children:"libs/idp-server-webauthn4j-adapter/src/main/resources/META-INF/services/org.idp.server.platform.dependency.ApplicationComponentProvider"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"org.idp.server.authenticators.webauthn4j.WebAuthn4jApplicationComponentProvider\n"})}),"\n",(0,r.jsx)(n.h3,{id:"executorfactory\u5b9f\u88c5",children:"ExecutorFactory\u5b9f\u88c5"}),"\n",(0,r.jsx)(n.p,{children:"4\u3064\u306eExecutor\u306b\u5bfe\u5fdc\u3059\u308b4\u3064\u306eFactory\u304c\u5b58\u5728\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"WebAuthn4jRegistrationChallengeExecutorFactory"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"WebAuthn4jRegistrationExecutorFactory"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"WebAuthn4jAuthenticationChallengeExecutorFactory"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"WebAuthn4jAuthenticationExecutorFactory"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Factory\u30d1\u30bf\u30fc\u30f3"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class WebAuthn4jRegistrationChallengeExecutorFactory {\n  public WebAuthn4jRegistrationChallengeExecutor create() {\n    AuthenticationInteractionCommandRepository commandRepo = ...;\n    AuthenticationInteractionQueryRepository queryRepo = ...;\n    WebAuthn4jCredentialRepository credentialRepo = ...;\n\n    return new WebAuthn4jRegistrationChallengeExecutor(\n        commandRepo, queryRepo, credentialRepo);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u6b63\u3057\u3044\u4f7f\u3044\u65b9",children:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u6b63\u3057\u3044\u4f7f\u3044\u65b9"}),"\n",(0,r.jsx)(n.h3,{id:"webauthnmanager\u306e\u4f5c\u6210",children:"WebAuthnManager\u306e\u4f5c\u6210"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{href:"https://webauthn4j.github.io/webauthn4j/ja/",children:"WebAuthn4j\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})]}),"\n",(0,r.jsx)(n.h4,{id:"nonstrict\u30e2\u30fc\u30c9\u63a8\u5968",children:"NonStrict\u30e2\u30fc\u30c9\uff08\u63a8\u5968\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"WebAuthnManager webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u5f15\u7528"}),":"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u5927\u591a\u6570\u306e\u30b5\u30a4\u30c8\u306f\u53b3\u5bc6\u306a\u69cb\u6210\u8a3c\u660e\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u306e\u691c\u8a3c\u3092\u5fc5\u8981\u3068\u305b\u305a\u3001\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u4ee5\u5916\u3067\u306f\u53b3\u5bc6\u306a\u69cb\u6210\u8a3c\u660e\u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u306e\u691c\u8a3c\u306f\u975e\u63a8\u5968"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),": \u2705 \u6b63\u3057\u304f\u4f7f\u7528"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jRegistrationManager.java:40\nthis.webAuthnManager = WebAuthnManager.createNonStrictWebAuthnManager();\n"})}),"\n",(0,r.jsx)(n.h4,{id:"strict\u30e2\u30fc\u30c9\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u306e\u307f",children:"Strict\u30e2\u30fc\u30c9\uff08\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u306e\u307f\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"List<AttestationStatementVerifier> verifiers = Arrays.asList(\n    new PackedAttestationStatementVerifier(),\n    new TPMAttestationStatementVerifier()\n);\nWebAuthnManager webAuthnManager = new WebAuthnManager(\n    verifiers,\n    new DefaultCertPathTrustworthinessVerifier(trustAnchorRepository)\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u63a8\u5968"}),": SecureRandom\u306732\u30d0\u30a4\u30c8\u306e\u30e9\u30f3\u30c0\u30e0\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// \u516c\u5f0f\u63a8\u5968\u30d1\u30bf\u30fc\u30f3\nbyte[] challenge = new byte[32];\nnew SecureRandom().nextBytes(challenge);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),": UUID\u30d9\u30fc\u30b9\uff0816\u30d0\u30a4\u30c8\uff09"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jChallenge.java:42-48\npublic static WebAuthn4jChallenge generate() {\n    UUID uuid = UUID.randomUUID();\n    long hi = uuid.getMostSignificantBits();\n    long lo = uuid.getLeastSignificantBits();\n    byte[] value = ByteBuffer.allocate(16).putLong(hi).putLong(lo).array();\n    return new WebAuthn4jChallenge(value);\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u8a55\u4fa1"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 \u4e00\u610f\u6027: UUID v4\u306f\u6697\u53f7\u5b66\u7684\u306b\u5b89\u5168"}),"\n",(0,r.jsx)(n.li,{children:"\u26a0\ufe0f \u30b5\u30a4\u30ba: 16\u30d0\u30a4\u30c8\uff08\u516c\u5f0f\u63a8\u596832\u30d0\u30a4\u30c8\u3088\u308a\u5c0f\u3055\u3044\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u30a8\u30f3\u30b3\u30fc\u30c9: Base64URL\u30a8\u30f3\u30b3\u30fc\u30c9\u6e08\u307f"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u30ea\u30d7\u30ec\u30a4\u653b\u6483\u5bfe\u7b56: \u5404\u64cd\u4f5c\u3067\u4e00\u610f"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"credentialrecord\u306e\u6c38\u7d9a\u5316",children:"CredentialRecord\u306e\u6c38\u7d9a\u5316"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30ac\u30a4\u30c9\u5f15\u7528"}),":"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u767b\u9332\u6642\u306b\u6c38\u7d9a\u5316\u3059\u308b\u969b\u306f\u3001\u691c\u7d22\u3059\u308b\u969b\u306e\u5229\u4fbf\u6027\u3092\u8003\u3048\u3001credentialId\u3092\u30ad\u30fc\u306b\u6c38\u7d9a\u5316\u3059\u308b\u3068\u826f\u3044"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),": \u2705 \u6b63\u3057\u304f\u5b9f\u88c5"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jCredentialRepository.java:19-29\npublic interface WebAuthn4jCredentialRepository {\n  void register(WebAuthn4jCredential credential);      // credential\u3067\u4fdd\u5b58\n  WebAuthn4jCredentials findAll(String userId);        // userId\u3067\u691c\u7d22\n  WebAuthn4jCredential get(String id);                 // credentialId\u3067\u53d6\u5f97\n  void updateSignCount(String credentialId, long signCount);  // \u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\n  void delete(String credentialId);                    // credentialId\u3067\u524a\u9664\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b9\u30ad\u30fc\u30de"}),": ",(0,r.jsx)(n.code,{children:"libs/idp-server-database/postgresql/V0_9_1__webauthn4j.sql"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE webauthn4j_credential (\n    id VARCHAR(255) PRIMARY KEY,           -- credentialId\uff08Base64URL\uff09\n    user_id VARCHAR(255) NOT NULL,\n    rp_id VARCHAR(255) NOT NULL,\n    attestation_object TEXT NOT NULL,      -- AttestedCredentialData\uff08Base64URL\uff09\n    sign_count BIGINT DEFAULT 0,           -- \u30ab\u30a6\u30f3\u30bf\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09\n    created_at TIMESTAMP DEFAULT NOW()\n);\nCREATE INDEX idx_webauthn4j_user_id ON webauthn4j_credential(user_id);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u30af\u30ed\u30fc\u30f3\u691c\u77e5",children:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),": \u8a8d\u8a3c\u6210\u529f\u5f8c\u306f\u5fc5\u305a\u30ab\u30a6\u30f3\u30bf\u3092\u66f4\u65b0\u3057\u3066\u30af\u30ed\u30fc\u30f3\u691c\u77e5\u3092\u5b9f\u65bd"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5\u72b6\u6cc1"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u274c ",(0,r.jsx)(n.strong,{children:"\u672a\u5b9f\u88c5"}),": ",(0,r.jsx)(n.code,{children:"WebAuthn4jAuthenticationExecutor"}),"\u3067",(0,r.jsx)(n.code,{children:"updateSignCount()"}),"\u3092\u547c\u3073\u51fa\u3057\u3066\u3044\u306a\u3044"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6539\u5584\u6848"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// WebAuthn4jAuthenticationExecutor.java:82-92\uff08\u6539\u5584\u7248\uff09\nmanager.verify(webAuthn4jCredential);\n\n// \u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u8ffd\u52a0\nAuthenticationData authenticationData = manager.parseAuthenticationData();\nlong newSignCount = authenticationData.getAuthenticatorData().getSignCount();\ncredentialRepository.updateSignCount(id, newSignCount);\n\n// \u30af\u30ed\u30fc\u30f3\u691c\u77e5\nif (newSignCount <= webAuthn4jCredential.signCount()) {\n    throw new WebAuthn4jBadRequestException("Possible credential clone detected");\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u691c\u8a3c\u9805\u76ee",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u691c\u8a3c\u9805\u76ee"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u91cd\u8981\u306a\u691c\u8a3c\u9805\u76ee"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u691c\u8a3c\u9805\u76ee"}),(0,r.jsx)(n.th,{children:"\u76ee\u7684"}),(0,r.jsx)(n.th,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u4e00\u81f4"})}),(0,r.jsx)(n.td,{children:"\u30ea\u30d7\u30ec\u30a4\u653b\u6483\u9632\u6b62"}),(0,r.jsx)(n.td,{children:"\u2705 webauthn4j\u304c\u81ea\u52d5\u691c\u8a3c"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Origin\u691c\u8a3c"})}),(0,r.jsx)(n.td,{children:"\u30d5\u30a3\u30c3\u30b7\u30f3\u30b0\u5bfe\u7b56"}),(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"ServerProperty"}),"\u3067\u8a2d\u5b9a"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RPId\u78ba\u8a8d"})}),(0,r.jsx)(n.td,{children:"\u30b9\u30b3\u30fc\u30d7\u7ba1\u7406"}),(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"configuration.rpId()"}),"\u3067\u8a2d\u5b9a"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"\u30ab\u30a6\u30f3\u30bf\u76e3\u8996"})}),(0,r.jsx)(n.td,{children:"\u30af\u30ed\u30fc\u30f3\u691c\u77e5"}),(0,r.jsx)(n.td,{children:"\u274c \u672a\u5b9f\u88c5\uff08\u8981\u6539\u5584\uff09"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"UserVerification"})}),(0,r.jsx)(n.td,{children:"\u30e6\u30fc\u30b6\u30fc\u672c\u4eba\u78ba\u8a8d"}),(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"userVerificationRequired"}),"\u3067\u8a2d\u5b9a"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"UserPresence"})}),(0,r.jsx)(n.td,{children:"\u7269\u7406\u7684\u5b58\u5728\u78ba\u8a8d"}),(0,r.jsxs)(n.td,{children:["\u2705 ",(0,r.jsx)(n.code,{children:"userPresenceRequired"}),"\u3067\u8a2d\u5b9a"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u6ce8\u610f\u4e8b\u9805",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u6ce8\u610f\u4e8b\u9805"}),"\n",(0,r.jsx)(n.h4,{id:"1-attestation\u691c\u8a3c\u306e\u6df7\u5728\u7981\u6b62",children:"1. Attestation\u691c\u8a3c\u306e\u6df7\u5728\u7981\u6b62"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u5f15\u7528"}),":"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Attestation\u691c\u8a3c\u3092\u884c\u308f\u306a\u3044NoneAttestationStatementVerifier\u306a\u3069\u3092\u3001\u4ed6\u306e\u691c\u8a3c\u3092\u884c\u3046AttestationStatementVerifier\u3068\u6df7\u305c\u3066\u3057\u307e\u3046\u3068\u3001Attestation\u691c\u8a3c\u8fc2\u56de\u306b\u4f7f\u7528\u3055\u308c\u308b\u629c\u3051\u7a74\u3068\u306a\u308b"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),": \u2705 \u5b89\u5168\uff08NonStrict\u30e2\u30fc\u30c9\u4e00\u8cab\u4f7f\u7528\uff09"]}),"\n",(0,r.jsx)(n.h4,{id:"2-webauthn4j\u306e\u30b9\u30b3\u30fc\u30d7\u5916\u306e\u5b9f\u88c5",children:"2. WebAuthn4J\u306e\u30b9\u30b3\u30fc\u30d7\u5916\u306e\u5b9f\u88c5"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"HTTP\u30d1\u30e9\u30e1\u30fc\u30bf\u51e6\u7406\u3001\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406\u3001CredentialRecord\u6c38\u7d9a\u5316\u306f\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8cac\u52d9"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),": \u2705 \u9069\u5207\u306b\u5206\u96e2"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["HTTP\u30d1\u30e9\u30e1\u30fc\u30bf: ",(0,r.jsx)(n.code,{children:"AuthenticationExecutionRequest"}),"\u3067\u30ab\u30d7\u30bb\u30eb\u5316"]}),"\n",(0,r.jsxs)(n.li,{children:["\u30bb\u30c3\u30b7\u30e7\u30f3\u7ba1\u7406: ",(0,r.jsx)(n.code,{children:"AuthenticationInteractionRepository"}),"\u3067\u7ba1\u7406"]}),"\n",(0,r.jsxs)(n.li,{children:["\u6c38\u7d9a\u5316: ",(0,r.jsx)(n.code,{children:"WebAuthn4jCredentialRepository"}),"\u3067\u30ab\u30d7\u30bb\u30eb\u5316"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"3-\u30c1\u30e3\u30ec\u30f3\u30b8\u4fdd\u5b58\u306e\u91cd\u8981\u6027",children:"3. \u30c1\u30e3\u30ec\u30f3\u30b8\u4fdd\u5b58\u306e\u91cd\u8981\u6027"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// \u2705 \u6b63\u3057\u3044\u5b9f\u88c5\uff08\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u4e00\u6642\u4fdd\u5b58\uff09\ntransactionCommandRepository.register(\n    tenant, identifier, type().value(), fido2Challenge);\n\n// \u274c \u9593\u9055\u3063\u305f\u5b9f\u88c5\uff08\u30c1\u30e3\u30ec\u30f3\u30b8\u3092\u4fdd\u5b58\u3057\u306a\u3044\uff09\n// \u30ea\u30d7\u30ec\u30a4\u653b\u6483\u306e\u5371\u967a\u6027\n"})}),"\n",(0,r.jsx)(n.h2,{id:"webauthn\u4ed5\u69d8\u6e96\u62e0",children:"WebAuthn\u4ed5\u69d8\u6e96\u62e0"}),"\n",(0,r.jsx)(n.h3,{id:"attestation-format",children:"Attestation Format"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/webauthn-2/#sctn-attestation",children:"Web Authentication Level 2 - Attestation"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"- packed           : FIDO2\u6a19\u6e96\u5f62\u5f0f\uff08\u63a8\u5968\uff09\n- fido-u2f         : FIDO U2F\u4e92\u63db\n- android-key      : Android KeyStore\n- android-safetynet: Android SafetyNet\n- apple            : Apple Anonymous Attestation\n- none             : Attestation\u306a\u3057\uff08\u73fe\u5728\u306e\u5b9f\u88c5\uff09\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u306e\u5b9f\u88c5"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jCredentialConverter.java:44\nreturn new CredentialRecordImpl(\n    new NoneAttestationStatement(),  // Attestation\u306a\u3057\n    ...\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"user-verification",children:"User Verification"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/webauthn-2/#user-verification",children:"Web Authentication Level 2 - User Verification"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// User Verification Required\nUserVerificationRequirement.REQUIRED  // PIN/\u751f\u4f53\u8a8d\u8a3c\u5fc5\u9808\uff08Passkey\u63a8\u5968\uff09\n\n// User Verification Preferred\nUserVerificationRequirement.PREFERRED // \u53ef\u80fd\u306a\u3089\u5b9f\u65bd\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n\n// User Verification Discouraged\nUserVerificationRequirement.DISCOURAGED // \u4e0d\u8981\uff08\u591a\u8981\u7d20\u8a8d\u8a3c\u6642\uff09\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u8a2d\u5b9a\u65b9\u6cd5"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jConfiguration.java:56-57\nboolean userVerificationRequired;     // PIN/\u751f\u4f53\u8a8d\u8a3c\u5fc5\u9808\u304b\nboolean userPresenceRequired;         // \u30bf\u30c3\u30d7/\u30bf\u30c3\u30c1\u5fc5\u9808\u304b\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b9f\u88c5\u6539\u5584\u63a8\u5968\u4e8b\u9805",children:"\u5b9f\u88c5\u6539\u5584\u63a8\u5968\u4e8b\u9805"}),"\n",(0,r.jsx)(n.h3,{id:"1-\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u306e\u5b9f\u88c5\u5fc5\u9808",children:"1. \u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u306e\u5b9f\u88c5\uff08\u5fc5\u9808\uff09"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u512a\u5148\u5ea6"}),": \ud83d\udd34 \u9ad8\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ea\u30b9\u30af\uff09"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// WebAuthn4jAuthenticationExecutor.execute() \u306b\u8ffd\u52a0\nmanager.verify(webAuthn4jCredential);\n\n// \u30ab\u30a6\u30f3\u30bf\u66f4\u65b0\u51e6\u7406\u3092\u8ffd\u52a0\nlong newSignCount = extractSignCount(manager);\nif (newSignCount <= webAuthn4jCredential.signCount()) {\n    throw new WebAuthn4jBadRequestException("Credential clone detected");\n}\ncredentialRepository.updateSignCount(id, newSignCount);\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-\u30c1\u30e3\u30ec\u30f3\u30b8\u30b5\u30a4\u30ba\u306e\u62e1\u5927\u63a8\u5968",children:"2. \u30c1\u30e3\u30ec\u30f3\u30b8\u30b5\u30a4\u30ba\u306e\u62e1\u5927\uff08\u63a8\u5968\uff09"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u512a\u5148\u5ea6"}),": \ud83d\udfe1 \u4e2d\uff08\u516c\u5f0f\u63a8\u5968\u306b\u5408\u308f\u305b\u308b\uff09"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// WebAuthn4jChallenge.generate() \u306e\u6539\u5584\npublic static WebAuthn4jChallenge generate() {\n    byte[] value = new byte[32];  // 16 \u2192 32\u30d0\u30a4\u30c8\n    new SecureRandom().nextBytes(value);\n    return new WebAuthn4jChallenge(value);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-attestation\u691c\u8a3c\u306e\u5f37\u5316\u30aa\u30d7\u30b7\u30e7\u30f3",children:"3. Attestation\u691c\u8a3c\u306e\u5f37\u5316\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u512a\u5148\u5ea6"}),": \ud83d\udfe2 \u4f4e\uff08\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u306e\u307f\uff09"]}),"\n",(0,r.jsx)(n.p,{children:"\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u7528\u9014\u3067\u30c7\u30d0\u30a4\u30b9\u691c\u8a3c\u304c\u5fc5\u8981\u306a\u5834\u5408\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WebAuthnManager.createNonStrictWebAuthnManager()"})," \u2192 Strict\u30e2\u30fc\u30c9\u306b\u5909\u66f4"]}),"\n",(0,r.jsx)(n.li,{children:"TrustAnchorRepository\u5b9f\u88c5"}),"\n",(0,r.jsx)(n.li,{children:"AttestationStatementVerifier\u9078\u5b9a"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u5c64\u5b9f\u88c5",children:"\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u5c64\u5b9f\u88c5"}),"\n",(0,r.jsx)(n.h3,{id:"webauthn4jcredentialdatasource",children:"WebAuthn4jCredentialDataSource"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(73218).A+"",children:"WebAuthn4jCredentialDataSource.java"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"DataSource-SqlExecutor \u30d1\u30bf\u30fc\u30f3"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"WebAuthn4jCredentialDataSource\n  \u251c\u2500 PostgresqlExecutor (PostgreSQL\u7528SQL)\n  \u2514\u2500 MysqlExecutor (MySQL\u7528SQL)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"SQL\u5b9f\u88c5"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- PostgreSQL: JSONB\u578b\u4f7f\u7528\nINSERT INTO webauthn4j_credential (id, user_id, rp_id, credential_data)\nVALUES (?, ?, ?, ?::jsonb)\n\n-- MySQL: JSON\u578b\u4f7f\u7528\nINSERT INTO webauthn4j_credential (id, user_id, rp_id, credential_data)\nVALUES (?, ?, ?, ?)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JsonConverter\u4f7f\u7528"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"JsonConverter jsonConverter = JsonConverter.snakeCaseInstance();\nString json = jsonConverter.write(credential.toMap());\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u30b7\u30fc\u30b1\u30f3\u30b9\u56f3",children:"\u30b7\u30fc\u30b1\u30f3\u30b9\u56f3"}),"\n",(0,r.jsx)(n.h3,{id:"\u767b\u9332\u30d5\u30ed\u30fcregistration",children:"\u767b\u9332\u30d5\u30ed\u30fc\uff08Registration\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Client                Executor              Manager              Repository\n  |                      |                     |                     |\n  |--- GET /challenge --\x3e|                     |                     |\n  |                      |-- generate() ------\x3e|                     |\n  |                      |<- challenge --------|                     |\n  |                      |-- save challenge -----------------------\x3e|\n  |<-- challenge --------|                     |                     |\n  |                      |                     |                     |\n  |--- POST /register --\x3e|                     |                     |\n  |  (credential data)   |-- load challenge -----------------------\x3e|\n  |                      |<- challenge ---------------------------- |\n  |                      |-- verify(data, challenge) -------------\x3e|\n  |                      |<- verified data ------------------------|\n  |                      |-- create credential --------------------\x3e|\n  |                      |<- credential ----------------------------|\n  |                      |-- register(credential) -----------------\x3e|\n  |<-- success ----------|                     |                     |\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8a8d\u8a3c\u30d5\u30ed\u30fcauthentication",children:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\uff08Authentication\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Client                Executor              Manager              Repository\n  |                      |                     |                     |\n  |--- GET /challenge --\x3e|                     |                     |\n  |                      |-- generate() ------\x3e|                     |\n  |                      |<- challenge --------|                     |\n  |                      |-- save challenge -----------------------\x3e|\n  |<-- challenge --------|                     |                     |\n  |                      |                     |                     |\n  |--- POST /auth ------\x3e|                     |                     |\n  |  (assertion)         |-- load challenge -----------------------\x3e|\n  |                      |<- challenge ---------------------------- |\n  |                      |-- get(credentialId) --------------------\x3e|\n  |                      |<- credential ----------------------------|\n  |                      |-- verify(assertion, credential) --------\x3e|\n  |                      |<- verification result -------------------|\n  |                      |-- updateSignCount(id, count) -----------\x3e| \u26a0\ufe0f \u8981\u5b9f\u88c5\n  |<-- success ----------|                     |                     |\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,r.jsx)(n.h3,{id:"webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u306e\u30dd\u30a4\u30f3\u30c8",children:"WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u4f7f\u3044\u65b9\u306e\u30dd\u30a4\u30f3\u30c8"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"WebAuthnManager"}),": ",(0,r.jsx)(n.code,{children:"createNonStrictWebAuthnManager()"}),"\u3092\u4f7f\u7528\uff08\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u4ee5\u5916\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8"}),": UUID\u30d9\u30fc\u30b9\uff0816\u30d0\u30a4\u30c8\uff09\u3067\u73fe\u5728\u5b9f\u88c5\u3001\u516c\u5f0f\u63a8\u5968\u306f32\u30d0\u30a4\u30c8"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u691c\u8a3c"}),": ",(0,r.jsx)(n.code,{children:"webAuthnManager.verify()"}),"\u3067\u81ea\u52d5\u7684\u306bRFC\u6e96\u62e0\u691c\u8a3c"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Credential\u4fdd\u5b58"}),": ",(0,r.jsx)(n.code,{children:"credentialId"}),"\u3092\u30ad\u30fc\u3068\u3057\u3066\u6c38\u7d9a\u5316"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0"}),": \u8a8d\u8a3c\u6210\u529f\u5f8c\u306b\u5fc5\u305a\u66f4\u65b0\uff08\u30af\u30ed\u30fc\u30f3\u691c\u77e5\uff09 - \u26a0\ufe0f ",(0,r.jsx)(n.strong,{children:"\u73fe\u5728\u672a\u5b9f\u88c5"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f8b\u5916\u51e6\u7406"}),": webauthn4j\u306e\u4f8b\u5916\u3092",(0,r.jsx)(n.code,{children:"WebAuthn4jBadRequestException"}),"\u3067\u30e9\u30c3\u30d7"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30d1\u30bf\u30fc\u30f3",children:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"4\u6bb5\u968eExecutor"}),": Registration/Authentication \xd7 Challenge/Execution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Manager\u5c64"}),": webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u30e9\u30c3\u30d7"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Repository\u5c64"}),": Credential\u6c38\u7d9a\u5316\uff08PostgreSQL/MySQL\u5bfe\u5fdc\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DataSource-SqlExecutor"}),": DB\u5225SQL\u5b9f\u88c5"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a55\u4fa1",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a55\u4fa1"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u9805\u76ee"}),(0,r.jsx)(n.th,{children:"\u72b6\u614b"}),(0,r.jsx)(n.th,{children:"\u8a55\u4fa1"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WebAuthnManager"}),(0,r.jsx)(n.td,{children:"NonStrict\u30e2\u30fc\u30c9"}),(0,r.jsx)(n.td,{children:"\u2705 \u516c\u5f0f\u63a8\u5968\u901a\u308a"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),(0,r.jsx)(n.td,{children:"UUID v4\uff0816\u30d0\u30a4\u30c8\uff09"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f \u516c\u5f0f\u63a8\u5968\u306f32\u30d0\u30a4\u30c8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u4fdd\u5b58"}),(0,r.jsx)(n.td,{children:"AuthenticationInteractionRepository"}),(0,r.jsx)(n.td,{children:"\u2705 \u6b63\u3057\u304f\u5b9f\u88c5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Origin\u691c\u8a3c"}),(0,r.jsx)(n.td,{children:"ServerProperty\u3067\u8a2d\u5b9a"}),(0,r.jsx)(n.td,{children:"\u2705 \u6b63\u3057\u304f\u5b9f\u88c5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u30ab\u30a6\u30f3\u30bf\u66f4\u65b0"}),(0,r.jsx)(n.td,{children:"\u672a\u5b9f\u88c5"}),(0,r.jsx)(n.td,{children:"\u274c \u8981\u6539\u5584\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ea\u30b9\u30af\uff09"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Credential\u6c38\u7d9a\u5316"}),(0,r.jsx)(n.td,{children:"credentialId\u3092\u30ad\u30fc"}),(0,r.jsx)(n.td,{children:"\u2705 \u516c\u5f0f\u63a8\u5968\u901a\u308a"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation",children:"\u8a8d\u8a3c\u30fb\u9023\u643a\u5c64\u7d71\u5408\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})," - WebAuthn\u3092\u542b\u3080\u5168\u8a8d\u8a3c\u30e2\u30b8\u30e5\u30fc\u30eb"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation",children:"idp-server-authentication-interactors"})," - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-11-core",children:"idp-server-core"})," - OAuth/OIDC\u30b3\u30a2\u30a8\u30f3\u30b8\u30f3"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-12-platform",children:"idp-server-platform"})," - JsonConverter, PluginLoader"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u8003\u8cc7\u6599",children:"\u53c2\u8003\u8cc7\u6599"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u516c\u5f0f\u4ed5\u69d8"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.w3.org/TR/webauthn-2/",children:"Web Authentication Level 2"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://webauthn4j.github.io/webauthn4j/ja/",children:"WebAuthn4j\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\uff08\u65e5\u672c\u8a9e\uff09"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://fidoalliance.org/specifications/",children:"FIDO Alliance Specifications"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"libs/idp-server-webauthn4j-adapter/src/main/java/org/idp/server/authenticators/webauthn4j/"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"libs/idp-server-webauthn4j-adapter/build.gradle"})," - ",(0,r.jsx)(n.code,{children:"com.webauthn4j:webauthn4j-core:0.28.5.RELEASE"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"libs/idp-server-database/postgresql/V0_9_1__webauthn4j.sql"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u78ba\u8a8d\u65b9\u6cd5"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# WebAuthn4j\u95a2\u9023\u30d5\u30a1\u30a4\u30eb\u78ba\u8a8d\nfind libs/idp-server-webauthn4j-adapter -name "*.java" -type f\n\n# \u30e9\u30a4\u30d6\u30e9\u30ea\u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\ngrep "webauthn4j" libs/idp-server-webauthn4j-adapter/build.gradle\n\n# \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b9\u30ad\u30fc\u30de\u78ba\u8a8d\ngrep "webauthn4j_credential" libs/idp-server-database/postgresql/*.sql\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-11-08"]})]})}function o(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},83614:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jAuthenticationChallengeExecutor-42953f1ec43d3db928053ea1d5b02f9b.java"},70123:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jAuthenticationExecutor-ebef4c7a891116ef078e1c9f24b71fbb.java"},83705:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jAuthenticationManager-920abd9964ea9e9d7d23187cc4c2dceb.java"},99243:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jChallenge-ac3fd1820355cf1ca4aa8e91ed861c28.java"},58336:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jConfiguration-ec5d7ddb2971bca9e75e8d2a78cf19a8.java"},37323:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jCredential-4bbd60bbebf05721e3436a751813e6a8.java"},93473:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jCredentialConverter-91c1c48a48f169c571604f9f0c417a2c.java"},9289:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jRegistrationChallengeExecutor-d850e4a5aee3031b291dc0864d5f5f4b.java"},88746:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jRegistrationExecutor-9065b388442c908d1b9413b837cbfbd6.java"},58138:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jRegistrationManager-8ced81fa946bffeafb23c5b68b8a3a00.java"},73218:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/files/WebAuthn4jCredentialDataSource-ad86af65eb0fa4d5fa6326163f57a483.java"},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(96540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);