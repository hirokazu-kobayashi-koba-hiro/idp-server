"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[651],{7148:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>i,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"content_11_learning/data-formats/cose","title":"COSE: CBOR Object Signing and Encryption","description":"COSE \u306f CBOR \u30d9\u30fc\u30b9\u306e\u7f72\u540d\u30fb\u6697\u53f7\u5316\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\uff08RFC 9052\uff09\u3002JWT/JWS/JWE \u306e CBOR \u7248\u3068\u3057\u3066\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002","source":"@site/docs/content_11_learning/18-data-formats/cose.md","sourceDirName":"content_11_learning/18-data-formats","slug":"/content_11_learning/data-formats/cose","permalink":"/idp-server/docs/content_11_learning/data-formats/cose","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/18-data-formats/cose.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docs","previous":{"title":"CBOR: Concise Binary Object Representation","permalink":"/idp-server/docs/content_11_learning/data-formats/cbor"},"next":{"title":"ASN.1 \u3068 DER","permalink":"/idp-server/docs/content_11_learning/data-formats/asn1-der"}}');var d=r(74848),t=r(28453);const i={sidebar_position:3},c="COSE: CBOR Object Signing and Encryption",l={},h=[{value:"COSE \u3068\u306f",id:"cose-\u3068\u306f",level:2},{value:"COSE \u306e\u69cb\u9020",id:"cose-\u306e\u69cb\u9020",level:2},{value:"COSE \u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7",id:"cose-\u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7",level:3},{value:"COSE_Sign1\uff08\u5358\u4e00\u7f72\u540d\uff09",id:"cose_sign1\u5358\u4e00\u7f72\u540d",level:2},{value:"\u69cb\u9020",id:"\u69cb\u9020",level:3},{value:"\u5177\u4f53\u4f8b",id:"\u5177\u4f53\u4f8b",level:3},{value:"\u30d8\u30c3\u30c0\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf",id:"\u30d8\u30c3\u30c0\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf",level:3},{value:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u8b58\u5225\u5b50",id:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u8b58\u5225\u5b50",level:3},{value:"COSE_Key\uff08\u9375\u8868\u73fe\uff09",id:"cose_key\u9375\u8868\u73fe",level:2},{value:"\u69cb\u9020",id:"\u69cb\u9020-1",level:3},{value:"\u9375\u30bf\u30a4\u30d7\uff08kty\uff09",id:"\u9375\u30bf\u30a4\u30d7kty",level:3},{value:"EC2 \u9375\u306e\u4f8b",id:"ec2-\u9375\u306e\u4f8b",level:3},{value:"EC2 \u66f2\u7dda\uff08crv\uff09",id:"ec2-\u66f2\u7ddacrv",level:3},{value:"JOSE \u3068\u306e\u5bfe\u5fdc\u95a2\u4fc2",id:"jose-\u3068\u306e\u5bfe\u5fdc\u95a2\u4fc2",level:2},{value:"JWS \u3068 COSE_Sign1",id:"jws-\u3068-cose_sign1",level:3},{value:"JWK \u3068 COSE_Key",id:"jwk-\u3068-cose_key",level:3},{value:"WebAuthn \u3067\u306e COSE",id:"webauthn-\u3067\u306e-cose",level:2},{value:"Credential Public Key",id:"credential-public-key",level:3},{value:"Attestation Statement\uff08packed \u5f62\u5f0f\uff09",id:"attestation-statementpacked-\u5f62\u5f0f",level:3},{value:"mdoc \u3067\u306e COSE",id:"mdoc-\u3067\u306e-cose",level:2},{value:"Mobile Security Object (MSO) \u306e\u7f72\u540d",id:"mobile-security-object-mso-\u306e\u7f72\u540d",level:3},{value:"\u7f72\u540d\u691c\u8a3c\u306e\u6d41\u308c",id:"\u7f72\u540d\u691c\u8a3c\u306e\u6d41\u308c",level:2},{value:"\u30b3\u30fc\u30c9\u4f8b",id:"\u30b3\u30fc\u30c9\u4f8b",level:2},{value:"Python (cose \u30e9\u30a4\u30d6\u30e9\u30ea)",id:"python-cose-\u30e9\u30a4\u30d6\u30e9\u30ea",level:3},{value:"JavaScript (cose-js)",id:"javascript-cose-js",level:3},{value:"\u30c7\u30d0\u30c3\u30b0\u30c4\u30fc\u30eb",id:"\u30c7\u30d0\u30c3\u30b0\u30c4\u30fc\u30eb",level:2},{value:"CBOR \u30c7\u30b3\u30fc\u30c9\u5f8c\u306e\u78ba\u8a8d",id:"cbor-\u30c7\u30b3\u30fc\u30c9\u5f8c\u306e\u78ba\u8a8d",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u53c2\u8003\u30ea\u30f3\u30af",id:"\u53c2\u8003\u30ea\u30f3\u30af",level:2}];function j(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"cose-cbor-object-signing-and-encryption",children:"COSE: CBOR Object Signing and Encryption"})}),"\n",(0,d.jsxs)(e.p,{children:["COSE \u306f CBOR \u30d9\u30fc\u30b9\u306e\u7f72\u540d\u30fb\u6697\u53f7\u5316\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\uff08",(0,d.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc9052.html",children:"RFC 9052"}),"\uff09\u3002JWT/JWS/JWE \u306e CBOR \u7248\u3068\u3057\u3066\u8a2d\u8a08\u3055\u308c\u3066\u3044\u307e\u3059\u3002"]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"cose-\u3068\u306f",children:"COSE \u3068\u306f"}),"\n",(0,d.jsxs)(e.p,{children:["COSE\uff08\u30b3\u30fc\u30ba\uff09\u306f\u3001",(0,d.jsx)(e.strong,{children:"CBOR \u30c7\u30fc\u30bf\u306b\u7f72\u540d\u30fb\u6697\u53f7\u5316\u3092\u884c\u3046\u305f\u3081\u306e\u6a19\u6e96"}),"\u3067\u3059\u3002"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"JOSE \u3068 COSE \u306e\u95a2\u4fc2:\n\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502                                                             \u2502\n  \u2502  JOSE\uff08JSON \u30d9\u30fc\u30b9\uff09          COSE\uff08CBOR \u30d9\u30fc\u30b9\uff09           \u2502\n  \u2502                                                             \u2502\n  \u2502  JWT  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba  CWT (CBOR Web Token)         \u2502\n  \u2502  JWS  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba  COSE_Sign / COSE_Sign1       \u2502\n  \u2502  JWE  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba  COSE_Encrypt / COSE_Encrypt0 \u2502\n  \u2502  JWK  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba  COSE_Key                     \u2502\n  \u2502                                                             \u2502\n  \u2502  \u4f7f\u7528\u4f8b:                      \u4f7f\u7528\u4f8b:                       \u2502\n  \u2502  - OAuth/OIDC                - WebAuthn/FIDO2              \u2502\n  \u2502  - Web API                   - mdoc/mDL                    \u2502\n  \u2502                              - IoT                          \u2502\n  \u2502                                                             \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"cose-\u306e\u69cb\u9020",children:"COSE \u306e\u69cb\u9020"}),"\n",(0,d.jsx)(e.h3,{id:"cose-\u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7",children:"COSE \u30e1\u30c3\u30bb\u30fc\u30b8\u30bf\u30a4\u30d7"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u30bf\u30a4\u30d7"}),(0,d.jsx)(e.th,{children:"CBOR \u30bf\u30b0"}),(0,d.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Sign"}),(0,d.jsx)(e.td,{children:"98"}),(0,d.jsx)(e.td,{children:"\u8907\u6570\u7f72\u540d"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Sign1"}),(0,d.jsx)(e.td,{children:"18"}),(0,d.jsx)(e.td,{children:"\u5358\u4e00\u7f72\u540d\uff08\u6700\u3082\u4e00\u822c\u7684\uff09"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Encrypt"}),(0,d.jsx)(e.td,{children:"96"}),(0,d.jsx)(e.td,{children:"\u8907\u6570\u53d7\u4fe1\u8005\u3078\u306e\u6697\u53f7\u5316"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Encrypt0"}),(0,d.jsx)(e.td,{children:"16"}),(0,d.jsx)(e.td,{children:"\u5358\u4e00\u53d7\u4fe1\u8005\u3078\u306e\u6697\u53f7\u5316"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Mac"}),(0,d.jsx)(e.td,{children:"97"}),(0,d.jsx)(e.td,{children:"\u8907\u6570\u53d7\u4fe1\u8005\u3078\u306e MAC"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"COSE_Mac0"}),(0,d.jsx)(e.td,{children:"17"}),(0,d.jsx)(e.td,{children:"\u5358\u4e00\u53d7\u4fe1\u8005\u3078\u306e MAC"})]})]})]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"cose_sign1\u5358\u4e00\u7f72\u540d",children:"COSE_Sign1\uff08\u5358\u4e00\u7f72\u540d\uff09"}),"\n",(0,d.jsx)(e.p,{children:"\u6700\u3082\u3088\u304f\u4f7f\u308f\u308c\u308b\u5f62\u5f0f\u3002mdoc \u306e issuerAuth \u306a\u3069\u3067\u4f7f\u7528\u3002"}),"\n",(0,d.jsx)(e.h3,{id:"\u69cb\u9020",children:"\u69cb\u9020"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"COSE_Sign1 = [\n    protected,   # bstr: \u4fdd\u8b77\u30d8\u30c3\u30c0\u30fc\uff08\u7f72\u540d\u5bfe\u8c61\uff09\n    unprotected, # map: \u975e\u4fdd\u8b77\u30d8\u30c3\u30c0\u30fc\uff08\u7f72\u540d\u5bfe\u8c61\u5916\uff09\n    payload,     # bstr / nil: \u30da\u30a4\u30ed\u30fc\u30c9\n    signature    # bstr: \u7f72\u540d\n]\n\nCBOR \u30bf\u30b0 18 \u304c\u4ed8\u4e0e\u3055\u308c\u308b:\n  D2                              # tag(18) = COSE_Sign1\n     84                           # array(4)\n        ...\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u5177\u4f53\u4f8b",children:"\u5177\u4f53\u4f8b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:'ES256 \u3067\u7f72\u540d\u3055\u308c\u305f COSE_Sign1:\n\nD2                                # tag(18) = COSE_Sign1\n   84                             # array(4)\n\n   # protected header (\u7f72\u540d\u5bfe\u8c61)\n   43                             # bytes(3)\n      A1 01 26                    # {1: -7}  \u2192 alg: ES256\n\n   # unprotected header\n   A0                             # {} \u7a7a\u306e\u30de\u30c3\u30d7\n\n   # payload\n   54                             # bytes(20)\n      48656C6C6F2C20576F726C6421  # "Hello, World!"\n\n   # signature\n   58 40                          # bytes(64)\n      [64 \u30d0\u30a4\u30c8\u306e ECDSA \u7f72\u540d]\n'})}),"\n",(0,d.jsx)(e.h3,{id:"\u30d8\u30c3\u30c0\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf",children:"\u30d8\u30c3\u30c0\u30fc\u30d1\u30e9\u30e1\u30fc\u30bf"}),"\n",(0,d.jsx)(e.p,{children:"COSE \u3067\u306f\u6574\u6570\u30ad\u30fc\u3092\u4f7f\u7528\uff08JWS \u306e\u6587\u5b57\u5217\u30ad\u30fc\u3068\u306f\u7570\u306a\u308b\uff09\u3002"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u6574\u6570\u30ad\u30fc"}),(0,d.jsx)(e.th,{children:"\u540d\u524d"}),(0,d.jsx)(e.th,{children:"JWS \u5bfe\u5fdc"}),(0,d.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"1"}),(0,d.jsx)(e.td,{children:"alg"}),(0,d.jsx)(e.td,{children:"alg"}),(0,d.jsx)(e.td,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"2"}),(0,d.jsx)(e.td,{children:"crit"}),(0,d.jsx)(e.td,{children:"crit"}),(0,d.jsx)(e.td,{children:"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"3"}),(0,d.jsx)(e.td,{children:"content type"}),(0,d.jsx)(e.td,{children:"cty"}),(0,d.jsx)(e.td,{children:"\u30b3\u30f3\u30c6\u30f3\u30c4\u30bf\u30a4\u30d7"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"4"}),(0,d.jsx)(e.td,{children:"kid"}),(0,d.jsx)(e.td,{children:"kid"}),(0,d.jsx)(e.td,{children:"\u9375 ID"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"5"}),(0,d.jsx)(e.td,{children:"IV"}),(0,d.jsx)(e.td,{children:"-"}),(0,d.jsx)(e.td,{children:"\u521d\u671f\u5316\u30d9\u30af\u30c8\u30eb"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"6"}),(0,d.jsx)(e.td,{children:"Partial IV"}),(0,d.jsx)(e.td,{children:"-"}),(0,d.jsx)(e.td,{children:"\u90e8\u5206 IV"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"7"}),(0,d.jsx)(e.td,{children:"counter signature"}),(0,d.jsx)(e.td,{children:"-"}),(0,d.jsx)(e.td,{children:"\u30ab\u30a6\u30f3\u30bf\u30fc\u7f72\u540d"})]})]})]}),"\n",(0,d.jsx)(e.h3,{id:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u8b58\u5225\u5b50",children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u8b58\u5225\u5b50"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u5024"}),(0,d.jsx)(e.th,{children:"\u540d\u524d"}),(0,d.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-7"}),(0,d.jsx)(e.td,{children:"ES256"}),(0,d.jsx)(e.td,{children:"ECDSA w/ SHA-256 (P-256)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-35"}),(0,d.jsx)(e.td,{children:"ES384"}),(0,d.jsx)(e.td,{children:"ECDSA w/ SHA-384 (P-384)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-36"}),(0,d.jsx)(e.td,{children:"ES512"}),(0,d.jsx)(e.td,{children:"ECDSA w/ SHA-512 (P-521)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-37"}),(0,d.jsx)(e.td,{children:"PS256"}),(0,d.jsx)(e.td,{children:"RSASSA-PSS w/ SHA-256"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-257"}),(0,d.jsx)(e.td,{children:"RS256"}),(0,d.jsx)(e.td,{children:"RSASSA-PKCS1-v1_5 w/ SHA-256"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-8"}),(0,d.jsx)(e.td,{children:"EdDSA"}),(0,d.jsx)(e.td,{children:"EdDSA (Ed25519, Ed448)"})]})]})]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"cose_key\u9375\u8868\u73fe",children:"COSE_Key\uff08\u9375\u8868\u73fe\uff09"}),"\n",(0,d.jsx)(e.p,{children:"JWK \u306b\u76f8\u5f53\u3059\u308b\u9375\u306e\u8868\u73fe\u5f62\u5f0f\u3002"}),"\n",(0,d.jsx)(e.h3,{id:"\u69cb\u9020-1",children:"\u69cb\u9020"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"COSE_Key = {\n    1: kty,      # \u9375\u30bf\u30a4\u30d7\n    2: kid,      # \u9375 ID\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09\n    3: alg,      # \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09\n    4: key_ops,  # \u9375\u64cd\u4f5c\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09\n    ...          # \u9375\u30bf\u30a4\u30d7\u56fa\u6709\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\n}\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u9375\u30bf\u30a4\u30d7kty",children:"\u9375\u30bf\u30a4\u30d7\uff08kty\uff09"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u5024"}),(0,d.jsx)(e.th,{children:"\u540d\u524d"}),(0,d.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"1"}),(0,d.jsx)(e.td,{children:"OKP"}),(0,d.jsx)(e.td,{children:"Octet Key Pair (Ed25519 \u306a\u3069)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"2"}),(0,d.jsx)(e.td,{children:"EC2"}),(0,d.jsx)(e.td,{children:"Elliptic Curve (P-256 \u306a\u3069)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"3"}),(0,d.jsx)(e.td,{children:"RSA"}),(0,d.jsx)(e.td,{children:"RSA"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"4"}),(0,d.jsx)(e.td,{children:"Symmetric"}),(0,d.jsx)(e.td,{children:"\u5bfe\u79f0\u9375"})]})]})]}),"\n",(0,d.jsx)(e.h3,{id:"ec2-\u9375\u306e\u4f8b",children:"EC2 \u9375\u306e\u4f8b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"P-256 \u516c\u958b\u9375:\n\n{\n    1: 2,        # kty: EC2\n    -1: 1,       # crv: P-256\n    -2: h'...',  # x \u5ea7\u6a19 (32 bytes)\n    -3: h'...'   # y \u5ea7\u6a19 (32 bytes)\n}\n\nCBOR:\nA4                              # map(4)\n   01 02                        # 1: 2 (EC2)\n   20 01                        # -1: 1 (P-256)\n   21 58 20 [32 bytes]          # -2: x\u5ea7\u6a19\n   22 58 20 [32 bytes]          # -3: y\u5ea7\u6a19\n"})}),"\n",(0,d.jsx)(e.h3,{id:"ec2-\u66f2\u7ddacrv",children:"EC2 \u66f2\u7dda\uff08crv\uff09"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u5024"}),(0,d.jsx)(e.th,{children:"\u66f2\u7dda"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"1"}),(0,d.jsx)(e.td,{children:"P-256"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"2"}),(0,d.jsx)(e.td,{children:"P-384"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"3"}),(0,d.jsx)(e.td,{children:"P-521"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"6"}),(0,d.jsx)(e.td,{children:"Ed25519"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"7"}),(0,d.jsx)(e.td,{children:"Ed448"})]})]})]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"jose-\u3068\u306e\u5bfe\u5fdc\u95a2\u4fc2",children:"JOSE \u3068\u306e\u5bfe\u5fdc\u95a2\u4fc2"}),"\n",(0,d.jsx)(e.h3,{id:"jws-\u3068-cose_sign1",children:"JWS \u3068 COSE_Sign1"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:'JWS:\n{\n    "alg": "ES256",\n    "typ": "JWT"\n}\n.\n{\n    "sub": "user123",\n    "name": "John"\n}\n.\n[signature]\n\nCOSE_Sign1:\nD2 84\n   43 A1 01 26              # protected: {1: -7}  (alg: ES256)\n   A1 03 6A 61... 2B6A7774  # unprotected: {3: "application/jwt"}\n   ...                      # payload\n   58 40 [signature]        # signature\n'})}),"\n",(0,d.jsx)(e.h3,{id:"jwk-\u3068-cose_key",children:"JWK \u3068 COSE_Key"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:'JWK (P-256 \u516c\u958b\u9375):\n{\n    "kty": "EC",\n    "crv": "P-256",\n    "x": "base64url...",\n    "y": "base64url..."\n}\n\nCOSE_Key:\n{\n    1: 2,       # kty: EC2\n    -1: 1,      # crv: P-256\n    -2: h\'...\', # x (raw bytes)\n    -3: h\'...\'  # y (raw bytes)\n}\n'})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"webauthn-\u3067\u306e-cose",children:"WebAuthn \u3067\u306e COSE"}),"\n",(0,d.jsx)(e.p,{children:"WebAuthn \u306e attestation/assertion \u3067 COSE \u304c\u4f7f\u308f\u308c\u307e\u3059\u3002"}),"\n",(0,d.jsx)(e.h3,{id:"credential-public-key",children:"Credential Public Key"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"\u8a8d\u8a3c\u5668\u304b\u3089\u8fd4\u3055\u308c\u308b\u516c\u958b\u9375\uff08COSE_Key \u5f62\u5f0f\uff09:\n\nA5                              # map(5)\n   01 02                        # 1: 2 (kty: EC2)\n   03 26                        # 3: -7 (alg: ES256)\n   20 01                        # -1: 1 (crv: P-256)\n   21 58 20                     # -2: bytes(32)\n      [32 bytes x\u5ea7\u6a19]\n   22 58 20                     # -3: bytes(32)\n      [32 bytes y\u5ea7\u6a19]\n"})}),"\n",(0,d.jsx)(e.h3,{id:"attestation-statementpacked-\u5f62\u5f0f",children:"Attestation Statement\uff08packed \u5f62\u5f0f\uff09"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:'{\n    "alg": -7,                  # ES256\n    "sig": h\'...\'               # \u7f72\u540d\n}\n\nCBOR:\nA2                              # map(2)\n   63 616C67                    # "alg"\n   26                           # -7\n   63 736967                    # "sig"\n   58 47                        # bytes(71)\n      [71 bytes ECDSA signature]\n'})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"mdoc-\u3067\u306e-cose",children:"mdoc \u3067\u306e COSE"}),"\n",(0,d.jsx)(e.p,{children:"mdoc \u306e issuerAuth \u306f COSE_Sign1 \u3067\u7f72\u540d\u3055\u308c\u307e\u3059\u3002"}),"\n",(0,d.jsx)(e.h3,{id:"mobile-security-object-mso-\u306e\u7f72\u540d",children:"Mobile Security Object (MSO) \u306e\u7f72\u540d"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"issuerAuth = COSE_Sign1\n\nD2                                # tag(18)\n   84                             # array(4)\n\n   # protected header\n   59 01 23                       # bytes(291)\n      A2                          # map(2)\n         01 26                    # alg: ES256\n         04 ...                   # kid: [\u767a\u884c\u8005\u306e\u9375ID]\n\n   # unprotected header\n   A1                             # map(1)\n      21                          # x5chain\n      81 59 02 ...               # [\u8a3c\u660e\u66f8\u30c1\u30a7\u30fc\u30f3]\n\n   # payload (MSO)\n   59 01 00                       # bytes(256)\n      [Mobile Security Object]\n\n   # signature\n   58 40                          # bytes(64)\n      [64 bytes signature]\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"\u7f72\u540d\u691c\u8a3c\u306e\u6d41\u308c",children:"\u7f72\u540d\u691c\u8a3c\u306e\u6d41\u308c"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"COSE_Sign1 \u306e\u691c\u8a3c:\n\n  1. \u69cb\u9020\u306e\u30d1\u30fc\u30b9\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502 D2 84 [protected] [unprotected]    \u2502\n     \u2502       [payload] [signature]        \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n  2. protected \u30d8\u30c3\u30c0\u30fc\u304b\u3089\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u53d6\u5f97\n     {1: -7} \u2192 ES256\n\n  3. Sig_structure \u306e\u69cb\u7bc9\n     Sig_structure = [\n         \"Signature1\",    # \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u6587\u5b57\u5217\n         protected,       # \u4fdd\u8b77\u30d8\u30c3\u30c0\u30fc\n         h'',             # \u5916\u90e8 AAD\uff08\u901a\u5e38\u306f\u7a7a\uff09\n         payload          # \u30da\u30a4\u30ed\u30fc\u30c9\n     ]\n\n  4. Sig_structure \u3092 CBOR \u30a8\u30f3\u30b3\u30fc\u30c9\n     \u2192 ToBeSigned \u30d0\u30a4\u30c8\u5217\n\n  5. \u7f72\u540d\u691c\u8a3c\n     verify(\u516c\u958b\u9375, ToBeSigned, signature)\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"\u30b3\u30fc\u30c9\u4f8b",children:"\u30b3\u30fc\u30c9\u4f8b"}),"\n",(0,d.jsx)(e.h3,{id:"python-cose-\u30e9\u30a4\u30d6\u30e9\u30ea",children:"Python (cose \u30e9\u30a4\u30d6\u30e9\u30ea)"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-python",children:'from cose.messages import Sign1Message\nfrom cose.keys import EC2Key\nfrom cose.algorithms import Es256\n\n# \u7f72\u540d\u4f5c\u6210\nmsg = Sign1Message(\n    phdr={1: Es256},  # alg: ES256\n    payload=b"Hello, World!"\n)\nmsg.key = private_key\nencoded = msg.encode()\n\n# \u7f72\u540d\u691c\u8a3c\nmsg = Sign1Message.decode(encoded)\nmsg.key = public_key\nverified = msg.verify_signature()\n'})}),"\n",(0,d.jsx)(e.h3,{id:"javascript-cose-js",children:"JavaScript (cose-js)"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-javascript",children:"const cose = require('cose-js');\n\n// \u7f72\u540d\u691c\u8a3c\nconst verifier = {\n    key: {\n        kty: 'EC',\n        crv: 'P-256',\n        x: Buffer.from(...),\n        y: Buffer.from(...)\n    }\n};\n\nconst verified = await cose.sign.verify(coseMessage, verifier);\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"\u30c7\u30d0\u30c3\u30b0\u30c4\u30fc\u30eb",children:"\u30c7\u30d0\u30c3\u30b0\u30c4\u30fc\u30eb"}),"\n",(0,d.jsx)(e.h3,{id:"cbor-\u30c7\u30b3\u30fc\u30c9\u5f8c\u306e\u78ba\u8a8d",children:"CBOR \u30c7\u30b3\u30fc\u30c9\u5f8c\u306e\u78ba\u8a8d"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"cbor.me \u3067 COSE_Sign1 \u3092\u30c7\u30b3\u30fc\u30c9:\n\n\u5165\u529b\uff0816\u9032\u6570\uff09:\nD2 84 43 A1 01 26 A0 54 48656C6C6F2C20576F726C6421 58 40 ...\n\n\u51fa\u529b\uff08\u8a3a\u65ad\u8868\u8a18\uff09:\n18([                              # COSE_Sign1\n    h'A10126',                    # protected: {1: -7}\n    {},                           # unprotected\n    h'48656C6C6F2C20576F726C6421', # payload: \"Hello, World!\"\n    h'...'                        # signature\n])\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{children:"COSE \u306e\u7279\u5fb4:\n\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502                                                             \u2502\n  \u2502  \u4f55\u8005\u304b:                                                    \u2502\n  \u2502    CBOR \u30d9\u30fc\u30b9\u306e\u7f72\u540d\u30fb\u6697\u53f7\u5316\u30d5\u30a9\u30fc\u30de\u30c3\u30c8                     \u2502\n  \u2502    JOSE\uff08JWT/JWS/JWE\uff09\u306e CBOR \u7248                           \u2502\n  \u2502                                                             \u2502\n  \u2502  \u4f7f\u308f\u308c\u308b\u5834\u6240:                                              \u2502\n  \u2502    - WebAuthn/FIDO2\uff08attestation, assertion\uff09             \u2502\n  \u2502    - mdoc/mDL\uff08issuerAuth\uff09                               \u2502\n  \u2502    - CWT\uff08CBOR Web Token\uff09                                \u2502\n  \u2502                                                             \u2502\n  \u2502  \u4e3b\u8981\u306a\u69cb\u9020:                                                \u2502\n  \u2502    - COSE_Sign1: \u5358\u4e00\u7f72\u540d\uff08\u6700\u3082\u4e00\u822c\u7684\uff09                    \u2502\n  \u2502    - COSE_Key: \u9375\u306e\u8868\u73fe                                    \u2502\n  \u2502                                                             \u2502\n  \u2502  JOSE \u3068\u306e\u9055\u3044:                                             \u2502\n  \u2502    - \u6587\u5b57\u5217\u30ad\u30fc \u2192 \u6574\u6570\u30ad\u30fc\uff08\u30b3\u30f3\u30d1\u30af\u30c8\uff09                    \u2502\n  \u2502    - Base64URL \u2192 \u30d0\u30a4\u30ca\u30ea\uff08\u52b9\u7387\u7684\uff09                        \u2502\n  \u2502    - JSON \u2192 CBOR                                           \u2502\n  \u2502                                                             \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"\u53c2\u8003\u30ea\u30f3\u30af",children:"\u53c2\u8003\u30ea\u30f3\u30af"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc9052.html",children:"RFC 9052 - COSE"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc9053.html",children:"RFC 9053 - COSE Algorithms"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc8392.html",children:"RFC 8392 - CWT"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://www.iana.org/assignments/cose/cose.xhtml",children:"COSE Algorithms Registry"})}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(j,{...n})}):j(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>c});var s=r(96540);const d={},t=s.createContext(d);function i(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:i(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);