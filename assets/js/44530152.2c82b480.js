"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3035],{25241:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"content_10_ai_developer/ai-54-security-event-framework","title":"idp-server-security-event-framework","description":"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981","source":"@site/docs/content_10_ai_developer/ai-54-security-event-framework.md","sourceDirName":"content_10_ai_developer","slug":"/content_10_ai_developer/ai-54-security-event-framework","permalink":"/idp-server/docs/content_10_ai_developer/ai-54-security-event-framework","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_10_ai_developer/ai-54-security-event-framework.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"idp-server-email-aws-adapter","permalink":"/idp-server/docs/content_10_ai_developer/ai-53-email-aws"},"next":{"title":"idp-server-security-event-hooks","permalink":"/idp-server/docs/content_10_ai_developer/ai-55-security-event-hooks"}}');var i=t(74848),s=t(28453);const o={},c="idp-server-security-event-framework",a={},l=[{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",level:2},{value:"\u8cac\u52d9",id:"\u8cac\u52d9",level:3},{value:"\u4e3b\u8981\u6a5f\u80fd",id:"\u4e3b\u8981\u6a5f\u80fd",level:3},{value:"SSF Event Types",id:"ssf-event-types",level:2},{value:"SSF Hook Executor - Push Delivery\u5b9f\u88c5",id:"ssf-hook-executor---push-delivery\u5b9f\u88c5",level:2},{value:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8",id:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8",level:2},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"idp-server-security-event-framework",children:"idp-server-security-event-framework"})}),"\n",(0,i.jsx)(n.h2,{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",children:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,i.jsx)(n.code,{children:"libs/idp-server-security-event-framework/"}),"\n",(0,i.jsx)(n.strong,{children:"\u78ba\u8a8d\u65e5"}),": 2025-10-12"]}),"\n",(0,i.jsx)(n.h3,{id:"\u8cac\u52d9",children:"\u8cac\u52d9"}),"\n",(0,i.jsx)(n.p,{children:"Shared Signals Framework (SSF) \u306b\u3088\u308b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a4\u30d9\u30f3\u30c8\u914d\u4fe1\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u4ed5\u69d8"}),": ",(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-sse-framework-1_0.html",children:"Shared Signals Framework"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u4e3b\u8981\u6a5f\u80fd",children:"\u4e3b\u8981\u6a5f\u80fd"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Push Delivery"}),": Webhook\u914d\u4fe1"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pull Delivery"}),": Polling\u914d\u4fe1"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Types"}),": ",(0,i.jsx)(n.code,{children:"account-disabled"}),", ",(0,i.jsx)(n.code,{children:"credential-change"}),", ",(0,i.jsx)(n.code,{children:"session-revoked"}),"\u7b49"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security Event Token (SET)"}),": JWT\u5f62\u5f0f\u306e\u30a4\u30d9\u30f3\u30c8"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ssf-event-types",children:"SSF Event Types"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event Type"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"https://schemas.openid.net/secevent/risc/event-type/account-disabled"})}),(0,i.jsx)(n.td,{children:"\u30a2\u30ab\u30a6\u30f3\u30c8\u7121\u52b9\u5316"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"https://schemas.openid.net/secevent/risc/event-type/credential-change"})}),(0,i.jsx)(n.td,{children:"\u8a8d\u8a3c\u60c5\u5831\u5909\u66f4"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"https://schemas.openid.net/secevent/risc/event-type/session-revoked"})}),(0,i.jsx)(n.td,{children:"\u30bb\u30c3\u30b7\u30e7\u30f3\u7121\u52b9\u5316"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"https://schemas.openid.net/secevent/caep/event-type/token-claims-change"})}),(0,i.jsx)(n.td,{children:"\u30c8\u30fc\u30af\u30f3\u30af\u30ec\u30fc\u30e0\u5909\u66f4"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"ssf-hook-executor---push-delivery\u5b9f\u88c5",children:"SSF Hook Executor - Push Delivery\u5b9f\u88c5"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,i.jsx)(n.a,{href:"../../libs/idp-server-security-event-framework/src/main/java/org/idp/server/security/event/hook/ssf/SsfHookExecutor.java#L35-L176",children:"SsfHookExecutor.java:35-176"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'/**\n * SSF Hook Executor\uff08Push Delivery\uff09\n * \u78ba\u8a8d\u65b9\u6cd5: \u5b9f\u30d5\u30a1\u30a4\u30eb\u306e35-176\u884c\u76ee\n */\npublic class SsfHookExecutor implements SecurityEventHook {\n\n  HttpRequestExecutor httpRequestExecutor;\n  JsonConverter jsonConverter;\n\n  @Override\n  public SecurityEventHookType type() {\n    return StandardSecurityEventHookType.SSF.toHookType();\n  }\n\n  @Override\n  public SecurityEventHookResult execute(\n      Tenant tenant,\n      SecurityEvent securityEvent,\n      SecurityEventHookConfiguration hookConfiguration) {\n\n    long startTime = System.currentTimeMillis();\n\n    try {\n      // 1. SSF\u8a2d\u5b9a\u53d6\u5f97\n      SecurityEventConfig securityEventConfig = hookConfiguration.getEvent(securityEvent.type());\n      SharedSignalFrameworkMetadataConfig metadataConfig =\n          jsonConverter.read(hookConfiguration.metadata(), SharedSignalFrameworkMetadataConfig.class);\n      SecurityEventExecutionConfig executionConfig = securityEventConfig.execution();\n      SharedSignalFrameworkTransmissionConfig transmissionConfig =\n          jsonConverter.read(executionConfig.details(), SharedSignalFrameworkTransmissionConfig.class);\n\n      // 2. Security Event Token (SET) \u751f\u6210\n      SecurityEventTokenCreator securityEventTokenCreator =\n          new SecurityEventTokenCreator(securityEvent, metadataConfig, transmissionConfig);\n      SecurityEventToken securityEventToken = securityEventTokenCreator.create();\n\n      // 3. SSF\u9001\u4fe1\n      return send(\n          hookConfiguration,\n          securityEvent,\n          transmissionConfig.url(),\n          securityEventToken,\n          transmissionConfig,\n          startTime);\n\n    } catch (Exception e) {\n      long executionDurationMs = System.currentTimeMillis() - startTime;\n      return SecurityEventHookResult.failureWithContext(\n          hookConfiguration,\n          securityEvent,\n          null,\n          executionDurationMs,\n          e.getClass().getSimpleName(),\n          "SSF hook execution failed: " + e.getMessage());\n    }\n  }\n\n  private SecurityEventHookResult send(\n      SecurityEventHookConfiguration hookConfiguration,\n      SecurityEvent securityEvent,\n      String endpoint,\n      SecurityEventToken securityEventToken,\n      SharedSignalFrameworkTransmissionConfig transmissionConfig,\n      long startTime) {\n\n    // HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u69cb\u7bc9\n    HttpRequest httpRequest = HttpRequest.newBuilder()\n        .uri(new URI(endpoint))\n        .header("Content-Type", "application/secevent+jwt")\n        .POST(HttpRequest.BodyPublishers.ofString(securityEventToken.value()))\n        .build();\n\n    // OAuth\u8a8d\u8a3c\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u8ffd\u52a0\n    HttpRequestResult httpRequestResult =\n        (transmissionConfig.oauthAuthorization() != null)\n            ? httpRequestExecutor.executeWithOAuth(httpRequest, transmissionConfig.oauthAuthorization())\n            : httpRequestExecutor.execute(httpRequest);\n\n    long executionDurationMs = System.currentTimeMillis() - startTime;\n\n    // \u30ec\u30b9\u30dd\u30f3\u30b9\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\n    if (httpRequestResult.isSuccess()) {\n      return SecurityEventHookResult.successWithContext(\n          hookConfiguration, securityEvent, executionDetails, executionDurationMs);\n    } else {\n      return SecurityEventHookResult.failureWithContext(\n          hookConfiguration, securityEvent, executionDetails, executionDurationMs,\n          "SSF_ERROR", "SSF transmission failed");\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8",children:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.code,{children:"SecurityEventHook"})," \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u5b9f\u88c5"]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.code,{children:"SecurityEventTokenCreator"}),"\u306b\u3088\u308bSET\u751f\u6210"]}),"\n",(0,i.jsx)(n.li,{children:"\u2705 OAuth\u8a8d\u8a3c\u30aa\u30d7\u30b7\u30e7\u30f3\u5bfe\u5fdc"}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.code,{children:"SecurityEventHookResult"}),"\u306b\u3088\u308b\u7d50\u679c\u7ba1\u7406"]}),"\n",(0,i.jsx)(n.li,{children:"\u2705 \u5b9f\u884c\u6642\u9593\u8a08\u6e2c\uff08executionDurationMs\uff09"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f"}),": SSF Pull Delivery\u306e\u5b9f\u88c5\u306f\u73fe\u6642\u70b9\u3067\u672a\u78ba\u8a8d\u3002\u5b9f\u88c5\u304c\u5b58\u5728\u3059\u308b\u304b\u8981\u8abf\u67fb\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-50-notification-security-event",children:"\u901a\u77e5\u30fb\u30a4\u30d9\u30f3\u30c8\u5c64\u7d71\u5408\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})," - SSF\u3092\u542b\u3080\u5168\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a4\u30d9\u30f3\u30c8\u30e2\u30b8\u30e5\u30fc\u30eb"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-55-security-event-hooks",children:"idp-server-security-event-hooks"})," - Webhook/Slack/Datadog\u9023\u643a"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-12-platform",children:"idp-server-platform"})," - HttpRequestExecutor\uff08\u30ea\u30c8\u30e9\u30a4\u6a5f\u80fd\uff09"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/idp-server-security-event-framework/"}),"\u914d\u4e0b\u306e\u5b9f\u88c5\u30b3\u30fc\u30c9"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"../../libs/idp-server-security-event-framework/src/main/java/org/idp/server/security/event/hook/ssf/SsfHookExecutor.java",children:"SsfHookExecutor.java"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-sse-framework-1_0.html",children:"Shared Signals Framework"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-12"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var r=t(96540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);