"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[1221],{52996:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content_06_developer-guide/implementation-guides/oauth-oidc/fapi","title":"FAPI","description":"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051","source":"@site/docs/content_06_developer-guide/04-implementation-guides/oauth-oidc/fapi.md","sourceDirName":"content_06_developer-guide/04-implementation-guides/oauth-oidc","slug":"/content_06_developer-guide/implementation-guides/oauth-oidc/fapi","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/oauth-oidc/fapi","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_06_developer-guide/04-implementation-guides/oauth-oidc/fapi.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"OpenID Connect Discovery","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/oauth-oidc/discovery-metadata"},"next":{"title":"JOSE (JWT/JWS/JWE)","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/oauth-oidc/jose-handler"}}');var s=t(74848),l=t(28453);const c={},r="FAPI",a={},o=[{value:"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",id:"-\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",level:2},{value:"\ud83c\udfd7\ufe0f FAPI \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",id:"\ufe0f-fapi-\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",level:2},{value:"idp-server\u306eFAPI\u5bfe\u5fdc",id:"idp-server\u306efapi\u5bfe\u5fdc",level:3},{value:"\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u81ea\u52d5\u5224\u5b9a",id:"\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u81ea\u52d5\u5224\u5b9a",level:3},{value:"\ud83d\udccb FAPI Baseline Profile \u5b9f\u88c5",id:"-fapi-baseline-profile-\u5b9f\u88c5",level:2},{value:"\u6982\u8981",id:"\u6982\u8981",level:3},{value:"\u5b9f\u88c5: FapiBaselineVerifier",id:"\u5b9f\u88c5-fapibaselineverifier",level:3},{value:"1. \u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u691c\u8a3c",id:"1-\u30ea\u30c0\u30a4\u30ec\u30af\u30c8uri\u691c\u8a3c",level:3},{value:"shall require redirect URIs to be pre-registered",id:"shall-require-redirect-uris-to-be-pre-registered",level:4},{value:"shall require the redirect_uri in the authorization request",id:"shall-require-the-redirect_uri-in-the-authorization-request",level:4},{value:"shall require redirect URIs to use the https scheme",id:"shall-require-redirect-uris-to-use-the-https-scheme",level:4},{value:"2. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c",id:"2-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c",level:3},{value:"shall authenticate using one of: mTLS, client_secret_jwt, private_key_jwt",id:"shall-authenticate-using-one-of-mtls-client_secret_jwt-private_key_jwt",level:4},{value:"3. PKCE\u691c\u8a3c",id:"3-pkce\u691c\u8a3c",level:3},{value:"shall require RFC7636 with S256 as the code challenge method",id:"shall-require-rfc7636-with-s256-as-the-code-challenge-method",level:4},{value:"4. Nonce / State\u691c\u8a3c",id:"4-nonce--state\u691c\u8a3c",level:3},{value:"Client requesting openid scope: shall require the nonce parameter",id:"client-requesting-openid-scope-shall-require-the-nonce-parameter",level:4},{value:"Clients not requesting openid scope: shall require the state parameter",id:"clients-not-requesting-openid-scope-shall-require-the-state-parameter",level:4},{value:"\ud83d\udd10 FAPI Advance Profile \u5b9f\u88c5",id:"-fapi-advance-profile-\u5b9f\u88c5",level:2},{value:"\u6982\u8981",id:"\u6982\u8981-1",level:3},{value:"\u5b9f\u88c5: FapiAdvanceVerifier",id:"\u5b9f\u88c5-fapiadvanceverifier",level:3},{value:"1. Request Object \u5fc5\u9808",id:"1-request-object-\u5fc5\u9808",level:3},{value:"shall require a JWS signed JWT request object",id:"shall-require-a-jws-signed-jwt-request-object",level:4},{value:"2. Response Type / Response Mode \u691c\u8a3c",id:"2-response-type--response-mode-\u691c\u8a3c",level:3},{value:"shall require response_type code id_token, or code + response_mode jwt",id:"shall-require-response_type-code-id_token-or-code--response_mode-jwt",level:4},{value:"3. Sender-constrained Access Tokens",id:"3-sender-constrained-access-tokens",level:3},{value:"shall only issue sender-constrained access tokens",id:"shall-only-issue-sender-constrained-access-tokens",level:4},{value:"4. Request Object \u6709\u52b9\u671f\u9650\u691c\u8a3c",id:"4-request-object-\u6709\u52b9\u671f\u9650\u691c\u8a3c",level:3},{value:"shall require exp claim that has a lifetime of no longer than 60 minutes after nbf",id:"shall-require-exp-claim-that-has-a-lifetime-of-no-longer-than-60-minutes-after-nbf",level:4},{value:"5. Audience (aud) \u691c\u8a3c",id:"5-audience-aud-\u691c\u8a3c",level:3},{value:"shall require the aud claim to contain the OP&#39;s Issuer Identifier URL",id:"shall-require-the-aud-claim-to-contain-the-ops-issuer-identifier-url",level:4},{value:"6. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c\uff08Advance\u9650\u5b9a\uff09",id:"6-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3cadvance\u9650\u5b9a",level:3},{value:"shall authenticate using: tls_client_auth, self_signed_tls_client_auth, or private_key_jwt",id:"shall-authenticate-using-tls_client_auth-self_signed_tls_client_auth-or-private_key_jwt",level:4},{value:"7. Public Client \u7981\u6b62",id:"7-public-client-\u7981\u6b62",level:3},{value:"\ud83d\udd27 mTLS \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u5b9f\u88c5",id:"-mtls-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u5b9f\u88c5",level:2},{value:"TlsClientAuthAuthenticator",id:"tlsclientauthauthenticator",level:3},{value:"\ud83d\udccb \u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"-\u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:2},{value:"FAPI Baseline",id:"fapi-baseline",level:3},{value:"FAPI Advance",id:"fapi-advance",level:3},{value:"\ud83d\udea8 \u3088\u304f\u3042\u308b\u9593\u9055\u3044",id:"-\u3088\u304f\u3042\u308b\u9593\u9055\u3044",level:2},{value:"1. PKCE \u306e code_challenge_method",id:"1-pkce-\u306e-code_challenge_method",level:3},{value:"2. Request Object \u306e\u6709\u52b9\u671f\u9650",id:"2-request-object-\u306e\u6709\u52b9\u671f\u9650",level:3},{value:"3. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u65b9\u5f0f\u306e\u6df7\u540c",id:"3-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u65b9\u5f0f\u306e\u6df7\u540c",level:3},{value:"4. Response Mode \u306e\u6307\u5b9a\u5fd8\u308c",id:"4-response-mode-\u306e\u6307\u5b9a\u5fd8\u308c",level:3},{value:"\ud83d\udd17 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"fapi",children:"FAPI"})}),"\n",(0,s.jsx)(n.h2,{id:"-\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",children:"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5bfe\u8c61\u8aad\u8005"}),": \u91d1\u878d\u30b0\u30ec\u30fc\u30c9\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u3092\u5b9f\u88c5\u3057\u305f\u3044\u958b\u767a\u8005"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b66\u3079\u308b\u3053\u3068"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"FAPI Baseline / Advance Profile \u306e\u5b9f\u88c5\u8a73\u7d30"}),"\n",(0,s.jsx)(n.li,{children:"mTLS (Mutual TLS) \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u306e\u4ed5\u7d44\u307f"}),"\n",(0,s.jsx)(n.li,{children:"Sender-constrained Access Tokens \u306e\u5b9f\u88c5"}),"\n",(0,s.jsx)(n.li,{children:"PAR (Pushed Authorization Requests) \u306e\u5b9f\u88c5"}),"\n",(0,s.jsx)(n.li,{children:"JARM (JWT Secured Authorization Response Mode) \u306e\u5b9f\u88c5"}),"\n",(0,s.jsx)(n.li,{children:"Request Object \u691c\u8a3c\u306e\u8a73\u7d30"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u524d\u63d0\u77e5\u8b58"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../content_03_concepts/03-authentication-authorization/concept-06-fapi.md",children:"concept-22: FAPI"}),"\u306e\u7406\u89e3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../content_11_learning/02-oauth-fundamentals/oauth2-authorization-code-flow.md",children:"basic-08: \u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc"}),"\u306e\u7406\u89e3"]}),"\n",(0,s.jsx)(n.li,{children:"OAuth 2.0 / OIDC \u306e\u57fa\u790e\u77e5\u8b58"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-fapi-\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",children:"\ud83c\udfd7\ufe0f FAPI \u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"FAPI (Financial-grade API)"})," \u306f\u3001\u91d1\u878d\u53d6\u5f15\u306a\u3069\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u304c\u8981\u6c42\u3055\u308c\u308b\u74b0\u5883\u3067 OAuth 2.0/OIDC \u3092\u5b89\u5168\u306b\u5229\u7528\u3059\u308b\u305f\u3081\u306e\u4ed5\u69d8\u3067\u3059\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"idp-server\u306efapi\u5bfe\u5fdc",children:"idp-server\u306eFAPI\u5bfe\u5fdc"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb"}),(0,s.jsx)(n.th,{children:"\u7528\u9014"}),(0,s.jsx)(n.th,{children:"\u5b9f\u88c5\u30e2\u30b8\u30e5\u30fc\u30eb"}),(0,s.jsx)(n.th,{children:"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"FAPI Baseline"})}),(0,s.jsx)(n.td,{children:"\u8aad\u307f\u53d6\u308a\u5c02\u7528API"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"idp-server-core-extension-fapi"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"FapiBaselineVerifier"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"FAPI Advance"})}),(0,s.jsx)(n.td,{children:"\u66f8\u304d\u8fbc\u307fAPI"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"idp-server-core-extension-fapi"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"FapiAdvanceVerifier"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"FAPI CIBA"})}),(0,s.jsx)(n.td,{children:"\u30c7\u30d0\u30a4\u30b9\u5206\u96e2\u8a8d\u8a3c"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"idp-server-core-extension-fapi-ciba"})}),(0,s.jsx)(n.td,{children:"(CIBA\u30e2\u30b8\u30e5\u30fc\u30eb)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u81ea\u52d5\u5224\u5b9a",children:"\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u81ea\u52d5\u5224\u5b9a"}),"\n",(0,s.jsxs)(n.p,{children:["idp-server\u306f\u3001",(0,s.jsx)(n.strong,{children:"\u30ea\u30af\u30a8\u30b9\u30c8\u3055\u308c\u305f\u30b9\u30b3\u30fc\u30d7"}),"\u306b\u57fa\u3065\u3044\u3066FAPI\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u5224\u5b9a\u30ed\u30b8\u30c3\u30af\uff08\u512a\u5148\u9806\u4f4d\u9806\uff09:\n1. \u30b9\u30b3\u30fc\u30d7\u304c fapiAdvanceScopes \u306b\u4e00\u81f4 \u2192 FAPI Advance\n2. \u30b9\u30b3\u30fc\u30d7\u304c fapiBaselineScopes \u306b\u4e00\u81f4 \u2192 FAPI Baseline\n3. \u30b9\u30b3\u30fc\u30d7\u306b openid \u304c\u542b\u307e\u308c\u308b \u2192 OIDC\n4. \u305d\u308c\u4ee5\u5916 \u2192 OAuth 2.0\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u30c6\u30ca\u30f3\u30c8\u8a2d\u5b9a\u4f8b"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "extension": {\n    "fapi_baseline_scopes": ["read", "account"],\n    "fapi_advance_scopes": ["write", "transfers", "payment_initiation"]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-fapi-baseline-profile-\u5b9f\u88c5",children:"\ud83d\udccb FAPI Baseline Profile \u5b9f\u88c5"}),"\n",(0,s.jsx)(n.h3,{id:"\u6982\u8981",children:"\u6982\u8981"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"FAPI Baseline"})," \u306f\u3001\u8aad\u307f\u53d6\u308a\u5c02\u7528API\uff08\u6b8b\u9ad8\u7167\u4f1a\u3001\u53d6\u5f15\u5c65\u6b74\u53c2\u7167\u7b49\uff09\u5411\u3051\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u4e3b\u8981\u8981\u4ef6"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 \u7f72\u540d\u4ed8\u304d\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff08PS256/ES256\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 PKCE\u5fc5\u9808\uff08S256\u306e\u307f\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u5f37\u56fa\u306a\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\uff08private_key_jwt \u307e\u305f\u306f mTLS\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 HTTPS\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u5fc5\u9808"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 nonce\uff08OIDC\u306e\u5834\u5408\uff09\u307e\u305f\u306f state\uff08OAuth 2.0\u306e\u5834\u5408\uff09\u5fc5\u9808"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9f\u88c5-fapibaselineverifier",children:"\u5b9f\u88c5: FapiBaselineVerifier"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class FapiBaselineVerifier implements AuthorizationRequestVerifier {\n\n  OAuthRequestBaseVerifier oAuthRequestBaseVerifier = new OAuthRequestBaseVerifier();\n  OidcRequestBaseVerifier oidcRequestBaseVerifier = new OidcRequestBaseVerifier();\n\n  public AuthorizationProfile profile() {\n    return AuthorizationProfile.FAPI_BASELINE;\n  }\n\n  @Override\n  public void verify(OAuthRequestContext context) {\n    // 1. \u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u691c\u8a3c\n    throwExceptionIfUnregisteredRedirectUri(context);\n    throwExceptionIfNotContainsRedirectUri(context);\n    throwExceptionUnMatchRedirectUri(context);\n    throwExceptionIfNotHttpsRedirectUri(context);\n\n    // 2. \u57fa\u672c\u691c\u8a3c\uff08OIDC or OAuth 2.0\uff09\n    if (context.isOidcRequest()) {\n      oidcRequestBaseVerifier.verify(context);\n    } else {\n      oAuthRequestBaseVerifier.verify(context);\n    }\n\n    // 3. FAPI Baseline\u56fa\u6709\u691c\u8a3c\n    throwExceptionIfClientSecretPostOrClientSecretBasic(context);\n    throwExceptionIfNotS256CodeChallengeMethod(context);\n    throwExceptionIfHasOpenidScopeAndNotContainsNonce(context);\n    throwExceptionIfNotHasOpenidScopeAndNotContainsState(context);\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/FapiBaselineVerifier.java#L31",children:"FapiBaselineVerifier.java:31"})]}),"\n",(0,s.jsx)(n.h3,{id:"1-\u30ea\u30c0\u30a4\u30ec\u30af\u30c8uri\u691c\u8a3c",children:"1. \u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI\u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-redirect-uris-to-be-pre-registered",children:"shall require redirect URIs to be pre-registered"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfUnregisteredRedirectUri(OAuthRequestContext context) {\n  ClientConfiguration clientConfiguration = context.clientConfiguration();\n  if (!clientConfiguration.hasRedirectUri()) {\n    throw new OAuthBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require redirect URIs to be pre-registered",\n        context.tenant());\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-the-redirect_uri-in-the-authorization-request",children:"shall require the redirect_uri in the authorization request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotContainsRedirectUri(OAuthRequestContext context) {\n  if (!context.hasRedirectUriInRequest()) {\n    throw new OAuthBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require the redirect_uri in the authorization request",\n        context.tenant());\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-redirect-uris-to-use-the-https-scheme",children:"shall require redirect URIs to use the https scheme"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotHttpsRedirectUri(OAuthRequestContext context) {\n  RedirectUri redirectUri = context.redirectUri();\n  if (!redirectUri.isHttps()) {\n    throw new OAuthBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require redirect URIs to use the https scheme",\n        context.tenant());\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"2-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c",children:"2. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-authenticate-using-one-of-mtls-client_secret_jwt-private_key_jwt",children:"shall authenticate using one of: mTLS, client_secret_jwt, private_key_jwt"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfClientSecretPostOrClientSecretBasic(OAuthRequestContext context) {\n  ClientAuthenticationType clientAuthenticationType = context.clientAuthenticationType();\n\n  // client_secret_basic \u306f\u7981\u6b62\n  if (clientAuthenticationType.isClientSecretBasic()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Baseline profile, client_secret_basic MUST not be used",\n        context);\n  }\n\n  // client_secret_post \u306f\u7981\u6b62\n  if (clientAuthenticationType.isClientSecretPost()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Baseline profile, client_secret_post MUST not be used",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8a31\u53ef\u3055\u308c\u308b\u8a8d\u8a3c\u65b9\u5f0f"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"private_key_jwt"})," - \u79d8\u5bc6\u9375\u306b\u3088\u308bJWT\u7f72\u540d"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"client_secret_jwt"})," - \u5171\u6709\u79d8\u5bc6\u306b\u3088\u308bJWT\u7f72\u540d"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"tls_client_auth"})," - mTLS\uff08\u8a3c\u660e\u66f8\u306b\u3088\u308b\u8a8d\u8a3c\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"self_signed_tls_client_auth"})," - \u81ea\u5df1\u7f72\u540d\u8a3c\u660e\u66f8\u306b\u3088\u308b\u8a8d\u8a3c"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-pkce\u691c\u8a3c",children:"3. PKCE\u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-rfc7636-with-s256-as-the-code-challenge-method",children:"shall require RFC7636 with S256 as the code challenge method"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotS256CodeChallengeMethod(OAuthRequestContext context) {\n  AuthorizationRequest authorizationRequest = context.authorizationRequest();\n\n  // code_challenge \u3068 code_challenge_method \u304c\u5fc5\u9808\n  if (!authorizationRequest.hasCodeChallenge()\n      || !authorizationRequest.hasCodeChallengeMethod()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, authorization request must contain code_challenge and code_challenge_method(S256).",\n        context);\n  }\n\n  // code_challenge_method \u306f S256 \u306e\u307f\n  if (!authorizationRequest.codeChallengeMethod().isS256()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require RFC7636 with S256 as the code challenge method.",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"PKCE\u691c\u8a3c\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"1. \u8a8d\u53ef\u30ea\u30af\u30a8\u30b9\u30c8:   code_challenge=xxx&code_challenge_method=S256\n2. \u8a8d\u53ef\u30b3\u30fc\u30c9\u767a\u884c:   code=yyy\n3. \u30c8\u30fc\u30af\u30f3\u30ea\u30af\u30a8\u30b9\u30c8: code=yyy&code_verifier=zzz\n4. \u691c\u8a3c:             SHA256(zzz) == xxx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-nonce--state\u691c\u8a3c",children:"4. Nonce / State\u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"client-requesting-openid-scope-shall-require-the-nonce-parameter",children:"Client requesting openid scope: shall require the nonce parameter"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfHasOpenidScopeAndNotContainsNonce(OAuthRequestContext context) {\n  if (!context.hasOpenidScope()) {\n    return;  // openid \u30b9\u30b3\u30fc\u30d7\u306a\u3057\u306e\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\n  }\n\n  if (!context.authorizationRequest().hasNonce()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require the nonce parameter in the authentication request.",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"clients-not-requesting-openid-scope-shall-require-the-state-parameter",children:"Clients not requesting openid scope: shall require the state parameter"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotHasOpenidScopeAndNotContainsState(OAuthRequestContext context) {\n  if (context.hasOpenidScope()) {\n    return;  // openid \u30b9\u30b3\u30fc\u30d7\u3042\u308a\u306e\u5834\u5408\u306f\u30b9\u30ad\u30c3\u30d7\n  }\n\n  if (!context.authorizationRequest().hasState()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Baseline profile, shall require the state parameter.",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-fapi-advance-profile-\u5b9f\u88c5",children:"\ud83d\udd10 FAPI Advance Profile \u5b9f\u88c5"}),"\n",(0,s.jsx)(n.h3,{id:"\u6982\u8981-1",children:"\u6982\u8981"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"FAPI Advance"})," \u306f\u3001\u66f8\u304d\u8fbc\u307fAPI\uff08\u9001\u91d1\u5b9f\u884c\u3001\u53e3\u5ea7\u8a2d\u5b9a\u5909\u66f4\u7b49\uff09\u5411\u3051\u306e\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Baseline\u306b\u8ffd\u52a0\u3055\u308c\u308b\u8981\u4ef6"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 PAR\uff08Pushed Authorization Requests\uff09\u5fc5\u9808"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 JARM\uff08JWT Secured Authorization Response\uff09\u5fc5\u9808"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Sender-constrained \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u5fc5\u9808\uff08mTLS binding\uff09"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Request Object \u6709\u52b9\u671f\u9650: \u6700\u592760\u5206"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"aud"})," claim\u5fc5\u9808\uff08Issuer URL\uff09"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Public\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u7981\u6b62"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"client_secret_jwt"})," \u3082\u7981\u6b62\uff08",(0,s.jsx)(n.code,{children:"private_key_jwt"})," \u307e\u305f\u306f mTLS \u306e\u307f\uff09"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9f\u88c5-fapiadvanceverifier",children:"\u5b9f\u88c5: FapiAdvanceVerifier"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class FapiAdvanceVerifier implements AuthorizationRequestVerifier {\n\n  public AuthorizationProfile profile() {\n    return AuthorizationProfile.FAPI_ADVANCE;\n  }\n\n  @Override\n  public void verify(OAuthRequestContext context) {\n    // 1. \u8a2d\u5b9a\u691c\u8a3c\n    throwIfExceptionInvalidConfig(context);\n\n    // 2. \u57fa\u672c\u691c\u8a3c\n    if (context.isOidcRequest()) {\n      oidcRequestBaseVerifier.verify(context);\n    } else {\n      oAuthRequestBaseVerifier.verify(context);\n    }\n\n    // 3. FAPI Advance\u56fa\u6709\u691c\u8a3c\n    throwExceptionIfNotRRequestParameterPattern(context);\n    throwExceptionIfInvalidResponseTypeAndResponseMode(context);\n    throwIfNotSenderConstrainedAccessToken(context);\n    throwExceptionIfNotContainExpAndNbfAndExp60minutesLongerThanNbf(context);\n    throwExceptionIfNotContainsAud(context);\n    throwExceptionIfClientSecretPostOrClientSecretBasicOrClientSecretJwt(context);\n    throwExceptionIfPublicClient(context);\n    throwExceptionIfNotContainNbfAnd60minutesLongerThan(context);\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/FapiAdvanceVerifier.java#L34",children:"FapiAdvanceVerifier.java:34"})]}),"\n",(0,s.jsx)(n.h3,{id:"1-request-object-\u5fc5\u9808",children:"1. Request Object \u5fc5\u9808"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-a-jws-signed-jwt-request-object",children:"shall require a JWS signed JWT request object"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotRRequestParameterPattern(OAuthRequestContext context) {\n  if (!context.isRequestParameterPattern()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Advance profile, shall require a JWS signed JWT request object passed by value with the request parameter or by reference with the request_uri parameter",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Request Object \u30d1\u30bf\u30fc\u30f3"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"By Value"}),": ",(0,s.jsx)(n.code,{children:"request=eyJhbGciOiJQUzI1NiIs..."})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"By Reference"}),": ",(0,s.jsx)(n.code,{children:"request_uri=https://client.example.com/request/abcd1234"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-response-type--response-mode-\u691c\u8a3c",children:"2. Response Type / Response Mode \u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-response_type-code-id_token-or-code--response_mode-jwt",children:"shall require response_type code id_token, or code + response_mode jwt"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfInvalidResponseTypeAndResponseMode(OAuthRequestContext context) {\n  // \u30d1\u30bf\u30fc\u30f31: response_type=code id_token (Hybrid Flow)\n  if (context.responseType().isCodeIdToken()) {\n    return;\n  }\n\n  // \u30d1\u30bf\u30fc\u30f32: response_type=code&response_mode=jwt (JARM)\n  if (context.responseType().isCode() && context.responseMode().isJwt()) {\n    return;\n  }\n\n  throw new OAuthRedirectableBadRequestException(\n      "invalid_request",\n      "When FAPI Advance profile, shall require the response_type value code id_token, or the response_type value code in conjunction with the response_mode value jwt",\n      context);\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8a31\u53ef\u3055\u308c\u308b\u30d1\u30bf\u30fc\u30f3"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"response_type=code id_token"})," - Hybrid Flow"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"response_type=code&response_mode=jwt"})," - JARM"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-sender-constrained-access-tokens",children:"3. Sender-constrained Access Tokens"}),"\n",(0,s.jsx)(n.h4,{id:"shall-only-issue-sender-constrained-access-tokens",children:"shall only issue sender-constrained access tokens"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwIfNotSenderConstrainedAccessToken(OAuthRequestContext context) {\n  AuthorizationServerConfiguration authorizationServerConfiguration =\n      context.serverConfiguration();\n  ClientConfiguration clientConfiguration = context.clientConfiguration();\n\n  // \u30b5\u30fc\u30d0\u30fc\u5074\u3067\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u304b\n  if (!authorizationServerConfiguration.isTlsClientCertificateBoundAccessTokens()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Advance profile, shall only issue sender-constrained access tokens, but server tls_client_certificate_bound_access_tokens is false",\n        context);\n  }\n\n  // \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067\u6709\u52b9\u5316\u3055\u308c\u3066\u3044\u308b\u304b\n  if (!clientConfiguration.isTlsClientCertificateBoundAccessTokens()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request",\n        "When FAPI Advance profile, shall only issue sender-constrained access tokens, but client tls_client_certificate_bound_access_tokens is false",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Sender-constrained Access Tokens \u306e\u4ed5\u7d44\u307f"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'1. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u306e\u30b5\u30e0\u30d7\u30ea\u30f3\u30c8\uff08SHA-256\uff09\u3092\u8a08\u7b97\n2. \u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\uff08JWT\uff09\u306e cnf \u30af\u30ec\u30fc\u30e0\u306b\u683c\u7d0d\n   {\n     "cnf": {\n       "x5t#S256": "bwcK0esc3ACC3DB2Y5_lESsXE8o9ltc05O89jdN-dg2"\n     }\n   }\n3. API\u547c\u3073\u51fa\u3057\u6642\u3001\u30b5\u30fc\u30d0\u30fc\u306f\u8a3c\u660e\u66f8\u3068\u30b5\u30e0\u30d7\u30ea\u30f3\u30c8\u3092\u7167\u5408\n4. \u4e00\u81f4\u3057\u305f\u5834\u5408\u306e\u307fAPI\u30a2\u30af\u30bb\u30b9\u3092\u8a31\u53ef\n'})}),"\n",(0,s.jsx)(n.h3,{id:"4-request-object-\u6709\u52b9\u671f\u9650\u691c\u8a3c",children:"4. Request Object \u6709\u52b9\u671f\u9650\u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-exp-claim-that-has-a-lifetime-of-no-longer-than-60-minutes-after-nbf",children:"shall require exp claim that has a lifetime of no longer than 60 minutes after nbf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotContainExpAndNbfAndExp60minutesLongerThanNbf(\n    OAuthRequestContext context) {\n\n  JoseContext joseContext = context.joseContext();\n  JsonWebTokenClaims claims = joseContext.claims();\n\n  // exp \u30af\u30ec\u30fc\u30e0\u5fc5\u9808\n  if (!claims.hasExp()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request_object",\n        "When FAPI Advance profile, shall require the request object to contain an exp claim",\n        context);\n  }\n\n  // nbf \u30af\u30ec\u30fc\u30e0\u5fc5\u9808\n  if (!claims.hasNbf()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request_object",\n        "When FAPI Advance profile, shall require the request object to contain an nbf claim",\n        context);\n  }\n\n  // exp - nbf <= 60\u5206\n  Date exp = claims.getExp();\n  Date nbf = claims.getNbf();\n  if (exp.getTime() - nbf.getTime() > 3600001) {  // 60\u5206 + 1\u30df\u30ea\u79d2\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request_object",\n        "When FAPI Advance profile, shall require the request object to contain an exp claim that has a lifetime of no longer than 60 minutes after the nbf claim",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"5-audience-aud-\u691c\u8a3c",children:"5. Audience (aud) \u691c\u8a3c"}),"\n",(0,s.jsx)(n.h4,{id:"shall-require-the-aud-claim-to-contain-the-ops-issuer-identifier-url",children:"shall require the aud claim to contain the OP's Issuer Identifier URL"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfNotContainsAud(OAuthRequestContext context) {\n  JoseContext joseContext = context.joseContext();\n  JsonWebTokenClaims claims = joseContext.claims();\n\n  // aud \u30af\u30ec\u30fc\u30e0\u5fc5\u9808\n  if (!claims.hasAud()) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request_object",\n        "When FAPI Advance profile, shall require the request object to contain an aud claim",\n        context);\n  }\n\n  // aud \u306b Issuer URL \u304c\u542b\u307e\u308c\u3066\u3044\u308b\u304b\n  List<String> aud = claims.getAud();\n  if (!aud.contains(context.tokenIssuer().value())) {\n    throw new OAuthRedirectableBadRequestException(\n        "invalid_request_object",\n        String.format(\n            "When FAPI Advance profile, shall require the aud claim in the request object to contain the OP\'s Issuer Identifier URL (%s)",\n            String.join(" ", aud)),\n        context);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"6-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3cadvance\u9650\u5b9a",children:"6. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u691c\u8a3c\uff08Advance\u9650\u5b9a\uff09"}),"\n",(0,s.jsx)(n.h4,{id:"shall-authenticate-using-tls_client_auth-self_signed_tls_client_auth-or-private_key_jwt",children:"shall authenticate using: tls_client_auth, self_signed_tls_client_auth, or private_key_jwt"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfClientSecretPostOrClientSecretBasicOrClientSecretJwt(\n    OAuthRequestContext context) {\n\n  ClientAuthenticationType clientAuthenticationType = context.clientAuthenticationType();\n\n  // client_secret_basic \u7981\u6b62\n  if (clientAuthenticationType.isClientSecretBasic()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Advance profile, client_secret_basic MUST not be used",\n        context);\n  }\n\n  // client_secret_post \u7981\u6b62\n  if (clientAuthenticationType.isClientSecretPost()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Advance profile, client_secret_post MUST not be used",\n        context);\n  }\n\n  // client_secret_jwt \u3082\u7981\u6b62\uff08Advance \u3067\u306f\uff09\n  if (clientAuthenticationType.isClientSecretJwt()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Advance profile, client_secret_jwt MUST not be used",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"FAPI Advance \u3067\u8a31\u53ef\u3055\u308c\u308b\u8a8d\u8a3c\u65b9\u5f0f"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"private_key_jwt"})," - \u79d8\u5bc6\u9375\u306b\u3088\u308bJWT\u7f72\u540d"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"tls_client_auth"})," - mTLS\uff08\u8a3c\u660e\u66f8\u306b\u3088\u308b\u8a8d\u8a3c\uff09"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"self_signed_tls_client_auth"})," - \u81ea\u5df1\u7f72\u540d\u8a3c\u660e\u66f8\u306b\u3088\u308b\u8a8d\u8a3c"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"FAPI Baseline \u3067\u8a31\u53ef\u3055\u308c\u308b\u8a8d\u8a3c\u65b9\u5f0f"}),"\uff08\u53c2\u8003\uff09:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"private_key_jwt"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"client_secret_jwt"})," \u2190 Advance\u3067\u306f\u7981\u6b62"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"tls_client_auth"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"self_signed_tls_client_auth"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"7-public-client-\u7981\u6b62",children:"7. Public Client \u7981\u6b62"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'void throwExceptionIfPublicClient(OAuthRequestContext context) {\n  ClientAuthenticationType clientAuthenticationType = context.clientAuthenticationType();\n\n  if (clientAuthenticationType.isNone()) {\n    throw new OAuthRedirectableBadRequestException(\n        "unauthorized_client",\n        "When FAPI Advance profile, shall not support public clients",\n        context);\n  }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-mtls-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u5b9f\u88c5",children:"\ud83d\udd27 mTLS \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u5b9f\u88c5"}),"\n",(0,s.jsx)(n.h3,{id:"tlsclientauthauthenticator",children:"TlsClientAuthAuthenticator"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"tls_client_auth"})," \u65b9\u5f0f\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class TlsClientAuthAuthenticator implements ClientAuthenticator {\n\n  @Override\n  public ClientAuthenticationType type() {\n    return ClientAuthenticationType.tls_client_auth;\n  }\n\n  @Override\n  public ClientCredentials authenticate(BackchannelRequestContext context) {\n    RequestedClientId requestedClientId = context.requestedClientId();\n\n    // 1. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a3c\u660e\u66f8\u304c\u5b58\u5728\u3059\u308b\u304b\u78ba\u8a8d\n    throwExceptionIfNotContainsClientCert(context);\n\n    // 2. X.509\u8a3c\u660e\u66f8\u3092\u30d1\u30fc\u30b9\u3057\u3066\u691c\u8a3c\n    X509Certification x509Certification = parseOrThrowExceptionIfNoneMatch(context);\n\n    // 3. ClientCredentials\u751f\u6210\n    ClientCertification clientCertification = new ClientCertification(x509Certification);\n\n    return new ClientCredentials(\n        requestedClientId,\n        ClientAuthenticationType.tls_client_auth,\n        new ClientSecret(),\n        new ClientAuthenticationPublicKey(),\n        new ClientAssertionJwt(),\n        clientCertification);\n  }\n\n  X509Certification parseOrThrowExceptionIfNoneMatch(BackchannelRequestContext context) {\n    ClientCert clientCert = context.clientCert();\n    X509Certification x509Certification = X509Certification.parse(clientCert.plainValue());\n    ClientConfiguration clientConfiguration = context.clientConfiguration();\n\n    // \u8a3c\u660e\u66f8\u691c\u8a3c\uff083\u3064\u306e\u65b9\u5f0f\u306e\u3044\u305a\u308c\u304b\u3067\u4e00\u81f4\uff09\n    // 1. tls_client_auth_subject_dn\n    if (x509Certification.subject().equals(clientConfiguration.tlsClientAuthSubjectDn())) {\n      return x509Certification;\n    }\n\n    // 2. tls_client_auth_san_dns (dNSName)\n    if (x509Certification.hasDNSName()\n        && x509Certification.dNSName().equals(clientConfiguration.tlsClientAuthSanDns())) {\n      return x509Certification;\n    }\n\n    // 3. tls_client_auth_san_uri (uniformResourceIdentifier)\n    if (x509Certification.hasUniformResourceIdentifier()\n        && x509Certification.uniformResourceIdentifier()\n            .equals(clientConfiguration.tlsClientAuthSanUri())) {\n      return x509Certification;\n    }\n\n    throw new ClientUnAuthorizedException("client certificate verification failed");\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/TlsClientAuthAuthenticator.java#L35",children:"TlsClientAuthAuthenticator.java:35"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u8a3c\u660e\u66f8\u691c\u8a3c\u65b9\u5f0f"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"subject DN"}),": \u8a3c\u660e\u66f8\u306eSubject Distinguished Name\u3067\u691c\u8a3c"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SAN DNS"}),": Subject Alternative Name \u306e dNSName \u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u691c\u8a3c"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SAN URI"}),": Subject Alternative Name \u306e uniformResourceIdentifier \u30d5\u30a3\u30fc\u30eb\u30c9\u3067\u691c\u8a3c"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-\u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\ud83d\udccb \u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,s.jsx)(n.p,{children:"FAPI\u5bfe\u5fdc\u3092\u5b9f\u88c5\u3059\u308b\u969b\u306e\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8:"}),"\n",(0,s.jsx)(n.h3,{id:"fapi-baseline",children:"FAPI Baseline"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URI"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u4e8b\u524d\u767b\u9332\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HTTPS\u30b9\u30ad\u30fc\u30e0\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u5b8c\u5168\u4e00\u81f4\u691c\u8a3c"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"PKCE"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","S256\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"code_challenge"})," / ",(0,s.jsx)(n.code,{children:"code_challenge_method"})," \u30d1\u30e9\u30e1\u30fc\u30bf\u5fc5\u9808"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"client_secret_basic"})," \u7981\u6b62"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"client_secret_post"})," \u7981\u6b62"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"private_key_jwt"}),", ",(0,s.jsx)(n.code,{children:"client_secret_jwt"}),", ",(0,s.jsx)(n.code,{children:"tls_client_auth"}),", ",(0,s.jsx)(n.code,{children:"self_signed_tls_client_auth"})," \u306e\u3044\u305a\u308c\u304b"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Nonce / State"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"openid"})," \u30b9\u30b3\u30fc\u30d7\u3042\u308a \u2192 ",(0,s.jsx)(n.code,{children:"nonce"})," \u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"openid"})," \u30b9\u30b3\u30fc\u30d7\u306a\u3057 \u2192 ",(0,s.jsx)(n.code,{children:"state"})," \u5fc5\u9808"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"fapi-advance",children:"FAPI Advance"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Baseline\u8981\u4ef6"}),": \u4e0a\u8a18\u3059\u3079\u3066\u6e80\u305f\u3059"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Request Object"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","JWS\u7f72\u540d\u4ed8\u304dRequest Object\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"exp"})," \u30af\u30ec\u30fc\u30e0\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"nbf"})," \u30af\u30ec\u30fc\u30e0\u5fc5\u9808"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"exp - nbf <= 60\u5206"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"aud"})," \u30af\u30ec\u30fc\u30e0\u5fc5\u9808\uff08Issuer URL\u542b\u3080\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"nbf"})," \u304c60\u5206\u4ee5\u4e0a\u904e\u53bb\u3067\u306a\u3044"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Response Type / Mode"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"response_type=code id_token"})," \u307e\u305f\u306f"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"response_type=code&response_mode=jwt"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Sender-constrained Access Tokens"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a\u3067 ",(0,s.jsx)(n.code,{children:"tls_client_certificate_bound_access_tokens=true"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a2d\u5b9a\u3067 ",(0,s.jsx)(n.code,{children:"tls_client_certificate_bound_access_tokens=true"})]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3\u306b ",(0,s.jsx)(n.code,{children:"cnf.x5t#S256"})," \u542b\u3080"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"client_secret_jwt"})," \u3082\u7981\u6b62"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"private_key_jwt"}),", ",(0,s.jsx)(n.code,{children:"tls_client_auth"}),", ",(0,s.jsx)(n.code,{children:"self_signed_tls_client_auth"})," \u306e\u3044\u305a\u308c\u304b"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.strong,{children:"Public Client"}),":"]}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u7981\u6b62"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-\u3088\u304f\u3042\u308b\u9593\u9055\u3044",children:"\ud83d\udea8 \u3088\u304f\u3042\u308b\u9593\u9055\u3044"}),"\n",(0,s.jsx)(n.h3,{id:"1-pkce-\u306e-code_challenge_method",children:"1. PKCE \u306e code_challenge_method"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: plain \u3092\u8a31\u53ef\u3057\u3066\u3057\u307e\u3046\nif (authorizationRequest.hasCodeChallenge()) {\n  // OK\n}\n\n// \u2705 \u6b63\u3057\u3044: S256 \u5fc5\u9808\nif (authorizationRequest.hasCodeChallenge()\n    && authorizationRequest.codeChallengeMethod().isS256()) {\n  // OK\n} else {\n  throw new OAuthRedirectableBadRequestException("code_challenge_method must be S256");\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"2-request-object-\u306e\u6709\u52b9\u671f\u9650",children:"2. Request Object \u306e\u6709\u52b9\u671f\u9650"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u274c \u8aa4\u308a: exp\u306e\u307f\u30c1\u30a7\u30c3\u30af\nif (claims.hasExp()) {\n  // OK\n}\n\n// \u2705 \u6b63\u3057\u3044: exp \u3068 nbf \u306e\u4e21\u65b9\u3092\u30c1\u30a7\u30c3\u30af + \u5dee\u520660\u5206\u4ee5\u5185\nif (claims.hasExp() && claims.hasNbf()) {\n  Date exp = claims.getExp();\n  Date nbf = claims.getNbf();\n  if (exp.getTime() - nbf.getTime() <= 3600000) {  // 60\u5206\n    // OK\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u65b9\u5f0f\u306e\u6df7\u540c",children:"3. \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u65b9\u5f0f\u306e\u6df7\u540c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: FAPI Advance \u3067 client_secret_jwt \u3092\u8a31\u53ef\n// Baseline \u3067\u306f OK \u3060\u304c Advance \u3067\u306f NG\n\n// \u2705 \u6b63\u3057\u3044: Advance \u3067\u306f\u7981\u6b62\nif (profile == AuthorizationProfile.FAPI_ADVANCE) {\n  if (clientAuthenticationType.isClientSecretJwt()) {\n    throw new OAuthRedirectableBadRequestException("client_secret_jwt not allowed in FAPI Advance");\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"4-response-mode-\u306e\u6307\u5b9a\u5fd8\u308c",children:"4. Response Mode \u306e\u6307\u5b9a\u5fd8\u308c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u274c \u8aa4\u308a: response_type=code \u306e\u307f\u6307\u5b9a\n// FAPI Advance \u3067\u306f response_mode=jwt \u3082\u5fc5\u8981\n\n// \u2705 \u6b63\u3057\u3044: response_type=code&response_mode=jwt\nif (context.responseType().isCode() && context.responseMode().isJwt()) {\n  // OK\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\ud83d\udd17 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6982\u5ff5\u30fb\u57fa\u790e"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../content_03_concepts/03-authentication-authorization/concept-06-fapi.md",children:"concept-22: FAPI"})," - FAPI\u6982\u5ff5\u8aac\u660e"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../content_11_learning/02-oauth-fundamentals/oauth2-authorization-code-flow.md",children:"basic-08: \u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc"})," - \u57fa\u672c\u30d5\u30ed\u30fc"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5b9f\u88c5\u8a73\u7d30"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"./impl-12-plugin-implementation.md",children:"impl-12: Plugin\u5b9f\u88c5\u30ac\u30a4\u30c9"})," - \u30d7\u30e9\u30b0\u30a4\u30f3\u30b7\u30b9\u30c6\u30e0"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../03-application-plane/02-authorization-flow.md",children:"03-application-plane/02-authorization-flow.md"})," - \u8a8d\u53ef\u30d5\u30ed\u30fc"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../03-application-plane/10-client-authentication.md",children:"03-application-plane/10-client-authentication.md"})," - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u53c2\u8003\u5b9f\u88c5\u30af\u30e9\u30b9"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/FapiBaselineVerifier.java",children:"FapiBaselineVerifier.java"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/FapiAdvanceVerifier.java",children:"FapiAdvanceVerifier.java"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../../../libs/idp-server-core-extension-fapi/src/main/java/org/idp/server/core/openid/extension/fapi/TlsClientAuthAuthenticator.java",children:"TlsClientAuthAuthenticator.java"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"RFC/\u4ed5\u69d8"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://openid.net/specs/openid-financial-api-part-1-1_0.html",children:"Financial-grade API Security Profile 1.0 - Part 1: Baseline"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://openid.net/specs/openid-financial-api-part-2-1_0.html",children:"Financial-grade API Security Profile 1.0 - Part 2: Advanced"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7636",children:"RFC 7636 - Proof Key for Code Exchange (PKCE)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc8705",children:"RFC 8705 - OAuth 2.0 Mutual-TLS Client Authentication"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-12-07\n",(0,s.jsx)(n.strong,{children:"\u96e3\u6613\u5ea6"}),": \u2b50\u2b50\u2b50\u2b50 (\u4e0a\u7d1a)"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>r});var i=t(96540);const s={},l=i.createContext(s);function c(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);