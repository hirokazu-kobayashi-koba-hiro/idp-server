"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[93619],{6880:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"content_11_learning/kubernetes/dockerfile-best-practices","title":"Dockerfile \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9","description":"\u52b9\u7387\u7684\u3067\u5b89\u5168\u306a\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eDockerfile\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u3092\u5b66\u3073\u307e\u3059\u3002","source":"@site/docs/content_11_learning/13-kubernetes/dockerfile-best-practices.md","sourceDirName":"content_11_learning/13-kubernetes","slug":"/content_11_learning/kubernetes/dockerfile-best-practices","permalink":"/idp-server/docs/content_11_learning/kubernetes/dockerfile-best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/13-kubernetes/dockerfile-best-practices.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u30b3\u30f3\u30c6\u30ca\u6280\u8853\u306e\u57fa\u790e","permalink":"/idp-server/docs/content_11_learning/kubernetes/container-basics"},"next":{"title":"Docker Compose","permalink":"/idp-server/docs/content_11_learning/kubernetes/docker-compose"}}');var l=r(74848),d=r(28453);const s={},c="Dockerfile \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",a={},t=[{value:"\u76ee\u6b21",id:"\u76ee\u6b21",level:2},{value:"Dockerfile\u306e\u57fa\u672c\u69cb\u9020",id:"dockerfile\u306e\u57fa\u672c\u69cb\u9020",level:2},{value:"\u57fa\u672c\u7684\u306aDockerfile",id:"\u57fa\u672c\u7684\u306adockerfile",level:3},{value:"\u4e3b\u8981\u306a\u547d\u4ee4",id:"\u4e3b\u8981\u306a\u547d\u4ee4",level:3},{value:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e",id:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e",level:2},{value:"\u30a4\u30e1\u30fc\u30b8\u6bd4\u8f03",id:"\u30a4\u30e1\u30fc\u30b8\u6bd4\u8f03",level:3},{value:"Java\u5411\u3051\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8",id:"java\u5411\u3051\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8",level:3},{value:"\u30d0\u30fc\u30b8\u30e7\u30f3\u56fa\u5b9a",id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u56fa\u5b9a",level:3},{value:"\u30ec\u30a4\u30e4\u30fc\u6700\u9069\u5316",id:"\u30ec\u30a4\u30e4\u30fc\u6700\u9069\u5316",level:2},{value:"\u30ec\u30a4\u30e4\u30fc\u306e\u4ed5\u7d44\u307f",id:"\u30ec\u30a4\u30e4\u30fc\u306e\u4ed5\u7d44\u307f",level:3},{value:"RUN\u547d\u4ee4\u306e\u6700\u9069\u5316",id:"run\u547d\u4ee4\u306e\u6700\u9069\u5316",level:3},{value:"COPY\u547d\u4ee4\u306e\u9806\u5e8f",id:"copy\u547d\u4ee4\u306e\u9806\u5e8f",level:3},{value:"\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6d3b\u7528",id:"\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6d3b\u7528",level:3},{value:"\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9",id:"\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9",level:2},{value:"\u57fa\u672c\u30d1\u30bf\u30fc\u30f3",id:"\u57fa\u672c\u30d1\u30bf\u30fc\u30f3",level:3},{value:"\u30b5\u30a4\u30ba\u6bd4\u8f03",id:"\u30b5\u30a4\u30ba\u6bd4\u8f03",level:3},{value:"\u8907\u6570\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8",id:"\u8907\u6570\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3",level:2},{value:"\u975eroot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u5b9f\u884c",id:"\u975eroot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u5b9f\u884c",level:3},{value:"\u6700\u5c0f\u6a29\u9650\u306e\u539f\u5247",id:"\u6700\u5c0f\u6a29\u9650\u306e\u539f\u5247",level:3},{value:"\u6a5f\u5bc6\u60c5\u5831\u306e\u53d6\u308a\u6271\u3044",id:"\u6a5f\u5bc6\u60c5\u5831\u306e\u53d6\u308a\u6271\u3044",level:3},{value:"\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30f3",id:"\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30f3",level:3},{value:"Java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051",id:"java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051",level:2},{value:"Spring Boot\u6700\u9069\u5316Dockerfile",id:"spring-boot\u6700\u9069\u5316dockerfile",level:3},{value:"JVM\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u6700\u9069\u5316",id:"jvm\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u6700\u9069\u5316",level:3},{value:".dockerignore",id:"dockerignore",level:2},{value:"\u57fa\u672c\u7684\u306a.dockerignore",id:"\u57fa\u672c\u7684\u306adockerignore",level:3},{value:"\u30d3\u30eb\u30c9\u5f15\u6570\u3068\u74b0\u5883\u5909\u6570",id:"\u30d3\u30eb\u30c9\u5f15\u6570\u3068\u74b0\u5883\u5909\u6570",level:2},{value:"ARG\u3068ENV\u306e\u4f7f\u3044\u5206\u3051",id:"arg\u3068env\u306e\u4f7f\u3044\u5206\u3051",level:3},{value:"\u30d3\u30eb\u30c9\u6642\u306e\u5f15\u6570\u6307\u5b9a",id:"\u30d3\u30eb\u30c9\u6642\u306e\u5f15\u6570\u6307\u5b9a",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:3},{value:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",id:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"dockerfile-\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"Dockerfile \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"})}),"\n",(0,l.jsx)(n.p,{children:"\u52b9\u7387\u7684\u3067\u5b89\u5168\u306a\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u305f\u3081\u306eDockerfile\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9\u3092\u5b66\u3073\u307e\u3059\u3002"}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u76ee\u6b21",children:"\u76ee\u6b21"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#dockerfile%E3%81%AE%E5%9F%BA%E6%9C%AC%E6%A7%8B%E9%80%A0",children:"Dockerfile\u306e\u57fa\u672c\u69cb\u9020"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E3%83%99%E3%83%BC%E3%82%B9%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8%E3%81%AE%E9%81%B8%E6%8A%9E",children:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%E6%9C%80%E9%81%A9%E5%8C%96",children:"\u30ec\u30a4\u30e4\u30fc\u6700\u9069\u5316"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%B9%E3%83%86%E3%83%BC%E3%82%B8%E3%83%93%E3%83%AB%E3%83%89",children:"\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#java%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E5%90%91%E3%81%91",children:"Java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#dockerignore",children:".dockerignore"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"#%E3%83%93%E3%83%AB%E3%83%89%E5%BC%95%E6%95%B0%E3%81%A8%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0",children:"\u30d3\u30eb\u30c9\u5f15\u6570\u3068\u74b0\u5883\u5909\u6570"})}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"dockerfile\u306e\u57fa\u672c\u69cb\u9020",children:"Dockerfile\u306e\u57fa\u672c\u69cb\u9020"}),"\n",(0,l.jsx)(n.h3,{id:"\u57fa\u672c\u7684\u306adockerfile",children:"\u57fa\u672c\u7684\u306aDockerfile"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'# \u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u6307\u5b9a\nFROM eclipse-temurin:21-jre-alpine\n\n# \u30e1\u30bf\u30c7\u30fc\u30bf\u306e\u8ffd\u52a0\nLABEL maintainer="team@example.com"\nLABEL version="1.0.0"\n\n# \u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u8a2d\u5b9a\nWORKDIR /app\n\n# \u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\nCOPY target/*.jar app.jar\n\n# \u30dd\u30fc\u30c8\u306e\u516c\u958b\u5ba3\u8a00\nEXPOSE 8080\n\n# \u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u6642\u306e\u30b3\u30de\u30f3\u30c9\nENTRYPOINT ["java", "-jar", "app.jar"]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u4e3b\u8981\u306a\u547d\u4ee4",children:"\u4e3b\u8981\u306a\u547d\u4ee4"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u547d\u4ee4"}),(0,l.jsx)(n.th,{children:"\u8aac\u660e"}),(0,l.jsx)(n.th,{children:"\u4f8b"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"FROM"})}),(0,l.jsx)(n.td,{children:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u6307\u5b9a"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"FROM alpine:3.19"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"WORKDIR"})}),(0,l.jsx)(n.td,{children:"\u4f5c\u696d\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u8a2d\u5b9a"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"WORKDIR /app"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"COPY"})}),(0,l.jsx)(n.td,{children:"\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"COPY src/ dest/"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ADD"})}),(0,l.jsx)(n.td,{children:"\u30d5\u30a1\u30a4\u30eb\u306e\u30b3\u30d4\u30fc\uff08\u5c55\u958b\u6a5f\u80fd\u4ed8\u304d\uff09"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ADD archive.tar.gz /"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"RUN"})}),(0,l.jsx)(n.td,{children:"\u30b3\u30de\u30f3\u30c9\u306e\u5b9f\u884c"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"RUN apt-get update"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ENV"})}),(0,l.jsx)(n.td,{children:"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'ENV JAVA_OPTS="-Xmx512m"'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ARG"})}),(0,l.jsx)(n.td,{children:"\u30d3\u30eb\u30c9\u6642\u5f15\u6570"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ARG VERSION=1.0.0"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"EXPOSE"})}),(0,l.jsx)(n.td,{children:"\u30dd\u30fc\u30c8\u306e\u516c\u958b\u5ba3\u8a00"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"EXPOSE 8080"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"USER"})}),(0,l.jsx)(n.td,{children:"\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u306e\u5909\u66f4"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"USER appuser"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"ENTRYPOINT"})}),(0,l.jsx)(n.td,{children:"\u30b3\u30f3\u30c6\u30ca\u8d77\u52d5\u30b3\u30de\u30f3\u30c9"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'ENTRYPOINT ["java", "-jar"]'})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"CMD"})}),(0,l.jsx)(n.td,{children:"\u30c7\u30d5\u30a9\u30eb\u30c8\u5f15\u6570"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:'CMD ["app.jar"]'})})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e",children:"\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e"}),"\n",(0,l.jsx)(n.h3,{id:"\u30a4\u30e1\u30fc\u30b8\u6bd4\u8f03",children:"\u30a4\u30e1\u30fc\u30b8\u6bd4\u8f03"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u306e\u9078\u629e                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u30d5\u30eb\u30a4\u30e1\u30fc\u30b8                                                \u2502\n\u2502  ubuntu:22.04, debian:bookworm                              \u2502\n\u2502  - \u30b5\u30a4\u30ba: \u5927 (70-100MB)                                    \u2502\n\u2502  - \u30d1\u30c3\u30b1\u30fc\u30b8: \u8c4a\u5bcc                                          \u2502\n\u2502  - \u30c7\u30d0\u30c3\u30b0: \u5bb9\u6613                                            \u2502\n\u2502                                                             \u2502\n\u2502  Slim\u30a4\u30e1\u30fc\u30b8                                                \u2502\n\u2502  debian:bookworm-slim                                       \u2502\n\u2502  - \u30b5\u30a4\u30ba: \u4e2d (50-80MB)                                     \u2502\n\u2502  - \u30d1\u30c3\u30b1\u30fc\u30b8: \u57fa\u672c\u7684\u306a\u3082\u306e                                   \u2502\n\u2502  - \u30d0\u30e9\u30f3\u30b9\u578b                                                \u2502\n\u2502                                                             \u2502\n\u2502  Alpine\u30a4\u30e1\u30fc\u30b8                                              \u2502\n\u2502  alpine:3.19                                                \u2502\n\u2502  - \u30b5\u30a4\u30ba: \u5c0f (5-7MB)                                       \u2502\n\u2502  - musl libc\u4f7f\u7528\uff08glibc\u4e92\u63db\u6027\u6ce8\u610f\uff09                          \u2502\n\u2502  - \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u91cd\u8996                                          \u2502\n\u2502                                                             \u2502\n\u2502  Distroless\u30a4\u30e1\u30fc\u30b8                                          \u2502\n\u2502  gcr.io/distroless/java21                                   \u2502\n\u2502  - \u30b5\u30a4\u30ba: \u6700\u5c0f\u9650                                            \u2502\n\u2502  - \u30b7\u30a7\u30eb\u306a\u3057\uff08\u30c7\u30d0\u30c3\u30b0\u56f0\u96e3\uff09                                 \u2502\n\u2502  - \u6700\u9ad8\u306e\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(n.h3,{id:"java\u5411\u3051\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8",children:"Java\u5411\u3051\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u63a8\u5968: Eclipse Temurin (\u65e7AdoptOpenJDK)\nFROM eclipse-temurin:21-jre-alpine\n\n# Amazon Corretto (AWS\u74b0\u5883\u5411\u3051)\nFROM amazoncorretto:21-alpine\n\n# Distroless (\u672c\u756a\u74b0\u5883\u3001\u6700\u5c0f\u30b5\u30a4\u30ba)\nFROM gcr.io/distroless/java21-debian12\n\n# \u30c7\u30d0\u30c3\u30b0\u7528 (Distroless\u306e\u30c7\u30d0\u30c3\u30b0\u7248)\nFROM gcr.io/distroless/java21-debian12:debug\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u30d0\u30fc\u30b8\u30e7\u30f3\u56fa\u5b9a",children:"\u30d0\u30fc\u30b8\u30e7\u30f3\u56fa\u5b9a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u60aa\u3044\u4f8b: \u53ef\u5909\u30bf\u30b0\nFROM eclipse-temurin:latest\nFROM eclipse-temurin:21\n\n# \u826f\u3044\u4f8b: \u5177\u4f53\u7684\u306a\u30d0\u30fc\u30b8\u30e7\u30f3\nFROM eclipse-temurin:21.0.1_12-jre-alpine\n\n# SHA256\u30c0\u30a4\u30b8\u30a7\u30b9\u30c8\u3067\u5b8c\u5168\u56fa\u5b9a\uff08\u6700\u3082\u5b89\u5168\uff09\nFROM eclipse-temurin@sha256:abc123...\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u30ec\u30a4\u30e4\u30fc\u6700\u9069\u5316",children:"\u30ec\u30a4\u30e4\u30fc\u6700\u9069\u5316"}),"\n",(0,l.jsx)(n.h3,{id:"\u30ec\u30a4\u30e4\u30fc\u306e\u4ed5\u7d44\u307f",children:"\u30ec\u30a4\u30e4\u30fc\u306e\u4ed5\u7d44\u307f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\u5404RUN, COPY, ADD\u547d\u4ee4\u304c1\u30ec\u30a4\u30e4\u30fc\u3092\u4f5c\u6210\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Layer 4: COPY app.jar /app/             \u2502  100MB\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 3: RUN apt-get install -y curl    \u2502  50MB\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 2: RUN apt-get update             \u2502  30MB (\u30ad\u30e3\u30c3\u30b7\u30e5\u6b8b\u308a)\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Layer 1: FROM debian:bookworm-slim      \u2502  74MB\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nTotal: 254MB (Layer 2\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u542b\u3080)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"run\u547d\u4ee4\u306e\u6700\u9069\u5316",children:"RUN\u547d\u4ee4\u306e\u6700\u9069\u5316"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u60aa\u3044\u4f8b: \u8907\u6570\u306eRUN\u547d\u4ee4\nRUN apt-get update\nRUN apt-get install -y curl\nRUN apt-get install -y wget\nRUN rm -rf /var/lib/apt/lists/*\n\n# \u826f\u3044\u4f8b: 1\u3064\u306eRUN\u547d\u4ee4\u306b\u307e\u3068\u3081\u308b\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n        curl \\\n        wget \\\n    && rm -rf /var/lib/apt/lists/*\n"})}),"\n",(0,l.jsx)(n.h3,{id:"copy\u547d\u4ee4\u306e\u9806\u5e8f",children:"COPY\u547d\u4ee4\u306e\u9806\u5e8f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u60aa\u3044\u4f8b: \u5909\u66f4\u983b\u5ea6\u306e\u9ad8\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u5148\u306b\u30b3\u30d4\u30fc\nCOPY . /app\nRUN npm install\n\n# \u826f\u3044\u4f8b: \u5909\u66f4\u983b\u5ea6\u306e\u4f4e\u3044\u3082\u306e\u304b\u3089\u9806\u306b\u30b3\u30d4\u30fc\n# \u4f9d\u5b58\u95a2\u4fc2\u30d5\u30a1\u30a4\u30eb\u3092\u5148\u306b\u30b3\u30d4\u30fc\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u6d3b\u7528\uff09\nCOPY package.json package-lock.json ./\nRUN npm ci --only=production\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306f\u6700\u5f8c\u306b\u30b3\u30d4\u30fc\nCOPY . .\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6d3b\u7528",children:"\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6d3b\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# Java\u306e\u4f8b: \u4f9d\u5b58\u95a2\u4fc2\u3092\u5148\u306b\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nFROM eclipse-temurin:21-jdk-alpine AS builder\n\nWORKDIR /app\n\n# Gradle\u30e9\u30c3\u30d1\u30fc\u3068\u30d3\u30eb\u30c9\u8a2d\u5b9a\u3092\u5148\u306b\u30b3\u30d4\u30fc\nCOPY gradlew .\nCOPY gradle gradle\nCOPY build.gradle settings.gradle ./\n\n# \u4f9d\u5b58\u95a2\u4fc2\u306e\u307f\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nRUN ./gradlew dependencies --no-daemon\n\n# \u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30d3\u30eb\u30c9\nCOPY src src\nRUN ./gradlew build -x test --no-daemon\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9",children:"\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9"}),"\n",(0,l.jsx)(n.h3,{id:"\u57fa\u672c\u30d1\u30bf\u30fc\u30f3",children:"\u57fa\u672c\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'# ==================== \u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8 ====================\nFROM eclipse-temurin:21-jdk-alpine AS builder\n\nWORKDIR /app\n\n# Gradle\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\nCOPY gradlew .\nCOPY gradle gradle\nCOPY build.gradle settings.gradle ./\n\n# \u4f9d\u5b58\u95a2\u4fc2\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nRUN ./gradlew dependencies --no-daemon\n\n# \u30bd\u30fc\u30b9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30d3\u30eb\u30c9\nCOPY src src\nRUN ./gradlew bootJar --no-daemon\n\n# ==================== \u5b9f\u884c\u30b9\u30c6\u30fc\u30b8 ====================\nFROM eclipse-temurin:21-jre-alpine\n\n# \u975eroot\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\nRUN addgroup -g 1000 app && adduser -u 1000 -G app -D app\n\nWORKDIR /app\n\n# \u30d3\u30eb\u30c9\u6210\u679c\u7269\u306e\u307f\u3092\u30b3\u30d4\u30fc\nCOPY --from=builder /app/build/libs/*.jar app.jar\n\n# \u6240\u6709\u6a29\u306e\u8a2d\u5b9a\nRUN chown -R app:app /app\n\nUSER app\n\nEXPOSE 8080\nENTRYPOINT ["java", "-jar", "app.jar"]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u30b5\u30a4\u30ba\u6bd4\u8f03",children:"\u30b5\u30a4\u30ba\u6bd4\u8f03"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"\u30b7\u30f3\u30b0\u30eb\u30b9\u30c6\u30fc\u30b8\uff08JDK\u542b\u3080\uff09:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 JDK + \u30d3\u30eb\u30c9\u30c4\u30fc\u30eb + \u30bd\u30fc\u30b9 + JAR       \u2502  ~500MB\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\uff08JRE\u306e\u307f\uff09:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 JRE + JAR                               \u2502  ~200MB\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u8907\u6570\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8",children:"\u8907\u6570\u306e\u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u30c6\u30b9\u30c8\u7528\u30b9\u30c6\u30fc\u30b8\nFROM eclipse-temurin:21-jdk-alpine AS tester\nWORKDIR /app\nCOPY --from=builder /app .\nRUN ./gradlew test --no-daemon\n\n# \u672c\u756a\u7528\u30b9\u30c6\u30fc\u30b8\nFROM eclipse-temurin:21-jre-alpine AS production\nCOPY --from=builder /app/build/libs/*.jar app.jar\n# ...\n\n# \u958b\u767a\u7528\u30b9\u30c6\u30fc\u30b8\uff08\u30c7\u30d0\u30c3\u30b0\u30c4\u30fc\u30eb\u4ed8\u304d\uff09\nFROM eclipse-temurin:21-jdk-alpine AS development\nRUN apk add --no-cache curl vim\nCOPY --from=builder /app .\n# ...\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"}),"\n",(0,l.jsx)(n.h3,{id:"\u975eroot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u5b9f\u884c",children:"\u975eroot\u30e6\u30fc\u30b6\u30fc\u3067\u306e\u5b9f\u884c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'FROM eclipse-temurin:21-jre-alpine\n\n# \u30b0\u30eb\u30fc\u30d7\u3068\u30e6\u30fc\u30b6\u30fc\u3092\u4f5c\u6210\nRUN addgroup -g 1000 appgroup && \\\n    adduser -u 1000 -G appgroup -D -s /sbin/nologin appuser\n\nWORKDIR /app\n\nCOPY --chown=appuser:appgroup target/*.jar app.jar\n\n# \u975eroot\u30e6\u30fc\u30b6\u30fc\u306b\u5207\u308a\u66ff\u3048\nUSER appuser\n\nENTRYPOINT ["java", "-jar", "app.jar"]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u6700\u5c0f\u6a29\u9650\u306e\u539f\u5247",children:"\u6700\u5c0f\u6a29\u9650\u306e\u539f\u5247"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'FROM eclipse-temurin:21-jre-alpine\n\n# \u5fc5\u8981\u306a\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u307f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nRUN apk add --no-cache \\\n    dumb-init \\\n    && rm -rf /var/cache/apk/*\n\n# \u4e0d\u8981\u306a\u30d5\u30a1\u30a4\u30eb\u3092\u524a\u9664\nRUN rm -rf /tmp/* /var/tmp/*\n\n# \u8aad\u307f\u53d6\u308a\u5c02\u7528\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3067\u5b9f\u884c\u53ef\u80fd\u306b\u3059\u308b\nWORKDIR /app\nCOPY --chmod=444 target/*.jar app.jar\n\nUSER 1000:1000\n\n# dumb-init\u3067\u30b7\u30b0\u30ca\u30eb\u51e6\u7406\u3092\u9069\u5207\u306b\nENTRYPOINT ["/usr/bin/dumb-init", "--"]\nCMD ["java", "-jar", "app.jar"]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u6a5f\u5bc6\u60c5\u5831\u306e\u53d6\u308a\u6271\u3044",children:"\u6a5f\u5bc6\u60c5\u5831\u306e\u53d6\u308a\u6271\u3044"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:"# \u60aa\u3044\u4f8b: \u6a5f\u5bc6\u60c5\u5831\u3092\u30a4\u30e1\u30fc\u30b8\u306b\u542b\u3081\u308b\nENV DATABASE_PASSWORD=secret123\nCOPY secrets.properties /app/\n\n# \u826f\u3044\u4f8b: \u5b9f\u884c\u6642\u306b\u74b0\u5883\u5909\u6570\u3067\u6e21\u3059\n# docker run -e DATABASE_PASSWORD=xxx my-app\n\n# \u826f\u3044\u4f8b: Docker Secrets\u3092\u4f7f\u7528\n# docker run --secret id=db_password my-app\n\n# BuildKit\u306e\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30de\u30a6\u30f3\u30c8\nRUN --mount=type=secret,id=npmrc,target=/root/.npmrc \\\n    npm ci\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30f3",children:"\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30f3"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Trivy\u3067\u30b9\u30ad\u30e3\u30f3\ntrivy image my-app:latest\n\n# Docker Scout\u3067\u30b9\u30ad\u30e3\u30f3\ndocker scout cves my-app:latest\n\n# Snyk\u3067\u30b9\u30ad\u30e3\u30f3\nsnyk container test my-app:latest\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051",children:"Java\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5411\u3051"}),"\n",(0,l.jsx)(n.h3,{id:"spring-boot\u6700\u9069\u5316dockerfile",children:"Spring Boot\u6700\u9069\u5316Dockerfile"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'# ==================== \u30d3\u30eb\u30c9\u30b9\u30c6\u30fc\u30b8 ====================\nFROM eclipse-temurin:21-jdk-alpine AS builder\n\nWORKDIR /app\n\n# Gradle\u30d5\u30a1\u30a4\u30eb\u3092\u30b3\u30d4\u30fc\nCOPY gradlew .\nCOPY gradle gradle\nCOPY build.gradle settings.gradle ./\nCOPY libs libs\n\n# \u4f9d\u5b58\u95a2\u4fc2\u306e\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\nRUN ./gradlew dependencies --no-daemon\n\n# \u30bd\u30fc\u30b9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30d3\u30eb\u30c9\nCOPY src src\nRUN ./gradlew bootJar --no-daemon\n\n# JAR\u3092\u5c55\u958b\uff08\u30ec\u30a4\u30e4\u30fc\u5206\u5272\u306e\u305f\u3081\uff09\nRUN java -Djarmode=layertools -jar build/libs/*.jar extract\n\n# ==================== \u5b9f\u884c\u30b9\u30c6\u30fc\u30b8 ====================\nFROM eclipse-temurin:21-jre-alpine\n\n# \u30bf\u30a4\u30e0\u30be\u30fc\u30f3\u8a2d\u5b9a\nRUN apk add --no-cache tzdata && \\\n    cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime && \\\n    echo "Asia/Tokyo" > /etc/timezone && \\\n    apk del tzdata\n\n# \u975eroot\u30e6\u30fc\u30b6\u30fc\nRUN addgroup -g 1000 app && adduser -u 1000 -G app -D app\n\nWORKDIR /app\n\n# Spring Boot\u306e\u30ec\u30a4\u30e4\u30fc\u3092\u9806\u756a\u306b\u30b3\u30d4\u30fc\nCOPY --from=builder --chown=app:app /app/dependencies/ ./\nCOPY --from=builder --chown=app:app /app/spring-boot-loader/ ./\nCOPY --from=builder --chown=app:app /app/snapshot-dependencies/ ./\nCOPY --from=builder --chown=app:app /app/application/ ./\n\nUSER app\n\n# JVM\u30aa\u30d7\u30b7\u30e7\u30f3\nENV JAVA_OPTS="-XX:+UseContainerSupport \\\n    -XX:MaxRAMPercentage=75.0 \\\n    -XX:InitialRAMPercentage=50.0 \\\n    -Djava.security.egd=file:/dev/./urandom"\n\nEXPOSE 8080\n\nHEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \\\n    CMD wget -q --spider http://localhost:8080/actuator/health || exit 1\n\nENTRYPOINT ["sh", "-c", "java $JAVA_OPTS org.springframework.boot.loader.launch.JarLauncher"]\n'})}),"\n",(0,l.jsx)(n.h3,{id:"jvm\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u6700\u9069\u5316",children:"JVM\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u6700\u9069\u5316"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'ENV JAVA_OPTS="\\\n    # \u30b3\u30f3\u30c6\u30ca\u306e\u30ea\u30bd\u30fc\u30b9\u5236\u9650\u3092\u8a8d\u8b58\n    -XX:+UseContainerSupport \\\n    # RAM\u306e75%\u3092\u30d2\u30fc\u30d7\u306b\u5272\u308a\u5f53\u3066\n    -XX:MaxRAMPercentage=75.0 \\\n    # \u521d\u671f\u30d2\u30fc\u30d7\u30b5\u30a4\u30ba\n    -XX:InitialRAMPercentage=50.0 \\\n    # G1GC\u3092\u4f7f\u7528\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n    -XX:+UseG1GC \\\n    # \u4e71\u6570\u751f\u6210\u306e\u9ad8\u901f\u5316\n    -Djava.security.egd=file:/dev/./urandom \\\n    # \u30bf\u30a4\u30e0\u30be\u30fc\u30f3\n    -Duser.timezone=Asia/Tokyo"\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"dockerignore",children:".dockerignore"}),"\n",(0,l.jsx)(n.h3,{id:"\u57fa\u672c\u7684\u306adockerignore",children:"\u57fa\u672c\u7684\u306a.dockerignore"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-plaintext",children:"# \u30d0\u30fc\u30b8\u30e7\u30f3\u7ba1\u7406\n.git\n.gitignore\n.gitattributes\n\n# IDE\u8a2d\u5b9a\n.idea\n*.iml\n.vscode\n.settings\n.project\n.classpath\n\n# \u30d3\u30eb\u30c9\u6210\u679c\u7269\nbuild\ntarget\nout\n*.class\n*.jar\n*.war\n\n# \u4f9d\u5b58\u95a2\u4fc2\u30ad\u30e3\u30c3\u30b7\u30e5\n.gradle\n.m2\nnode_modules\n\n# \u30ed\u30b0\u3068\u30c6\u30f3\u30dd\u30e9\u30ea\n*.log\ntmp\ntemp\n\n# \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\n*.md\n!README.md\ndocs\ndocumentation\n\n# \u30c6\u30b9\u30c8\ntest\ntests\n*_test.go\n*.test\n\n# Docker\u95a2\u9023\nDockerfile*\ndocker-compose*\n.dockerignore\n\n# \u74b0\u5883\u8a2d\u5b9a\n.env\n.env.*\n*.local\n\n# \u30b7\u30fc\u30af\u30ec\u30c3\u30c8\n*.pem\n*.key\ncredentials*\nsecrets*\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u30d3\u30eb\u30c9\u5f15\u6570\u3068\u74b0\u5883\u5909\u6570",children:"\u30d3\u30eb\u30c9\u5f15\u6570\u3068\u74b0\u5883\u5909\u6570"}),"\n",(0,l.jsx)(n.h3,{id:"arg\u3068env\u306e\u4f7f\u3044\u5206\u3051",children:"ARG\u3068ENV\u306e\u4f7f\u3044\u5206\u3051"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dockerfile",children:'# ARG: \u30d3\u30eb\u30c9\u6642\u306e\u307f\u4f7f\u7528\nARG JAVA_VERSION=21\nFROM eclipse-temurin:${JAVA_VERSION}-jre-alpine\n\n# ARG\u306fFROM\u306e\u5f8c\u3067\u518d\u5b9a\u7fa9\u304c\u5fc5\u8981\nARG APP_VERSION=1.0.0\nLABEL version="${APP_VERSION}"\n\n# ENV: \u5b9f\u884c\u6642\u3082\u4f7f\u7528\nENV SPRING_PROFILES_ACTIVE=production\nENV SERVER_PORT=8080\n\n# ARG\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092ENV\u306b\u6e21\u3059\nARG DEFAULT_JAVA_OPTS="-Xmx512m"\nENV JAVA_OPTS=${DEFAULT_JAVA_OPTS}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u30d3\u30eb\u30c9\u6642\u306e\u5f15\u6570\u6307\u5b9a",children:"\u30d3\u30eb\u30c9\u6642\u306e\u5f15\u6570\u6307\u5b9a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u30d3\u30eb\u30c9\u5f15\u6570\u3092\u6307\u5b9a\ndocker build \\\n    --build-arg JAVA_VERSION=21 \\\n    --build-arg APP_VERSION=2.0.0 \\\n    -t my-app:2.0.0 .\n\n# \u74b0\u5883\u5909\u6570\u3068\u3057\u3066\u5b9f\u884c\u6642\u306b\u6e21\u3059\ndocker run \\\n    -e SPRING_PROFILES_ACTIVE=staging \\\n    -e DATABASE_URL=jdbc:postgresql://db:5432/app \\\n    my-app:2.0.0\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,l.jsx)(n.h3,{id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u9069\u5207\u306a\u30d9\u30fc\u30b9\u30a4\u30e1\u30fc\u30b8\u3092\u9078\u629e\uff08Alpine/Distroless\uff09"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u56fa\u5b9a"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30de\u30eb\u30c1\u30b9\u30c6\u30fc\u30b8\u30d3\u30eb\u30c9\u3092\u4f7f\u7528"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30ec\u30a4\u30e4\u30fc\u3092\u6700\u9069\u5316\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u6d3b\u7528\uff09"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u975eroot\u30e6\u30fc\u30b6\u30fc\u3067\u5b9f\u884c"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6a5f\u5bc6\u60c5\u5831\u3092\u30a4\u30e1\u30fc\u30b8\u306b\u542b\u3081\u306a\u3044"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HEALTHCHECK\u3092\u8a2d\u5b9a"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ",".dockerignore\u3092\u8a2d\u5b9a"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u8106\u5f31\u6027\u30b9\u30ad\u30e3\u30f3\u3092\u5b9f\u65bd"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/kubernetes/docker-compose",children:"Docker Compose"})," - \u8907\u6570\u30b3\u30f3\u30c6\u30ca\u306e\u7ba1\u7406"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/kubernetes/docker-commands",children:"Docker\u30b3\u30de\u30f3\u30c9\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9"})," - \u3088\u304f\u4f7f\u3046\u30b3\u30de\u30f3\u30c9\u96c6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/kubernetes/kubernetes-architecture",children:"Kubernetes\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3"})," - \u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9",children:"\u53c2\u8003\u30ea\u30bd\u30fc\u30b9"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.docker.com/engine/reference/dockerfile/",children:"Dockerfile reference"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",children:"Best practices for writing Dockerfiles"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.docker.com/build/buildkit/",children:"Docker BuildKit"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://spring.io/guides/topicals/spring-boot-docker/",children:"Spring Boot Docker"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var i=r(96540);const l={},d=i.createContext(l);function s(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);