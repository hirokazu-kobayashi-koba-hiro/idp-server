"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[9740],{82980:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"content_06_developer-guide/implementation-guides/impl-24-notification-fcm-apns","title":"\u30d7\u30c3\u30b7\u30e5\u901a\u77e5 (FCM/APNs)","description":"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051","source":"@site/docs/content_06_developer-guide/04-implementation-guides/impl-24-notification-fcm-apns.md","sourceDirName":"content_06_developer-guide/04-implementation-guides","slug":"/content_06_developer-guide/implementation-guides/impl-24-notification-fcm-apns","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-24-notification-fcm-apns","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_06_developer-guide/04-implementation-guides/impl-24-notification-fcm-apns.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"PKCE","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-23-pkce-implementation"},"next":{"title":"\u76e3\u67fb\u30ed\u30b0","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-25-audit-logging"}}');var s=i(74848),a=i(28453);const r={},o="\u30d7\u30c3\u30b7\u30e5\u901a\u77e5 (FCM/APNs)",c={},l=[{value:"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",id:"-\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",level:2},{value:"\ud83c\udfd7\ufe0f \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",id:"\ufe0f-\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",level:2},{value:"\u901a\u77e5\u30d5\u30ed\u30fc",id:"\u901a\u77e5\u30d5\u30ed\u30fc",level:3},{value:"\ud83d\udd0c AuthenticationDeviceNotifier \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",id:"-authenticationdevicenotifier-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",level:2},{value:"NotificationResult",id:"notificationresult",level:3},{value:"NotificationTemplate",id:"notificationtemplate",level:3},{value:"\ud83d\udcf1 FCM\u5b9f\u88c5",id:"-fcm\u5b9f\u88c5",level:2},{value:"FcmNotifier",id:"fcmnotifier",level:3},{value:"FCM\u8a2d\u5b9a",id:"fcm\u8a2d\u5b9a",level:3},{value:"\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8",id:"\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8",level:3},{value:"1. \u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306eFirebaseApp",id:"1-\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306efirebaseapp",level:4},{value:"2. Android / iOS \u4e21\u5bfe\u5fdc",id:"2-android--ios-\u4e21\u5bfe\u5fdc",level:4},{value:"3. \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316",id:"3-\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316",level:4},{value:"\ud83c\udf4e APNs\u5b9f\u88c5",id:"-apns\u5b9f\u88c5",level:2},{value:"ApnsNotifier",id:"apnsnotifier",level:3},{value:"APNs\u8a2d\u5b9a",id:"apns\u8a2d\u5b9a",level:3},{value:"APNs\u30da\u30a4\u30ed\u30fc\u30c9\u4f5c\u6210",id:"apns\u30da\u30a4\u30ed\u30fc\u30c9\u4f5c\u6210",level:3},{value:"JWT \u30c8\u30fc\u30af\u30f3\u751f\u6210\u3068\u30ad\u30e3\u30c3\u30b7\u30e5",id:"jwt-\u30c8\u30fc\u30af\u30f3\u751f\u6210\u3068\u30ad\u30e3\u30c3\u30b7\u30e5",level:3},{value:"APNs\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",id:"apns\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",level:3},{value:"\ud83d\udccb \u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"-\u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:2},{value:"FCM\u5b9f\u88c5",id:"fcm\u5b9f\u88c5",level:3},{value:"APNs\u5b9f\u88c5",id:"apns\u5b9f\u88c5",level:3},{value:"\ud83e\uddea \u30c6\u30b9\u30c8\u5b9f\u88c5\u4f8b",id:"-\u30c6\u30b9\u30c8\u5b9f\u88c5\u4f8b",level:2},{value:"FCM\u901a\u77e5\u30c6\u30b9\u30c8",id:"fcm\u901a\u77e5\u30c6\u30b9\u30c8",level:3},{value:"APNs\u901a\u77e5\u30c6\u30b9\u30c8",id:"apns\u901a\u77e5\u30c6\u30b9\u30c8",level:3},{value:"\ud83d\udea8 \u3088\u304f\u3042\u308b\u9593\u9055\u3044",id:"-\u3088\u304f\u3042\u308b\u9593\u9055\u3044",level:2},{value:"1. FCM: FirebaseApp \u306e\u91cd\u8907\u521d\u671f\u5316",id:"1-fcm-firebaseapp-\u306e\u91cd\u8907\u521d\u671f\u5316",level:3},{value:"2. APNs: JWT \u30c8\u30fc\u30af\u30f3\u306e\u518d\u4f5c\u6210",id:"2-apns-jwt-\u30c8\u30fc\u30af\u30f3\u306e\u518d\u4f5c\u6210",level:3},{value:"3. APNs: \u74b0\u5883URL \u306e\u9593\u9055\u3044",id:"3-apns-\u74b0\u5883url-\u306e\u9593\u9055\u3044",level:3},{value:"4. \u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\u5fd8\u308c",id:"4-\u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\u5fd8\u308c",level:3},{value:"5. APNs: ExpiredProviderToken \u30a8\u30e9\u30fc\u6642\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u5fd8\u308c",id:"5-apns-expiredprovidertoken-\u30a8\u30e9\u30fc\u6642\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u5fd8\u308c",level:3},{value:"\ud83d\udd17 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u30d7\u30c3\u30b7\u30e5\u901a\u77e5-fcmapns",children:"\u30d7\u30c3\u30b7\u30e5\u901a\u77e5 (FCM/APNs)"})}),"\n",(0,s.jsx)(e.h2,{id:"-\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051",children:"\ud83d\udccd \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u4f4d\u7f6e\u3065\u3051"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u5bfe\u8c61\u8aad\u8005"}),": \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\uff08FCM/APNs\uff09\u306e\u5b9f\u88c5\u8a73\u7d30\u3092\u7406\u89e3\u3057\u305f\u3044\u958b\u767a\u8005"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b66\u3079\u308b\u3053\u3068"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"FCM (Firebase Cloud Messaging) \u306e\u5b9f\u88c5\u8a73\u7d30"}),"\n",(0,s.jsx)(e.li,{children:"APNs (Apple Push Notification service) \u306e\u5b9f\u88c5\u8a73\u7d30"}),"\n",(0,s.jsx)(e.li,{children:"AuthenticationDeviceNotifier \u30d7\u30e9\u30b0\u30a4\u30f3\u306e\u5b9f\u88c5\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.li,{children:"\u901a\u77e5\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u7ba1\u7406"}),"\n",(0,s.jsx)(e.li,{children:"JWT \u30c8\u30fc\u30af\u30f3\u30ad\u30e3\u30c3\u30b7\u30e5\u6226\u7565\uff08APNs\uff09"}),"\n",(0,s.jsx)(e.li,{children:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068\u30ea\u30c8\u30e9\u30a4"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u524d\u63d0\u77e5\u8b58"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-12-plugin-implementation",children:"impl-12: Plugin\u5b9f\u88c5\u30ac\u30a4\u30c9"}),"\u306e\u7406\u89e3"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"../../content_05_how-to/how-to-12-ciba-flow-fido-uaf.md",children:"how-to-12: CIBA Flow (FIDO-UAF)"}),"\u306e\u7406\u89e3"]}),"\n",(0,s.jsx)(e.li,{children:"FCM/APNs\u306e\u57fa\u790e\u77e5\u8b58"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\ufe0f-\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",children:"\ud83c\udfd7\ufe0f \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3"}),"\n",(0,s.jsxs)(e.p,{children:["idp-server\u306f\u3001",(0,s.jsx)(e.strong,{children:"AuthenticationDeviceNotifier"}),"\u30d7\u30e9\u30b0\u30a4\u30f3\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(e.h3,{id:"\u901a\u77e5\u30d5\u30ed\u30fc",children:"\u901a\u77e5\u30d5\u30ed\u30fc"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1. CIBA\u8a8d\u8a3c\u30ea\u30af\u30a8\u30b9\u30c8\u53d7\u4fe1                                    \u2502\n\u2502    - auth_req_id \u767a\u884c                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2. AuthenticationDeviceNotifier \u9078\u629e                         \u2502\n\u2502    - NotificationChannel \u306b\u57fa\u3065\u3044\u3066\u9078\u629e                      \u2502\n\u2502    - fcm / apns / email / sms                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 3. \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u9001\u4fe1                                          \u2502\n\u2502    - FCM: Firebase Admin SDK                                 \u2502\n\u2502    - APNs: HTTP/2 APIs + JWT\u8a8d\u8a3c                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 4. \u30e6\u30fc\u30b6\u30fc\u627f\u8a8d                                              \u2502\n\u2502    - \u30e2\u30d0\u30a4\u30eb\u30a2\u30d7\u30ea\u3067\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u53d7\u4fe1                         \u2502\n\u2502    - \u8a8d\u8a3c\u51e6\u7406\uff08FIDO-UAF\u7b49\uff09                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 5. \u30c8\u30fc\u30af\u30f3\u767a\u884c                                              \u2502\n\u2502    - Poll/Ping\u65b9\u5f0f\u3067\u30c8\u30fc\u30af\u30f3\u53d6\u5f97                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-authenticationdevicenotifier-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",children:"\ud83d\udd0c AuthenticationDeviceNotifier \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9"}),"\n",(0,s.jsx)(e.p,{children:"\u3059\u3079\u3066\u306e\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u5b9f\u88c5\u306f\u3001\u3053\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public interface AuthenticationDeviceNotifier {\n\n  /**\n   * \u901a\u77e5\u30c1\u30e3\u30cd\u30eb\u540d\u3092\u8fd4\u3059\n   */\n  NotificationChannel chanel();\n\n  /**\n   * \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u4fe1\n   *\n   * @param tenant \u30c6\u30ca\u30f3\u30c8\u60c5\u5831\n   * @param device \u8a8d\u8a3c\u30c7\u30d0\u30a4\u30b9\uff08\u901a\u77e5\u30c8\u30fc\u30af\u30f3\u3092\u542b\u3080\uff09\n   * @param configuration \u8a8d\u8a3c\u8a2d\u5b9a\uff08FCM/APNs\u8a2d\u5b9a\u3092\u542b\u3080\uff09\n   * @return \u901a\u77e5\u7d50\u679c\n   */\n  NotificationResult notify(\n      Tenant tenant,\n      AuthenticationDevice device,\n      AuthenticationExecutionConfig configuration);\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(e.a,{href:"../../../libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/device/AuthenticationDeviceNotifier.java#L25",children:"AuthenticationDeviceNotifier.java:25"})]}),"\n",(0,s.jsx)(e.h3,{id:"notificationresult",children:"NotificationResult"}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u77e5\u7d50\u679c\u3092\u8868\u3059\u30af\u30e9\u30b9\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public class NotificationResult {\n  boolean success;\n  String channel;\n  Map<String, Object> data;\n  String errorMessage;\n\n  public static NotificationResult success(String channel, Map<String, Object> data) {\n    return new NotificationResult(true, channel, data, null);\n  }\n\n  public static NotificationResult failure(String channel, String errorMessage) {\n    return new NotificationResult(false, channel, Map.of(), errorMessage);\n  }\n\n  public boolean isSuccess() {\n    return success;\n  }\n\n  public boolean isFailure() {\n    return !success;\n  }\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(e.a,{href:"../../../libs/idp-server-platform/src/main/java/org/idp/server/platform/notification/NotificationResult.java#L21",children:"NotificationResult.java:21"})]}),"\n",(0,s.jsx)(e.h3,{id:"notificationtemplate",children:"NotificationTemplate"}),"\n",(0,s.jsx)(e.p,{children:"\u901a\u77e5\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u8868\u3059\u30af\u30e9\u30b9\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"public class NotificationTemplate implements JsonReadable {\n  String sender;\n  String title;\n  String body;\n\n  public String optSender(String defaultValue) {\n    if (sender == null) {\n      return defaultValue;\n    }\n    return sender;\n  }\n\n  public String optTitle(String defaultValue) {\n    if (title == null) {\n      return defaultValue;\n    }\n    return title;\n  }\n\n  public String optBody(String defaultValue) {\n    if (body == null) {\n      return defaultValue;\n    }\n    return body;\n  }\n}\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(e.a,{href:"../../../libs/idp-server-platform/src/main/java/org/idp/server/platform/notification/NotificationTemplate.java#L21",children:"NotificationTemplate.java:21"})]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-fcm\u5b9f\u88c5",children:"\ud83d\udcf1 FCM\u5b9f\u88c5"}),"\n",(0,s.jsx)(e.h3,{id:"fcmnotifier",children:"FcmNotifier"}),"\n",(0,s.jsx)(e.p,{children:"Firebase Admin SDK \u3092\u4f7f\u7528\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'public class FcmNotifier implements AuthenticationDeviceNotifier {\n\n  JsonConverter jsonConverter = JsonConverter.snakeCaseInstance();\n  Map<String, FirebaseMessaging> cache = new ConcurrentHashMap<>();\n\n  @Override\n  public NotificationChannel chanel() {\n    return new NotificationChannel("fcm");\n  }\n\n  @Override\n  public NotificationResult notify(\n      Tenant tenant,\n      AuthenticationDevice device,\n      AuthenticationExecutionConfig configuration) {\n\n    try {\n      // 1. \u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\n      if (!device.hasNotificationToken()) {\n        return NotificationResult.failure("fcm", "Device has no notification token");\n      }\n\n      // 2. FCM\u8a2d\u5b9a\u306e\u53d6\u5f97\n      Object fcmConfigData = configuration.details().get("fcm");\n      if (fcmConfigData == null) {\n        return NotificationResult.failure("fcm", "FCM configuration not found");\n      }\n\n      FcmConfiguration fcmConfiguration =\n          jsonConverter.read(fcmConfigData, FcmConfiguration.class);\n\n      // 3. FirebaseMessaging \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u53d6\u5f97\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\uff09\n      FirebaseMessaging firebaseMessaging =\n          getOrInitFirebaseMessaging(tenant, fcmConfiguration);\n\n      // 4. \u901a\u77e5\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u53d6\u5f97\n      NotificationTemplate notificationTemplate = fcmConfiguration.findTemplate("default");\n      String notificationToken = device.notificationToken().value();\n\n      // 5. \u30e1\u30c3\u30bb\u30fc\u30b8\u69cb\u7bc9\n      Message message =\n          Message.builder()\n              .setToken(notificationToken)\n              .setAndroidConfig(\n                  AndroidConfig.builder()\n                      .setPriority(AndroidConfig.Priority.HIGH)\n                      .putData("sender", notificationTemplate.optSender(tenant.identifierValue()))\n                      .putData("title", notificationTemplate.optTitle("Transaction Authentication"))\n                      .putData("body", notificationTemplate.optBody("Please approve the transaction."))\n                      .build())\n              .setApnsConfig(\n                  ApnsConfig.builder()\n                      .putHeader("apns-priority", "10")\n                      .putCustomData("sender", notificationTemplate.optSender(tenant.identifierValue()))\n                      .putCustomData("title", notificationTemplate.optTitle("Transaction Authentication"))\n                      .putCustomData("body", notificationTemplate.optBody("Please approve the transaction."))\n                      .setAps(Aps.builder().setContentAvailable(true).build())\n                      .build())\n              .build();\n\n      // 6. \u9001\u4fe1\n      String result = firebaseMessaging.send(message);\n\n      return NotificationResult.success("fcm", Map.of("result", result));\n\n    } catch (Exception e) {\n      return NotificationResult.failure("fcm", e.getMessage());\n    }\n  }\n\n  FirebaseMessaging getOrInitFirebaseMessaging(Tenant tenant, FcmConfiguration fcmConfiguration) {\n    return cache.computeIfAbsent(\n        tenant.identifierValue(),\n        (key) -> {\n          try {\n            String credential = fcmConfiguration.credential();\n            FirebaseOptions options =\n                FirebaseOptions.builder()\n                    .setCredentials(\n                        GoogleCredentials.fromStream(\n                            new ByteArrayInputStream(credential.getBytes())))\n                    .build();\n\n            FirebaseApp firebaseApp = FirebaseApp.initializeApp(options, tenant.identifierValue());\n            return FirebaseMessaging.getInstance(firebaseApp);\n\n          } catch (IOException e) {\n            throw new FcmRuntimeException(e);\n          }\n        });\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(e.a,{href:"../../../libs/idp-server-notification-fcm-adapter/src/main/java/org/idp/server/notification/push/fcm/FcmNotifier.java#L37",children:"FcmNotifier.java:37"})]}),"\n",(0,s.jsx)(e.h3,{id:"fcm\u8a2d\u5b9a",children:"FCM\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "fcm": {\n    "credential": "{Firebase Admin SDK JSON}",\n    "templates": {\n      "default": {\n        "sender": "MyBank",\n        "title": "Transaction Authentication",\n        "body": "Please approve the transaction to continue."\n      }\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"credential"}),": Firebase Admin SDK \u306e\u30b5\u30fc\u30d3\u30b9\u30a2\u30ab\u30a6\u30f3\u30c8\u30ad\u30fc\uff08JSON\u5f62\u5f0f\uff09"]}),"\n",(0,s.jsx)(e.h3,{id:"\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8",children:"\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8"}),"\n",(0,s.jsx)(e.h4,{id:"1-\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306efirebaseapp",children:"1. \u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306eFirebaseApp"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"// \u2705 \u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b FirebaseApp \u3092\u521d\u671f\u5316\nFirebaseApp firebaseApp = FirebaseApp.initializeApp(options, tenant.identifierValue());\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u7406\u7531"}),": \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u74b0\u5883\u3067\u3001\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b\u7570\u306a\u308bFirebase\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3092\u4f7f\u7528\u3059\u308b\u305f\u3081"]}),"\n",(0,s.jsx)(e.h4,{id:"2-android--ios-\u4e21\u5bfe\u5fdc",children:"2. Android / iOS \u4e21\u5bfe\u5fdc"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"Message message = Message.builder()\n    .setToken(notificationToken)\n    .setAndroidConfig(...)  // Android\u5411\u3051\u8a2d\u5b9a\n    .setApnsConfig(...)     // iOS\u5411\u3051\u8a2d\u5b9a\n    .build();\n"})}),"\n",(0,s.jsxs)(e.p,{children:["FCM\u306f",(0,s.jsx)(e.strong,{children:"Android \u3068 iOS \u306e\u4e21\u65b9"}),"\u306b\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(e.h4,{id:"3-\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316",children:"3. \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6700\u9069\u5316"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"Map<String, FirebaseMessaging> cache = new ConcurrentHashMap<>();\n\nFirebaseMessaging getOrInitFirebaseMessaging(...) {\n  return cache.computeIfAbsent(tenant.identifierValue(), ...);\n}\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-apns\u5b9f\u88c5",children:"\ud83c\udf4e APNs\u5b9f\u88c5"}),"\n",(0,s.jsx)(e.h3,{id:"apnsnotifier",children:"ApnsNotifier"}),"\n",(0,s.jsx)(e.p,{children:"APNs HTTP/2 API\u3092\u4f7f\u7528\u3057\u3066\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'public class ApnsNotifier implements AuthenticationDeviceNotifier {\n\n  JsonConverter jsonConverter = JsonConverter.snakeCaseInstance();\n  Map<String, JwtTokenCache> jwtTokenCache = new ConcurrentHashMap<>();\n  HttpClient httpClient = HttpClient.newBuilder().version(HttpClient.Version.HTTP_2).build();\n  JsonWebSignatureFactory jwsFactory = new JsonWebSignatureFactory();\n\n  private static final String PRODUCTION_URL = "https://api.push.apple.com";\n  private static final String DEVELOPMENT_URL = "https://api.sandbox.push.apple.com";\n  private static final long TOKEN_DURATION_SECONDS = 3600; // 1\u6642\u9593\n\n  @Override\n  public NotificationChannel chanel() {\n    return new NotificationChannel("apns");\n  }\n\n  @Override\n  public NotificationResult notify(\n      Tenant tenant,\n      AuthenticationDevice device,\n      AuthenticationExecutionConfig configuration) {\n\n    try {\n      // 1. \u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\n      if (!device.hasNotificationToken()) {\n        return NotificationResult.failure("apns", "Device has no notification token");\n      }\n\n      // 2. APNs\u8a2d\u5b9a\u306e\u53d6\u5f97\n      Object apnsConfigData = configuration.details().get("apns");\n      if (apnsConfigData == null) {\n        return NotificationResult.failure("apns", "APNs configuration not found");\n      }\n\n      ApnsConfiguration apnsConfiguration =\n          jsonConverter.read(apnsConfigData, ApnsConfiguration.class);\n\n      // 3. JWT \u30c8\u30fc\u30af\u30f3\u53d6\u5f97\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u307e\u305f\u306f\u65b0\u898f\u4f5c\u6210\uff09\n      String jwtToken = getOrCreateJwtToken(tenant, apnsConfiguration);\n\n      // 4. \u901a\u77e5\u30da\u30a4\u30ed\u30fc\u30c9\u4f5c\u6210\n      NotificationTemplate notificationTemplate = apnsConfiguration.findTemplate("default");\n      String payload = createApnsPayload(notificationTemplate, tenant);\n\n      // 5. APNs HTTP/2 \u30ea\u30af\u30a8\u30b9\u30c8\n      String notificationToken = device.notificationToken().value();\n      String apnsUrl =\n          (apnsConfiguration.isProduction() ? PRODUCTION_URL : DEVELOPMENT_URL)\n              + "/3/device/"\n              + notificationToken;\n\n      HttpRequest request =\n          HttpRequest.newBuilder()\n              .uri(URI.create(apnsUrl))\n              .header("Authorization", "bearer " + jwtToken)\n              .header("apns-topic", apnsConfiguration.bundleId())\n              .header("apns-priority", "10")\n              .header("apns-push-type", "alert")\n              .header("Content-Type", "application/json")\n              .POST(HttpRequest.BodyPublishers.ofString(payload))\n              .build();\n\n      // 6. \u9001\u4fe1\n      HttpResponse<String> response =\n          httpClient.send(request, HttpResponse.BodyHandlers.ofString());\n\n      String apnsId = response.headers().firstValue("apns-id").orElse("unknown");\n\n      // 7. \u30ec\u30b9\u30dd\u30f3\u30b9\u51e6\u7406\n      if (response.statusCode() == 200) {\n        return NotificationResult.success("apns", Map.of("apns-id", apnsId));\n      } else {\n        String errorMessage = handleApnsError(response, apnsId, tenant);\n        return NotificationResult.failure("apns", errorMessage);\n      }\n\n    } catch (Exception e) {\n      return NotificationResult.failure("apns", e.getMessage());\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5"}),": ",(0,s.jsx)(e.a,{href:"../../../libs/idp-server-notification-apns-adapter/src/main/java/org/idp/server/notification/push/apns/ApnsNotifier.java#L42",children:"ApnsNotifier.java:42"})]}),"\n",(0,s.jsx)(e.h3,{id:"apns\u8a2d\u5b9a",children:"APNs\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "apns": {\n    "team_id": "YOUR_TEAM_ID",\n    "key_id": "YOUR_KEY_ID",\n    "key_content": "-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----",\n    "bundle_id": "com.example.app",\n    "is_production": false,\n    "templates": {\n      "default": {\n        "sender": "MyBank",\n        "title": "Transaction Authentication",\n        "body": "Please approve the transaction to continue."\n      }\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u8a2d\u5b9a\u30d1\u30e9\u30e1\u30fc\u30bf"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"team_id"}),": Apple Developer Team ID"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"key_id"}),": APNs\u8a8d\u8a3c\u30ad\u30fcID\uff08.p8\u30d5\u30a1\u30a4\u30eb\u306eKey ID\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"key_content"}),": \u79d8\u5bc6\u9375\uff08PEM\u5f62\u5f0f\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"bundle_id"}),": \u30a2\u30d7\u30ea\u306eBundle Identifier"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"is_production"}),": \u672c\u756a\u74b0\u5883 (true) / \u958b\u767a\u74b0\u5883 (false)"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"apns\u30da\u30a4\u30ed\u30fc\u30c9\u4f5c\u6210",children:"APNs\u30da\u30a4\u30ed\u30fc\u30c9\u4f5c\u6210"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'String createApnsPayload(NotificationTemplate template, Tenant tenant) {\n  try {\n    Map<String, Object> aps = new HashMap<>();\n    Map<String, String> alert = new HashMap<>();\n\n    String title = template.optTitle("Transaction Authentication");\n    String body = template.optBody("Please approve the transaction to continue.");\n    String sender = template.optSender(tenant.identifierValue());\n\n    alert.put("title", title);\n    alert.put("body", body);\n    aps.put("alert", alert);\n\n    Map<String, Object> payload = new HashMap<>();\n    payload.put("aps", aps);\n    payload.put("sender", sender);  // \u30ab\u30b9\u30bf\u30e0\u30c7\u30fc\u30bf\n\n    return jsonConverter.write(payload);\n  } catch (Exception e) {\n    throw new ApnsRuntimeException("Failed to create APNs payload", e);\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u30da\u30a4\u30ed\u30fc\u30c9\u4f8b"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "aps": {\n    "alert": {\n      "title": "Transaction Authentication",\n      "body": "Please approve the transaction to continue."\n    }\n  },\n  "sender": "tenant-id-12345678"\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"jwt-\u30c8\u30fc\u30af\u30f3\u751f\u6210\u3068\u30ad\u30e3\u30c3\u30b7\u30e5",children:"JWT \u30c8\u30fc\u30af\u30f3\u751f\u6210\u3068\u30ad\u30e3\u30c3\u30b7\u30e5"}),"\n",(0,s.jsxs)(e.p,{children:["APNs\u306f\u3001",(0,s.jsx)(e.strong,{children:"JWT \u30c8\u30fc\u30af\u30f3\u306b\u3088\u308b\u8a8d\u8a3c"}),"\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u30c8\u30fc\u30af\u30f3\u306f1\u6642\u9593\u6709\u52b9\u3067\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u3088\u308a\u518d\u5229\u7528\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'String getOrCreateJwtToken(Tenant tenant, ApnsConfiguration config) {\n  String cacheKey = createCacheKey(tenant);\n  JwtTokenCache cachedToken = jwtTokenCache.get(cacheKey);\n\n  // \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u3042\u308a\u3001\u307e\u3060\u6709\u52b9\u306a\u5834\u5408\u306f\u518d\u5229\u7528\n  if (cachedToken != null && !cachedToken.shouldRefresh()) {\n    return cachedToken.token();\n  }\n\n  // \u65b0\u3057\u3044JWT\u30c8\u30fc\u30af\u30f3\u4f5c\u6210\n  try {\n    LocalDateTime now = SystemDateTime.now();\n    LocalDateTime expiresAt = now.plusSeconds(TOKEN_DURATION_SECONDS);\n\n    // JWT Claims\n    Map<String, Object> claims = new HashMap<>();\n    claims.put("iss", config.teamId());\n    claims.put("iat", SystemDateTime.toEpochSecond(now));\n\n    // JWT Headers\n    Map<String, Object> customHeaders = new HashMap<>();\n    customHeaders.put("kid", config.keyId());\n\n    // ES256 \u7f72\u540d\n    JsonWebSignature jws =\n        jwsFactory.createWithAsymmetricKeyForPem(claims, customHeaders, config.keyContent());\n    String token = jws.serialize();\n\n    // \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u4fdd\u5b58\n    jwtTokenCache.put(cacheKey, new JwtTokenCache(token, expiresAt));\n\n    return token;\n\n  } catch (Exception e) {\n    throw new ApnsRuntimeException("Failed to create JWT token", e);\n  }\n}\n\nString createCacheKey(Tenant tenant) {\n  return "jwt-" + tenant.identifierValue();\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"JWT \u30c8\u30fc\u30af\u30f3\u306e\u4ed5\u69d8"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),": ES256\uff08ECDSA with SHA-256\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Header"}),": ",(0,s.jsx)(e.code,{children:"kid"})," \u306b Key ID \u3092\u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Claims"}),":","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"iss"}),": Team ID"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"iat"}),": \u767a\u884c\u6642\u523b\uff08Unix time\uff09"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u6709\u52b9\u671f\u9650"}),": 1\u6642\u9593\uff08\u63a8\u5968\uff09"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"apns\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",children:"APNs\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'String handleApnsError(HttpResponse<String> response, String apnsId, Tenant tenant) {\n  try {\n    int statusCode = response.statusCode();\n    String responseBody = response.body();\n\n    // JSON\u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u30d1\u30fc\u30b9\n    if (Objects.nonNull(responseBody) && !responseBody.isEmpty()) {\n      JsonNodeWrapper errorJson = JsonNodeWrapper.fromString(responseBody);\n      String reason = errorJson.getValueOrEmptyAsString("reason");\n\n      log.warn(\n          "APNs notification failed - Status: {}, Reason: {}, APNs-ID: {}",\n          statusCode, reason, apnsId);\n\n      // \u7279\u5b9a\u30a8\u30e9\u30fc\u306e\u51e6\u7406\n      switch (reason) {\n        case "BadDeviceToken" -> log.warn("Invalid device token");\n        case "TopicDisallowed" -> log.warn("Topic not allowed");\n        case "ExpiredProviderToken" -> {\n          log.warn("JWT token expired, clearing cache");\n          jwtTokenCache.remove(createCacheKey(tenant));\n        }\n      }\n\n      return "Status: " + statusCode + ", Reason: " + reason;\n    }\n\n    return "Status: " + statusCode + ", APNs-ID: " + apnsId;\n\n  } catch (Exception e) {\n    log.error("Error parsing APNs error response: {}", e.getMessage());\n    return "Error parsing APNs response: " + e.getMessage();\n  }\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u4e3b\u306a\u30a8\u30e9\u30fc\u7406\u7531"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"BadDeviceToken"}),": \u7121\u52b9\u306a\u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"TopicDisallowed"}),": Bundle ID\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"ExpiredProviderToken"}),": JWT \u30c8\u30fc\u30af\u30f3\u306e\u6709\u52b9\u671f\u9650\u5207\u308c"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"DeviceTokenNotForTopic"}),": \u30c7\u30d0\u30a4\u30b9\u30c8\u30fc\u30af\u30f3\u3068Bundle ID\u306e\u4e0d\u4e00\u81f4"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-\u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\ud83d\udccb \u5b9f\u88c5\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,s.jsx)(e.h3,{id:"fcm\u5b9f\u88c5",children:"FCM\u5b9f\u88c5"}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"Firebase Admin SDK\u4f9d\u5b58\u95a2\u4fc2"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-groovy",children:"implementation 'com.google.firebase:firebase-admin:9.2.0'\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"FCM Configuration"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Firebase Admin SDK JSON \u3092\u53d6\u5f97"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"credential"})," \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u8a2d\u5b9a"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"\u901a\u77e5\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"sender"}),", ",(0,s.jsx)(e.code,{children:"title"}),", ",(0,s.jsx)(e.code,{children:"body"})," \u3092\u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u9069\u5207\u306b\u8a2d\u5b9a"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"FirebaseApp\u521d\u671f\u5316"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b FirebaseApp \u3092\u521d\u671f\u5316"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u30ad\u30e3\u30c3\u30b7\u30e5\u3067\u518d\u5229\u7528"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"\u30d7\u30e9\u30b0\u30a4\u30f3\u767b\u9332"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"META-INF/services/org.idp.server.authentication.interactors.device.AuthenticationDeviceNotifier\norg.idp.server.notification.push.fcm.FcmNotifier\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"apns\u5b9f\u88c5",children:"APNs\u5b9f\u88c5"}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"APNs\u8a8d\u8a3c\u30ad\u30fc\u53d6\u5f97"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Apple Developer Portal\u3067Key\u4f5c\u6210\uff08.p8\u30d5\u30a1\u30a4\u30eb\uff09"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Team ID, Key ID, \u79d8\u5bc6\u9375\u3092\u53d6\u5f97"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"APNs Configuration"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"team_id"}),", ",(0,s.jsx)(e.code,{children:"key_id"}),", ",(0,s.jsx)(e.code,{children:"key_content"})," \u3092\u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"bundle_id"})," \u3092\u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"is_production"})," \u3092\u9069\u5207\u306b\u8a2d\u5b9a"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"JWT \u30c8\u30fc\u30af\u30f3\u751f\u6210"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","ES256 \u7f72\u540d"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Header \u306b ",(0,s.jsx)(e.code,{children:"kid"})," \u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Claims \u306b ",(0,s.jsx)(e.code,{children:"iss"})," (Team ID), ",(0,s.jsx)(e.code,{children:"iat"})," \u8a2d\u5b9a"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"\u30c8\u30fc\u30af\u30f3\u30ad\u30e3\u30c3\u30b7\u30e5"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","1\u6642\u9593\u6709\u52b9"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b\u30ad\u30e3\u30c3\u30b7\u30e5"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"ExpiredProviderToken"})," \u30a8\u30e9\u30fc\u6642\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"HTTP/2 \u30ea\u30af\u30a8\u30b9\u30c8"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Authorization: bearer ",(0,s.jsx)(e.code,{children:"<jwt_token>"})]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","apns-topic: ",(0,s.jsx)(e.code,{children:"<bundle_id>"})]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","apns-priority: 10\uff08\u5373\u6642\u914d\u4fe1\uff09"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","apns-push-type: alert"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0"}),":"]}),"\n",(0,s.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\u78ba\u8a8d\uff08200\u4ee5\u5916\u306f\u30a8\u30e9\u30fc\uff09"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.code,{children:"reason"})," \u30d5\u30a3\u30fc\u30eb\u30c9\u304b\u3089\u30a8\u30e9\u30fc\u7406\u7531\u53d6\u5f97"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ","\u9069\u5207\u306a\u30ed\u30b0\u51fa\u529b"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{className:"task-list-item",children:["\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(e.strong,{children:"\u30d7\u30e9\u30b0\u30a4\u30f3\u767b\u9332"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"META-INF/services/org.idp.server.authentication.interactors.device.AuthenticationDeviceNotifier\norg.idp.server.notification.push.apns.ApnsNotifier\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-\u30c6\u30b9\u30c8\u5b9f\u88c5\u4f8b",children:"\ud83e\uddea \u30c6\u30b9\u30c8\u5b9f\u88c5\u4f8b"}),"\n",(0,s.jsx)(e.h3,{id:"fcm\u901a\u77e5\u30c6\u30b9\u30c8",children:"FCM\u901a\u77e5\u30c6\u30b9\u30c8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'@Test\nvoid testFcmNotification() {\n  // 1. \u30c6\u30ca\u30f3\u30c8\u4f5c\u6210\n  Tenant tenant = new Tenant(new TenantIdentifier("tenant-123"), ...);\n\n  // 2. \u30c7\u30d0\u30a4\u30b9\u4f5c\u6210\uff08\u901a\u77e5\u30c8\u30fc\u30af\u30f3\u542b\u3080\uff09\n  AuthenticationDevice device = AuthenticationDevice.builder()\n      .notificationToken(new NotificationToken("fcm-token-xyz"))\n      .build();\n\n  // 3. FCM\u8a2d\u5b9a\n  Map<String, Object> fcmConfig = Map.of(\n      "credential", "{Firebase Admin SDK JSON}",\n      "templates", Map.of(\n          "default", Map.of(\n              "title", "Test Notification",\n              "body", "Test Body"\n          )\n      )\n  );\n\n  AuthenticationExecutionConfig config = AuthenticationExecutionConfig.builder()\n      .details(Map.of("fcm", fcmConfig))\n      .build();\n\n  // 4. \u901a\u77e5\u9001\u4fe1\n  FcmNotifier notifier = new FcmNotifier();\n  NotificationResult result = notifier.notify(tenant, device, config);\n\n  // 5. \u691c\u8a3c\n  assertTrue(result.isSuccess());\n  assertThat(result.channel()).isEqualTo("fcm");\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"apns\u901a\u77e5\u30c6\u30b9\u30c8",children:"APNs\u901a\u77e5\u30c6\u30b9\u30c8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'@Test\nvoid testApnsNotification() {\n  // 1. \u30c6\u30ca\u30f3\u30c8\u4f5c\u6210\n  Tenant tenant = new Tenant(new TenantIdentifier("tenant-456"), ...);\n\n  // 2. \u30c7\u30d0\u30a4\u30b9\u4f5c\u6210\n  AuthenticationDevice device = AuthenticationDevice.builder()\n      .notificationToken(new NotificationToken("apns-token-abc"))\n      .build();\n\n  // 3. APNs\u8a2d\u5b9a\n  Map<String, Object> apnsConfig = Map.of(\n      "team_id", "YOUR_TEAM_ID",\n      "key_id", "YOUR_KEY_ID",\n      "key_content", "-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----",\n      "bundle_id", "com.example.app",\n      "is_production", false,\n      "templates", Map.of(\n          "default", Map.of(\n              "title", "Test Notification",\n              "body", "Test Body"\n          )\n      )\n  );\n\n  AuthenticationExecutionConfig config = AuthenticationExecutionConfig.builder()\n      .details(Map.of("apns", apnsConfig))\n      .build();\n\n  // 4. \u901a\u77e5\u9001\u4fe1\n  ApnsNotifier notifier = new ApnsNotifier();\n  NotificationResult result = notifier.notify(tenant, device, config);\n\n  // 5. \u691c\u8a3c\n  assertTrue(result.isSuccess());\n  assertThat(result.channel()).isEqualTo("apns");\n  assertThat(result.data()).containsKey("apns-id");\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-\u3088\u304f\u3042\u308b\u9593\u9055\u3044",children:"\ud83d\udea8 \u3088\u304f\u3042\u308b\u9593\u9055\u3044"}),"\n",(0,s.jsx)(e.h3,{id:"1-fcm-firebaseapp-\u306e\u91cd\u8907\u521d\u671f\u5316",children:"1. FCM: FirebaseApp \u306e\u91cd\u8907\u521d\u671f\u5316"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: \u6bce\u56de FirebaseApp \u3092\u521d\u671f\u5316\uff08\u30a8\u30e9\u30fc\u306b\u306a\u308b\uff09\nFirebaseApp firebaseApp = FirebaseApp.initializeApp(options, "app-name");\n\n// \u2705 \u6b63\u3057\u3044: \u30ad\u30e3\u30c3\u30b7\u30e5\u3067\u518d\u5229\u7528\nFirebaseMessaging getOrInitFirebaseMessaging(...) {\n  return cache.computeIfAbsent(tenant.identifierValue(), ...);\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-apns-jwt-\u30c8\u30fc\u30af\u30f3\u306e\u518d\u4f5c\u6210",children:"2. APNs: JWT \u30c8\u30fc\u30af\u30f3\u306e\u518d\u4f5c\u6210"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"// \u274c \u8aa4\u308a: \u6bce\u56de JWT \u30c8\u30fc\u30af\u30f3\u3092\u4f5c\u6210\uff08\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u4f4e\u4e0b\uff09\nString jwtToken = createJwtToken(config);\n\n// \u2705 \u6b63\u3057\u3044: \u30ad\u30e3\u30c3\u30b7\u30e5\u30671\u6642\u9593\u518d\u5229\u7528\nString jwtToken = getOrCreateJwtToken(tenant, config);\n"})}),"\n",(0,s.jsx)(e.h3,{id:"3-apns-\u74b0\u5883url-\u306e\u9593\u9055\u3044",children:"3. APNs: \u74b0\u5883URL \u306e\u9593\u9055\u3044"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: \u672c\u756a\u74b0\u5883\u3067\u958b\u767aURL\u3092\u4f7f\u7528\nString apnsUrl = "https://api.sandbox.push.apple.com/3/device/" + token;\n\n// \u2705 \u6b63\u3057\u3044: \u8a2d\u5b9a\u306b\u57fa\u3065\u3044\u3066\u5207\u308a\u66ff\u3048\nString apnsUrl = (apnsConfiguration.isProduction()\n    ? "https://api.push.apple.com"\n    : "https://api.sandbox.push.apple.com") + "/3/device/" + token;\n'})}),"\n",(0,s.jsx)(e.h3,{id:"4-\u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\u5fd8\u308c",children:"4. \u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306e\u5b58\u5728\u78ba\u8a8d\u5fd8\u308c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: \u901a\u77e5\u30c8\u30fc\u30af\u30f3\u306a\u3057\u3067\u9001\u4fe1\uff08\u30a8\u30e9\u30fc\uff09\nString notificationToken = device.notificationToken().value();  // NullPointerException\n\n// \u2705 \u6b63\u3057\u3044: \u5b58\u5728\u78ba\u8a8d\nif (!device.hasNotificationToken()) {\n  return NotificationResult.failure("apns", "Device has no notification token");\n}\nString notificationToken = device.notificationToken().value();\n'})}),"\n",(0,s.jsx)(e.h3,{id:"5-apns-expiredprovidertoken-\u30a8\u30e9\u30fc\u6642\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u5fd8\u308c",children:"5. APNs: ExpiredProviderToken \u30a8\u30e9\u30fc\u6642\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u5fd8\u308c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:'// \u274c \u8aa4\u308a: \u30a8\u30e9\u30fc\u3092\u30ed\u30b0\u51fa\u529b\u3059\u308b\u3060\u3051\ncase "ExpiredProviderToken" -> log.warn("JWT token expired");\n\n// \u2705 \u6b63\u3057\u3044: \u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2\u3057\u3066\u6b21\u56de\u518d\u4f5c\u6210\ncase "ExpiredProviderToken" -> {\n  log.warn("JWT token expired, clearing cache");\n  jwtTokenCache.remove(createCacheKey(tenant));\n}\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\ud83d\udd17 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6982\u5ff5\u30fb\u57fa\u790e"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"../../content_05_how-to/how-to-12-ciba-flow-fido-uaf.md",children:"how-to-12: CIBA Flow (FIDO-UAF)"})," - \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3092\u4f7f\u7528\u3059\u308b\u30d5\u30ed\u30fc"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"../../content_05_how-to/how-to-08-mfa-setup.md",children:"how-to-08: MFA\u8a2d\u5b9a"})," - \u30c7\u30d0\u30a4\u30b9\u767b\u9332"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u5b9f\u88c5\u8a73\u7d30"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-12-plugin-implementation",children:"impl-12: Plugin\u5b9f\u88c5\u30ac\u30a4\u30c9"})," - \u30d7\u30e9\u30b0\u30a4\u30f3\u30b7\u30b9\u30c6\u30e0\u306e\u8a73\u7d30"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/idp-server/docs/content_06_developer-guide/application-plane/ciba-flow",children:"03-application-plane/06-ciba-flow.md"})," - CIBA\u30d5\u30ed\u30fc"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u53c2\u8003\u5b9f\u88c5\u30af\u30e9\u30b9"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"../../../libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/device/AuthenticationDeviceNotifier.java",children:"AuthenticationDeviceNotifier.java"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"../../../libs/idp-server-notification-fcm-adapter/src/main/java/org/idp/server/notification/push/fcm/FcmNotifier.java",children:"FcmNotifier.java"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"../../../libs/idp-server-notification-apns-adapter/src/main/java/org/idp/server/notification/push/apns/ApnsNotifier.java",children:"ApnsNotifier.java"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"../../../libs/idp-server-platform/src/main/java/org/idp/server/platform/notification/NotificationTemplate.java",children:"NotificationTemplate.java"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"../../../libs/idp-server-platform/src/main/java/org/idp/server/platform/notification/NotificationResult.java",children:"NotificationResult.java"})}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u5916\u90e8\u30ea\u30bd\u30fc\u30b9"}),":"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://firebase.google.com/docs/cloud-messaging",children:"Firebase Cloud Messaging"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://developer.apple.com/documentation/usernotifications",children:"Apple Push Notification service"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/establishing_a_token-based_connection_to_apns",children:"APNs Provider Authentication Token"})}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-12-07\n",(0,s.jsx)(e.strong,{children:"\u96e3\u6613\u5ea6"}),": \u2b50\u2b50\u2b50 (\u4e2d\u7d1a)"]})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453:(n,e,i)=>{i.d(e,{R:()=>r,x:()=>o});var t=i(96540);const s={},a=t.createContext(s);function r(n){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),t.createElement(a.Provider,{value:e},n.children)}}}]);