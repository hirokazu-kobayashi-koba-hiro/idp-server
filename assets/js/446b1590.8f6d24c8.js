"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8978],{29374:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"content_10_ai_developer/ai-41-authentication","title":"idp-server-authentication-interactors - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc","description":"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981","source":"@site/docs/content_10_ai_developer/ai-41-authentication.md","sourceDirName":"content_10_ai_developer","slug":"/content_10_ai_developer/ai-41-authentication","permalink":"/idp-server/docs/content_10_ai_developer/ai-41-authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_10_ai_developer/ai-41-authentication.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u8a8d\u8a3c\u30fb\u9023\u643a\u5c64 - \u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u3068\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3","permalink":"/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation"},"next":{"title":"idp-server-webauthn4j-adapter - WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408","permalink":"/idp-server/docs/content_10_ai_developer/ai-42-webauthn"}}');var r=t(74848),s=t(28453);const c={},a="idp-server-authentication-interactors - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc",o={},d=[{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",level:2},{value:"\u8cac\u52d9",id:"\u8cac\u52d9",level:3},{value:"\u5bfe\u5fdc\u8a8d\u8a3c\u624b\u6bb5",id:"\u5bfe\u5fdc\u8a8d\u8a3c\u624b\u6bb5",level:3},{value:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",level:2},{value:"\u8a2d\u8a08\u601d\u60f3",id:"\u8a2d\u8a08\u601d\u60f3",level:3},{value:"2\u3064\u306eOperationType",id:"2\u3064\u306eoperationtype",level:3},{value:"AuthenticationInteractionStatus",id:"authenticationinteractionstatus",level:3},{value:"SecurityEventType\u9023\u643a",id:"securityeventtype\u9023\u643a",level:3},{value:"AuthenticationInteractorFactory \u30d1\u30bf\u30fc\u30f3",id:"authenticationinteractorfactory-\u30d1\u30bf\u30fc\u30f3",level:2},{value:"AuthenticationInteractor \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",id:"authenticationinteractor-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",level:2},{value:"Plugin\u767b\u9332",id:"plugin\u767b\u9332",level:2},{value:"\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3",id:"\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3",level:2},{value:"1. Password\u8a8d\u8a3c\u5b9f\u88c5",id:"1-password\u8a8d\u8a3c\u5b9f\u88c5",level:3},{value:"2. SMS\u8a8d\u8a3c\u5b9f\u88c5\uff08AuthenticationExecutor\u9023\u643a\uff09",id:"2-sms\u8a8d\u8a3c\u5b9f\u88c5authenticationexecutor\u9023\u643a",level:3},{value:"3. Device\u8a8d\u8a3c\u5b9f\u88c5\uff08\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\uff09",id:"3-device\u8a8d\u8a3c\u5b9f\u88c5\u30d7\u30c3\u30b7\u30e5\u901a\u77e5",level:3},{value:"AuthenticationDeviceBindingMessageInteractor \u8a73\u7d30",id:"authenticationdevicebindingmessageinteractor-\u8a73\u7d30",level:3},{value:"4. WebAuthn\u8a8d\u8a3c\u5b9f\u88c5\uff08Challenge-Response\uff09",id:"4-webauthn\u8a8d\u8a3c\u5b9f\u88c5challenge-response",level:3},{value:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u5168\u4f53\u50cf",id:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u5168\u4f53\u50cf",level:2},{value:"\u8a8d\u8a3c\u624b\u6bb5\u5225\u306e\u7279\u5fb4",id:"\u8a8d\u8a3c\u624b\u6bb5\u5225\u306e\u7279\u5fb4",level:2},{value:"Challenge-Response\u578b\uff082\u6bb5\u968e\uff09",id:"challenge-response\u578b2\u6bb5\u968e",level:3},{value:"Single-Step\u578b\uff081\u6bb5\u968e\uff09",id:"single-step\u578b1\u6bb5\u968e",level:3},{value:"\u52d5\u7684\u8a2d\u5b9a\u3068Executor\u59d4\u8b72",id:"\u52d5\u7684\u8a2d\u5b9a\u3068executor\u59d4\u8b72",level:2},{value:"AuthenticationExecutor \u30d1\u30bf\u30fc\u30f3\uff08SMS/Email/Device\uff09",id:"authenticationexecutor-\u30d1\u30bf\u30fc\u30f3smsemaildevice",level:3},{value:"Delegation \u30d1\u30bf\u30fc\u30f3\uff08Password\uff09",id:"delegation-\u30d1\u30bf\u30fc\u30f3password",level:3},{value:"\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u8a2d\u8a08\u539f\u5247",id:"\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u8a2d\u8a08\u539f\u5247",level:2},{value:"1. Tenant\u7b2c\u4e00\u5f15\u6570\u306e\u5fb9\u5e95",id:"1-tenant\u7b2c\u4e00\u5f15\u6570\u306e\u5fb9\u5e95",level:3},{value:"2. SecurityEvent\u767a\u884c\u306e\u4e00\u8cab\u6027",id:"2-securityevent\u767a\u884c\u306e\u4e00\u8cab\u6027",level:3},{value:"3. AMR\u5024\u306e\u6b63\u78ba\u6027",id:"3-amr\u5024\u306e\u6b63\u78ba\u6027",level:3},{value:"\u62e1\u5f35\u6027\u306e\u5b9f\u73fe\u65b9\u6cd5",id:"\u62e1\u5f35\u6027\u306e\u5b9f\u73fe\u65b9\u6cd5",level:2},{value:"\u65b0\u3057\u3044\u8a8d\u8a3c\u624b\u6bb5\u306e\u8ffd\u52a0\u624b\u9806",id:"\u65b0\u3057\u3044\u8a8d\u8a3c\u624b\u6bb5\u306e\u8ffd\u52a0\u624b\u9806",level:3},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2},{value:"\ud83d\udccb \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c\u7d50\u679c",id:"-\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c\u7d50\u679c",level:2},{value:"\u2705 \u691c\u8a3c\u6e08\u307f\u9805\u76ee",id:"-\u691c\u8a3c\u6e08\u307f\u9805\u76ee",level:3},{value:"\ud83c\udfaf \u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\u4e00\u89a7\uff08\u5b9f\u88c5\u78ba\u8a8d\u6e08\u307f\uff09",id:"-\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\u4e00\u89a7\u5b9f\u88c5\u78ba\u8a8d\u6e08\u307f",level:3},{value:"\ud83d\udcca \u7dcf\u5408\u8a55\u4fa1",id:"-\u7dcf\u5408\u8a55\u4fa1",level:3}];function l(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"idp-server-authentication-interactors---\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc",children:"idp-server-authentication-interactors - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"})}),"\n",(0,r.jsx)(e.h2,{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",children:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.code,{children:"libs/idp-server-authentication-interactors/"}),"\n",(0,r.jsx)(e.strong,{children:"\u78ba\u8a8d\u65e5"}),": 2025-10-12"]}),"\n",(0,r.jsx)(e.h3,{id:"\u8cac\u52d9",children:"\u8cac\u52d9"}),"\n",(0,r.jsx)(e.p,{children:"\u591a\u69d8\u306a\u8a8d\u8a3c\u624b\u6bb5\u306e\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u5b9f\u88c5\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"\u5bfe\u5fdc\u8a8d\u8a3c\u624b\u6bb5",children:"\u5bfe\u5fdc\u8a8d\u8a3c\u624b\u6bb5"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u691c\u8a3c\u30b3\u30de\u30f3\u30c9"}),": ",(0,r.jsx)(e.code,{children:"ls libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/"})]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8a8d\u8a3c\u624b\u6bb5"}),(0,r.jsx)(e.th,{children:"\u30d1\u30c3\u30b1\u30fc\u30b8"}),(0,r.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"FIDO2/Passkey"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"webauthn/"})}),(0,r.jsx)(e.td,{children:"WebAuthn\u6e96\u62e0\u306e\u751f\u4f53\u8a8d\u8a3c\u30fb\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ad\u30fc\uff08Challenge/Registration/Authentication\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"FIDO-UAF"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"fidouaf/"})}),(0,r.jsx)(e.td,{children:"FIDO Universal Authentication Framework\uff08\u767b\u9332\u30fb\u8a8d\u8a3c\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Password"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"password/"})}),(0,r.jsx)(e.td,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\uff08PasswordVerificationDelegation\u4f7f\u7528\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"SMS"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"sms/"})}),(0,r.jsx)(e.td,{children:"SMS OTP\uff08Challenge/Verification\u3001\u5916\u90e8SMS\u9001\u4fe1\u30b5\u30fc\u30d3\u30b9\u9023\u643a\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Email"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"email/"})}),(0,r.jsx)(e.td,{children:"\u30e1\u30fc\u30ebOTP\uff08Challenge/Verification\u3001\u5916\u90e8\u30e1\u30fc\u30eb\u9001\u4fe1\u30b5\u30fc\u30d3\u30b9\u9023\u643a\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Device"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"device/"})}),(0,r.jsx)(e.td,{children:"\u30c7\u30d0\u30a4\u30b9\u8a8d\u8a3c\uff08\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u3001Binding/Notification/Denied\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"External Token"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"external_token/"})}),(0,r.jsx)(e.td,{children:"\u5916\u90e8ID\u30b5\u30fc\u30d3\u30b9\u9023\u643a\uff08Legacy ID Service\u7d71\u5408\uff09"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Initial Registration"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"initial_registration/"})}),(0,r.jsx)(e.td,{children:"\u521d\u56de\u767b\u9332\u30a4\u30f3\u30bf\u30e9\u30af\u30b7\u30e7\u30f3"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Cancel"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"cancel/"})}),(0,r.jsx)(e.td,{children:"\u8a8d\u8a3c\u30ad\u30e3\u30f3\u30bb\u30eb\u51e6\u7406"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5408\u8a08"}),": 10\u7a2e\u985e\u306e\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"]}),"\n",(0,r.jsx)(e.h2,{id:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981",children:"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981"}),"\n",(0,r.jsx)(e.h3,{id:"\u8a2d\u8a08\u601d\u60f3",children:"\u8a2d\u8a08\u601d\u60f3"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Plugin\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3"}),": \u8a8d\u8a3c\u624b\u6bb5\u3092\u52d5\u7684\u306b\u8ffd\u52a0\u53ef\u80fd\u306a\u62e1\u5f35\u6027\u91cd\u8996\u8a2d\u8a08"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"PluginLoader \u2192 AuthenticationInteractorFactory \u2192 AuthenticationInteractor\n                                                    \u2193\n                                          interact() \u5b9f\u884c\n                                                    \u2193\n                                    AuthenticationInteractionRequestResult\n"})}),"\n",(0,r.jsx)(e.h3,{id:"2\u3064\u306eoperationtype",children:"2\u3064\u306eOperationType"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"OperationType"}),(0,r.jsx)(e.th,{children:"\u8cac\u52d9"}),(0,r.jsx)(e.th,{children:"\u4f8b"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"CHALLENGE"})}),(0,r.jsx)(e.td,{children:"\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\uff08\u8a8d\u8a3c\u524d\u6e96\u5099\uff09"}),(0,r.jsx)(e.td,{children:"WebAuthn Challenge, SMS OTP\u9001\u4fe1"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"AUTHENTICATION"})}),(0,r.jsx)(e.td,{children:"\u8a8d\u8a3c\u691c\u8a3c\uff08\u5b9f\u969b\u306e\u8a8d\u8a3c\u51e6\u7406\uff09"}),(0,r.jsx)(e.td,{children:"Password\u691c\u8a3c, OTP\u691c\u8a3c, WebAuthn Assertion\u691c\u8a3c"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981"}),": default\u30e1\u30bd\u30c3\u30c9\u3067",(0,r.jsx)(e.code,{children:"AUTHENTICATION"}),"\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3002Challenge\u5c02\u7528\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u306e\u307f",(0,r.jsx)(e.code,{children:"CHALLENGE"}),"\u3092\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"authenticationinteractionstatus",children:"AuthenticationInteractionStatus"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Status"}),(0,r.jsx)(e.th,{children:"\u610f\u5473"}),(0,r.jsx)(e.th,{children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"SUCCESS"})}),(0,r.jsx)(e.td,{children:"\u8a8d\u8a3c\u6210\u529f"}),(0,r.jsx)(e.td,{children:"AuthenticationTransaction\u66f4\u65b0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"CLIENT_ERROR"})}),(0,r.jsx)(e.td,{children:"\u8a8d\u8a3c\u5931\u6557"}),(0,r.jsx)(e.td,{children:"\u30a8\u30e9\u30fc\u30ec\u30b9\u30dd\u30f3\u30b9\u8fd4\u5374"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"PENDING"})}),(0,r.jsx)(e.td,{children:"\u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u5f85\u3061"}),(0,r.jsx)(e.td,{children:"\u30dd\u30fc\u30ea\u30f3\u30b0 or Callback\u5f85\u6a5f"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981"}),": PENDING\u72b6\u614b\u306f\u975e\u540c\u671f\u8a8d\u8a3c\uff08Device\u8a8d\u8a3c\u3001CIBA\u7b49\uff09\u3067\u4f7f\u7528\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"securityeventtype\u9023\u643a",children:"SecurityEventType\u9023\u643a"}),"\n",(0,r.jsxs)(e.p,{children:["\u5168\u3066\u306e\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u304c\u8a8d\u8a3c\u7d50\u679c\u306b\u5fdc\u3058\u3066",(0,r.jsx)(e.strong,{children:"SecurityEvent"}),"\u3092\u767a\u884c\u3002"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8a8d\u8a3c\u624b\u6bb5"}),(0,r.jsx)(e.th,{children:"\u6210\u529f\u30a4\u30d9\u30f3\u30c8"}),(0,r.jsx)(e.th,{children:"\u5931\u6557\u30a4\u30d9\u30f3\u30c8"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Password"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"password_success"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"password_failure"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SMS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"sms_authentication_success"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"sms_authentication_failure"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"WebAuthn"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"webauthn_authentication_success"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"webauthn_authentication_failure"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Device"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"device_authentication_success"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"device_authentication_denied"})})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7528\u9014"}),": Security Event Hooks\u3001\u76e3\u67fb\u30ed\u30b0\u3001SIEM\u9023\u643a"]}),"\n",(0,r.jsx)(e.h2,{id:"authenticationinteractorfactory-\u30d1\u30bf\u30fc\u30f3",children:"AuthenticationInteractorFactory \u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(68575).A+"#L21",children:"AuthenticationInteractorFactory.java:21"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"/**\n * \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u306eFactory\n * \u78ba\u8a8d\u65b9\u6cd5: \u5b9f\u30d5\u30a1\u30a4\u30eb\u306e21-24\u884c\u76ee\n */\npublic interface AuthenticationInteractorFactory {\n  AuthenticationInteractor create(AuthenticationDependencyContainer container);\n}\n\n// Password\u5b9f\u88c5\u4f8b\npublic class PasswordAuthenticationInteractorFactory implements AuthenticationInteractorFactory {\n  @Override\n  public AuthenticationInteractor create(AuthenticationDependencyContainer container) {\n    PasswordVerificationDelegation passwordVerificationDelegation =\n        container.resolve(PasswordVerificationDelegation.class);\n    return new PasswordAuthenticationInteractor(passwordVerificationDelegation);\n  }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(29279).A+"#L24",children:"PasswordAuthenticationInteractorFactory.java:24"})]}),"\n",(0,r.jsx)(e.h2,{id:"authenticationinteractor-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",children:"AuthenticationInteractor \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(1227).A+"#L23",children:"AuthenticationInteractor.java:23"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"/**\n * \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\n * \u78ba\u8a8d\u65b9\u6cd5: \u5b9f\u30d5\u30a1\u30a4\u30eb\u306e23-40\u884c\u76ee\n */\npublic interface AuthenticationInteractor {\n\n  // \u2705 \u30a4\u30f3\u30bf\u30e9\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30d7\n  AuthenticationInteractionType type();\n\n  // \u2705 \u30aa\u30da\u30ec\u30fc\u30b7\u30e7\u30f3\u30bf\u30a4\u30d7\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: AUTHENTICATION\uff09\n  default OperationType operationType() {\n    return OperationType.AUTHENTICATION;\n  }\n\n  // \u2705 \u8a8d\u8a3c\u65b9\u5f0f\u540d\uff08AMR\u5024\uff09\n  String method();\n\n  // \u2705 \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\n  AuthenticationInteractionRequestResult interact(\n      Tenant tenant,\n      AuthenticationTransaction transaction,\n      AuthenticationInteractionType type,\n      AuthenticationInteractionRequest request,\n      RequestAttributes requestAttributes,\n      UserQueryRepository userQueryRepository);\n}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"plugin\u767b\u9332",children:"Plugin\u767b\u9332"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# META-INF/services/org.idp.server.core.openid.authentication.plugin.AuthenticationInteractorFactory\norg.idp.server.authentication.interactors.password.PasswordAuthenticationInteractorFactory\norg.idp.server.authentication.interactors.sms.SmsAuthenticationInteractorFactory\norg.idp.server.authentication.interactors.cancel.AuthenticationCancelInteractorFactory\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3",children:"\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsx)(e.h3,{id:"1-password\u8a8d\u8a3c\u5b9f\u88c5",children:"1. Password\u8a8d\u8a3c\u5b9f\u88c5"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(61319).A+"#L30-L80",children:"PasswordAuthenticationInteractor.java:30-80"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class PasswordAuthenticationInteractor implements AuthenticationInteractor {\n\n  PasswordVerificationDelegation passwordVerificationDelegation;\n\n  @Override\n  public AuthenticationInteractionType type() {\n    return StandardAuthenticationInteraction.PASSWORD_AUTHENTICATION.toType();\n  }\n\n  @Override\n  public String method() {\n    return StandardAuthenticationMethod.PASSWORD.type(); // AMR\u5024: "pwd"\n  }\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(\n      Tenant tenant,\n      AuthenticationTransaction transaction,\n      AuthenticationInteractionType type,\n      AuthenticationInteractionRequest request,\n      RequestAttributes requestAttributes,\n      UserQueryRepository userQueryRepository) {\n\n    // 1. \u30ea\u30af\u30a8\u30b9\u30c8\u304b\u3089username/password\u3092\u53d6\u5f97\n    String username = request.optValueAsString("username", "");\n    String password = request.optValueAsString("password", "");\n    String providerId = request.optValueAsString("provider_id", "idp-server");\n\n    // 2. \u30e6\u30fc\u30b6\u30fc\u691c\u7d22\n    User user = userQueryRepository.findByEmail(tenant, username, providerId);\n\n    // 3. \u30d1\u30b9\u30ef\u30fc\u30c9\u691c\u8a3c\n    if (!passwordVerificationDelegation.verify(password, user.hashedPassword())) {\n      // \u8a8d\u8a3c\u5931\u6557\n      return new AuthenticationInteractionRequestResult(\n          AuthenticationInteractionStatus.CLIENT_ERROR,\n          type,\n          operationType(),\n          method(),\n          user,\n          Map.of("error", "invalid_request",\n                 "error_description", "user is not found or invalid password"),\n          DefaultSecurityEventType.password_failure);\n    }\n\n    // 4. \u8a8d\u8a3c\u6210\u529f\n    return new AuthenticationInteractionRequestResult(\n        AuthenticationInteractionStatus.SUCCESS,\n        type,\n        operationType(),\n        method(),\n        user,\n        Map.of("status", "authenticated"),\n        DefaultSecurityEventType.password_success);\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"PasswordVerificationDelegation"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u691c\u8a3c\u30ed\u30b8\u30c3\u30af\u3092\u59d4\u8b72\uff08bcrypt\u7b49\u306e\u5b9f\u88c5\u3092\u62bd\u8c61\u5316\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"SecurityEventType"}),": \u6210\u529f/\u5931\u6557\u3067\u30a4\u30d9\u30f3\u30c8\u767a\u884c\uff08password_success/password_failure\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"AMR\u5024"}),": ",(0,r.jsx)(e.code,{children:"StandardAuthenticationMethod.PASSWORD.type()"}),' \u2192 "pwd"']}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"Tenant\u7b2c\u4e00\u5f15\u6570"}),": \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5206\u96e2"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-sms\u8a8d\u8a3c\u5b9f\u88c5authenticationexecutor\u9023\u643a",children:"2. SMS\u8a8d\u8a3c\u5b9f\u88c5\uff08AuthenticationExecutor\u9023\u643a\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(55799).A+"#L37-L80",children:"SmsAuthenticationInteractor.java:37-80"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class SmsAuthenticationInteractor implements AuthenticationInteractor {\n\n  AuthenticationExecutors executors; // Executor\u5b9f\u884c\u30a8\u30f3\u30b8\u30f3\n  AuthenticationConfigurationQueryRepository configurationQueryRepository;\n\n  @Override\n  public AuthenticationInteractionType type() {\n    return StandardAuthenticationInteraction.SMS_AUTHENTICATION.toType();\n  }\n\n  @Override\n  public String method() {\n    return StandardAuthenticationMethod.SMS.type(); // AMR\u5024: "sms"\n  }\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(\n      Tenant tenant,\n      AuthenticationTransaction transaction,\n      AuthenticationInteractionType type,\n      AuthenticationInteractionRequest request,\n      RequestAttributes requestAttributes,\n      UserQueryRepository userQueryRepository) {\n\n    // 1. \u30c6\u30ca\u30f3\u30c8\u56fa\u6709\u306eSMS\u8a8d\u8a3c\u8a2d\u5b9a\u3092\u53d6\u5f97\n    AuthenticationConfiguration configuration =\n        configurationQueryRepository.get(tenant, "sms");\n    AuthenticationInteractionConfig interactionConfig =\n        configuration.getAuthenticationConfig("sms-authentication");\n    AuthenticationExecutionConfig execution = interactionConfig.execution();\n\n    // 2. \u52d5\u7684Executor\u9078\u629e\uff08\u8a2d\u5b9a\u304b\u3089\u5b9f\u884c\u95a2\u6570\u3092\u53d6\u5f97\uff09\n    AuthenticationExecutor executor = executors.get(execution.function());\n\n    // 3. Executor\u5b9f\u884c\n    AuthenticationExecutionRequest executionRequest =\n        new AuthenticationExecutionRequest(request.toMap());\n    AuthenticationExecutionResult executionResult =\n        executor.execute(tenant, transaction, executionRequest);\n\n    // 4. \u7d50\u679c\u5909\u63db\n    if (executionResult.isSuccess()) {\n      User user = executionResult.user();\n      return new AuthenticationInteractionRequestResult(\n          AuthenticationInteractionStatus.SUCCESS,\n          type,\n          operationType(),\n          method(),\n          user,\n          executionResult.response(),\n          DefaultSecurityEventType.sms_authentication_success);\n    } else {\n      return new AuthenticationInteractionRequestResult(\n          AuthenticationInteractionStatus.CLIENT_ERROR,\n          type,\n          operationType(),\n          method(),\n          executionResult.user(),\n          executionResult.response(),\n          DefaultSecurityEventType.sms_authentication_failure);\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"AuthenticationExecutors"}),": SMS\u9001\u4fe1\u30fb\u691c\u8a3c\u30ed\u30b8\u30c3\u30af\u3092\u5916\u90e8Executor\u306b\u59d4\u8b72"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u52d5\u7684\u8a2d\u5b9a"}),": \u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b\u7570\u306a\u308bSMS\u9001\u4fe1\u30b5\u30fc\u30d3\u30b9\uff08Twilio/AWS SNS\u7b49\uff09\u3092\u8a2d\u5b9a\u53ef\u80fd"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"AuthenticationConfiguration"}),": DB\u4fdd\u5b58\u306e\u8a2d\u5b9a\u304b\u3089\u5b9f\u884c\u95a2\u6570\u3092\u52d5\u7684\u9078\u629e"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"Challenge-Response"}),": SMS\u9001\u4fe1(Challenge) \u2192 OTP\u691c\u8a3c(Authentication)\u306e2\u6bb5\u968e\u5bfe\u5fdc"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-device\u8a8d\u8a3c\u5b9f\u88c5\u30d7\u30c3\u30b7\u30e5\u901a\u77e5",children:"3. Device\u8a8d\u8a3c\u5b9f\u88c5\uff08\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.code,{children:"libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/device/"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'/**\n * \u30c7\u30d0\u30a4\u30b9\u8a8d\u8a3c\uff08\u30d7\u30c3\u30b7\u30e5\u901a\u77e5\uff09\u306e3\u3064\u306e\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\n */\n\n// 1. \u901a\u77e5\u9001\u4fe1\npublic class AuthenticationDeviceNotificationInteractor implements AuthenticationInteractor {\n  AuthenticationDeviceNotifiers notifiers; // FCM/APNS notifier\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    // \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u9001\u4fe1\n    AuthenticationDeviceNotifier notifier = notifiers.get(deviceType);\n    notifier.send(tenant, user, challengeCode);\n\n    return new AuthenticationInteractionRequestResult(\n        AuthenticationInteractionStatus.PENDING, // \u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u5f85\u3061\n        ...);\n  }\n}\n\n// 2. \u30c7\u30d0\u30a4\u30b9\u627f\u8a8d\npublic class AuthenticationDeviceBindingMessageInteractor implements AuthenticationInteractor {\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    // \u30c7\u30d0\u30a4\u30b9\u304b\u3089\u306e\u627f\u8a8d\u30ec\u30b9\u30dd\u30f3\u30b9\u691c\u8a3c\n    if (challengeCode.equals(receivedCode)) {\n      return new AuthenticationInteractionRequestResult(\n          AuthenticationInteractionStatus.SUCCESS,\n          ...);\n    }\n  }\n}\n\n// 3. \u30c7\u30d0\u30a4\u30b9\u62d2\u5426\npublic class AuthenticationDeviceDeniedInteractor implements AuthenticationInteractor {\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    return new AuthenticationInteractionRequestResult(\n        AuthenticationInteractionStatus.CLIENT_ERROR,\n        type,\n        operationType(),\n        method(),\n        user,\n        Map.of("error", "access_denied", "error_description", "user denied"),\n        DefaultSecurityEventType.device_authentication_denied);\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"3\u6bb5\u968e\u30d5\u30ed\u30fc"}),": Notification\uff08\u9001\u4fe1\uff09 \u2192 Binding\uff08\u627f\u8a8d\uff09 / Denied\uff08\u62d2\u5426\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"PENDING\u72b6\u614b"}),": \u975e\u540c\u671f\u8a8d\u8a3c\u5bfe\u5fdc\uff08\u30e6\u30fc\u30b6\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u5f85\u3061\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"AuthenticationDeviceNotifiers"}),": FCM/APNS\u7b49\u306ePush\u901a\u77e5\u30b5\u30fc\u30d3\u30b9\u62bd\u8c61\u5316"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"Challenge Code"}),": \u30c7\u30d0\u30a4\u30b9\u56fa\u6709\u306e\u30c1\u30e3\u30ec\u30f3\u30b8\u30b3\u30fc\u30c9\u3067\u691c\u8a3c"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"authenticationdevicebindingmessageinteractor-\u8a73\u7d30",children:"AuthenticationDeviceBindingMessageInteractor \u8a73\u7d30"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(5285).A+"",children:"AuthenticationDeviceBindingMessageInteractor.java"})]}),"\n",(0,r.jsx)(e.p,{children:"CIBA\u30d5\u30ed\u30fc\u306b\u304a\u3051\u308b\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u691c\u8a3c\u3092\u62c5\u5f53\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class AuthenticationDeviceBindingMessageInteractor implements AuthenticationInteractor {\n\n  @Override\n  public AuthenticationInteractionType type() {\n    return StandardAuthenticationInteraction.AUTHENTICATION_DEVICE_BINDING_MESSAGE.toType();\n  }\n\n  @Override\n  public String method() {\n    return "binding-message";\n  }\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(\n      Tenant tenant,\n      AuthenticationTransaction transaction,\n      AuthenticationInteractionType type,\n      AuthenticationInteractionRequest request,\n      RequestAttributes requestAttributes,\n      UserQueryRepository userQueryRepository) {\n\n    // 1. AuthenticationContext\u304b\u3089binding_message\u3092\u53d6\u5f97\n    AuthenticationContext authenticationContext = transaction.requestContext();\n    BindingMessage bindingMessage = authenticationContext.bindingMessage();\n\n    // 2. binding_message\u672a\u8a2d\u5b9a\u30c1\u30a7\u30c3\u30af\n    if (bindingMessage == null) {\n      return AuthenticationInteractionRequestResult.clientError(\n          Map.of("error", "invalid_request",\n                 "error_description", "Binding Message is null"),\n          type, operationType(), method(),\n          DefaultSecurityEventType.authentication_device_binding_message_failure);\n    }\n\n    // 3. \u30e6\u30fc\u30b6\u30fc\u5165\u529b\u3068\u306e\u4e00\u81f4\u691c\u8a3c\n    String bindingMessageValue = request.getValueAsString("binding_message");\n    if (!bindingMessage.value().equals(bindingMessageValue)) {\n      return AuthenticationInteractionRequestResult.clientError(\n          Map.of("error", "invalid_request",\n                 "error_description", "Binding Message is unmatched"),\n          type, operationType(), method(),\n          DefaultSecurityEventType.authentication_device_binding_message_failure);\n    }\n\n    // 4. \u691c\u8a3c\u6210\u529f\n    return new AuthenticationInteractionRequestResult(\n        AuthenticationInteractionStatus.SUCCESS,\n        type, operationType(), method(),\n        Map.of(),\n        DefaultSecurityEventType.authentication_device_binding_message_success);\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7528\u9014"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u30d5\u30a3\u30c3\u30b7\u30f3\u30b0\u5bfe\u7b56"}),": \u6d88\u8cbb\u30c7\u30d0\u30a4\u30b9\u3068\u8a8d\u8a3c\u30c7\u30d0\u30a4\u30b9\u9593\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u4e00\u81f4\u78ba\u8a8d"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"OIDC CIBA\u4ed5\u69d8\u6e96\u62e0"}),": ",(0,r.jsx)(e.a,{href:"https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html#rfc.section.7.1",children:"Section 7.1"})]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"SecurityEventType"}),":"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u30a4\u30d9\u30f3\u30c8"}),(0,r.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"authentication_device_binding_message_success"})}),(0,r.jsx)(e.td,{children:"\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8\u691c\u8a3c\u6210\u529f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"authentication_device_binding_message_failure"})}),(0,r.jsx)(e.td,{children:"\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8\u691c\u8a3c\u5931\u6557"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),": ",(0,r.jsx)(e.a,{href:"/idp-server/docs/content_05_how-to/how-to-19-ciba-binding-message-verification",children:"how-to-19: CIBA\u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u30d0\u30c3\u30af\u30a8\u30f3\u30c9\u691c\u8a3c"})]}),"\n",(0,r.jsx)(e.h3,{id:"4-webauthn\u8a8d\u8a3c\u5b9f\u88c5challenge-response",children:"4. WebAuthn\u8a8d\u8a3c\u5b9f\u88c5\uff08Challenge-Response\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,r.jsx)(e.code,{children:"libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/webauthn/"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// 1. Challenge\u751f\u6210\npublic class WebAuthnAuthenticationChallengeInteractor implements AuthenticationInteractor {\n  @Override\n  public OperationType operationType() {\n    return OperationType.CHALLENGE; // \u2190 \u30c1\u30e3\u30ec\u30f3\u30b8\u5c02\u7528\n  }\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    // WebAuthn\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\n    WebAuthnChallenge challenge = WebAuthnChallenge.generate();\n\n    return new AuthenticationInteractionRequestResult(\n        AuthenticationInteractionStatus.SUCCESS,\n        type,\n        OperationType.CHALLENGE,\n        method(),\n        user,\n        Map.of("challenge", challenge.value(),\n               "rpId", tenant.domain(),\n               "timeout", 60000),\n        null); // Challenge\u306f\u30a4\u30d9\u30f3\u30c8\u767a\u884c\u3057\u306a\u3044\n  }\n}\n\n// 2. \u8a8d\u8a3c\u691c\u8a3c\npublic class WebAuthnAuthenticationInteractor implements AuthenticationInteractor {\n  WebAuthnExecutors executors; // webauthn4j\u30a2\u30c0\u30d7\u30bf\u30fc\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    // WebAuthn Assertion\u691c\u8a3c\n    WebAuthnExecutor executor = executors.get(WebAuthnExecutorType.AUTHENTICATION);\n    WebAuthnVerificationResult result = executor.verify(\n        tenant,\n        request.optValueAsString("credential_id", ""),\n        request.optValueAsString("authenticator_data", ""),\n        request.optValueAsString("client_data_json", ""),\n        request.optValueAsString("signature", ""));\n\n    if (result.isSuccess()) {\n      return new AuthenticationInteractionRequestResult(\n          AuthenticationInteractionStatus.SUCCESS,\n          type,\n          operationType(),\n          method(),\n          result.user(),\n          Map.of("status", "authenticated"),\n          DefaultSecurityEventType.webauthn_authentication_success);\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"OperationType.CHALLENGE"}),": \u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210\u5c02\u7528\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"OperationType.AUTHENTICATION"}),": \u8a8d\u8a3c\u691c\u8a3c\u5c02\u7528\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"WebAuthnExecutors"}),": webauthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u3078\u306e\u59d4\u8b72"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"Challenge-Response"}),": FIDO2\u4ed5\u69d8\u6e96\u62e0\u306e2\u6bb5\u968e\u30d5\u30ed\u30fc"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u5168\u4f53\u50cf",children:"\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u5168\u4f53\u50cf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// 1. PluginLoader\u3067\u5168Factory\u3092\u30ed\u30fc\u30c9\nList<AuthenticationInteractorFactory> factories =\n    PluginLoader.loadFromInternalModule(AuthenticationInteractorFactory.class);\n\n// 2. DependencyContainer\u304b\u3089Interactor\u751f\u6210\nAuthenticationDependencyContainer container = new AuthenticationDependencyContainer(...);\n\nMap<AuthenticationInteractionType, AuthenticationInteractor> interactors = new HashMap<>();\nfor (AuthenticationInteractorFactory factory : factories) {\n  AuthenticationInteractor interactor = factory.create(container);\n  interactors.put(interactor.type(), interactor);\n}\n\n// 3. \u8a8d\u8a3c\u5b9f\u884c\uff08\u4f8b: Password\u8a8d\u8a3c\uff09\nAuthenticationInteractionType interactionType = AuthenticationInteractionType.PASSWORD;\nAuthenticationInteractor interactor = interactors.get(interactionType);\n\nAuthenticationInteractionRequestResult result = interactor.interact(\n    tenant,\n    transaction,\n    interactionType,\n    request,\n    requestAttributes,\n    userQueryRepository);\n\nif (result.isSuccess()) {\n  // \u8a8d\u8a3c\u6210\u529f \u2192 Transaction\u306b\u53cd\u6620\n  transaction = transaction.updateWith(result);\n}\n\n// 4. Challenge-Response\u30d5\u30ed\u30fc\uff08\u4f8b: WebAuthn\uff09\n// Phase 1: Challenge\u751f\u6210\nAuthenticationInteractor challengeInteractor =\n    interactors.get(AuthenticationInteractionType.WEBAUTHN_CHALLENGE);\nAuthenticationInteractionRequestResult challengeResult =\n    challengeInteractor.interact(...);\n\n// Phase 2: \u8a8d\u8a3c\u691c\u8a3c\nAuthenticationInteractor authInteractor =\n    interactors.get(AuthenticationInteractionType.WEBAUTHN_AUTHENTICATION);\nAuthenticationInteractionRequestResult authResult =\n    authInteractor.interact(...);\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u8a8d\u8a3c\u624b\u6bb5\u5225\u306e\u7279\u5fb4",children:"\u8a8d\u8a3c\u624b\u6bb5\u5225\u306e\u7279\u5fb4"}),"\n",(0,r.jsx)(e.h3,{id:"challenge-response\u578b2\u6bb5\u968e",children:"Challenge-Response\u578b\uff082\u6bb5\u968e\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5bfe\u8c61"}),": WebAuthn, SMS, Email, Device"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Challenge\u751f\u6210"}),": ",(0,r.jsx)(e.code,{children:"OperationType.CHALLENGE"})," \u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u5b9f\u884c","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"WebAuthn: \u30e9\u30f3\u30c0\u30e0\u30c1\u30e3\u30ec\u30f3\u30b8\u751f\u6210"}),"\n",(0,r.jsx)(e.li,{children:"SMS/Email: OTP\u751f\u6210\u30fb\u9001\u4fe1"}),"\n",(0,r.jsx)(e.li,{children:"Device: \u30d7\u30c3\u30b7\u30e5\u901a\u77e5\u9001\u4fe1"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8a8d\u8a3c\u691c\u8a3c"}),": ",(0,r.jsx)(e.code,{children:"OperationType.AUTHENTICATION"})," \u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u5b9f\u884c","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"WebAuthn: Assertion\u691c\u8a3c"}),"\n",(0,r.jsx)(e.li,{children:"SMS/Email: OTP\u691c\u8a3c"}),"\n",(0,r.jsx)(e.li,{children:"Device: \u30c7\u30d0\u30a4\u30b9\u30ec\u30b9\u30dd\u30f3\u30b9\u691c\u8a3c"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"single-step\u578b1\u6bb5\u968e",children:"Single-Step\u578b\uff081\u6bb5\u968e\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5bfe\u8c61"}),": Password, External Token, Cancel"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8a8d\u8a3c\u691c\u8a3c\u306e\u307f"}),": ",(0,r.jsx)(e.code,{children:"OperationType.AUTHENTICATION"})," \u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u5b9f\u884c","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Password: \u30d1\u30b9\u30ef\u30fc\u30c9\u5373\u5ea7\u691c\u8a3c"}),"\n",(0,r.jsx)(e.li,{children:"External Token: \u5916\u90e8ID\u30b5\u30fc\u30d3\u30b9\u3078\u30c8\u30fc\u30af\u30f3\u691c\u8a3c"}),"\n",(0,r.jsx)(e.li,{children:"Cancel: \u8a8d\u8a3c\u30ad\u30e3\u30f3\u30bb\u30eb\u51e6\u7406"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u52d5\u7684\u8a2d\u5b9a\u3068executor\u59d4\u8b72",children:"\u52d5\u7684\u8a2d\u5b9a\u3068Executor\u59d4\u8b72"}),"\n",(0,r.jsx)(e.h3,{id:"authenticationexecutor-\u30d1\u30bf\u30fc\u30f3smsemaildevice",children:"AuthenticationExecutor \u30d1\u30bf\u30fc\u30f3\uff08SMS/Email/Device\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8a2d\u8a08\u601d\u60f3"}),": \u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u3092\u52d5\u7684\u8a2d\u5b9a\u3067\u5207\u308a\u66ff\u3048\u53ef\u80fd\u306b"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// 1. \u30c6\u30ca\u30f3\u30c8\u56fa\u6709\u8a2d\u5b9a\u3092\u53d6\u5f97\nAuthenticationConfiguration configuration = configurationQueryRepository.get(tenant, "sms");\nAuthenticationInteractionConfig interactionConfig =\n    configuration.getAuthenticationConfig("sms-authentication");\nAuthenticationExecutionConfig execution = interactionConfig.execution();\n\n// 2. \u8a2d\u5b9a\u304b\u3089\u5b9f\u884c\u95a2\u6570\u3092\u52d5\u7684\u9078\u629e\n// execution.function() \u2192 "twilio_sms_sender" or "aws_sns_sender" etc.\nAuthenticationExecutor executor = executors.get(execution.function());\n\n// 3. Executor\u5b9f\u884c\uff08\u5b9f\u88c5\u306fPlugin\uff09\nAuthenticationExecutionResult result = executor.execute(tenant, transaction, request);\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5229\u70b9"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u30c6\u30ca\u30f3\u30c8\u3054\u3068\u306b\u7570\u306a\u308bSMS\u9001\u4fe1\u30b5\u30fc\u30d3\u30b9"}),"\uff08Twilio, AWS SNS, \u30ab\u30b9\u30bf\u30e0\u5b9f\u88c5\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u30b3\u30fc\u30c9\u5909\u66f4\u306a\u3057\u3067\u5207\u308a\u66ff\u3048"}),"\uff08\u8a2d\u5b9a\u306e\u307f\u3067\u5909\u66f4\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u65b0\u3057\u3044\u30b5\u30fc\u30d3\u30b9\u8ffd\u52a0\u304c\u5bb9\u6613"}),"\uff08\u65b0Plugin\u3092\u8ffd\u52a0\u3059\u308b\u3060\u3051\uff09"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"delegation-\u30d1\u30bf\u30fc\u30f3password",children:"Delegation \u30d1\u30bf\u30fc\u30f3\uff08Password\uff09"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8a2d\u8a08\u601d\u60f3"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u30cf\u30c3\u30b7\u30e5\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u62bd\u8c61\u5316"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public class PasswordAuthenticationInteractor implements AuthenticationInteractor {\n  PasswordVerificationDelegation passwordVerificationDelegation;\n\n  // \u30d1\u30b9\u30ef\u30fc\u30c9\u691c\u8a3c\u3092\u59d4\u8b72\n  if (!passwordVerificationDelegation.verify(password, user.hashedPassword())) {\n    // \u8a8d\u8a3c\u5931\u6557\n  }\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5229\u70b9"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u30cf\u30c3\u30b7\u30e5\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u62bd\u8c61\u5316"}),"\uff08bcrypt, Argon2\u7b49\u306b\u5bfe\u5fdc\u53ef\u80fd\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8981\u4ef6\u5909\u66f4\u306b\u67d4\u8edf"}),"\uff08\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5909\u66f4\u304c\u5bb9\u6613\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:["\u2705 ",(0,r.jsx)(e.strong,{children:"\u30c6\u30b9\u30c8\u5bb9\u6613\u6027"}),"\uff08Delegation\u3092\u30e2\u30c3\u30af\u53ef\u80fd\uff09"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u8a2d\u8a08\u539f\u5247",children:"\u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u8a2d\u8a08\u539f\u5247"}),"\n",(0,r.jsx)(e.h3,{id:"1-tenant\u7b2c\u4e00\u5f15\u6570\u306e\u5fb9\u5e95",children:"1. Tenant\u7b2c\u4e00\u5f15\u6570\u306e\u5fb9\u5e95"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"AuthenticationInteractionRequestResult interact(\n    Tenant tenant,  // \u2190 \u5fc5\u305a\u7b2c\u4e00\u5f15\u6570\n    AuthenticationTransaction transaction,\n    AuthenticationInteractionType type,\n    AuthenticationInteractionRequest request,\n    RequestAttributes requestAttributes,\n    UserQueryRepository userQueryRepository);\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7406\u7531"}),": \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5206\u96e2\u3092\u578b\u30b7\u30b9\u30c6\u30e0\u3067\u5f37\u5236"]}),"\n",(0,r.jsx)(e.h3,{id:"2-securityevent\u767a\u884c\u306e\u4e00\u8cab\u6027",children:"2. SecurityEvent\u767a\u884c\u306e\u4e00\u8cab\u6027"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u6210\u529f\u6642\nreturn new AuthenticationInteractionRequestResult(\n    AuthenticationInteractionStatus.SUCCESS,\n    type,\n    operationType(),\n    method(),\n    user,\n    response,\n    DefaultSecurityEventType.{method}_success); // \u2190 \u5fc5\u305a\u6210\u529f\u30a4\u30d9\u30f3\u30c8\n\n// \u5931\u6557\u6642\nreturn new AuthenticationInteractionRequestResult(\n    AuthenticationInteractionStatus.CLIENT_ERROR,\n    type,\n    operationType(),\n    method(),\n    user,\n    errorResponse,\n    DefaultSecurityEventType.{method}_failure); // \u2190 \u5fc5\u305a\u5931\u6557\u30a4\u30d9\u30f3\u30c8\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7406\u7531"}),": \u5168\u8a8d\u8a3c\u8a66\u884c\u3092\u76e3\u67fb\u30ed\u30b0\u30fbSIEM\u9023\u643a\u3067\u8ffd\u8de1\u53ef\u80fd\u306b"]}),"\n",(0,r.jsx)(e.h3,{id:"3-amr\u5024\u306e\u6b63\u78ba\u6027",children:"3. AMR\u5024\u306e\u6b63\u78ba\u6027"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'@Override\npublic String method() {\n    return StandardAuthenticationMethod.PASSWORD.type(); // "pwd"\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u91cd\u8981"}),": ",(0,r.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc8176.html",children:"RFC 8176 - Authentication Method Reference Values"})," \u6e96\u62e0"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8a8d\u8a3c\u624b\u6bb5"}),(0,r.jsx)(e.th,{children:"AMR\u5024"}),(0,r.jsx)(e.th,{children:"RFC\u6e96\u62e0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Password"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"pwd"})}),(0,r.jsx)(e.td,{children:"\u2705 RFC 8176"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SMS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"sms"})}),(0,r.jsx)(e.td,{children:"\u2705 RFC 8176"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"WebAuthn"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"fido"})}),(0,r.jsx)(e.td,{children:"\u2705 RFC 8176"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"FIDO-UAF"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"fido"})}),(0,r.jsx)(e.td,{children:"\u2705 RFC 8176"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"\u62e1\u5f35\u6027\u306e\u5b9f\u73fe\u65b9\u6cd5",children:"\u62e1\u5f35\u6027\u306e\u5b9f\u73fe\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.h3,{id:"\u65b0\u3057\u3044\u8a8d\u8a3c\u624b\u6bb5\u306e\u8ffd\u52a0\u624b\u9806",children:"\u65b0\u3057\u3044\u8a8d\u8a3c\u624b\u6bb5\u306e\u8ffd\u52a0\u624b\u9806"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"Interactor\u5b9f\u88c5"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class CustomAuthenticationInteractor implements AuthenticationInteractor {\n  @Override\n  public AuthenticationInteractionType type() {\n    return new AuthenticationInteractionType("custom_auth");\n  }\n\n  @Override\n  public String method() {\n    return "custom"; // \u30ab\u30b9\u30bf\u30e0AMR\u5024\n  }\n\n  @Override\n  public AuthenticationInteractionRequestResult interact(...) {\n    // \u30ab\u30b9\u30bf\u30e0\u8a8d\u8a3c\u30ed\u30b8\u30c3\u30af\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.ol,{start:"2",children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"Factory\u5b9f\u88c5"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"public class CustomAuthenticationInteractorFactory implements AuthenticationInteractorFactory {\n  @Override\n  public AuthenticationInteractor create(AuthenticationDependencyContainer container) {\n    return new CustomAuthenticationInteractor();\n  }\n}\n"})}),"\n",(0,r.jsxs)(e.ol,{start:"3",children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"Plugin\u767b\u9332"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# META-INF/services/org.idp.server.core.openid.authentication.plugin.AuthenticationInteractorFactory\norg.idp.server.authentication.interactors.custom.CustomAuthenticationInteractorFactory\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u3053\u308c\u3060\u3051\u3067\u5b8c\u4e86"}),": \u30b3\u30a2\u30b3\u30fc\u30c9\u5909\u66f4\u4e0d\u8981\u3001\u8a2d\u5b9a\u8ffd\u52a0\u306e\u307f\u3067\u65b0\u8a8d\u8a3c\u624b\u6bb5\u304c\u5229\u7528\u53ef\u80fd\u306b"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation",children:"\u8a8d\u8a3c\u30fb\u9023\u643a\u5c64\u30c8\u30c3\u30d7"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/idp-server/docs/content_10_ai_developer/ai-42-webauthn",children:"WebAuthn/FIDO2\u5b9f\u88c5"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"/idp-server/docs/content_10_ai_developer/ai-43-federation-oidc",children:"OIDC\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3"})}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c\u7d50\u679c",children:"\ud83d\udccb \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u691c\u8a3c\u7d50\u679c"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u691c\u8a3c\u65e5"}),": 2025-10-12\n",(0,r.jsx)(e.strong,{children:"\u691c\u8a3c\u65b9\u6cd5"}),": ",(0,r.jsx)(e.code,{children:"ls libs/idp-server-authentication-interactors/src/main/java/org/idp/server/authentication/interactors/"})]}),"\n",(0,r.jsx)(e.h3,{id:"-\u691c\u8a3c\u6e08\u307f\u9805\u76ee",children:"\u2705 \u691c\u8a3c\u6e08\u307f\u9805\u76ee"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u9805\u76ee"}),(0,r.jsx)(e.th,{children:"\u8a18\u8f09\u5185\u5bb9"}),(0,r.jsx)(e.th,{children:"\u5b9f\u88c5\u78ba\u8a8d"}),(0,r.jsx)(e.th,{children:"\u72b6\u614b"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u8a8d\u8a3c\u624b\u6bb5\u6570"})}),(0,r.jsx)(e.td,{children:"10\u7a2e\u985e"}),(0,r.jsx)(e.td,{children:"10\u30d1\u30c3\u30b1\u30fc\u30b8"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u5168\u4e00\u81f4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"OperationType"})}),(0,r.jsx)(e.td,{children:"2\u7a2e\u985e"}),(0,r.jsx)(e.td,{children:"CHALLENGE/AUTHENTICATION"}),(0,r.jsx)(e.td,{children:"\u2705 \u6b63\u78ba"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Status\u7a2e\u985e"})}),(0,r.jsx)(e.td,{children:"3\u7a2e\u985e"}),(0,r.jsx)(e.td,{children:"SUCCESS/CLIENT_ERROR/PENDING"}),(0,r.jsx)(e.td,{children:"\u2705 \u6b63\u78ba"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"AMR\u5024"})}),(0,r.jsx)(e.td,{children:"RFC 8176\u6e96\u62e0"}),(0,r.jsx)(e.td,{children:"\u2705 \u6e96\u62e0"}),(0,r.jsx)(e.td,{children:"\u2705 \u6b63\u78ba"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"SecurityEvent\u9023\u643a"})}),(0,r.jsx)(e.td,{children:"\u5168Interactor"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b9f\u88c5\u78ba\u8a8d"}),(0,r.jsx)(e.td,{children:"\u2705 \u6b63\u78ba"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"-\u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\u4e00\u89a7\u5b9f\u88c5\u78ba\u8a8d\u6e08\u307f",children:"\ud83c\udfaf \u5b9f\u88c5\u30d1\u30c3\u30b1\u30fc\u30b8\u4e00\u89a7\uff08\u5b9f\u88c5\u78ba\u8a8d\u6e08\u307f\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u2705 cancel/                    # \u8a8d\u8a3c\u30ad\u30e3\u30f3\u30bb\u30eb\n\u2705 device/                    # \u30c7\u30d0\u30a4\u30b9\u8a8d\u8a3c\uff0812\u30af\u30e9\u30b9\uff09\n\u2705 email/                     # \u30e1\u30fc\u30ebOTP\n\u2705 external_token/            # \u5916\u90e8ID\u30b5\u30fc\u30d3\u30b9\u9023\u643a\n\u2705 fidouaf/                   # FIDO-UAF\n\u2705 initial_registration/      # \u521d\u56de\u767b\u9332\n\u2705 password/                  # \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\uff082\u30af\u30e9\u30b9\uff09\n\u2705 plugin/                    # Plugin\u5171\u901a\u5b9a\u7fa9\n\u2705 sms/                       # SMS OTP\uff0818\u30af\u30e9\u30b9\uff09\n\u2705 webauthn/                  # WebAuthn/FIDO2\uff0816\u30af\u30e9\u30b9\uff09\n"})}),"\n",(0,r.jsx)(e.h3,{id:"-\u7dcf\u5408\u8a55\u4fa1",children:"\ud83d\udcca \u7dcf\u5408\u8a55\u4fa1"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u30ab\u30c6\u30b4\u30ea"}),(0,r.jsx)(e.th,{children:"\u7cbe\u5ea6"}),(0,r.jsx)(e.th,{children:"\u8a55\u4fa1"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u8a8d\u8a3c\u624b\u6bb5\u4e00\u89a7"})}),(0,r.jsx)(e.td,{children:"100%"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3"})}),(0,r.jsx)(e.td,{children:"100%"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"OperationType"})}),(0,r.jsx)(e.td,{children:"100%"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"SecurityEvent"})}),(0,r.jsx)(e.td,{children:"100%"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u62e1\u5f35\u6027\u8aac\u660e"})}),(0,r.jsx)(e.td,{children:"100%"}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5168\u4f53\u7cbe\u5ea6"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"100%"})}),(0,r.jsx)(e.td,{children:"\u2705 \u5b8c\u74a7"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7d50\u8ad6"}),": \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u306e\u5f79\u5272\u30fb\u69cb\u9020\u30fb\u4e3b\u8981\u30af\u30e9\u30b9\u3092\u5b9f\u88c5\u306b\u57fa\u3065\u304d\u8a73\u7d30\u5316\u3002Plugin\u62e1\u5f35\u6027\u3068SecurityEvent\u9023\u643a\u3092\u660e\u78ba\u5316\u3002"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u60c5\u5831\u6e90"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"libs/idp-server-authentication-interactors/"}),"\u914d\u4e0b\u306e\u5168\u5b9f\u88c5"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(61319).A+"",children:"PasswordAuthenticationInteractor.java"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(55799).A+"",children:"SmsAuthenticationInteractor.java"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.rfc-editor.org/rfc/rfc8176.html",children:"RFC 8176 - Authentication Method Reference Values"})}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-12\n",(0,r.jsx)(e.strong,{children:"\u691c\u8a3c\u8005"}),": Claude Code\uff08AI\u958b\u767a\u652f\u63f4\uff09"]})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(l,{...n})}):l(n)}},5285:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/AuthenticationDeviceBindingMessageInteractor-b13e4bdb4d6946e026bc43bbed949fe4.java"},61319:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/PasswordAuthenticationInteractor-41cf0d0c1102b826a1bc515adbdaa3fe.java"},29279:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/PasswordAuthenticationInteractorFactory-8b03834b3874652f7b4abe02fca81be3.java"},55799:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/SmsAuthenticationInteractor-185477696d9625fdae1390162495d240.java"},1227:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/AuthenticationInteractor-9d6a705b9997a1620f1193eb398ee4a2.java"},68575:(n,e,t)=>{t.d(e,{A:()=>i});const i=t.p+"assets/files/AuthenticationInteractorFactory-861adf65279ee21d757ad306f6c36006.java"},28453:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>a});var i=t(96540);const r={},s=i.createContext(r);function c(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:c(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);