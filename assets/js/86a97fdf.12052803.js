"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2146],{726:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>r,contentTitle:()=>a,default:()=>E,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content_11_learning/postgresql/dev-04-transactions","title":"PostgreSQL \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3","description":"\u6240\u8981\u6642\u9593","source":"@site/docs/content_11_learning/11-postgresql/dev-04-transactions.md","sourceDirName":"content_11_learning/11-postgresql","slug":"/content_11_learning/postgresql/dev-04-transactions","permalink":"/idp-server/docs/content_11_learning/postgresql/dev-04-transactions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/11-postgresql/dev-04-transactions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"PostgreSQL \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u8a2d\u8a08\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/postgresql/dev-03-indexes"},"next":{"title":"PostgreSQL \u30af\u30a8\u30ea\u6700\u9069\u5316","permalink":"/idp-server/docs/content_11_learning/postgresql/dev-05-query-optimization"}}');var s=l(74848),c=l(28453);const d={},a="PostgreSQL \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3",r={},o=[{value:"\u6240\u8981\u6642\u9593",id:"\u6240\u8981\u6642\u9593",level:2},{value:"\u5b66\u3079\u308b\u3053\u3068",id:"\u5b66\u3079\u308b\u3053\u3068",level:2},{value:"\u524d\u63d0\u77e5\u8b58",id:"\u524d\u63d0\u77e5\u8b58",level:2},{value:"1. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3068\u306f",id:"1-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3068\u306f",level:2},{value:"1.1 \u57fa\u672c\u6982\u5ff5",id:"11-\u57fa\u672c\u6982\u5ff5",level:3},{value:"1.2 \u57fa\u672c\u69cb\u6587",id:"12-\u57fa\u672c\u69cb\u6587",level:3},{value:"1.3 \u6697\u9ed9\u7684\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3",id:"13-\u6697\u9ed9\u7684\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3",level:3},{value:"2. ACID\u7279\u6027",id:"2-acid\u7279\u6027",level:2},{value:"2.1 \u6982\u8981",id:"21-\u6982\u8981",level:3},{value:"2.2 \u539f\u5b50\u6027\uff08Atomicity\uff09\u306e\u4f8b",id:"22-\u539f\u5b50\u6027atomicity\u306e\u4f8b",level:3},{value:"2.3 \u4e00\u8cab\u6027\uff08Consistency\uff09\u306e\u4f8b",id:"23-\u4e00\u8cab\u6027consistency\u306e\u4f8b",level:3},{value:"2.4 \u5206\u96e2\u6027\uff08Isolation\uff09\u306e\u8a73\u7d30",id:"24-\u5206\u96e2\u6027isolation\u306e\u8a73\u7d30",level:3},{value:"2.5 \u6c38\u7d9a\u6027\uff08Durability\uff09\u306e\u4fdd\u8a3c",id:"25-\u6c38\u7d9a\u6027durability\u306e\u4fdd\u8a3c",level:3},{value:"3. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5206\u96e2\u30ec\u30d9\u30eb",id:"3-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5206\u96e2\u30ec\u30d9\u30eb",level:2},{value:"3.1 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u6982\u8981",id:"31-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u6982\u8981",level:3},{value:"3.2 \u767a\u751f\u3057\u3046\u308b\u73fe\u8c61",id:"32-\u767a\u751f\u3057\u3046\u308b\u73fe\u8c61",level:3},{value:"3.3 \u5404\u73fe\u8c61\u306e\u5177\u4f53\u4f8b",id:"33-\u5404\u73fe\u8c61\u306e\u5177\u4f53\u4f8b",level:3},{value:"Dirty Read\uff08\u30c0\u30fc\u30c6\u30a3\u30ea\u30fc\u30c9\uff09",id:"dirty-read\u30c0\u30fc\u30c6\u30a3\u30ea\u30fc\u30c9",level:4},{value:"Non-Repeatable Read\uff08\u53cd\u5fa9\u4e0d\u80fd\u8aad\u307f\u53d6\u308a\uff09",id:"non-repeatable-read\u53cd\u5fa9\u4e0d\u80fd\u8aad\u307f\u53d6\u308a",level:4},{value:"Phantom Read\uff08\u30d5\u30a1\u30f3\u30c8\u30e0\u30ea\u30fc\u30c9\uff09",id:"phantom-read\u30d5\u30a1\u30f3\u30c8\u30e0\u30ea\u30fc\u30c9",level:4},{value:"3.4 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",id:"34-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",level:3},{value:"3.5 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u9078\u629e\u6307\u91dd",id:"35-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u9078\u629e\u6307\u91dd",level:3},{value:"4. \u30ed\u30c3\u30af\u6a5f\u69cb",id:"4-\u30ed\u30c3\u30af\u6a5f\u69cb",level:2},{value:"4.1 \u30ed\u30c3\u30af\u306e\u7a2e\u985e",id:"41-\u30ed\u30c3\u30af\u306e\u7a2e\u985e",level:3},{value:"4.2 \u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af",id:"42-\u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af",level:3},{value:"4.3 \u884c\u30ed\u30c3\u30af\u306e\u7af6\u5408\u30de\u30c8\u30ea\u30af\u30b9",id:"43-\u884c\u30ed\u30c3\u30af\u306e\u7af6\u5408\u30de\u30c8\u30ea\u30af\u30b9",level:3},{value:"4.4 \u30ed\u30c3\u30af\u5f85\u6a5f\u306e\u53ef\u8996\u5316",id:"44-\u30ed\u30c3\u30af\u5f85\u6a5f\u306e\u53ef\u8996\u5316",level:3},{value:"5. \u30c7\u30c3\u30c9\u30ed\u30c3\u30af",id:"5-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af",level:2},{value:"5.1 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",id:"51-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",level:3},{value:"5.2 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u4f8b",id:"52-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u4f8b",level:3},{value:"5.3 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f\u7b56",id:"53-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f\u7b56",level:3},{value:"\u7b561: \u4e00\u8cab\u3057\u305f\u9806\u5e8f\u3067\u30ed\u30c3\u30af",id:"\u7b561-\u4e00\u8cab\u3057\u305f\u9806\u5e8f\u3067\u30ed\u30c3\u30af",level:4},{value:"\u7b562: \u30ed\u30c3\u30af\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a",id:"\u7b562-\u30ed\u30c3\u30af\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a",level:4},{value:"\u7b563: NOWAIT \u30aa\u30d7\u30b7\u30e7\u30f3",id:"\u7b563-nowait-\u30aa\u30d7\u30b7\u30e7\u30f3",level:4},{value:"\u7b564: \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u306e\u30ea\u30c8\u30e9\u30a4",id:"\u7b564-\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u306e\u30ea\u30c8\u30e9\u30a4",level:4},{value:"5.4 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\u306e\u8a2d\u5b9a",id:"54-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\u306e\u8a2d\u5b9a",level:3},{value:"6. \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8",id:"6-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8",level:2},{value:"6.1 \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u3068\u306f",id:"61-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u3068\u306f",level:3},{value:"6.2 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",id:"62-\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",level:3},{value:"6.3 \u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u4f8b",id:"63-\u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u4f8b",level:3},{value:"\u30d0\u30c3\u30c1\u51e6\u7406\u3067\u306e\u90e8\u5206\u30b3\u30df\u30c3\u30c8",id:"\u30d0\u30c3\u30c1\u51e6\u7406\u3067\u306e\u90e8\u5206\u30b3\u30df\u30c3\u30c8",level:4},{value:"\u8907\u6570\u64cd\u4f5c\u306e\u6761\u4ef6\u4ed8\u304d\u5b9f\u884c",id:"\u8907\u6570\u64cd\u4f5c\u306e\u6761\u4ef6\u4ed8\u304d\u5b9f\u884c",level:4},{value:"6.4 \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u5236\u9650\u3068\u6ce8\u610f\u70b9",id:"64-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u5236\u9650\u3068\u6ce8\u610f\u70b9",level:3},{value:"7. MVCC\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8",id:"7-mvcc\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8",level:2},{value:"7.1 MVCC\u3068\u306f",id:"71-mvcc\u3068\u306f",level:3},{value:"7.2 \u53ef\u8996\u6027\u30eb\u30fc\u30eb",id:"72-\u53ef\u8996\u6027\u30eb\u30fc\u30eb",level:3},{value:"7.3 \u8aad\u307f\u53d6\u308a\u3068\u66f8\u304d\u8fbc\u307f\u306e\u5206\u96e2",id:"73-\u8aad\u307f\u53d6\u308a\u3068\u66f8\u304d\u8fbc\u307f\u306e\u5206\u96e2",level:3},{value:"8. \u5b9f\u8df5\u7684\u306a\u30d1\u30bf\u30fc\u30f3",id:"8-\u5b9f\u8df5\u7684\u306a\u30d1\u30bf\u30fc\u30f3",level:2},{value:"8.1 SELECT FOR UPDATE \u30d1\u30bf\u30fc\u30f3",id:"81-select-for-update-\u30d1\u30bf\u30fc\u30f3",level:3},{value:"8.2 Upsert\uff08INSERT ON CONFLICT\uff09",id:"82-upsertinsert-on-conflict",level:3},{value:"8.3 Advisory Lock\uff08\u30a2\u30c9\u30d0\u30a4\u30b6\u30ea\u30fc\u30ed\u30c3\u30af\uff09",id:"83-advisory-lock\u30a2\u30c9\u30d0\u30a4\u30b6\u30ea\u30fc\u30ed\u30c3\u30af",level:3},{value:"8.4 \u697d\u89b3\u7684\u30ed\u30c3\u30af",id:"84-\u697d\u89b3\u7684\u30ed\u30c3\u30af",level:3},{value:"9. \u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",id:"9-\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",level:2},{value:"9.1 \u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u691c\u51fa",id:"91-\u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u691c\u51fa",level:3},{value:"9.2 \u30a2\u30a4\u30c9\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u81ea\u52d5\u7d42\u4e86",id:"92-\u30a2\u30a4\u30c9\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u81ea\u52d5\u7d42\u4e86",level:3},{value:"9.3 \u30ed\u30c3\u30af\u7af6\u5408\u306e\u5206\u6790",id:"93-\u30ed\u30c3\u30af\u7af6\u5408\u306e\u5206\u6790",level:3},{value:"9.4 \u5f37\u5236\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u7d42\u4e86",id:"94-\u5f37\u5236\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u7d42\u4e86",level:3},{value:"10. \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",id:"10-\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",level:2},{value:"10.1 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u8a2d\u8a08",id:"101-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u8a2d\u8a08",level:3},{value:"10.2 \u63a8\u5968\u8a2d\u5b9a",id:"102-\u63a8\u5968\u8a2d\u5b9a",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2}];function t(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"postgresql-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3",children:"PostgreSQL \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6240\u8981\u6642\u9593",children:"\u6240\u8981\u6642\u9593"}),"\n",(0,s.jsx)(e.p,{children:"\u7d0445\u5206"}),"\n",(0,s.jsx)(e.h2,{id:"\u5b66\u3079\u308b\u3053\u3068",children:"\u5b66\u3079\u308b\u3053\u3068"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u57fa\u672c\u6982\u5ff5\u3068ACID\u7279\u6027"}),"\n",(0,s.jsx)(e.li,{children:"\u5206\u96e2\u30ec\u30d9\u30eb\u3068\u5404\u30ec\u30d9\u30eb\u3067\u767a\u751f\u3059\u308b\u73fe\u8c61"}),"\n",(0,s.jsx)(e.li,{children:"\u30ed\u30c3\u30af\u6a5f\u69cb\u3068\u9069\u5207\u306a\u4f7f\u3044\u65b9"}),"\n",(0,s.jsx)(e.li,{children:"\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.li,{children:"\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u6d3b\u7528"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u524d\u63d0\u77e5\u8b58",children:"\u524d\u63d0\u77e5\u8b58"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"SQL\u306e\u57fa\u672c\u64cd\u4f5c\uff08SELECT\u3001UPDATE\u7b49\uff09"}),"\n",(0,s.jsx)(e.li,{children:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u8a08\u306e\u57fa\u790e"}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"1-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3068\u306f",children:"1. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3068\u306f"}),"\n",(0,s.jsx)(e.h3,{id:"11-\u57fa\u672c\u6982\u5ff5",children:"1.1 \u57fa\u672c\u6982\u5ff5"}),"\n",(0,s.jsxs)(e.p,{children:["\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u3001\u8907\u6570\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u64cd\u4f5c\u3092",(0,s.jsx)(e.strong,{children:"\u4e00\u3064\u306e\u8ad6\u7406\u7684\u306a\u4f5c\u696d\u5358\u4f4d"}),"\u3068\u3057\u3066\u307e\u3068\u3081\u308b\u4ed5\u7d44\u307f\u3067\u3059\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 \u64cd\u4f5c 1   \u2502 \u2192 \u2502 \u64cd\u4f5c 2   \u2502 \u2192 \u2502 \u64cd\u4f5c 3   \u2502              \u2502\n\u2502  \u2502 UPDATE  \u2502   \u2502 INSERT  \u2502   \u2502 DELETE  \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                                                         \u2502\n\u2502  \u3059\u3079\u3066\u6210\u529f \u2192 COMMIT\uff08\u78ba\u5b9a\uff09                              \u2502\n\u2502  \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 ROLLBACK\uff08\u53d6\u6d88\uff09                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"12-\u57fa\u672c\u69cb\u6587",children:"1.2 \u57fa\u672c\u69cb\u6587"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\nBEGIN;\n\n-- \u8907\u6570\u306e\u64cd\u4f5c\nUPDATE accounts SET balance = balance - 1000 WHERE id = 1;\nUPDATE accounts SET balance = balance + 1000 WHERE id = 2;\n\n-- \u6210\u529f\u3057\u305f\u3089\u78ba\u5b9a\nCOMMIT;\n\n-- \u5931\u6557\u3057\u305f\u3089\u53d6\u6d88\n-- ROLLBACK;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"13-\u6697\u9ed9\u7684\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3",children:"1.3 \u6697\u9ed9\u7684\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3"}),"\n",(0,s.jsxs)(e.p,{children:["PostgreSQL\u3067\u306f\u3001\u660e\u793a\u7684\u306b",(0,s.jsx)(e.code,{children:"BEGIN"}),"\u3092\u66f8\u304b\u306a\u3044\u5834\u5408\u3001\u5404SQL\u6587\u304c",(0,s.jsx)(e.strong,{children:"\u81ea\u52d5\u30b3\u30df\u30c3\u30c8"}),"\u3055\u308c\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u3053\u308c\u3089\u306f\u5404\u6587\u304c\u500b\u5225\u306b\u30b3\u30df\u30c3\u30c8\u3055\u308c\u308b\nUPDATE accounts SET balance = balance - 1000 WHERE id = 1;  -- \u5373\u5ea7\u306b\u30b3\u30df\u30c3\u30c8\nUPDATE accounts SET balance = balance + 1000 WHERE id = 2;  -- \u5373\u5ea7\u306b\u30b3\u30df\u30c3\u30c8\n\n-- 1\u3064\u76ee\u304c\u6210\u529f\u3057\u30662\u3064\u76ee\u304c\u5931\u6557\u3059\u308b\u3068\u3001\u4e0d\u6574\u5408\u304c\u767a\u751f\u3059\u308b\uff01\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u91cd\u8981"}),": \u8907\u6570\u306e\u95a2\u9023\u3059\u308b\u64cd\u4f5c\u306f\u5fc5\u305a\u660e\u793a\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u56f2\u3080\u3053\u3068\u3002"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"2-acid\u7279\u6027",children:"2. ACID\u7279\u6027"}),"\n",(0,s.jsx)(e.p,{children:"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u304c\u4fdd\u8a3c\u3059\u308b4\u3064\u306e\u7279\u6027\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"21-\u6982\u8981",children:"2.1 \u6982\u8981"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          ACID\u7279\u6027                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Atomicity    \u2502 \u539f\u5b50\u6027\uff1a\u5168\u90e8\u6210\u529f or \u5168\u90e8\u5931\u6557\u3001\u4e2d\u9014\u534a\u7aef\u306a\u72b6\u614b\u306f\u306a\u3044      \u2502\n\u2502 (\u539f\u5b50\u6027)      \u2502                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Consistency  \u2502 \u4e00\u8cab\u6027\uff1a\u5236\u7d04\u9055\u53cd\u304c\u3042\u308c\u3070\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u5931\u6557          \u2502\n\u2502 (\u4e00\u8cab\u6027)      \u2502                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Isolation    \u2502 \u5206\u96e2\u6027\uff1a\u540c\u6642\u5b9f\u884c\u3055\u308c\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u4e92\u3044\u306b\u5e72\u6e09\u3057\u306a\u3044 \u2502\n\u2502 (\u5206\u96e2\u6027)      \u2502                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Durability   \u2502 \u6c38\u7d9a\u6027\uff1a\u30b3\u30df\u30c3\u30c8\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306f\u6c38\u7d9a\u7684\u306b\u4fdd\u5b58\u3055\u308c\u308b        \u2502\n\u2502 (\u6c38\u7d9a\u6027)      \u2502                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"22-\u539f\u5b50\u6027atomicity\u306e\u4f8b",children:"2.2 \u539f\u5b50\u6027\uff08Atomicity\uff09\u306e\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u9280\u884c\u306e\u9001\u91d1\u51e6\u7406\nBEGIN;\n  -- \u9001\u91d1\u5143\u304b\u3089\u5f15\u304d\u843d\u3068\u3057\n  UPDATE accounts SET balance = balance - 10000 WHERE id = 1;\n\n  -- \u9001\u91d1\u5148\u306b\u5165\u91d1\uff08\u3053\u3053\u3067\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u3068\u4eee\u5b9a\uff09\n  UPDATE accounts SET balance = balance + 10000 WHERE id = 999;  -- \u5b58\u5728\u3057\u306a\u3044ID\n\n  -- \u30a8\u30e9\u30fc\u304c\u767a\u751f\u3059\u308b\u3068\u3001\u6700\u521d\u306eUPDATE\u3082\u53d6\u308a\u6d88\u3055\u308c\u308b\nROLLBACK;  -- \u307e\u305f\u306f\u81ea\u52d5\u7684\u306b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\n\n-- \u7d50\u679c\uff1a\u3069\u3061\u3089\u306e\u53e3\u5ea7\u3082\u5909\u66f4\u3055\u308c\u306a\u3044\uff08\u539f\u5b50\u6027\u304c\u4fdd\u8a3c\u3055\u308c\u308b\uff09\n"})}),"\n",(0,s.jsx)(e.h3,{id:"23-\u4e00\u8cab\u6027consistency\u306e\u4f8b",children:"2.3 \u4e00\u8cab\u6027\uff08Consistency\uff09\u306e\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5236\u7d04\u306b\u3088\u308b\u4e00\u8cab\u6027\u306e\u4fdd\u8a3c\nCREATE TABLE accounts (\n    id SERIAL PRIMARY KEY,\n    balance NUMERIC(15,2) CHECK (balance >= 0)  -- \u6b8b\u9ad8\u306f0\u4ee5\u4e0a\n);\n\nBEGIN;\n  UPDATE accounts SET balance = balance - 10000 WHERE id = 1;\n  -- balance \u304c\u8ca0\u306b\u306a\u308b\u5834\u5408\u3001CHECK\u5236\u7d04\u9055\u53cd\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5168\u4f53\u304c\u5931\u6557\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"24-\u5206\u96e2\u6027isolation\u306e\u8a73\u7d30",children:"2.4 \u5206\u96e2\u6027\uff08Isolation\uff09\u306e\u8a73\u7d30"}),"\n",(0,s.jsx)(e.p,{children:"\u5206\u96e2\u6027\u306f\u6b21\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u3067\u8a73\u3057\u304f\u8aac\u660e\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"25-\u6c38\u7d9a\u6027durability\u306e\u4fdd\u8a3c",children:"2.5 \u6c38\u7d9a\u6027\uff08Durability\uff09\u306e\u4fdd\u8a3c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u6c38\u7d9a\u6027\u306e\u5b9f\u73fe\u65b9\u6cd5                         \u2502\n\u2502                                                         \u2502\n\u2502  COMMIT\u5b9f\u884c                                              \u2502\n\u2502      \u2193                                                  \u2502\n\u2502  WAL\uff08Write-Ahead Log\uff09\u306b\u66f8\u304d\u8fbc\u307f                        \u2502\n\u2502      \u2193                                                  \u2502\n\u2502  \u30c7\u30a3\u30b9\u30af\u306b\u540c\u671f\uff08fsync\uff09                                  \u2502\n\u2502      \u2193                                                  \u2502\n\u2502  \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u6210\u529f\u3092\u8fd4\u7b54                                 \u2502\n\u2502                                                         \u2502\n\u2502  \u203b \u30b5\u30fc\u30d0\u30fc\u30af\u30e9\u30c3\u30b7\u30e5\u6642\u3082WAL\u304b\u3089\u5fa9\u65e7\u53ef\u80fd                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"3-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5206\u96e2\u30ec\u30d9\u30eb",children:"3. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5206\u96e2\u30ec\u30d9\u30eb"}),"\n",(0,s.jsx)(e.h3,{id:"31-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u6982\u8981",children:"3.1 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u6982\u8981"}),"\n",(0,s.jsx)(e.p,{children:"PostgreSQL\u306f4\u3064\u306e\u5206\u96e2\u30ec\u30d9\u30eb\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5206\u96e2\u30ec\u30d9\u30eb                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u5206\u96e2\u30ec\u30d9\u30eb            \u2502 \u8aac\u660e                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 READ UNCOMMITTED     \u2502 \u4ed6\u306e\u30b3\u30df\u30c3\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u5909\u66f4\u304c\u898b\u3048\u308b                       \u2502\n\u2502                      \u2502 \u203b PostgreSQL\u3067\u306f READ COMMITTED \u3068\u540c\u7b49                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 READ COMMITTED       \u2502 \u4ed6\u306e\u30b3\u30df\u30c3\u30c8\u3055\u308c\u305f\u5909\u66f4\u306e\u307f\u304c\u898b\u3048\u308b\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09            \u2502\n\u2502                      \u2502 \u5404SQL\u6587\u306e\u5b9f\u884c\u6642\u70b9\u3067\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 REPEATABLE READ      \u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u958b\u59cb\u6642\u70b9\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3092\u4f7f\u7528            \u2502\n\u2502                      \u2502 \u540c\u3058\u30af\u30a8\u30ea\u306f\u5e38\u306b\u540c\u3058\u7d50\u679c                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 SERIALIZABLE         \u2502 \u5b8c\u5168\u306a\u76f4\u5217\u5316\u53ef\u80fd\u6027\u3092\u4fdd\u8a3c                                   \u2502\n\u2502                      \u2502 \u6700\u3082\u53b3\u683c\u3060\u304c\u3001\u7af6\u5408\u6642\u306b\u30a8\u30e9\u30fc\u306b\u306a\u308b\u53ef\u80fd\u6027                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"32-\u767a\u751f\u3057\u3046\u308b\u73fe\u8c61",children:"3.2 \u767a\u751f\u3057\u3046\u308b\u73fe\u8c61"}),"\n",(0,s.jsx)(e.p,{children:"\u5404\u5206\u96e2\u30ec\u30d9\u30eb\u3067\u767a\u751f\u3057\u3046\u308b\u73fe\u8c61\u3092\u6574\u7406\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u5206\u96e2\u30ec\u30d9\u30eb\u3068\u767a\u751f\u3059\u308b\u73fe\u8c61                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u5206\u96e2\u30ec\u30d9\u30eb        \u2502 Dirty Read   \u2502 Non-Repeatable\u2502 Phantom      \u2502 \u76f4\u5217\u5316    \u2502\n\u2502                  \u2502 (\u30c0\u30fc\u30c6\u30a3     \u2502 Read(\u53cd\u5fa9    \u2502 Read(\u30d5\u30a1\u30f3  \u2502 \u7570\u5e38      \u2502\n\u2502                  \u2502  \u30ea\u30fc\u30c9)      \u2502 \u4e0d\u80fd\u8aad\u307f\u53d6\u308a) \u2502 \u30c8\u30e0\u30ea\u30fc\u30c9)  \u2502           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 READ UNCOMMITTED \u2502 \u767a\u751f\u3057\u306a\u3044\u203b  \u2502 \u767a\u751f\u3059\u308b      \u2502 \u767a\u751f\u3059\u308b      \u2502 \u767a\u751f\u3059\u308b  \u2502\n\u2502 READ COMMITTED   \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3059\u308b      \u2502 \u767a\u751f\u3059\u308b      \u2502 \u767a\u751f\u3059\u308b  \u2502\n\u2502 REPEATABLE READ  \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3057\u306a\u3044\u203b  \u2502 \u767a\u751f\u3059\u308b  \u2502\n\u2502 SERIALIZABLE     \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3057\u306a\u3044    \u2502 \u767a\u751f\u3057\u306a\u3044\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u203b PostgreSQL\u72ec\u81ea\u306e\u5b9f\u88c5\u306b\u3088\u308a\u3001\u6a19\u6e96SQL\u3088\u308a\u53b3\u683c\n"})}),"\n",(0,s.jsx)(e.h3,{id:"33-\u5404\u73fe\u8c61\u306e\u5177\u4f53\u4f8b",children:"3.3 \u5404\u73fe\u8c61\u306e\u5177\u4f53\u4f8b"}),"\n",(0,s.jsx)(e.h4,{id:"dirty-read\u30c0\u30fc\u30c6\u30a3\u30ea\u30fc\u30c9",children:"Dirty Read\uff08\u30c0\u30fc\u30c6\u30a3\u30ea\u30fc\u30c9\uff09"}),"\n",(0,s.jsx)(e.p,{children:"\u672a\u30b3\u30df\u30c3\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u8aad\u3093\u3067\u3057\u307e\u3046\u73fe\u8c61\uff08PostgreSQL\u3067\u306f\u767a\u751f\u3057\u306a\u3044\uff09\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u6642\u9593 \u2192\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A              \u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 BEGIN;                        \u2502                              \u2502\n\u2502 UPDATE users                  \u2502                              \u2502\n\u2502   SET name = '\u5909\u66f4\u5f8c'         \u2502                              \u2502\n\u2502   WHERE id = 1;               \u2502                              \u2502\n\u2502                               \u2502 BEGIN;                       \u2502\n\u2502                               \u2502 SELECT name FROM users       \u2502\n\u2502                               \u2502   WHERE id = 1;              \u2502\n\u2502                               \u2502 -- '\u5909\u66f4\u5f8c' \u304c\u898b\u3048\u308b\uff1f        \u2502\n\u2502                               \u2502 -- PostgreSQL\u3067\u306f\u898b\u3048\u306a\u3044    \u2502\n\u2502 ROLLBACK;                     \u2502                              \u2502\n\u2502                               \u2502 -- \u3082\u3057\u898b\u3048\u3066\u3044\u305f\u3089\u4e0d\u6574\u5408    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h4,{id:"non-repeatable-read\u53cd\u5fa9\u4e0d\u80fd\u8aad\u307f\u53d6\u308a",children:"Non-Repeatable Read\uff08\u53cd\u5fa9\u4e0d\u80fd\u8aad\u307f\u53d6\u308a\uff09"}),"\n",(0,s.jsx)(e.p,{children:"\u540c\u3058\u30af\u30a8\u30ea\u30922\u56de\u5b9f\u884c\u3059\u308b\u3068\u7570\u306a\u308b\u7d50\u679c\u304c\u8fd4\u308b\u73fe\u8c61\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A\uff08READ COMMITTED\uff09\nBEGIN;\nSELECT balance FROM accounts WHERE id = 1;  -- \u7d50\u679c: 10000\n\n-- \u3053\u306e\u9593\u306b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B\u304c\u66f4\u65b0\u30fb\u30b3\u30df\u30c3\u30c8\n-- UPDATE accounts SET balance = 5000 WHERE id = 1; COMMIT;\n\nSELECT balance FROM accounts WHERE id = 1;  -- \u7d50\u679c: 5000\uff08\u5909\u308f\u3063\u305f\uff01\uff09\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u6642\u9593 \u2192\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A              \u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 BEGIN;                        \u2502                              \u2502\n\u2502 SELECT balance...             \u2502                              \u2502\n\u2502 \u2192 10000                       \u2502                              \u2502\n\u2502                               \u2502 BEGIN;                       \u2502\n\u2502                               \u2502 UPDATE accounts              \u2502\n\u2502                               \u2502   SET balance = 5000...      \u2502\n\u2502                               \u2502 COMMIT;                      \u2502\n\u2502 SELECT balance...             \u2502                              \u2502\n\u2502 \u2192 5000 \u2190 \u5024\u304c\u5909\u308f\u3063\u305f\uff01        \u2502                              \u2502\n\u2502 COMMIT;                       \u2502                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h4,{id:"phantom-read\u30d5\u30a1\u30f3\u30c8\u30e0\u30ea\u30fc\u30c9",children:"Phantom Read\uff08\u30d5\u30a1\u30f3\u30c8\u30e0\u30ea\u30fc\u30c9\uff09"}),"\n",(0,s.jsx)(e.p,{children:"\u540c\u3058\u6761\u4ef6\u3067\u691c\u7d22\u3059\u308b\u3068\u3001\u884c\u6570\u304c\u5909\u308f\u308b\u73fe\u8c61\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A\uff08READ COMMITTED\uff09\nBEGIN;\nSELECT COUNT(*) FROM users WHERE status = 'active';  -- \u7d50\u679c: 100\n\n-- \u3053\u306e\u9593\u306b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B\u304c\u65b0\u898f\u884c\u3092\u8ffd\u52a0\u30fb\u30b3\u30df\u30c3\u30c8\n\nSELECT COUNT(*) FROM users WHERE status = 'active';  -- \u7d50\u679c: 101\uff08\u5897\u3048\u305f\uff01\uff09\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"34-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a",children:"3.4 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5358\u4f4d\u3067\u8a2d\u5b9a\nBEGIN TRANSACTION ISOLATION LEVEL REPEATABLE READ;\n-- \u307e\u305f\u306f\nBEGIN;\nSET TRANSACTION ISOLATION LEVEL REPEATABLE READ;\n\n-- \u30bb\u30c3\u30b7\u30e7\u30f3\u5358\u4f4d\u3067\u8a2d\u5b9a\nSET SESSION CHARACTERISTICS AS TRANSACTION ISOLATION LEVEL REPEATABLE READ;\n\n-- \u73fe\u5728\u306e\u5206\u96e2\u30ec\u30d9\u30eb\u3092\u78ba\u8a8d\nSHOW transaction_isolation;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"35-\u5206\u96e2\u30ec\u30d9\u30eb\u306e\u9078\u629e\u6307\u91dd",children:"3.5 \u5206\u96e2\u30ec\u30d9\u30eb\u306e\u9078\u629e\u6307\u91dd"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         \u5206\u96e2\u30ec\u30d9\u30eb\u9078\u629e\u30ac\u30a4\u30c9                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u30e6\u30fc\u30b9\u30b1\u30fc\u30b9          \u2502 \u63a8\u5968\u5206\u96e2\u30ec\u30d9\u30eb                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u4e00\u822c\u7684\u306aWeb\u30a2\u30d7\u30ea     \u2502 READ COMMITTED\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09                              \u2502\n\u2502                      \u2502 \u307b\u3068\u3093\u3069\u306e\u5834\u5408\u306f\u3053\u308c\u3067\u5341\u5206                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u30ec\u30dd\u30fc\u30c8\u751f\u6210          \u2502 REPEATABLE READ                                          \u2502\n\u2502 \u96c6\u8a08\u51e6\u7406             \u2502 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u4e2d\u306f\u4e00\u8cab\u3057\u305f\u30c7\u30fc\u30bf\u3092\u898b\u308b\u5fc5\u8981\u304c\u3042\u308b        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u5728\u5eab\u7ba1\u7406             \u2502 SERIALIZABLE                                             \u2502\n\u2502 \u4e88\u7d04\u30b7\u30b9\u30c6\u30e0          \u2502 \u7af6\u5408\u3092\u5b8c\u5168\u306b\u9632\u304e\u305f\u3044\u5834\u5408                                  \u2502\n\u2502 \u91d1\u878d\u53d6\u5f15             \u2502 \uff08\u305f\u3060\u3057\u30ea\u30c8\u30e9\u30a4\u30ed\u30b8\u30c3\u30af\u304c\u5fc5\u8981\uff09                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"4-\u30ed\u30c3\u30af\u6a5f\u69cb",children:"4. \u30ed\u30c3\u30af\u6a5f\u69cb"}),"\n",(0,s.jsx)(e.h3,{id:"41-\u30ed\u30c3\u30af\u306e\u7a2e\u985e",children:"4.1 \u30ed\u30c3\u30af\u306e\u7a2e\u985e"}),"\n",(0,s.jsx)(e.p,{children:"PostgreSQL\u306b\u306f\u8907\u6570\u306e\u30ed\u30c3\u30af\u30ec\u30d9\u30eb\u304c\u3042\u308a\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           \u30c6\u30fc\u30d6\u30eb\u30ed\u30c3\u30af\u30e2\u30fc\u30c9                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u30ed\u30c3\u30af\u30e2\u30fc\u30c9               \u2502 \u7528\u9014                                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ACCESS SHARE               \u2502 SELECT \u3067\u53d6\u5f97                                       \u2502\n\u2502                            \u2502 ACCESS EXCLUSIVE \u3068\u306e\u307f\u7af6\u5408                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ROW SHARE                  \u2502 SELECT FOR UPDATE/SHARE \u3067\u53d6\u5f97                      \u2502\n\u2502                            \u2502                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ROW EXCLUSIVE              \u2502 UPDATE, DELETE, INSERT \u3067\u53d6\u5f97                       \u2502\n\u2502                            \u2502                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 SHARE                      \u2502 CREATE INDEX\uff08\u975eCONCURRENT\uff09\u3067\u53d6\u5f97                  \u2502\n\u2502                            \u2502                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ACCESS EXCLUSIVE           \u2502 ALTER TABLE, DROP, TRUNCATE, VACUUM FULL \u3067\u53d6\u5f97     \u2502\n\u2502                            \u2502 \u4ed6\u306e\u3059\u3079\u3066\u306e\u30ed\u30c3\u30af\u3068\u7af6\u5408                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"42-\u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af",children:"4.2 \u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af"}),"\n",(0,s.jsx)(e.p,{children:"\u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af\u306f\u3001\u7279\u5b9a\u306e\u884c\u306e\u307f\u3092\u30ed\u30c3\u30af\u3057\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u6392\u4ed6\u30ed\u30c3\u30af\uff08\u66f4\u65b0\u7528\uff09\nSELECT * FROM accounts WHERE id = 1 FOR UPDATE;\n-- \u4ed6\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u3053\u306e\u884c\u3092\u66f4\u65b0\u3067\u304d\u306a\u3044\n\n-- \u5171\u6709\u30ed\u30c3\u30af\uff08\u8aad\u307f\u53d6\u308a\u7528\uff09\nSELECT * FROM accounts WHERE id = 1 FOR SHARE;\n-- \u4ed6\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3082\u3053\u306e\u884c\u3092\u8aad\u307f\u53d6\u308a\u53ef\u80fd\u3060\u304c\u3001\u66f4\u65b0\u306f\u5f85\u6a5f\n\n-- \u30ed\u30c3\u30af\u5f85\u6a5f\u3092\u30b9\u30ad\u30c3\u30d7\nSELECT * FROM accounts WHERE id = 1 FOR UPDATE NOWAIT;\n-- \u30ed\u30c3\u30af\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u5373\u5ea7\u306b\u30a8\u30e9\u30fc\n\n-- \u30ed\u30c3\u30af\u3067\u304d\u305f\u884c\u306e\u307f\u53d6\u5f97\nSELECT * FROM accounts WHERE id IN (1, 2, 3) FOR UPDATE SKIP LOCKED;\n-- \u30ed\u30c3\u30af\u4e2d\u306e\u884c\u306f\u30b9\u30ad\u30c3\u30d7\u3055\u308c\u308b\n"})}),"\n",(0,s.jsx)(e.h3,{id:"43-\u884c\u30ed\u30c3\u30af\u306e\u7af6\u5408\u30de\u30c8\u30ea\u30af\u30b9",children:"4.3 \u884c\u30ed\u30c3\u30af\u306e\u7af6\u5408\u30de\u30c8\u30ea\u30af\u30b9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     \u884c\u30ec\u30d9\u30eb\u30ed\u30c3\u30af\u306e\u7af6\u5408                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                  \u2502 FOR KEY SHARE      \u2502 FOR SHARE         \u2502 FOR UPDATE  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 FOR KEY SHARE    \u2502 \u25cb \u5171\u5b58\u53ef\u80fd          \u2502 \u25cb \u5171\u5b58\u53ef\u80fd         \u2502 \u25cb \u5171\u5b58\u53ef\u80fd   \u2502\n\u2502 FOR SHARE        \u2502 \u25cb \u5171\u5b58\u53ef\u80fd          \u2502 \u25cb \u5171\u5b58\u53ef\u80fd         \u2502 \xd7 \u7af6\u5408      \u2502\n\u2502 FOR UPDATE       \u2502 \u25cb \u5171\u5b58\u53ef\u80fd          \u2502 \xd7 \u7af6\u5408            \u2502 \xd7 \u7af6\u5408      \u2502\n\u2502 FOR NO KEY UPDATE\u2502 \u25cb \u5171\u5b58\u53ef\u80fd          \u2502 \xd7 \u7af6\u5408            \u2502 \xd7 \u7af6\u5408      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"44-\u30ed\u30c3\u30af\u5f85\u6a5f\u306e\u53ef\u8996\u5316",children:"4.4 \u30ed\u30c3\u30af\u5f85\u6a5f\u306e\u53ef\u8996\u5316"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u73fe\u5728\u306e\u30ed\u30c3\u30af\u72b6\u6cc1\u3092\u78ba\u8a8d\nSELECT\n    l.pid,\n    l.locktype,\n    l.mode,\n    l.granted,\n    a.query\nFROM pg_locks l\nJOIN pg_stat_activity a ON l.pid = a.pid\nWHERE NOT l.granted;  -- \u5f85\u6a5f\u4e2d\u306e\u30ed\u30c3\u30af\n\n-- \u30d6\u30ed\u30c3\u30af\u3057\u3066\u3044\u308b\u30d7\u30ed\u30bb\u30b9\u3092\u7279\u5b9a\nSELECT\n    blocked.pid AS blocked_pid,\n    blocked.query AS blocked_query,\n    blocking.pid AS blocking_pid,\n    blocking.query AS blocking_query\nFROM pg_stat_activity blocked\nJOIN pg_locks blocked_locks ON blocked.pid = blocked_locks.pid\nJOIN pg_locks blocking_locks\n    ON blocked_locks.locktype = blocking_locks.locktype\n    AND blocked_locks.relation = blocking_locks.relation\n    AND blocked_locks.pid != blocking_locks.pid\nJOIN pg_stat_activity blocking ON blocking_locks.pid = blocking.pid\nWHERE NOT blocked_locks.granted\n  AND blocking_locks.granted;\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"5-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af",children:"5. \u30c7\u30c3\u30c9\u30ed\u30c3\u30af"}),"\n",(0,s.jsx)(e.h3,{id:"51-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f",children:"5.1 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3068\u306f"}),"\n",(0,s.jsx)(e.p,{children:"2\u3064\u4ee5\u4e0a\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u304c\u4e92\u3044\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u5f85\u3061\u5408\u3046\u72b6\u614b\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u767a\u751f                                      \u2502\n\u2502                                                                                 \u2502\n\u2502    \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A                     \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B                        \u2502\n\u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502\n\u2502    \u2502 \u884c1\u3092\u30ed\u30c3\u30af \u2713    \u2502                  \u2502 \u884c2\u3092\u30ed\u30c3\u30af \u2713    \u2502                    \u2502\n\u2502    \u2502                 \u2502                  \u2502                 \u2502                    \u2502\n\u2502    \u2502 \u884c2\u3092\u30ed\u30c3\u30af\u5f85\u3061 \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u5f85\u6a5f \u2500\u2500\u2500\u2500\u2500\u2192 \u884c1\u3092\u30ed\u30c3\u30af\u5f85\u3061  \u2502                    \u2502\n\u2502    \u2502       \u2191         \u2502                  \u2502       \u2191         \u2502                    \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                             \u2502\n\u2502                                                                                 \u2502\n\u2502    \u2192 PostgreSQL\u304c\u691c\u51fa\u3057\u3001\u4e00\u65b9\u3092ROLLBACK                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"52-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u4f8b",children:"5.2 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A\nBEGIN;\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;  -- \u884c1\u3092\u30ed\u30c3\u30af\n-- \u3053\u3053\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B\u3092\u5f85\u6a5f\n\n-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3B\uff08\u540c\u6642\u306b\u5b9f\u884c\uff09\nBEGIN;\nUPDATE accounts SET balance = balance - 100 WHERE id = 2;  -- \u884c2\u3092\u30ed\u30c3\u30af\nUPDATE accounts SET balance = balance + 100 WHERE id = 1;  -- \u884c1\u3092\u5f85\u6a5f\n\n-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3A\uff08\u7d9a\u304d\uff09\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;  -- \u884c2\u3092\u5f85\u6a5f \u2192 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\uff01\n"})}),"\n",(0,s.jsx)(e.h3,{id:"53-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f\u7b56",children:"5.3 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u306e\u56de\u907f\u7b56"}),"\n",(0,s.jsx)(e.h4,{id:"\u7b561-\u4e00\u8cab\u3057\u305f\u9806\u5e8f\u3067\u30ed\u30c3\u30af",children:"\u7b561: \u4e00\u8cab\u3057\u305f\u9806\u5e8f\u3067\u30ed\u30c3\u30af"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5e38\u306bID\u306e\u6607\u9806\u3067\u30ed\u30c3\u30af\nBEGIN;\nSELECT * FROM accounts WHERE id IN (1, 2) ORDER BY id FOR UPDATE;\n-- \u3053\u308c\u306b\u3088\u308a\u3001\u3059\u3079\u3066\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u304c\u540c\u3058\u9806\u5e8f\u3067\u30ed\u30c3\u30af\u3092\u53d6\u5f97\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h4,{id:"\u7b562-\u30ed\u30c3\u30af\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a",children:"\u7b562: \u30ed\u30c3\u30af\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u306e\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30bb\u30c3\u30b7\u30e7\u30f3\u5358\u4f4d\u3067\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\nSET lock_timeout = '5s';\n\nBEGIN;\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\n-- 5\u79d2\u4ee5\u4e0a\u30ed\u30c3\u30af\u3092\u5f85\u3064\u3068\u30a8\u30e9\u30fc\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h4,{id:"\u7b563-nowait-\u30aa\u30d7\u30b7\u30e7\u30f3",children:"\u7b563: NOWAIT \u30aa\u30d7\u30b7\u30e7\u30f3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"BEGIN;\nSELECT * FROM accounts WHERE id = 1 FOR UPDATE NOWAIT;\n-- \u30ed\u30c3\u30af\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u5373\u5ea7\u306b\u30a8\u30e9\u30fc\uff08\u5f85\u6a5f\u3057\u306a\u3044\uff09\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h4,{id:"\u7b564-\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u306e\u30ea\u30c8\u30e9\u30a4",children:"\u7b564: \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u3067\u306e\u30ea\u30c8\u30e9\u30a4"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-java",children:"// Java\u3067\u306e\u30ea\u30c8\u30e9\u30a4\u4f8b\nint maxRetries = 3;\nfor (int i = 0; i < maxRetries; i++) {\n    try {\n        performTransaction();\n        break;  // \u6210\u529f\u3057\u305f\u3089\u30eb\u30fc\u30d7\u3092\u629c\u3051\u308b\n    } catch (SQLException e) {\n        if (isDeadlockError(e) && i < maxRetries - 1) {\n            // \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u30a8\u30e9\u30fc\u306e\u5834\u5408\u3001\u5c11\u3057\u5f85\u3063\u3066\u30ea\u30c8\u30e9\u30a4\n            Thread.sleep(100 * (i + 1));\n        } else {\n            throw e;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"54-\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\u306e\u8a2d\u5b9a",children:"5.4 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\u306e\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u691c\u51fa\u306e\u9593\u9694\uff08\u30c7\u30d5\u30a9\u30eb\u30c81\u79d2\uff09\nSHOW deadlock_timeout;\n\n-- \u672c\u756a\u74b0\u5883\u3067\u306e\u63a8\u5968\u8a2d\u5b9a\nSET deadlock_timeout = '1s';  -- \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5341\u5206\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"6-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8",children:"6. \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8"}),"\n",(0,s.jsx)(e.h3,{id:"61-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u3068\u306f",children:"6.1 \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u3068\u306f"}),"\n",(0,s.jsx)(e.p,{children:"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u306b\u4e2d\u9593\u5730\u70b9\u3092\u8a2d\u5b9a\u3057\u3001\u90e8\u5206\u7684\u306a\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u53ef\u80fd\u306b\u3059\u308b\u6a5f\u80fd\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u6982\u5ff5                                    \u2502\n\u2502                                                                                 \u2502\n\u2502  BEGIN \u2500\u2192 \u64cd\u4f5c1 \u2500\u2192 SAVEPOINT sp1 \u2500\u2192 \u64cd\u4f5c2 \u2500\u2192 \u64cd\u4f5c3                             \u2502\n\u2502                        \u2502                         \u2502                              \u2502\n\u2502                        \u2502                         \u2193                              \u2502\n\u2502                        \u2502               ROLLBACK TO sp1                          \u2502\n\u2502                        \u2502                         \u2502                              \u2502\n\u2502                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502\n\u2502                                    \u2193                                            \u2502\n\u2502                              \u64cd\u4f5c2\u3068\u64cd\u4f5c3\u306e\u307f\u53d6\u6d88                                 \u2502\n\u2502                              \u64cd\u4f5c1\u306f\u4fdd\u6301\u3055\u308c\u308b                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"62-\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9",children:"6.2 \u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"BEGIN;\n\n-- \u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\nINSERT INTO users (name, email) VALUES ('\u7530\u4e2d', 'tanaka@example.com');\n\n-- \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u4f5c\u6210\nSAVEPOINT user_created;\n\n-- \u95a2\u9023\u30c7\u30fc\u30bf\u4f5c\u6210\uff08\u5931\u6557\u3059\u308b\u53ef\u80fd\u6027\u3042\u308a\uff09\nINSERT INTO profiles (user_id, bio) VALUES (currval('users_id_seq'), '\u81ea\u5df1\u7d39\u4ecb...');\n\n-- \u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u5834\u5408\nROLLBACK TO user_created;\n\n-- \u5225\u306e\u51e6\u7406\u3092\u8a66\u884c\nINSERT INTO profiles (user_id, bio) VALUES (currval('users_id_seq'), '\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u81ea\u5df1\u7d39\u4ecb');\n\nCOMMIT;\n-- \u30e6\u30fc\u30b6\u30fc\u306f\u4f5c\u6210\u3055\u308c\u3001\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb\u3082\uff08\u30ea\u30c8\u30e9\u30a4\u5f8c\u306b\uff09\u4f5c\u6210\u3055\u308c\u308b\n"})}),"\n",(0,s.jsx)(e.h3,{id:"63-\u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u4f8b",children:"6.3 \u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u4f8b"}),"\n",(0,s.jsx)(e.h4,{id:"\u30d0\u30c3\u30c1\u51e6\u7406\u3067\u306e\u90e8\u5206\u30b3\u30df\u30c3\u30c8",children:"\u30d0\u30c3\u30c1\u51e6\u7406\u3067\u306e\u90e8\u5206\u30b3\u30df\u30c3\u30c8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"BEGIN;\n\nSAVEPOINT batch_start;\n\n-- 1000\u4ef6\u306e\u30c7\u30fc\u30bf\u3092\u51e6\u7406\nFOR i IN 1..1000 LOOP\n    BEGIN\n        -- \u500b\u5225\u306e\u51e6\u7406\n        INSERT INTO processed_items (item_id, result)\n        VALUES (i, process_item(i));\n\n        -- 100\u4ef6\u3054\u3068\u306b\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u66f4\u65b0\n        IF i % 100 = 0 THEN\n            RELEASE SAVEPOINT batch_start;\n            SAVEPOINT batch_start;\n        END IF;\n    EXCEPTION WHEN OTHERS THEN\n        -- \u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3082\u7d9a\u884c\n        ROLLBACK TO batch_start;\n        INSERT INTO error_log (item_id, error) VALUES (i, SQLERRM);\n    END;\nEND LOOP;\n\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h4,{id:"\u8907\u6570\u64cd\u4f5c\u306e\u6761\u4ef6\u4ed8\u304d\u5b9f\u884c",children:"\u8907\u6570\u64cd\u4f5c\u306e\u6761\u4ef6\u4ed8\u304d\u5b9f\u884c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"BEGIN;\n\n-- \u30e1\u30a4\u30f3\u51e6\u7406\nUPDATE orders SET status = 'shipped' WHERE id = 123;\nSAVEPOINT order_updated;\n\n-- \u30aa\u30d7\u30b7\u30e7\u30f3\u51e6\u74061\uff08\u5931\u6557\u3057\u3066\u3082\u7d9a\u884c\uff09\nBEGIN\n    INSERT INTO notifications (user_id, message)\n    VALUES (456, '\u6ce8\u6587\u304c\u767a\u9001\u3055\u308c\u307e\u3057\u305f');\nEXCEPTION WHEN OTHERS THEN\n    ROLLBACK TO order_updated;\nEND;\n\nSAVEPOINT notification_done;\n\n-- \u30aa\u30d7\u30b7\u30e7\u30f3\u51e6\u74062\uff08\u5931\u6557\u3057\u3066\u3082\u7d9a\u884c\uff09\nBEGIN\n    UPDATE inventory SET quantity = quantity - 1 WHERE product_id = 789;\nEXCEPTION WHEN OTHERS THEN\n    ROLLBACK TO notification_done;\nEND;\n\nCOMMIT;\n-- \u30e1\u30a4\u30f3\u306e\u6ce8\u6587\u66f4\u65b0\u306f\u5fc5\u305a\u4fdd\u6301\u3055\u308c\u308b\n"})}),"\n",(0,s.jsx)(e.h3,{id:"64-\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u5236\u9650\u3068\u6ce8\u610f\u70b9",children:"6.4 \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u5236\u9650\u3068\u6ce8\u610f\u70b9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306e\u6ce8\u610f\u70b9                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 1. ROLLBACK TO sp1 \u306e\u5f8c\u3001sp1 \u306f\u518d\u5229\u7528\u53ef\u80fd                                        \u2502\n\u2502    \uff08\u518d\u5ea6 ROLLBACK TO sp1 \u3067\u304d\u308b\uff09                                               \u2502\n\u2502                                                                                 \u2502\n\u2502 2. RELEASE sp1 \u3067\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u3092\u89e3\u653e                                            \u2502\n\u2502    \uff08\u30e1\u30e2\u30ea\u3092\u7bc0\u7d04\u3001\u305d\u306e\u5f8c ROLLBACK TO sp1 \u306f\u4e0d\u53ef\uff09                                \u2502\n\u2502                                                                                 \u2502\n\u2502 3. \u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u306f\u30cd\u30b9\u30c8\u3067\u304d\u308b                                                  \u2502\n\u2502    SAVEPOINT sp1 \u2192 SAVEPOINT sp2 \u2192 ROLLBACK TO sp1                             \u2502\n\u2502    sp2 \u306f sp1 \u3078\u306e\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3067\u81ea\u52d5\u7684\u306b\u7834\u68c4\u3055\u308c\u308b                               \u2502\n\u2502                                                                                 \u2502\n\u2502 4. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5168\u4f53\u306e\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u3067\u306f\u3059\u3079\u3066\u306e\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8\u304c\u7121\u52b9             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"7-mvcc\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8",children:"7. MVCC\u3068\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8"}),"\n",(0,s.jsx)(e.h3,{id:"71-mvcc\u3068\u306f",children:"7.1 MVCC\u3068\u306f"}),"\n",(0,s.jsx)(e.p,{children:"MVCC\uff08Multi-Version Concurrency Control\uff09\u306f\u3001PostgreSQL\u306e\u540c\u6642\u5b9f\u884c\u5236\u5fa1\u306e\u57fa\u76e4\u3067\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                              MVCC\u306e\u4ed5\u7d44\u307f                                        \u2502\n\u2502                                                                                 \u2502\n\u2502  \u66f4\u65b0\u524d                                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502 \u884c\u30c7\u30fc\u30bf (version 1)                                       \u2502                 \u2502\n\u2502  \u2502 xmin=100, xmax=\u221e                                          \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                                                                 \u2502\n\u2502  UPDATE\u5b9f\u884c\uff08\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID=200\uff09                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502 \u884c\u30c7\u30fc\u30bf (version 1) - \u65e7\u30d0\u30fc\u30b8\u30e7\u30f3                         \u2502                 \u2502\n\u2502  \u2502 xmin=100, xmax=200  \u2190 \u524a\u9664\u30de\u30fc\u30af                           \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502 \u884c\u30c7\u30fc\u30bf (version 2) - \u65b0\u30d0\u30fc\u30b8\u30e7\u30f3                         \u2502                 \u2502\n\u2502  \u2502 xmin=200, xmax=\u221e                                          \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                                                                 \u2502\n\u2502  \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID 150 \u306eSELECT \u2192 version 1 \u3092\u53c2\u7167                              \u2502\n\u2502  \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID 250 \u306eSELECT \u2192 version 2 \u3092\u53c2\u7167                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"72-\u53ef\u8996\u6027\u30eb\u30fc\u30eb",children:"7.2 \u53ef\u8996\u6027\u30eb\u30fc\u30eb"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u884c\u304c\u53ef\u8996\u304b\u3069\u3046\u304b\u306e\u5224\u65ad\n/*\n  1. xmin \u304c\u73fe\u5728\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3088\u308a\u524d\u3067\u30b3\u30df\u30c3\u30c8\u6e08\u307f \u2192 \u53ef\u8996\n  2. xmax \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3001\u307e\u305f\u306f\n     xmax \u304c\u73fe\u5728\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\u3088\u308a\u5f8c\u3001\u307e\u305f\u306f\n     xmax \u304c\u30b3\u30df\u30c3\u30c8\u3055\u308c\u3066\u3044\u306a\u3044 \u2192 \u53ef\u8996\n  3. \u305d\u308c\u4ee5\u5916 \u2192 \u4e0d\u53ef\u8996\n*/\n\n-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u72b6\u614b\u78ba\u8a8d\nSELECT txid_current();  -- \u73fe\u5728\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3ID\nSELECT txid_current_snapshot();  -- \u73fe\u5728\u306e\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\n"})}),"\n",(0,s.jsx)(e.h3,{id:"73-\u8aad\u307f\u53d6\u308a\u3068\u66f8\u304d\u8fbc\u307f\u306e\u5206\u96e2",children:"7.3 \u8aad\u307f\u53d6\u308a\u3068\u66f8\u304d\u8fbc\u307f\u306e\u5206\u96e2"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        MVCC\u306e\u5229\u70b9                                                \u2502\n\u2502                                                                                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 \u8aad\u307f\u53d6\u308a\uff08SELECT\uff09\u306f\u66f8\u304d\u8fbc\u307f\uff08UPDATE/DELETE\uff09\u3092\u30d6\u30ed\u30c3\u30af\u3057\u306a\u3044              \u2502   \u2502\n\u2502  \u2502 \u66f8\u304d\u8fbc\u307f\uff08UPDATE/DELETE\uff09\u306f\u8aad\u307f\u53d6\u308a\uff08SELECT\uff09\u3092\u30d6\u30ed\u30c3\u30af\u3057\u306a\u3044              \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                                 \u2502\n\u2502  \u5f93\u6765\u306e\u30ed\u30c3\u30af\u65b9\u5f0f:                                                               \u2502\n\u2502  Writer \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[\u30ed\u30c3\u30af]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                            \u2502\n\u2502  Reader         \u2193\u30d6\u30ed\u30c3\u30af\u2193                                                     \u2502\n\u2502                                                                                 \u2502\n\u2502  MVCC\u65b9\u5f0f:                                                                      \u2502\n\u2502  Writer \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[\u66f4\u65b0]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                              \u2502\n\u2502  Reader \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500[\u8aad\u53d6]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500  \u2190 \u65e7\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8aad\u3081\u308b                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"8-\u5b9f\u8df5\u7684\u306a\u30d1\u30bf\u30fc\u30f3",children:"8. \u5b9f\u8df5\u7684\u306a\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,s.jsx)(e.h3,{id:"81-select-for-update-\u30d1\u30bf\u30fc\u30f3",children:"8.1 SELECT FOR UPDATE \u30d1\u30bf\u30fc\u30f3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5728\u5eab\u306e\u6392\u4ed6\u7684\u78ba\u4fdd\nBEGIN;\n\n-- \u5728\u5eab\u884c\u3092\u30ed\u30c3\u30af\nSELECT quantity FROM inventory\nWHERE product_id = 123\nFOR UPDATE;\n\n-- \u5728\u5eab\u30c1\u30a7\u30c3\u30af\n-- (\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067 quantity >= required \u3092\u78ba\u8a8d)\n\n-- \u5728\u5eab\u3092\u6e1b\u3089\u3059\nUPDATE inventory\nSET quantity = quantity - 1\nWHERE product_id = 123;\n\nCOMMIT;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"82-upsertinsert-on-conflict",children:"8.2 Upsert\uff08INSERT ON CONFLICT\uff09"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5b58\u5728\u3057\u306a\u3051\u308c\u3070INSERT\u3001\u5b58\u5728\u3059\u308c\u3070UPDATE\nINSERT INTO user_settings (user_id, setting_key, setting_value)\nVALUES (1, 'theme', 'dark')\nON CONFLICT (user_id, setting_key)\nDO UPDATE SET\n    setting_value = EXCLUDED.setting_value,\n    updated_at = CURRENT_TIMESTAMP;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"83-advisory-lock\u30a2\u30c9\u30d0\u30a4\u30b6\u30ea\u30fc\u30ed\u30c3\u30af",children:"8.3 Advisory Lock\uff08\u30a2\u30c9\u30d0\u30a4\u30b6\u30ea\u30fc\u30ed\u30c3\u30af\uff09"}),"\n",(0,s.jsx)(e.p,{children:"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ec\u30d9\u30eb\u3067\u4efb\u610f\u306e\u30ed\u30c3\u30af\u3092\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30bb\u30c3\u30b7\u30e7\u30f3\u30ec\u30d9\u30eb\u306e\u30ed\u30c3\u30af\nSELECT pg_advisory_lock(12345);  -- \u30ed\u30c3\u30af\u53d6\u5f97\uff08ID\u306f\u4efb\u610f\u306e\u6574\u6570\uff09\n-- \u6392\u4ed6\u7684\u306a\u51e6\u7406\nSELECT pg_advisory_unlock(12345);  -- \u30ed\u30c3\u30af\u89e3\u653e\n\n-- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30ec\u30d9\u30eb\u306e\u30ed\u30c3\u30af\uff08COMMIT/ROLLBACK\u3067\u81ea\u52d5\u89e3\u653e\uff09\nSELECT pg_advisory_xact_lock(12345);\n\n-- \u30ce\u30f3\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\uff08\u30ed\u30c3\u30af\u3067\u304d\u306a\u3051\u308c\u3070false\u3092\u8fd4\u3059\uff09\nSELECT pg_try_advisory_lock(12345);\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5b9f\u8df5\u4f8b\uff1a\u5206\u6563\u30b7\u30b9\u30c6\u30e0\u3067\u306e\u6392\u4ed6\u5236\u5fa1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30e6\u30fc\u30b6\u30fc\u5358\u4f4d\u3067\u51e6\u7406\u3092\u6392\u4ed6\u5236\u5fa1\nBEGIN;\n\n-- \u30e6\u30fc\u30b6\u30fcID\u3092\u30ad\u30fc\u3068\u3057\u3066\u30ed\u30c3\u30af\nSELECT pg_advisory_xact_lock(hashtext('user:' || 'user123'));\n\n-- \u3053\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u5bfe\u3059\u308b\u51e6\u7406\u3092\u5b9f\u884c\nUPDATE user_balance SET amount = amount - 100 WHERE user_id = 'user123';\nINSERT INTO transactions (user_id, amount, type) VALUES ('user123', -100, 'withdrawal');\n\nCOMMIT;  -- \u81ea\u52d5\u7684\u306b\u30a2\u30c9\u30d0\u30a4\u30b6\u30ea\u30fc\u30ed\u30c3\u30af\u3082\u89e3\u653e\n"})}),"\n",(0,s.jsx)(e.h3,{id:"84-\u697d\u89b3\u7684\u30ed\u30c3\u30af",children:"8.4 \u697d\u89b3\u7684\u30ed\u30c3\u30af"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u30d0\u30fc\u30b8\u30e7\u30f3\u5217\u3092\u4f7f\u7528\nCREATE TABLE documents (\n    id SERIAL PRIMARY KEY,\n    content TEXT,\n    version INTEGER DEFAULT 1\n);\n\n-- \u66f4\u65b0\u6642\u306b\u30d0\u30fc\u30b8\u30e7\u30f3\u30c1\u30a7\u30c3\u30af\nUPDATE documents\nSET content = '\u65b0\u3057\u3044\u5185\u5bb9',\n    version = version + 1\nWHERE id = 1\n  AND version = 5;  -- \u8aad\u307f\u53d6\u308a\u6642\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\n\n-- \u5f71\u97ff\u884c\u6570\u304c0\u306a\u3089\u3001\u4ed6\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u304c\u5148\u306b\u66f4\u65b0\u3057\u3066\u3044\u308b\n-- \u2192 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u30ea\u30c8\u30e9\u30a4\u307e\u305f\u306f\u30a8\u30e9\u30fc\u51e6\u7406\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"9-\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",children:"9. \u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"}),"\n",(0,s.jsx)(e.h3,{id:"91-\u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u691c\u51fa",children:"9.1 \u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u691c\u51fa"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u9577\u6642\u9593\u5b9f\u884c\u4e2d\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\nSELECT\n    pid,\n    now() - xact_start AS duration,\n    state,\n    query\nFROM pg_stat_activity\nWHERE xact_start IS NOT NULL\n  AND now() - xact_start > interval '5 minutes'\nORDER BY duration DESC;\n\n-- \u30a2\u30a4\u30c9\u30eb\u72b6\u614b\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\uff08\u7279\u306b\u554f\u984c\uff09\nSELECT\n    pid,\n    now() - xact_start AS duration,\n    query\nFROM pg_stat_activity\nWHERE state = 'idle in transaction'\n  AND now() - xact_start > interval '1 minute';\n"})}),"\n",(0,s.jsx)(e.h3,{id:"92-\u30a2\u30a4\u30c9\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u81ea\u52d5\u7d42\u4e86",children:"9.2 \u30a2\u30a4\u30c9\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u81ea\u52d5\u7d42\u4e86"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- PostgreSQL 14\u4ee5\u964d\nSET idle_in_transaction_session_timeout = '5min';\n\n-- \u307e\u305f\u306f postgresql.conf \u3067\u8a2d\u5b9a\n-- idle_in_transaction_session_timeout = 300000  -- \u30df\u30ea\u79d2\n"})}),"\n",(0,s.jsx)(e.h3,{id:"93-\u30ed\u30c3\u30af\u7af6\u5408\u306e\u5206\u6790",children:"9.3 \u30ed\u30c3\u30af\u7af6\u5408\u306e\u5206\u6790"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5f85\u6a5f\u4e2d\u306e\u30af\u30a8\u30ea\u3068\u30d6\u30ed\u30c3\u30af\u3057\u3066\u3044\u308b\u30af\u30a8\u30ea\nSELECT\n    blocked.pid AS blocked_pid,\n    blocked.query AS blocked_query,\n    blocking.pid AS blocking_pid,\n    blocking.query AS blocking_query,\n    now() - blocked.query_start AS waiting_duration\nFROM pg_stat_activity blocked\nJOIN pg_catalog.pg_locks blocked_locks\n    ON blocked.pid = blocked_locks.pid AND NOT blocked_locks.granted\nJOIN pg_catalog.pg_locks blocking_locks\n    ON blocking_locks.locktype = blocked_locks.locktype\n    AND blocking_locks.database IS NOT DISTINCT FROM blocked_locks.database\n    AND blocking_locks.relation IS NOT DISTINCT FROM blocked_locks.relation\n    AND blocking_locks.page IS NOT DISTINCT FROM blocked_locks.page\n    AND blocking_locks.tuple IS NOT DISTINCT FROM blocked_locks.tuple\n    AND blocking_locks.virtualxid IS NOT DISTINCT FROM blocked_locks.virtualxid\n    AND blocking_locks.transactionid IS NOT DISTINCT FROM blocked_locks.transactionid\n    AND blocking_locks.classid IS NOT DISTINCT FROM blocked_locks.classid\n    AND blocking_locks.objid IS NOT DISTINCT FROM blocked_locks.objid\n    AND blocking_locks.objsubid IS NOT DISTINCT FROM blocked_locks.objsubid\n    AND blocking_locks.pid != blocked_locks.pid\n    AND blocking_locks.granted\nJOIN pg_stat_activity blocking ON blocking_locks.pid = blocking.pid\nORDER BY waiting_duration DESC;\n"})}),"\n",(0,s.jsx)(e.h3,{id:"94-\u5f37\u5236\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u7d42\u4e86",children:"9.4 \u5f37\u5236\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u7d42\u4e86"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u512a\u3057\u304f\u7d42\u4e86\uff08SIGTERM\u30b7\u30b0\u30ca\u30eb\uff09\nSELECT pg_terminate_backend(pid);\n\n-- \u30af\u30a8\u30ea\u306e\u307f\u30ad\u30e3\u30f3\u30bb\u30eb\uff08SIGINT\u30b7\u30b0\u30ca\u30eb\uff09\nSELECT pg_cancel_backend(pid);\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"10-\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"10. \u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"}),"\n",(0,s.jsx)(e.h3,{id:"101-\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u8a2d\u8a08",children:"10.1 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u8a2d\u8a08"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u8a2d\u8a08\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u2713 \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u77ed\u304f\u4fdd\u3064                                                    \u2502\n\u2502   - \u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306f\u30ed\u30c3\u30af\u7af6\u5408\u3068bloat\u306e\u539f\u56e0                              \u2502\n\u2502   - \u30e6\u30fc\u30b6\u30fc\u5165\u529b\u5f85\u3061\u3092\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067\u884c\u308f\u306a\u3044                               \u2502\n\u2502                                                                                 \u2502\n\u2502 \u2713 \u9069\u5207\u306a\u5206\u96e2\u30ec\u30d9\u30eb\u3092\u9078\u629e\u3059\u308b                                                    \u2502\n\u2502   - \u30c7\u30d5\u30a9\u30eb\u30c8\uff08READ COMMITTED\uff09\u3067\u5341\u5206\u306a\u5834\u5408\u304c\u307b\u3068\u3093\u3069                          \u2502\n\u2502   - \u5fc5\u8981\u306a\u5834\u5408\u306e\u307f\u9ad8\u3044\u5206\u96e2\u30ec\u30d9\u30eb\u3092\u4f7f\u7528                                          \u2502\n\u2502                                                                                 \u2502\n\u2502 \u2713 \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3092\u9632\u3050                                                            \u2502\n\u2502   - \u5e38\u306b\u540c\u3058\u9806\u5e8f\u3067\u30ea\u30bd\u30fc\u30b9\u3092\u30ed\u30c3\u30af                                              \u2502\n\u2502   - \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u8a2d\u5b9a                                                          \u2502\n\u2502                                                                                 \u2502\n\u2502 \u2713 \u30ea\u30c8\u30e9\u30a4\u30ed\u30b8\u30c3\u30af\u3092\u5b9f\u88c5\u3059\u308b                                                    \u2502\n\u2502   - SERIALIZABLE \u3084\u7af6\u5408\u6642\u306e\u30a8\u30e9\u30fc\u306b\u5099\u3048\u308b                                       \u2502\n\u2502   - \u6307\u6570\u30d0\u30c3\u30af\u30aa\u30d5\u3092\u691c\u8a0e                                                        \u2502\n\u2502                                                                                 \u2502\n\u2502 \u2713 \u660e\u793a\u7684\u306a\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5883\u754c\u3092\u4f7f\u7528                                            \u2502\n\u2502   - \u81ea\u52d5\u30b3\u30df\u30c3\u30c8\u306b\u4f9d\u5b58\u3057\u306a\u3044                                                    \u2502\n\u2502   - BEGIN/COMMIT \u3092\u660e\u793a\u7684\u306b\u8a18\u8ff0                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(e.h3,{id:"102-\u63a8\u5968\u8a2d\u5b9a",children:"10.2 \u63a8\u5968\u8a2d\u5b9a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u63a5\u7d9a\u30d7\u30fc\u30eb\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306e\u63a8\u5968\u8a2d\u5b9a\n\n-- \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff08\u9577\u3059\u304e\u308b\u30af\u30a8\u30ea\u3092\u9632\u6b62\uff09\nSET statement_timeout = '30s';\n\n-- \u30ed\u30c3\u30af\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\uff08\u30ed\u30c3\u30af\u5f85\u3061\u304c\u9577\u3059\u304e\u308b\u5834\u5408\uff09\nSET lock_timeout = '10s';\n\n-- \u30a2\u30a4\u30c9\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\nSET idle_in_transaction_session_timeout = '5min';\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"ACID\u7279\u6027"}),"\u3092\u7406\u89e3\u3057\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u4e00\u8cab\u6027\u3092\u4fdd\u8a3c\u3059\u308b"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u5206\u96e2\u30ec\u30d9\u30eb"}),"\u306f\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u306b\u5fdc\u3058\u3066\u9078\u629e\uff08\u901a\u5e38\u306fREAD COMMITTED\uff09"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u30ed\u30c3\u30af"}),"\u306e\u4ed5\u7d44\u307f\u3092\u7406\u89e3\u3057\u3001\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u3092\u9632\u3050"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"MVCC"}),"\u306b\u3088\u308a\u8aad\u307f\u53d6\u308a\u3068\u66f8\u304d\u8fbc\u307f\u304c\u4e92\u3044\u3092\u30d6\u30ed\u30c3\u30af\u3057\u306a\u3044"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u30bb\u30fc\u30d6\u30dd\u30a4\u30f3\u30c8"}),"\u3067\u90e8\u5206\u7684\u306a\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u304c\u53ef\u80fd"]}),"\n",(0,s.jsxs)(e.li,{children:["\u9577\u6642\u9593\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u907f\u3051\u3001",(0,s.jsx)(e.strong,{children:"\u9069\u5207\u306a\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"}),"\u3092\u8a2d\u5b9a\u3059\u308b"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/postgresql/dev-05-query-optimization",children:"dev-05-query-optimization.md"}),": \u30af\u30a8\u30ea\u6700\u9069\u5316"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/postgresql/dba-03-replication-ha",children:"dba-03-replication-ha.md"}),": \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u9ad8\u53ef\u7528\u6027"]}),"\n"]})]})}function E(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(t,{...n})}):t(n)}},28453:(n,e,l)=>{l.d(e,{R:()=>d,x:()=>a});var i=l(96540);const s={},c=i.createContext(s);function d(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),i.createElement(c.Provider,{value:e},n.children)}}}]);