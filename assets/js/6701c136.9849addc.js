"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[98752],{42786:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"content_11_learning/postgresql/dba-08-planner","title":"PostgreSQL \u30d7\u30e9\u30f3\u30ca\u30fc\u6df1\u6398\u308a\u30ac\u30a4\u30c9","description":"\u30d7\u30e9\u30f3\u30ca\u30fc\uff08\u30af\u30a8\u30ea\u30aa\u30d7\u30c6\u30a3\u30de\u30a4\u30b6\uff09\u306f\u3001SQL\u3092\u300c\u3069\u306e\u3088\u3046\u306b\u5b9f\u884c\u3059\u308b\u304b\u300d\u3092\u6c7a\u5b9a\u3059\u308bPostgreSQL\u306e\u982d\u8133\u3067\u3059\u3002\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5185\u90e8\u52d5\u4f5c\u3092\u8a73\u3057\u304f\u89e3\u8aac\u3057\u307e\u3059\u3002","source":"@site/docs/content_11_learning/11-postgresql/dba-08-planner.md","sourceDirName":"content_11_learning/11-postgresql","slug":"/content_11_learning/postgresql/dba-08-planner","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-08-planner","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/11-postgresql/dba-08-planner.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"PostgreSQL \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-07-partitioning"},"next":{"title":"PostgreSQL \u62e1\u5f35\u6a5f\u80fd\uff08Extensions\uff09\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-09-extensions"}}');var r=s(74848),l=s(28453);const d={},a="PostgreSQL \u30d7\u30e9\u30f3\u30ca\u30fc\u6df1\u6398\u308a\u30ac\u30a4\u30c9",c={},t=[{value:"\u76ee\u6b21",id:"\u76ee\u6b21",level:2},{value:"1. \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5f79\u5272\u3068\u5168\u4f53\u50cf",id:"1-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5f79\u5272\u3068\u5168\u4f53\u50cf",level:2},{value:"1.1 \u30d7\u30e9\u30f3\u30ca\u30fc\u3068\u306f",id:"11-\u30d7\u30e9\u30f3\u30ca\u30fc\u3068\u306f",level:3},{value:"1.2 \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u51e6\u7406\u30d5\u30ed\u30fc",id:"12-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u51e6\u7406\u30d5\u30ed\u30fc",level:3},{value:"1.3 \u300c\u30d1\u30b9\u300d\u3068\u300c\u30d7\u30e9\u30f3\u300d",id:"13-\u30d1\u30b9\u3068\u30d7\u30e9\u30f3",level:3},{value:"2. \u7d71\u8a08\u60c5\u5831\u306e\u4ed5\u7d44\u307f",id:"2-\u7d71\u8a08\u60c5\u5831\u306e\u4ed5\u7d44\u307f",level:2},{value:"2.1 \u7d71\u8a08\u60c5\u5831\u3068\u306f",id:"21-\u7d71\u8a08\u60c5\u5831\u3068\u306f",level:3},{value:"2.2 \u7d71\u8a08\u60c5\u5831\u306e\u78ba\u8a8d\u65b9\u6cd5",id:"22-\u7d71\u8a08\u60c5\u5831\u306e\u78ba\u8a8d\u65b9\u6cd5",level:3},{value:"2.3 n_distinct \u306e\u89e3\u91c8",id:"23-n_distinct-\u306e\u89e3\u91c8",level:3},{value:"2.4 \u30d2\u30b9\u30c8\u30b0\u30e9\u30e0",id:"24-\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0",level:3},{value:"2.5 \u76f8\u95a2 (correlation)",id:"25-\u76f8\u95a2-correlation",level:3},{value:"2.6 \u7d71\u8a08\u60c5\u5831\u306e\u66f4\u65b0",id:"26-\u7d71\u8a08\u60c5\u5831\u306e\u66f4\u65b0",level:3},{value:"2.7 \u62e1\u5f35\u7d71\u8a08\u60c5\u5831",id:"27-\u62e1\u5f35\u7d71\u8a08\u60c5\u5831",level:3},{value:"3. \u30b3\u30b9\u30c8\u8a08\u7b97\u30e2\u30c7\u30eb",id:"3-\u30b3\u30b9\u30c8\u8a08\u7b97\u30e2\u30c7\u30eb",level:2},{value:"3.1 \u30b3\u30b9\u30c8\u3068\u306f",id:"31-\u30b3\u30b9\u30c8\u3068\u306f",level:3},{value:"3.2 EXPLAIN\u3067\u898b\u308b\u30b3\u30b9\u30c8",id:"32-explain\u3067\u898b\u308b\u30b3\u30b9\u30c8",level:3},{value:"3.3 Sequential Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97",id:"33-sequential-scan-\u306e\u30b3\u30b9\u30c8\u8a08\u7b97",level:3},{value:"3.4 Index Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97",id:"34-index-scan-\u306e\u30b3\u30b9\u30c8\u8a08\u7b97",level:3},{value:"3.5 \u30b3\u30b9\u30c8\u6bd4\u8f03\u306e\u4f8b",id:"35-\u30b3\u30b9\u30c8\u6bd4\u8f03\u306e\u4f8b",level:3},{value:"3.6 \u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",id:"36-\u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",level:3},{value:"4. \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e",id:"4-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e",level:2},{value:"4.1 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u4e00\u89a7",id:"41-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u4e00\u89a7",level:3},{value:"4.2 Sequential Scan",id:"42-sequential-scan",level:3},{value:"4.3 Index Scan",id:"43-index-scan",level:3},{value:"4.4 Index Only Scan",id:"44-index-only-scan",level:3},{value:"4.5 Bitmap Scan",id:"45-bitmap-scan",level:3},{value:"4.6 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u57fa\u6e96",id:"46-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u57fa\u6e96",level:3},{value:"5. \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e",id:"5-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e",level:2},{value:"5.1 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u89a7",id:"51-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u89a7",level:3},{value:"5.2 Nested Loop Join",id:"52-nested-loop-join",level:3},{value:"5.3 Hash Join",id:"53-hash-join",level:3},{value:"5.4 Merge Join",id:"54-merge-join",level:3},{value:"5.5 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e\u57fa\u6e96",id:"55-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e\u57fa\u6e96",level:3},{value:"5.6 \u5b9f\u884c\u8a08\u753b\u3067\u306e\u78ba\u8a8d\u4f8b",id:"56-\u5b9f\u884c\u8a08\u753b\u3067\u306e\u78ba\u8a8d\u4f8b",level:3},{value:"6. \u7d50\u5408\u9806\u5e8f\u306e\u6700\u9069\u5316",id:"6-\u7d50\u5408\u9806\u5e8f\u306e\u6700\u9069\u5316",level:2},{value:"6.1 \u7d50\u5408\u9806\u5e8f\u554f\u984c",id:"61-\u7d50\u5408\u9806\u5e8f\u554f\u984c",level:3},{value:"6.2 \u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u65b9\u6cd5",id:"62-\u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u65b9\u6cd5",level:3},{value:"6.3 \u7d50\u5408\u9806\u5e8f\u306b\u95a2\u3059\u308b\u8a2d\u5b9a",id:"63-\u7d50\u5408\u9806\u5e8f\u306b\u95a2\u3059\u308b\u8a2d\u5b9a",level:3},{value:"6.4 FROM\u53e5\u306e\u66f8\u304d\u65b9\u306b\u3088\u308b\u5236\u5fa1",id:"64-from\u53e5\u306e\u66f8\u304d\u65b9\u306b\u3088\u308b\u5236\u5fa1",level:3},{value:"7. \u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9",id:"7-\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9",level:2},{value:"7.1 EXPLAIN\u306e\u7a2e\u985e",id:"71-explain\u306e\u7a2e\u985e",level:3},{value:"7.2 \u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9\u306e\u57fa\u672c",id:"72-\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9\u306e\u57fa\u672c",level:3},{value:"7.3 \u3088\u304f\u898b\u308b\u30ce\u30fc\u30c9\u30bf\u30a4\u30d7",id:"73-\u3088\u304f\u898b\u308b\u30ce\u30fc\u30c9\u30bf\u30a4\u30d7",level:3},{value:"7.4 \u63a8\u5b9a\u5024\u3068\u5b9f\u969b\u306e\u5024\u306e\u305a\u308c\u3092\u898b\u308b",id:"74-\u63a8\u5b9a\u5024\u3068\u5b9f\u969b\u306e\u5024\u306e\u305a\u308c\u3092\u898b\u308b",level:3},{value:"7.5 BUFFERS\u51fa\u529b\u306e\u8aad\u307f\u65b9",id:"75-buffers\u51fa\u529b\u306e\u8aad\u307f\u65b9",level:3},{value:"8. \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5236\u5fa1\u3068\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",id:"8-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5236\u5fa1\u3068\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",level:2},{value:"8.1 \u30d7\u30e9\u30f3\u30ca\u30fc\u95a2\u9023\u306e\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf",id:"81-\u30d7\u30e9\u30f3\u30ca\u30fc\u95a2\u9023\u306e\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf",level:3},{value:"8.2 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u5236\u5fa1",id:"82-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u5236\u5fa1",level:3},{value:"8.3 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u5236\u5fa1",id:"83-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u5236\u5fa1",level:3},{value:"8.4 \u7d71\u8a08\u60c5\u5831\u306e\u8abf\u6574",id:"84-\u7d71\u8a08\u60c5\u5831\u306e\u8abf\u6574",level:3},{value:"8.5 \u5b9f\u8df5\u7684\u306a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u4f8b",id:"85-\u5b9f\u8df5\u7684\u306a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u4f8b",level:3},{value:"9. \u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u82e6\u624b\u306a\u30b1\u30fc\u30b9",id:"9-\u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u82e6\u624b\u306a\u30b1\u30fc\u30b9",level:2},{value:"9.1 \u7d71\u8a08\u60c5\u5831\u306e\u554f\u984c",id:"91-\u7d71\u8a08\u60c5\u5831\u306e\u554f\u984c",level:3},{value:"9.2 \u63a8\u5b9a\u304c\u96e3\u3057\u3044\u6761\u4ef6",id:"92-\u63a8\u5b9a\u304c\u96e3\u3057\u3044\u6761\u4ef6",level:3},{value:"9.3 \u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u679c\u306e\u898b\u7a4d\u3082\u308a",id:"93-\u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u679c\u306e\u898b\u7a4d\u3082\u308a",level:3},{value:"9.4 \u591a\u30c6\u30fc\u30d6\u30eb\u7d50\u5408\u306e\u8a08\u753b\u6642\u9593",id:"94-\u591a\u30c6\u30fc\u30d6\u30eb\u7d50\u5408\u306e\u8a08\u753b\u6642\u9593",level:3},{value:"10. \u5b9f\u8df5\u7684\u306a\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",id:"10-\u5b9f\u8df5\u7684\u306a\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",level:2},{value:"10.1 \u9045\u3044\u30af\u30a8\u30ea\u306e\u5206\u6790\u624b\u9806",id:"101-\u9045\u3044\u30af\u30a8\u30ea\u306e\u5206\u6790\u624b\u9806",level:3},{value:"10.2 \u3088\u304f\u3042\u308b\u554f\u984c\u3068\u89e3\u6c7a\u7b56",id:"102-\u3088\u304f\u3042\u308b\u554f\u984c\u3068\u89e3\u6c7a\u7b56",level:3},{value:"10.3 \u5b9f\u8df5\u7684\u306a EXPLAIN \u5206\u6790\u4f8b",id:"103-\u5b9f\u8df5\u7684\u306a-explain-\u5206\u6790\u4f8b",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2},{value:"\u53c2\u8003\u30ea\u30f3\u30af",id:"\u53c2\u8003\u30ea\u30f3\u30af",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"postgresql-\u30d7\u30e9\u30f3\u30ca\u30fc\u6df1\u6398\u308a\u30ac\u30a4\u30c9",children:"PostgreSQL \u30d7\u30e9\u30f3\u30ca\u30fc\u6df1\u6398\u308a\u30ac\u30a4\u30c9"})}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\uff08\u30af\u30a8\u30ea\u30aa\u30d7\u30c6\u30a3\u30de\u30a4\u30b6\uff09\u306f\u3001SQL\u3092\u300c\u3069\u306e\u3088\u3046\u306b\u5b9f\u884c\u3059\u308b\u304b\u300d\u3092\u6c7a\u5b9a\u3059\u308bPostgreSQL\u306e\u982d\u8133\u3067\u3059\u3002\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5185\u90e8\u52d5\u4f5c\u3092\u8a73\u3057\u304f\u89e3\u8aac\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u76ee\u6b21",children:"\u76ee\u6b21"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#1-%E3%83%97%E3%83%A9%E3%83%B3%E3%83%8A%E3%83%BC%E3%81%AE%E5%BD%B9%E5%89%B2%E3%81%A8%E5%85%A8%E4%BD%93%E5%83%8F",children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5f79\u5272\u3068\u5168\u4f53\u50cf"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#2-%E7%B5%B1%E8%A8%88%E6%83%85%E5%A0%B1%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF",children:"\u7d71\u8a08\u60c5\u5831\u306e\u4ed5\u7d44\u307f"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#3-%E3%82%B3%E3%82%B9%E3%83%88%E8%A8%88%E7%AE%97%E3%83%A2%E3%83%87%E3%83%AB",children:"\u30b3\u30b9\u30c8\u8a08\u7b97\u30e2\u30c7\u30eb"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#4-%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3%E6%96%B9%E5%BC%8F%E3%81%AE%E9%81%B8%E6%8A%9E",children:"\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#5-%E7%B5%90%E5%90%88%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0%E3%81%AE%E9%81%B8%E6%8A%9E",children:"\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#6-%E7%B5%90%E5%90%88%E9%A0%86%E5%BA%8F%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96",children:"\u7d50\u5408\u9806\u5e8f\u306e\u6700\u9069\u5316"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#7-%E5%AE%9F%E8%A1%8C%E8%A8%88%E7%94%BB%E3%81%AE%E8%AA%AD%E3%81%BF%E6%96%B9",children:"\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#8-%E3%83%97%E3%83%A9%E3%83%B3%E3%83%8A%E3%83%BC%E3%81%AE%E5%88%B6%E5%BE%A1%E3%81%A8%E3%83%81%E3%83%A5%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0",children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5236\u5fa1\u3068\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#9-%E3%83%97%E3%83%A9%E3%83%B3%E3%83%8A%E3%83%BC%E3%81%8C%E8%8B%A6%E6%89%8B%E3%81%AA%E3%82%B1%E3%83%BC%E3%82%B9",children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u82e6\u624b\u306a\u30b1\u30fc\u30b9"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"#10-%E5%AE%9F%E8%B7%B5%E7%9A%84%E3%81%AA%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0",children:"\u5b9f\u8df5\u7684\u306a\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"})}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"1-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5f79\u5272\u3068\u5168\u4f53\u50cf",children:"1. \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5f79\u5272\u3068\u5168\u4f53\u50cf"}),"\n",(0,r.jsx)(e.h3,{id:"11-\u30d7\u30e9\u30f3\u30ca\u30fc\u3068\u306f",children:"1.1 \u30d7\u30e9\u30f3\u30ca\u30fc\u3068\u306f"}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306f\u3001\u30af\u30a8\u30ea\u6728\uff08Query Tree\uff09\u3092\u53d7\u3051\u53d6\u308a\u3001\u6700\u9069\u306a\u5b9f\u884c\u8a08\u753b\uff08Plan Tree\uff09\u3092\u751f\u6210\u3059\u308b\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3067\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u4f4d\u7f6e\u3065\u3051                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502   SQL\u6587                                                      \u2502\n\u2502     \u2502                                                        \u2502\n\u2502     \u25bc                                                        \u2502\n\u2502   Parser (\u69cb\u6587\u89e3\u6790)                                          \u2502\n\u2502     \u2502                                                        \u2502\n\u2502     \u25bc                                                        \u2502\n\u2502   Analyzer (\u610f\u5473\u89e3\u6790)                                        \u2502\n\u2502     \u2502                                                        \u2502\n\u2502     \u25bc                                                        \u2502\n\u2502   Rewriter (\u66f8\u304d\u63db\u3048)                                        \u2502\n\u2502     \u2502                                                        \u2502\n\u2502     \u25bc                                                        \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    Planner                           \u2502   \u2502\n\u2502   \u2502                                                      \u2502   \u2502\n\u2502   \u2502  \u5165\u529b: Query Tree (\u4f55\u3092\u53d6\u5f97\u3059\u308b\u304b)                   \u2502   \u2502\n\u2502   \u2502  \u51fa\u529b: Plan Tree (\u3069\u3046\u3084\u3063\u3066\u53d6\u5f97\u3059\u308b\u304b)              \u2502   \u2502\n\u2502   \u2502                                                      \u2502   \u2502\n\u2502   \u2502  \u300c\u540c\u3058\u7d50\u679c\u3092\u5f97\u308b\u8907\u6570\u306e\u65b9\u6cd5\u300d\u304b\u3089\u6700\u9069\u306a\u3082\u306e\u3092\u9078\u3076     \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502     \u2502                                                        \u2502\n\u2502     \u25bc                                                        \u2502\n\u2502   Executor (\u5b9f\u884c)                                            \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"12-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u51e6\u7406\u30d5\u30ed\u30fc",children:"1.2 \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u51e6\u7406\u30d5\u30ed\u30fc"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u30d7\u30e9\u30f3\u30ca\u30fc\u5185\u90e8\u306e\u51e6\u7406\u30d5\u30ed\u30fc                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  Query Tree                                                  \u2502\n\u2502      \u2502                                                       \u2502\n\u2502      \u25bc                                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  1. \u524d\u51e6\u7406 (Preprocessing)             \u2502                 \u2502\n\u2502  \u2502     - \u30b5\u30d6\u30af\u30a8\u30ea\u306e\u5e73\u5766\u5316               \u2502                 \u2502\n\u2502  \u2502     - \u5b9a\u6570\u306e\u7573\u307f\u8fbc\u307f                   \u2502                 \u2502\n\u2502  \u2502     - WHERE\u53e5\u306e\u6b63\u898f\u5316                  \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  2. \u30b9\u30ad\u30e3\u30f3\u30d1\u30b9\u306e\u751f\u6210                  \u2502                 \u2502\n\u2502  \u2502     - \u5404\u30c6\u30fc\u30d6\u30eb\u306e\u30a2\u30af\u30bb\u30b9\u65b9\u6cd5\u3092\u5217\u6319    \u2502                 \u2502\n\u2502  \u2502     - Sequential Scan, Index Scan\u7b49    \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  3. \u7d50\u5408\u30d1\u30b9\u306e\u751f\u6210                      \u2502                 \u2502\n\u2502  \u2502     - \u30c6\u30fc\u30d6\u30eb\u306e\u7d50\u5408\u65b9\u6cd5\u3092\u5217\u6319          \u2502                 \u2502\n\u2502  \u2502     - Nested Loop, Hash Join\u7b49         \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  4. \u6700\u9069\u30d1\u30b9\u306e\u9078\u629e                      \u2502                 \u2502\n\u2502  \u2502     - \u30b3\u30b9\u30c8\u304c\u6700\u5c0f\u306e\u30d1\u30b9\u3092\u9078\u629e          \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  5. Plan Tree \u306e\u751f\u6210                    \u2502                 \u2502\n\u2502  \u2502     - \u9078\u629e\u3057\u305f\u30d1\u30b9\u3092\u5b9f\u884c\u8a08\u753b\u306b\u5909\u63db      \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  Plan Tree                                                   \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"13-\u30d1\u30b9\u3068\u30d7\u30e9\u30f3",children:"1.3 \u300c\u30d1\u30b9\u300d\u3068\u300c\u30d7\u30e9\u30f3\u300d"}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u5185\u90e8\u3067\u306f\u3001\u307e\u305a\u8907\u6570\u306e\u300c\u30d1\u30b9 (Path)\u300d\u3092\u751f\u6210\u3057\u3001\u6700\u7d42\u7684\u306b\u6700\u9069\u306a\u30d1\u30b9\u3092\u300c\u30d7\u30e9\u30f3 (Plan)\u300d\u306b\u5909\u63db\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u3010\u30d1\u30b9 (Path)\u3011\n- \u5b9f\u884c\u65b9\u6cd5\u306e\u5019\u88dc\n- \u30b3\u30b9\u30c8\u898b\u7a4d\u3082\u308a\u3092\u6301\u3064\n- \u8907\u6570\u306e\u30d1\u30b9\u304c\u4e26\u884c\u3057\u3066\u691c\u8a0e\u3055\u308c\u308b\n\n\u3010\u30d7\u30e9\u30f3 (Plan)\u3011\n- \u6700\u7d42\u7684\u306b\u63a1\u7528\u3055\u308c\u305f\u5b9f\u884c\u8a08\u753b\n- Executor\u304c\u5b9f\u969b\u306b\u5b9f\u884c\u3059\u308b\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"2-\u7d71\u8a08\u60c5\u5831\u306e\u4ed5\u7d44\u307f",children:"2. \u7d71\u8a08\u60c5\u5831\u306e\u4ed5\u7d44\u307f"}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u9069\u5207\u306a\u5224\u65ad\u3092\u3059\u308b\u305f\u3081\u306b\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u306e\u7d71\u8a08\u60c5\u5831\u304c\u4e0d\u53ef\u6b20\u3067\u3059\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"21-\u7d71\u8a08\u60c5\u5831\u3068\u306f",children:"2.1 \u7d71\u8a08\u60c5\u5831\u3068\u306f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u7d71\u8a08\u60c5\u5831\u306e\u7a2e\u985e                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30c6\u30fc\u30d6\u30eb\u30ec\u30d9\u30eb\u3011pg_class                                   \u2502\n\u2502  \u251c\u2500 reltuples: \u63a8\u5b9a\u884c\u6570                                      \u2502\n\u2502  \u251c\u2500 relpages:  \u30da\u30fc\u30b8\u6570\uff088KB\u30d6\u30ed\u30c3\u30af\u6570\uff09                     \u2502\n\u2502  \u2514\u2500 relallvisible: \u5168\u53ef\u8996\u30da\u30fc\u30b8\u6570                            \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30ab\u30e9\u30e0\u30ec\u30d9\u30eb\u3011pg_statistic / pg_stats                      \u2502\n\u2502  \u251c\u2500 null_frac:      NULL\u5024\u306e\u5272\u5408                             \u2502\n\u2502  \u251c\u2500 n_distinct:     \u30e6\u30cb\u30fc\u30af\u5024\u306e\u6570\uff08\u307e\u305f\u306f\u5272\u5408\uff09              \u2502\n\u2502  \u251c\u2500 most_common_vals:   \u6700\u983b\u5024\u30ea\u30b9\u30c8                         \u2502\n\u2502  \u251c\u2500 most_common_freqs:  \u6700\u983b\u5024\u306e\u51fa\u73fe\u983b\u5ea6                     \u2502\n\u2502  \u251c\u2500 histogram_bounds:   \u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u5883\u754c\u5024                    \u2502\n\u2502  \u2514\u2500 correlation:        \u7269\u7406\u9806\u5e8f\u3068\u306e\u76f8\u95a2                      \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"22-\u7d71\u8a08\u60c5\u5831\u306e\u78ba\u8a8d\u65b9\u6cd5",children:"2.2 \u7d71\u8a08\u60c5\u5831\u306e\u78ba\u8a8d\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u30c6\u30fc\u30d6\u30eb\u306e\u57fa\u672c\u7d71\u8a08\nSELECT \n    relname,\n    reltuples::bigint AS estimated_rows,\n    relpages AS pages\nFROM pg_class \nWHERE relname = 'users';\n\n-- \u30ab\u30e9\u30e0\u306e\u8a73\u7d30\u7d71\u8a08\nSELECT \n    attname,\n    null_frac,\n    n_distinct,\n    most_common_vals,\n    most_common_freqs,\n    histogram_bounds\nFROM pg_stats \nWHERE tablename = 'users' AND attname = 'status';\n"})}),"\n",(0,r.jsx)(e.h3,{id:"23-n_distinct-\u306e\u89e3\u91c8",children:"2.3 n_distinct \u306e\u89e3\u91c8"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   n_distinct \u306e\u610f\u5473                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u6b63\u306e\u5024: \u30e6\u30cb\u30fc\u30af\u5024\u306e\u7d76\u5bfe\u6570                                   \u2502\n\u2502    \u4f8b: n_distinct = 5 \u2192 5\u7a2e\u985e\u306e\u5024\u304c\u3042\u308b                       \u2502\n\u2502                                                              \u2502\n\u2502  \u8ca0\u306e\u5024: \u884c\u6570\u306b\u5bfe\u3059\u308b\u5272\u5408\uff08\u7d76\u5bfe\u5024\uff09                           \u2502\n\u2502    \u4f8b: n_distinct = -0.5 \u2192 \u30e6\u30cb\u30fc\u30af\u5024\u306f\u884c\u6570\u306e50%              \u2502\n\u2502         10000\u884c\u306a\u3089\u7d045000\u7a2e\u985e                                 \u2502\n\u2502                                                              \u2502\n\u2502  -1: \u3059\u3079\u3066\u306e\u5024\u304c\u30e6\u30cb\u30fc\u30af\uff08\u4e3b\u30ad\u30fc\u306a\u3069\uff09                       \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"24-\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0",children:"2.4 \u30d2\u30b9\u30c8\u30b0\u30e9\u30e0"}),"\n",(0,r.jsx)(e.p,{children:"\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u306f\u5024\u306e\u5206\u5e03\u3092\u8868\u3057\u3001\u7bc4\u56f2\u691c\u7d22\u306e\u9078\u629e\u6027\u3092\u63a8\u5b9a\u3059\u308b\u306e\u306b\u4f7f\u308f\u308c\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u306e\u4f8b                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  histogram_bounds = {0, 20, 40, 60, 80, 100}                 \u2502\n\u2502                                                              \u2502\n\u2502  \u3053\u308c\u306f\u5024\u30925\u3064\u306e\u7b49\u983b\u5ea6\u30d0\u30b1\u30c3\u30c8\u306b\u5206\u5272:                         \u2502\n\u2502  [0-20), [20-40), [40-60), [60-80), [80-100]                 \u2502\n\u2502  \u5404\u30d0\u30b1\u30c3\u30c8\u306b\u306f\u7d0420%\u306e\u30c7\u30fc\u30bf\u304c\u542b\u307e\u308c\u308b                        \u2502\n\u2502                                                              \u2502\n\u2502  WHERE age BETWEEN 30 AND 50 \u306e\u9078\u629e\u6027\u63a8\u5b9a:                   \u2502\n\u2502  - [20-40) \u306e\u4e00\u90e8 + [40-60) \u306e\u4e00\u90e8                           \u2502\n\u2502  - \u7d04 (10/20 \xd7 20%) + (10/20 \xd7 20%) = 20%                   \u2502\n\u2502                                                              \u2502\n\u2502   \u983b\u5ea6                                                       \u2502\n\u2502    \u25b2                                                         \u2502\n\u2502    \u2502  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588                          \u2502\n\u2502    \u2502  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588  \u2588\u2588\u2588\u2588                          \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 \u5024                   \u2502\n\u2502       0    20    40    60    80   100                        \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"25-\u76f8\u95a2-correlation",children:"2.5 \u76f8\u95a2 (correlation)"}),"\n",(0,r.jsx)(e.p,{children:"\u7269\u7406\u7684\u306a\u884c\u306e\u4e26\u3073\u9806\u3068\u3001\u30ab\u30e9\u30e0\u5024\u306e\u8ad6\u7406\u7684\u306a\u9806\u5e8f\u306e\u76f8\u95a2\u3092\u793a\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    correlation \u306e\u610f\u5473                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  correlation = 1.0:  \u5b8c\u5168\u306b\u9806\u5e8f\u901a\u308a                          \u2502\n\u2502    \u7269\u7406\u9806: \u884c1, \u884c2, \u884c3, \u884c4, \u884c5                           \u2502\n\u2502    \u5024:     10,  20,  30,  40,  50                            \u2502\n\u2502    \u2192 Index Scan \u304c\u52b9\u7387\u7684\uff08\u9023\u7d9a\u8aad\u307f\u53d6\u308a\uff09                     \u2502\n\u2502                                                              \u2502\n\u2502  correlation = 0.0:  \u30e9\u30f3\u30c0\u30e0                                \u2502\n\u2502    \u7269\u7406\u9806: \u884c1, \u884c2, \u884c3, \u884c4, \u884c5                           \u2502\n\u2502    \u5024:     30,  10,  50,  20,  40                            \u2502\n\u2502    \u2192 Index Scan \u306f\u30e9\u30f3\u30c0\u30e0I/O\u304c\u591a\u767a                          \u2502\n\u2502                                                              \u2502\n\u2502  correlation = -1.0: \u5b8c\u5168\u306b\u9006\u9806                              \u2502\n\u2502    \u7269\u7406\u9806: \u884c1, \u884c2, \u884c3, \u884c4, \u884c5                           \u2502\n\u2502    \u5024:     50,  40,  30,  20,  10                            \u2502\n\u2502                                                              \u2502\n\u2502  \u3010Index Scan \u306e\u30b3\u30b9\u30c8\u306b\u5f71\u97ff\u3011                                \u2502\n\u2502  correlation \u304c\u4f4e\u3044 \u2192 \u30e9\u30f3\u30c0\u30e0I/O \u2192 \u30b3\u30b9\u30c8\u9ad8                 \u2502\n\u2502  correlation \u304c\u9ad8\u3044 \u2192 \u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30ebI/O \u2192 \u30b3\u30b9\u30c8\u4f4e           \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"26-\u7d71\u8a08\u60c5\u5831\u306e\u66f4\u65b0",children:"2.6 \u7d71\u8a08\u60c5\u5831\u306e\u66f4\u65b0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7279\u5b9a\u30c6\u30fc\u30d6\u30eb\u306e\u7d71\u8a08\u60c5\u5831\u3092\u66f4\u65b0\nANALYZE users;\n\n-- \u5168\u30c6\u30fc\u30d6\u30eb\u306e\u7d71\u8a08\u60c5\u5831\u3092\u66f4\u65b0\nANALYZE;\n\n-- \u7d71\u8a08\u60c5\u5831\u306e\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\uff08\u30b5\u30f3\u30d7\u30eb\u6570\u3092\u5897\u3084\u3059\uff09\nALTER TABLE users ALTER COLUMN status SET STATISTICS 1000;\nANALYZE users;\n-- \u30c7\u30d5\u30a9\u30eb\u30c8\u306f 100\u3001\u6700\u5927 10000\n"})}),"\n",(0,r.jsx)(e.h3,{id:"27-\u62e1\u5f35\u7d71\u8a08\u60c5\u5831",children:"2.7 \u62e1\u5f35\u7d71\u8a08\u60c5\u5831"}),"\n",(0,r.jsx)(e.p,{children:"PostgreSQL 10\u4ee5\u964d\u3067\u306f\u3001\u8907\u6570\u30ab\u30e9\u30e0\u9593\u306e\u76f8\u95a2\u3092\u8a18\u9332\u3067\u304d\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u8907\u6570\u30ab\u30e9\u30e0\u306e\u76f8\u95a2\u7d71\u8a08\u3092\u4f5c\u6210\nCREATE STATISTICS stats_city_zip ON city, zip_code FROM addresses;\nANALYZE addresses;\n\n-- \u78ba\u8a8d\nSELECT * FROM pg_statistic_ext WHERE stxname = 'stats_city_zip';\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u62e1\u5f35\u7d71\u8a08\u304c\u5fc5\u8981\u306a\u30b1\u30fc\u30b9                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u554f\u984c\u3011\u30ab\u30e9\u30e0\u9593\u306b\u76f8\u95a2\u304c\u3042\u308b\u306e\u306b\u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u8a8d\u8b58\u3067\u304d\u306a\u3044       \u2502\n\u2502                                                              \u2502\n\u2502  \u4f8b: addresses \u30c6\u30fc\u30d6\u30eb                                       \u2502\n\u2502      city = '\u6771\u4eac\u90fd' AND zip_code LIKE '1%'                  \u2502\n\u2502                                                              \u2502\n\u2502  \u901a\u5e38\u306e\u7d71\u8a08:                                                  \u2502\n\u2502    city = '\u6771\u4eac\u90fd' \u306e\u9078\u629e\u6027: 10%                             \u2502\n\u2502    zip_code LIKE '1%' \u306e\u9078\u629e\u6027: 10%                          \u2502\n\u2502    \u63a8\u5b9a\u9078\u629e\u6027: 10% \xd7 10% = 1% \u2190 \u72ec\u7acb\u3068\u4eee\u5b9a                   \u2502\n\u2502                                                              \u2502\n\u2502  \u5b9f\u969b:                                                        \u2502\n\u2502    \u6771\u4eac\u90fd\u306e\u90f5\u4fbf\u756a\u53f7\u306f1\u3067\u59cb\u307e\u308b \u2192 \u5b9f\u969b\u306f10%                    \u2502\n\u2502                                                              \u2502\n\u2502  \u62e1\u5f35\u7d71\u8a08\u3092\u4f7f\u3046\u3068\u6b63\u78ba\u306b\u63a8\u5b9a\u3067\u304d\u308b                             \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"3-\u30b3\u30b9\u30c8\u8a08\u7b97\u30e2\u30c7\u30eb",children:"3. \u30b3\u30b9\u30c8\u8a08\u7b97\u30e2\u30c7\u30eb"}),"\n",(0,r.jsx)(e.h3,{id:"31-\u30b3\u30b9\u30c8\u3068\u306f",children:"3.1 \u30b3\u30b9\u30c8\u3068\u306f"}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u300c\u30b3\u30b9\u30c8\u300d\u306f\u3001\u5b9f\u884c\u306b\u304b\u304b\u308b\u30ea\u30bd\u30fc\u30b9\u306e\u76f8\u5bfe\u7684\u306a\u898b\u7a4d\u3082\u308a\u3067\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30b3\u30b9\u30c8\u306e\u69cb\u6210\u8981\u7d20                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u7dcf\u30b3\u30b9\u30c8 = I/O\u30b3\u30b9\u30c8 + CPU\u30b3\u30b9\u30c8                            \u2502\n\u2502                                                              \u2502\n\u2502  \u3010I/O\u30b3\u30b9\u30c8\u3011                                               \u2502\n\u2502  \u251c\u2500 \u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u8aad\u307f\u53d6\u308a (seq_page_cost = 1.0)             \u2502\n\u2502  \u2514\u2500 \u30e9\u30f3\u30c0\u30e0\u8aad\u307f\u53d6\u308a (random_page_cost = 4.0)                \u2502\n\u2502                                                              \u2502\n\u2502  \u3010CPU\u30b3\u30b9\u30c8\u3011                                               \u2502\n\u2502  \u251c\u2500 \u884c\u306e\u51e6\u7406 (cpu_tuple_cost = 0.01)                        \u2502\n\u2502  \u251c\u2500 \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30a8\u30f3\u30c8\u30ea\u306e\u51e6\u7406 (cpu_index_tuple_cost = 0.005)\u2502\n\u2502  \u2514\u2500 \u6f14\u7b97\u5b50/\u95a2\u6570\u306e\u5b9f\u884c (cpu_operator_cost = 0.0025)          \u2502\n\u2502                                                              \u2502\n\u2502  \u203b \u5024\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3002SSD\u306a\u3089random_page_cost\u3092\u4e0b\u3052\u308b\u7b49\u306e\u8abf\u6574\u53ef  \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"32-explain\u3067\u898b\u308b\u30b3\u30b9\u30c8",children:"3.2 EXPLAIN\u3067\u898b\u308b\u30b3\u30b9\u30c8"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"EXPLAIN SELECT * FROM users WHERE id = 100;\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Index Scan using users_pkey on users  (cost=0.29..8.30 rows=1 width=100)\n                                       ~~~~~ ~~~~~\n                                         \u2502     \u2502\n                              startup cost   total cost\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u30b3\u30b9\u30c8\u306e\u8aad\u307f\u65b9                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  cost=0.29..8.30                                             \u2502\n\u2502       ~~~~  ~~~~                                             \u2502\n\u2502        \u2502     \u2514\u2500 total cost: \u5168\u884c\u3092\u53d6\u5f97\u3059\u308b\u307e\u3067\u306e\u7dcf\u30b3\u30b9\u30c8     \u2502\n\u2502        \u2502                                                     \u2502\n\u2502        \u2514\u2500 startup cost: \u6700\u521d\u306e\u884c\u3092\u8fd4\u3059\u307e\u3067\u306e\u30b3\u30b9\u30c8           \u2502\n\u2502                         (\u30bd\u30fc\u30c8\u3084\u96c6\u7d04\u3067\u306f\u5927\u304d\u304f\u306a\u308b)          \u2502\n\u2502                                                              \u2502\n\u2502  rows=1     : \u63a8\u5b9a\u7d50\u679c\u884c\u6570                                   \u2502\n\u2502  width=100  : 1\u884c\u3042\u305f\u308a\u306e\u63a8\u5b9a\u30d0\u30a4\u30c8\u6570                        \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"33-sequential-scan-\u306e\u30b3\u30b9\u30c8\u8a08\u7b97",children:"3.3 Sequential Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Sequential Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97\u5f0f                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  total_cost = seq_page_cost \xd7 \u30da\u30fc\u30b8\u6570                       \u2502\n\u2502             + cpu_tuple_cost \xd7 \u884c\u6570                          \u2502\n\u2502             + cpu_operator_cost \xd7 \u884c\u6570 \xd7 WHERE\u6761\u4ef6\u6570         \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u4f8b\u3011users \u30c6\u30fc\u30d6\u30eb: 10000\u884c, 500\u30da\u30fc\u30b8                     \u2502\n\u2502        WHERE status = 'active'                               \u2502\n\u2502                                                              \u2502\n\u2502  I/O\u30b3\u30b9\u30c8  = 1.0 \xd7 500 = 500                                \u2502\n\u2502  CPU\u30b3\u30b9\u30c8  = 0.01 \xd7 10000 + 0.0025 \xd7 10000 = 125            \u2502\n\u2502  \u7dcf\u30b3\u30b9\u30c8   = 625                                            \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"34-index-scan-\u306e\u30b3\u30b9\u30c8\u8a08\u7b97",children:"3.4 Index Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502               Index Scan \u306e\u30b3\u30b9\u30c8\u8a08\u7b97\u5f0f                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  total_cost = \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u63a2\u7d22\u30b3\u30b9\u30c8                         \u2502\n\u2502             + random_page_cost \xd7 \u8aad\u307f\u53d6\u308a\u30da\u30fc\u30b8\u6570            \u2502\n\u2502             + cpu_index_tuple_cost \xd7 \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u884c\u6570        \u2502\n\u2502             + cpu_tuple_cost \xd7 \u30c6\u30fc\u30d6\u30eb\u884c\u6570                  \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u91cd\u8981\u3011correlation \u304c\u8003\u616e\u3055\u308c\u308b                            \u2502\n\u2502                                                              \u2502\n\u2502  correlation\u9ad8\u3044 \u2192 \u30da\u30fc\u30b8\u8aad\u307f\u53d6\u308a\u304c\u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u306b\u8fd1\u3044       \u2502\n\u2502                  \u2192 \u30b3\u30b9\u30c8\u304c\u4e0b\u304c\u308b                            \u2502\n\u2502                                                              \u2502\n\u2502  correlation\u4f4e\u3044 \u2192 \u30e9\u30f3\u30c0\u30e0I/O\u304c\u591a\u3044                         \u2502\n\u2502                  \u2192 \u30b3\u30b9\u30c8\u304c\u4e0a\u304c\u308b                            \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u4f8b\u3011users.id \u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3001id = 100 \u3092\u691c\u7d22               \u2502\n\u2502        \u63a8\u5b9a1\u884c\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u6df1\u30553\u3001correlation = 1.0          \u2502\n\u2502                                                              \u2502\n\u2502  \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u63a2\u7d22 = random_page_cost \xd7 3 = 12                \u2502\n\u2502  \u30c6\u30fc\u30d6\u30eb\u8aad\u307f\u53d6\u308a = random_page_cost \xd7 1 = 4                 \u2502\n\u2502  CPU\u51e6\u7406         = \u7d04 0.03                                   \u2502\n\u2502  \u7dcf\u30b3\u30b9\u30c8        \u2248 16                                        \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"35-\u30b3\u30b9\u30c8\u6bd4\u8f03\u306e\u4f8b",children:"3.5 \u30b3\u30b9\u30c8\u6bd4\u8f03\u306e\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- 10000\u884c\u306eusers\u30c6\u30fc\u30d6\u30eb\u3001status\u30ab\u30e9\u30e0\u306b5\u7a2e\u985e\u306e\u5024\n-- 1. \u9078\u629e\u6027\u304c\u9ad8\u3044\u5834\u5408 (1\u884c\u306e\u307f)\nEXPLAIN SELECT * FROM users WHERE id = 100;\n-- \u2192 Index Scan (cost \u2248 8)\n\n-- 2. \u9078\u629e\u6027\u304c\u4e2d\u7a0b\u5ea6 (2000\u884c = 20%)\nEXPLAIN SELECT * FROM users WHERE status = 'active';\n-- \u2192 Index Scan \u307e\u305f\u306f Bitmap Scan (cost\u6bd4\u8f03\u3067\u6c7a\u5b9a)\n\n-- 3. \u9078\u629e\u6027\u304c\u4f4e\u3044 (8000\u884c = 80%)\nEXPLAIN SELECT * FROM users WHERE status != 'deleted';\n-- \u2192 Sequential Scan (cost \u2248 625) \n-- \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f7f\u3046\u3088\u308a\u5168\u4ef6\u30b9\u30ad\u30e3\u30f3\u306e\u65b9\u304c\u52b9\u7387\u7684\n"})}),"\n",(0,r.jsx)(e.h3,{id:"36-\u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",children:"3.6 \u30b3\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- SSD\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\uff08\u30e9\u30f3\u30c0\u30e0\u8aad\u307f\u53d6\u308a\u304c\u901f\u3044\uff09\nSET random_page_cost = 1.1;  -- \u30c7\u30d5\u30a9\u30eb\u30c8 4.0\n\n-- \u30e1\u30e2\u30ea\u304c\u6f64\u6ca2\u3067\u30c7\u30fc\u30bf\u304c\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u3066\u3044\u308b\u5834\u5408\nSET effective_cache_size = '8GB';  -- OS\u30ad\u30e3\u30c3\u30b7\u30e5\u3082\u542b\u3081\u305f\u63a8\u5b9a\n\n-- \u78ba\u8a8d\nSHOW random_page_cost;\nSHOW seq_page_cost;\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"4-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e",children:"4. \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e"}),"\n",(0,r.jsx)(e.h3,{id:"41-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u4e00\u89a7",children:"4.1 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u4e00\u89a7"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u7a2e\u985e                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502 Sequential Scan \u2502  \u30c6\u30fc\u30d6\u30eb\u5168\u4f53\u3092\u5148\u982d\u304b\u3089\u9806\u306b\u8aad\u3080         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2502           \u2193 \u9078\u629e\u6027\u304c\u4f4e\u3044\u5834\u5408\u306b\u6709\u5229                           \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502   Index Scan    \u2502  \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u2192\u30c6\u30fc\u30d6\u30eb\u306e\u9806\u3067\u30a2\u30af\u30bb\u30b9    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2502           \u2193 \u9078\u629e\u6027\u304c\u9ad8\u3044\u5834\u5408\u306b\u6709\u5229                           \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502Index Only Scan  \u2502  \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3060\u3051\u3067\u5b8c\u7d50\uff08\u30c6\u30fc\u30d6\u30eb\u4e0d\u8981\uff09  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2502           \u2193 SELECT\u5bfe\u8c61\u304c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u542b\u307e\u308c\u308b\u5834\u5408           \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502  Bitmap Scan    \u2502  \u8907\u6570\u6761\u4ef6\u3092\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3067\u52b9\u7387\u5316         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2502           \u2193 \u4e2d\u7a0b\u5ea6\u306e\u9078\u629e\u6027\u3001\u8907\u6570\u30a4\u30f3\u30c7\u30c3\u30af\u30b9                 \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502    TID Scan     \u2502  \u76f4\u63a5\u884c\u306eTID\u3092\u6307\u5b9a\u3057\u3066\u30a2\u30af\u30bb\u30b9          \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                        \u2502\n\u2502           \u2193 WHERE ctid = '(0,1)' \u306a\u3069\u7279\u6b8a\u30b1\u30fc\u30b9             \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"42-sequential-scan",children:"4.2 Sequential Scan"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Sequential Scan                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u52d5\u4f5c\u3011                                                    \u2502\n\u2502  \u30c6\u30fc\u30d6\u30eb\u306e\u5168\u30da\u30fc\u30b8\u3092\u5148\u982d\u304b\u3089\u9806\u756a\u306b\u8aad\u307f\u3001\u5404\u884c\u3092\u30c1\u30a7\u30c3\u30af        \u2502\n\u2502                                                              \u2502\n\u2502  Page 0 \u2192 Page 1 \u2192 Page 2 \u2192 ... \u2192 Page N                    \u2502\n\u2502    \u2193        \u2193        \u2193              \u2193                       \u2502\n\u2502  \u5404\u884c\u3092WHERE\u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0                              \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9078\u3070\u308c\u308b\u6761\u4ef6\u3011                                            \u2502\n\u2502  - \u53d6\u5f97\u884c\u304c\u5168\u4f53\u306e\u5927\u90e8\u5206\u3092\u5360\u3081\u308b                              \u2502\n\u2502  - \u9069\u5207\u306a\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u306a\u3044                                  \u2502\n\u2502  - \u30c6\u30fc\u30d6\u30eb\u304c\u5c0f\u3055\u3044                                          \u2502\n\u2502  - correlation \u304c\u4f4e\u304fIndex Scan\u304c\u975e\u52b9\u7387                      \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30d1\u30e9\u30ec\u30eb\u5b9f\u884c\u3011                                            \u2502\n\u2502  \u5927\u304d\u306a\u30c6\u30fc\u30d6\u30eb\u3067\u306f\u8907\u6570\u30ef\u30fc\u30ab\u30fc\u3067\u4e26\u5217\u5b9f\u884c\u53ef\u80fd                 \u2502\n\u2502  \u2192 Parallel Sequential Scan                                  \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"43-index-scan",children:"4.3 Index Scan"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Index Scan                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u52d5\u4f5c\u3011                                                    \u2502\n\u2502                                                              \u2502\n\u2502  Step 1: \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u63a2\u7d22\u3057\u3066\u6761\u4ef6\u306b\u5408\u3046\u30a8\u30f3\u30c8\u30ea\u3092\u898b\u3064\u3051\u308b   \u2502\n\u2502                                                              \u2502\n\u2502      B-tree Index                                            \u2502\n\u2502          \u2502                                                   \u2502\n\u2502          \u25bc                                                   \u2502\n\u2502      [Root] \u2192 [Internal] \u2192 [Leaf]                           \u2502\n\u2502                              \u2502                               \u2502\n\u2502                         TID (0, 5)  \u2190 \u884c\u306e\u7269\u7406\u4f4d\u7f6e           \u2502\n\u2502                                                              \u2502\n\u2502  Step 2: TID\u3092\u4f7f\u3063\u3066\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u884c\u3092\u53d6\u5f97                      \u2502\n\u2502                                                              \u2502\n\u2502      Table                                                   \u2502\n\u2502      Page 0: [row1][row2][row3]...                           \u2502\n\u2502                              \u2191                               \u2502\n\u2502                          \u3053\u3053\u3092\u8aad\u3080                          \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9078\u3070\u308c\u308b\u6761\u4ef6\u3011                                            \u2502\n\u2502  - \u9078\u629e\u6027\u304c\u9ad8\u3044\uff08\u5c11\u6570\u306e\u884c\u3092\u53d6\u5f97\uff09                            \u2502\n\u2502  - ORDER BY\u304c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u9806\u3068\u4e00\u81f4                            \u2502\n\u2502  - LIMIT\u3068\u7d44\u307f\u5408\u308f\u305b                                         \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"44-index-only-scan",children:"4.4 Index Only Scan"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Index Only Scan                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u52d5\u4f5c\u3011                                                    \u2502\n\u2502  \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3060\u3051\u3067\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u304c\u63c3\u3046\u5834\u5408\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u8aad\u307e\u306a\u3044  \u2502\n\u2502                                                              \u2502\n\u2502  CREATE INDEX idx_users_email ON users(email);               \u2502\n\u2502  SELECT email FROM users WHERE email LIKE 'a%';              \u2502\n\u2502                                                              \u2502\n\u2502      Index (email)                                           \u2502\n\u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                               \u2502\n\u2502      \u2502 alice@example.com    \u2502 \u2190 \u3053\u308c\u3060\u3051\u3067\u56de\u7b54\u53ef\u80fd           \u2502\n\u2502      \u2502 anna@example.com     \u2502                                \u2502\n\u2502      \u2502 ...                  \u2502                                \u2502\n\u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                               \u2502\n\u2502              \u2193                                               \u2502\n\u2502      \u30c6\u30fc\u30d6\u30eb\u30a2\u30af\u30bb\u30b9\u4e0d\u8981\uff01                                   \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u6761\u4ef6\u3011                                                    \u2502\n\u2502  1. SELECT\u3059\u308b\u30ab\u30e9\u30e0\u304c\u5168\u3066\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b\u542b\u307e\u308c\u308b              \u2502\n\u2502  2. Visibility Map \u3067\u884c\u304c\u300c\u5168\u53ef\u8996\u300d\u3068\u5206\u304b\u3063\u3066\u3044\u308b             \u2502\n\u2502     \uff08VACUUM\u304c\u9069\u5207\u306b\u5b9f\u884c\u3055\u308c\u3066\u3044\u308b\u5fc5\u8981\u3042\u308a\uff09                  \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30ab\u30d0\u30ea\u30f3\u30b0\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3011                                   \u2502\n\u2502  CREATE INDEX idx_covering ON users(email) INCLUDE (name);   \u2502\n\u2502  \u2192 SELECT email, name FROM users WHERE email = '...'         \u2502\n\u2502    \u3082Index Only Scan\u306b\u3067\u304d\u308b                                 \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"45-bitmap-scan",children:"4.5 Bitmap Scan"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Bitmap Scan                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u52d5\u4f5c\u30113\u6bb5\u968e\u306e\u30d7\u30ed\u30bb\u30b9                                      \u2502\n\u2502                                                              \u2502\n\u2502  \u2460 Bitmap Index Scan: \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304b\u3089\u8a72\u5f53\u30da\u30fc\u30b8\u3092\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u5316\u2502\n\u2502                                                              \u2502\n\u2502     Index                    Bitmap                          \u2502\n\u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502     \u2502id = 5  \u2502\u2500\u2500\u2192           \u2502 Page 0: 1         \u2502           \u2502\n\u2502     \u2502id = 12 \u2502\u2500\u2500\u2192           \u2502 Page 1: 0         \u2502           \u2502\n\u2502     \u2502id = 15 \u2502\u2500\u2500\u2192           \u2502 Page 2: 1         \u2502           \u2502\n\u2502     \u2502id = 23 \u2502\u2500\u2500\u2192           \u2502 Page 3: 1         \u2502           \u2502\n\u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502                                                              \u2502\n\u2502  \u2461 BitmapAnd / BitmapOr: \u8907\u6570\u6761\u4ef6\u306e\u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u3092\u7d50\u5408         \u2502\n\u2502                                                              \u2502\n\u2502     WHERE status='active' AND category='A'                   \u2502\n\u2502                                                              \u2502\n\u2502     Bitmap(status)     Bitmap(category)     Result           \u2502\n\u2502     [1,0,1,1,0]    AND [1,1,0,1,0]      =  [1,0,0,1,0]       \u2502\n\u2502                                                              \u2502\n\u2502  \u2462 Bitmap Heap Scan: \u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u306b\u57fa\u3065\u3044\u3066\u30c6\u30fc\u30d6\u30eb\u3092\u8aad\u3080     \u2502\n\u2502                                                              \u2502\n\u2502     Page 0, Page 3 \u306e\u307f\u8aad\u307f\u53d6\u308a                              \u2502\n\u2502     \u2192 \u30da\u30fc\u30b8\u5358\u4f4d\u3067\u307e\u3068\u3081\u3066\u8aad\u3080\u306e\u3067\u30e9\u30f3\u30c0\u30e0I/O\u524a\u6e1b             \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9078\u3070\u308c\u308b\u6761\u4ef6\u3011                                            \u2502\n\u2502  - \u4e2d\u7a0b\u5ea6\u306e\u9078\u629e\u6027\uff08\u591a\u3059\u304e\u305a\u5c11\u306a\u3059\u304e\u305a\uff09                       \u2502\n\u2502  - \u8907\u6570\u306e\u6761\u4ef6\u3092OR/AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b                          \u2502\n\u2502  - correlation \u304c\u4f4e\u3044\uff08\u30e9\u30f3\u30c0\u30e0I/O\u3092\u6e1b\u3089\u3057\u305f\u3044\uff09             \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"46-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u57fa\u6e96",children:"4.6 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u57fa\u6e96"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u30d5\u30ed\u30fc                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u9069\u5207\u306a\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u3042\u308b\uff1f                                   \u2502\n\u2502         \u2502                                                    \u2502\n\u2502    No   \u2502   Yes                                              \u2502\n\u2502    \u2193    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                  \u2502\n\u2502  Seq Scan                \u2502                                   \u2502\n\u2502                    \u9078\u629e\u6027\u306f\uff1f                                \u2502\n\u2502                    \u2502     \u2502      \u2502                            \u2502\n\u2502                  \u9ad8\u3044  \u4e2d\u7a0b\u5ea6  \u4f4e\u3044                           \u2502\n\u2502                   \u2502     \u2502      \u2502                             \u2502\n\u2502                   \u25bc     \u25bc      \u25bc                             \u2502\n\u2502              Index   Bitmap   Seq                            \u2502\n\u2502              Scan    Scan     Scan                           \u2502\n\u2502                \u2502                                             \u2502\n\u2502         SELECT\u5217\u304c\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306b                             \u2502\n\u2502         \u5168\u3066\u542b\u307e\u308c\u308b\uff1f                                       \u2502\n\u2502              \u2502     \u2502                                         \u2502\n\u2502            Yes    No                                         \u2502\n\u2502              \u2502     \u2502                                         \u2502\n\u2502              \u25bc     \u25bc                                         \u2502\n\u2502         Index    Index                                       \u2502\n\u2502         Only     Scan                                        \u2502\n\u2502         Scan                                                 \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u3010\u9078\u629e\u6027\u306e\u76ee\u5b89\u3011\n- \u9ad8\u3044: \u5168\u4f53\u306e 1-5% \u672a\u6e80 \u2192 Index Scan\n- \u4e2d\u7a0b\u5ea6: 5-20% \u2192 Bitmap Scan\n- \u4f4e\u3044: 20% \u4ee5\u4e0a \u2192 Sequential Scan\n\n\u203b \u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\u3001correlation\u3001effective_cache_size\u7b49\u3067\u5909\u52d5\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"5-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e",children:"5. \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e"}),"\n",(0,r.jsx)(e.h3,{id:"51-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u89a7",children:"5.1 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e00\u89a7"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                  Nested Loop Join                    \u2502    \u2502\n\u2502  \u2502  \u5916\u5074\u30c6\u30fc\u30d6\u30eb\u306e\u5404\u884c\u306b\u5bfe\u3057\u3001\u5185\u5074\u30c6\u30fc\u30d6\u30eb\u3092\u691c\u7d22         \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                    Hash Join                         \u2502    \u2502\n\u2502  \u2502  \u4e00\u65b9\u306e\u30c6\u30fc\u30d6\u30eb\u3067\u30cf\u30c3\u30b7\u30e5\u30c6\u30fc\u30d6\u30eb\u3092\u69cb\u7bc9\u3057\u3001           \u2502    \u2502\n\u2502  \u2502  \u3082\u3046\u4e00\u65b9\u3092\u305d\u308c\u306b\u7167\u5408                                \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                   Merge Join                         \u2502    \u2502\n\u2502  \u2502  \u4e21\u30c6\u30fc\u30d6\u30eb\u3092\u30bd\u30fc\u30c8\u3057\u3066\u30de\u30fc\u30b8                        \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"52-nested-loop-join",children:"5.2 Nested Loop Join"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Nested Loop Join                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3011                                            \u2502\n\u2502                                                              \u2502\n\u2502  for each row in outer_table:          # \u5916\u5074\u30eb\u30fc\u30d7          \u2502\n\u2502      for each row in inner_table:      # \u5185\u5074\u30eb\u30fc\u30d7          \u2502\n\u2502          if join_condition matches:                          \u2502\n\u2502              output combined row                             \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u56f3\u89e3\u3011                                                    \u2502\n\u2502                                                              \u2502\n\u2502  Outer (users)         Inner (orders)                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                         \u2502\n\u2502  \u2502 id=1     \u2502\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2192\u2502 user_id  \u2502 \u5168\u4ef6\u307e\u305f\u306f              \u2502\n\u2502  \u2502 id=2     \u2502\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2192\u2502 \u3092\u30b9\u30ad\u30e3\u30f3\u2502 \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3067\u691c\u7d22      \u2502\n\u2502  \u2502 id=3     \u2502\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2192\u2502          \u2502                         \u2502\n\u2502  \u2502 ...      \u2502    \u2502     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502                                          \u2502\n\u2502                  \u2514\u2500 \u5916\u5074\u306e\u5404\u884c\u306b\u5bfe\u3057\u3066\u5185\u5074\u3092\u691c\u7d22             \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30b3\u30b9\u30c8\u3011                                                  \u2502\n\u2502  O(N \xd7 M) ... \u305f\u3060\u3057\u5185\u5074\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u3042\u308c\u3070 O(N \xd7 log M) \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9069\u3057\u305f\u30b1\u30fc\u30b9\u3011                                            \u2502\n\u2502  - \u5916\u5074\u30c6\u30fc\u30d6\u30eb\u304c\u5c0f\u3055\u3044                                      \u2502\n\u2502  - \u5185\u5074\u30c6\u30fc\u30d6\u30eb\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u3042\u308b                          \u2502\n\u2502  - \u975e\u7b49\u4fa1\u7d50\u5408\uff08<, >, BETWEEN \u306a\u3069\uff09                         \u2502\n\u2502  - LIMIT \u3068\u7d44\u307f\u5408\u308f\u305b\uff08\u65e9\u671f\u7d42\u4e86\u3067\u304d\u308b\uff09                      \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"53-hash-join",children:"5.3 Hash Join"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       Hash Join                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u30112\u30d5\u30a7\u30fc\u30ba                                    \u2502\n\u2502                                                              \u2502\n\u2502  Phase 1: Build (\u30cf\u30c3\u30b7\u30e5\u30c6\u30fc\u30d6\u30eb\u69cb\u7bc9)                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Inner Table (\u901a\u5e38\u306f\u5c0f\u3055\u3044\u65b9)                        \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                     \u2502    \u2502\n\u2502  \u2502  \u2502 id=1, ...  \u2502\u2500\u2500\u2192 hash(1) = bucket[3]             \u2502    \u2502\n\u2502  \u2502  \u2502 id=2, ...  \u2502\u2500\u2500\u2192 hash(2) = bucket[7]             \u2502    \u2502\n\u2502  \u2502  \u2502 id=3, ...  \u2502\u2500\u2500\u2192 hash(3) = bucket[3]             \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                     \u2502    \u2502\n\u2502  \u2502                     Hash Table                       \u2502    \u2502\n\u2502  \u2502                     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502    \u2502\n\u2502  \u2502                     \u2502 [0]:            \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2502 [1]:            \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2502 [2]:            \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2502 [3]: id=1, id=3 \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2502 ...             \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2502 [7]: id=2       \u2502             \u2502    \u2502\n\u2502  \u2502                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  Phase 2: Probe (\u7167\u5408)                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  Outer Table \u306e\u5404\u884c\u3092\u30cf\u30c3\u30b7\u30e5\u30c6\u30fc\u30d6\u30eb\u3067\u691c\u7d22           \u2502    \u2502\n\u2502  \u2502                                                      \u2502    \u2502\n\u2502  \u2502  user_id=1 \u2192 hash(1) \u2192 bucket[3] \u2192 \u30de\u30c3\u30c1!          \u2502    \u2502\n\u2502  \u2502  user_id=5 \u2192 hash(5) \u2192 bucket[2] \u2192 \u306a\u3057             \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30b3\u30b9\u30c8\u3011                                                  \u2502\n\u2502  O(N + M) ... \u30cf\u30c3\u30b7\u30e5\u69cb\u7bc9O(M) + \u7167\u5408O(N)                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9069\u3057\u305f\u30b1\u30fc\u30b9\u3011                                            \u2502\n\u2502  - \u7b49\u4fa1\u7d50\u5408 (=) \u306e\u307f                                        \u2502\n\u2502  - \u4e21\u30c6\u30fc\u30d6\u30eb\u304c\u6bd4\u8f03\u7684\u5927\u304d\u3044                                  \u2502\n\u2502  - work_mem \u306b\u53ce\u307e\u308b\u30b5\u30a4\u30ba                                  \u2502\n\u2502  - \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u306a\u3044\u5834\u5408                                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u6ce8\u610f\u3011                                                    \u2502\n\u2502  - \u30cf\u30c3\u30b7\u30e5\u30c6\u30fc\u30d6\u30eb\u304cwork_mem\u3092\u8d85\u3048\u308b\u3068\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u306b\u9000\u907f     \u2502\n\u2502    \u2192 \u5927\u5e45\u306b\u9045\u304f\u306a\u308b                                         \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"54-merge-join",children:"5.4 Merge Join"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       Merge Join                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3011                                            \u2502\n\u2502                                                              \u2502\n\u2502  \u524d\u63d0: \u4e21\u30c6\u30fc\u30d6\u30eb\u304c\u7d50\u5408\u30ad\u30fc\u3067\u30bd\u30fc\u30c8\u6e08\u307f                       \u2502\n\u2502                                                              \u2502\n\u2502  Sorted Outer     Sorted Inner                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                               \u2502\n\u2502  \u2502 id=1     \u2502\u2190\u2500\u2500\u2192\u2502 user_id=1\u2502  \u30de\u30c3\u30c1!                      \u2502\n\u2502  \u2502 id=2     \u2502\u2190\u2500\u2500\u2192\u2502 user_id=2\u2502  \u30de\u30c3\u30c1!                      \u2502\n\u2502  \u2502 id=3     \u2502    \u2502 user_id=2\u2502  (2\u3068\u8907\u6570\u30de\u30c3\u30c1)               \u2502\n\u2502  \u2502 id=4     \u2502\u2190\u2500\u2500\u2192\u2502 user_id=4\u2502  \u30de\u30c3\u30c1!                      \u2502\n\u2502  \u2502 id=5     \u2502    \u2502 user_id=6\u2502  (5\u306f\u30b9\u30ad\u30c3\u30d7)                 \u2502\n\u2502  \u2502 id=6     \u2502\u2190\u2500\u2500\u2192\u2502 user_id=6\u2502  \u30de\u30c3\u30c1!                      \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                               \u2502\n\u2502       \u2193               \u2193                                      \u2502\n\u2502    \u540c\u6642\u306b\u9032\u3081\u308b\uff08\u30de\u30fc\u30b8\uff09                                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30b3\u30b9\u30c8\u3011                                                  \u2502\n\u2502  O(N log N + M log M + N + M)                                \u2502\n\u2502  \u30bd\u30fc\u30c8\u6e08\u307f\u306a\u3089 O(N + M)                                     \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u9069\u3057\u305f\u30b1\u30fc\u30b9\u3011                                            \u2502\n\u2502  - \u5927\u304d\u306a\u30c6\u30fc\u30d6\u30eb\u540c\u58eb\u306e\u7d50\u5408                                  \u2502\n\u2502  - \u65e2\u306b\u30bd\u30fc\u30c8\u6e08\u307f\uff08\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u3042\u308b\uff09                      \u2502\n\u2502  - ORDER BY \u304c\u7d50\u5408\u30ad\u30fc\u3068\u540c\u3058                                 \u2502\n\u2502  - \u7b49\u4fa1\u7d50\u5408\u3060\u3051\u3067\u306a\u304f\u7bc4\u56f2\u7d50\u5408\u3082\u53ef\u80fd                          \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"55-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e\u57fa\u6e96",children:"5.5 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e\u57fa\u6e96"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u9078\u629e\u30d5\u30ed\u30fc                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u7d50\u5408\u6761\u4ef6\u306f\uff1f                                                \u2502\n\u2502       \u2502                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510                                                \u2502\n\u2502  \u2502         \u2502                                                 \u2502\n\u2502 \u7b49\u4fa1(=)  \u975e\u7b49\u4fa1(<,>\u7b49)                                       \u2502\n\u2502  \u2502         \u2502                                                 \u2502\n\u2502  \u2502         \u2514\u2500\u2500\u2192 Nested Loop (\u307b\u307c\u552f\u4e00\u306e\u9078\u629e\u80a2)              \u2502\n\u2502  \u2502                                                           \u2502\n\u2502  \u25bc                                                           \u2502\n\u2502  \u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\u306f\uff1f                                          \u2502\n\u2502       \u2502                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                        \u2502\n\u2502  \u2502    \u2502            \u2502                                         \u2502\n\u2502 \u5c0f\xd7\u5c0f \u5c0f\xd7\u5927      \u5927\xd7\u5927                                       \u2502\n\u2502  \u2502    \u2502            \u2502                                         \u2502\n\u2502  \u2502    \u2502     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                 \u2502\n\u2502  \u2502    \u2502     \u2502             \u2502                                  \u2502\n\u2502  \u2502    \u2502   \u30bd\u30fc\u30c8\u6e08\u307f\uff1f  \u30bd\u30fc\u30c8\u306a\u3057                           \u2502\n\u2502  \u2502    \u2502     \u2502             \u2502                                  \u2502\n\u2502  \u25bc    \u25bc     \u25bc             \u25bc                                  \u2502\n\u2502 NL   NL   Merge         Hash                                 \u2502\n\u2502(idx) (idx) Join          Join                                \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u3010\u5224\u65ad\u306e\u88dc\u8db3\u3011\n- \u5c0f\u3055\u3044\u30c6\u30fc\u30d6\u30eb: \u6570\u5343\u884c\u4ee5\u4e0b\n- \u5927\u304d\u3044\u30c6\u30fc\u30d6\u30eb: \u6570\u4e07\u884c\u4ee5\u4e0a\n- \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u6709\u7121\u3067 Nested Loop \u306e\u52b9\u7387\u304c\u5927\u304d\u304f\u5909\u308f\u308b\n- work_mem \u306e\u30b5\u30a4\u30ba\u3067 Hash Join \u306e\u52b9\u7387\u304c\u5909\u308f\u308b\n"})}),"\n",(0,r.jsx)(e.h3,{id:"56-\u5b9f\u884c\u8a08\u753b\u3067\u306e\u78ba\u8a8d\u4f8b",children:"5.6 \u5b9f\u884c\u8a08\u753b\u3067\u306e\u78ba\u8a8d\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"EXPLAIN (ANALYZE, BUFFERS) \nSELECT u.name, o.total\nFROM users u\nJOIN orders o ON u.id = o.user_id\nWHERE u.status = 'active';\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"-- Nested Loop \u306e\u4f8b\nNested Loop  (cost=0.29..125.35 rows=100 ...)\n  ->  Index Scan using idx_users_status on users u  (...)\n        Index Cond: (status = 'active')\n  ->  Index Scan using idx_orders_user_id on orders o  (...)\n        Index Cond: (user_id = u.id)\n\n-- Hash Join \u306e\u4f8b\nHash Join  (cost=15.00..85.00 rows=1000 ...)\n  Hash Cond: (o.user_id = u.id)\n  ->  Seq Scan on orders o  (...)\n  ->  Hash  (...)\n        ->  Seq Scan on users u  (...)\n              Filter: (status = 'active')\n\n-- Merge Join \u306e\u4f8b\nMerge Join  (cost=200.00..350.00 rows=1000 ...)\n  Merge Cond: (u.id = o.user_id)\n  ->  Index Scan using users_pkey on users u  (...)\n  ->  Sort  (...)\n        Sort Key: o.user_id\n        ->  Seq Scan on orders o  (...)\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"6-\u7d50\u5408\u9806\u5e8f\u306e\u6700\u9069\u5316",children:"6. \u7d50\u5408\u9806\u5e8f\u306e\u6700\u9069\u5316"}),"\n",(0,r.jsx)(e.h3,{id:"61-\u7d50\u5408\u9806\u5e8f\u554f\u984c",children:"6.1 \u7d50\u5408\u9806\u5e8f\u554f\u984c"}),"\n",(0,r.jsx)(e.p,{children:"\u8907\u6570\u30c6\u30fc\u30d6\u30eb\u3092\u7d50\u5408\u3059\u308b\u5834\u5408\u3001\u9806\u5e8f\u306b\u3088\u3063\u3066\u6027\u80fd\u304c\u5927\u304d\u304f\u5909\u308f\u308a\u307e\u3059\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u7d50\u5408\u9806\u5e8f\u306e\u91cd\u8981\u6027                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  3\u30c6\u30fc\u30d6\u30eb\u7d50\u5408: A \u22c8 B \u22c8 C                                   \u2502\n\u2502                                                              \u2502\n\u2502  \u53ef\u80fd\u306a\u9806\u5e8f:                                                 \u2502\n\u2502  1. (A \u22c8 B) \u22c8 C                                             \u2502\n\u2502  2. (A \u22c8 C) \u22c8 B                                             \u2502\n\u2502  3. (B \u22c8 C) \u22c8 A                                             \u2502\n\u2502  4. A \u22c8 (B \u22c8 C)                                             \u2502\n\u2502  5. B \u22c8 (A \u22c8 C)                                             \u2502\n\u2502  6. C \u22c8 (A \u22c8 B)                                             \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u4f8b\u3011                                                      \u2502\n\u2502  A: 10\u884c, B: 10000\u884c, C: 100\u884c                               \u2502\n\u2502  A \u22c8 B: 1000\u884c, B \u22c8 C: 5000\u884c, A \u22c8 C: 100\u884c                \u2502\n\u2502                                                              \u2502\n\u2502  \u60aa\u3044\u9806\u5e8f: (B \u22c8 C) \u22c8 A                                      \u2502\n\u2502    \u2192 B \u22c8 C \u30675000\u884c\u306e\u4e2d\u9593\u7d50\u679c                               \u2502\n\u2502    \u2192 5000\u884c \u22c8 A                                             \u2502\n\u2502                                                              \u2502\n\u2502  \u826f\u3044\u9806\u5e8f: (A \u22c8 C) \u22c8 B                                      \u2502\n\u2502    \u2192 A \u22c8 C \u3067100\u884c\u306e\u4e2d\u9593\u7d50\u679c                                \u2502\n\u2502    \u2192 100\u884c \u22c8 B                                              \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"62-\u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u65b9\u6cd5",children:"6.2 \u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u30c6\u30fc\u30d6\u30eb\u6570\u304c\u5c11\u306a\u3044\u5834\u5408 (\u2264 geqo_threshold, \u30c7\u30d5\u30a9\u30eb\u30c812)      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502              \u52d5\u7684\u8a08\u753b\u6cd5 (Dynamic Programming)        \u2502    \u2502\n\u2502  \u2502                                                      \u2502    \u2502\n\u2502  \u2502  \u5168\u3066\u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u8a55\u4fa1\u3057\u3066\u6700\u9069\u89e3\u3092\u898b\u3064\u3051\u308b            \u2502    \u2502\n\u2502  \u2502  \u8a08\u7b97\u91cf: O(n! \xd7 2^n)                                 \u2502    \u2502\n\u2502  \u2502  \u2192 \u78ba\u5b9f\u306b\u6700\u9069\u89e3\u304c\u5f97\u3089\u308c\u308b                            \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u30c6\u30fc\u30d6\u30eb\u6570\u304c\u591a\u3044\u5834\u5408 (> geqo_threshold)                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502              GEQO (\u907a\u4f1d\u7684\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0)                \u2502    \u2502\n\u2502  \u2502                                                      \u2502    \u2502\n\u2502  \u2502  \u30e9\u30f3\u30c0\u30e0\u306a\u9806\u5e8f\u304b\u3089\u59cb\u3081\u3066\u3001\u9032\u5316\u7684\u306b\u6539\u5584              \u2502    \u2502\n\u2502  \u2502  \u8a08\u7b97\u91cf: \u8a2d\u5b9a\u53ef\u80fd                                    \u2502    \u2502\n\u2502  \u2502  \u2192 \u6700\u9069\u89e3\u306f\u4fdd\u8a3c\u3055\u308c\u306a\u3044\u304c\u3001\u73fe\u5b9f\u7684\u306a\u6642\u9593\u3067\u5b8c\u4e86        \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"63-\u7d50\u5408\u9806\u5e8f\u306b\u95a2\u3059\u308b\u8a2d\u5b9a",children:"6.3 \u7d50\u5408\u9806\u5e8f\u306b\u95a2\u3059\u308b\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u52d5\u7684\u8a08\u753b\u6cd5\u3092\u4f7f\u3046\u30c6\u30fc\u30d6\u30eb\u6570\u306e\u95be\u5024\nSHOW geqo_threshold;  -- \u30c7\u30d5\u30a9\u30eb\u30c8 12\n\n-- GEQO\u306e\u52d5\u4f5c\u3092\u5236\u5fa1\nSET geqo = on;                -- GEQO \u3092\u6709\u52b9\u5316\nSET geqo_effort = 5;          -- \u63a2\u7d22\u306e\u52aa\u529b\u5ea6 (1-10)\nSET geqo_generations = 0;     -- \u4e16\u4ee3\u6570 (0=\u81ea\u52d5)\nSET geqo_pool_size = 0;       -- \u96c6\u56e3\u30b5\u30a4\u30ba (0=\u81ea\u52d5)\n\n-- \u7279\u5b9a\u306e\u7d50\u5408\u9806\u5e8f\u3092\u5f37\u5236\uff08\u30c7\u30d0\u30c3\u30b0\u7528\uff09\nSET join_collapse_limit = 1;  -- \u660e\u793a\u7684\u306a\u9806\u5e8f\u3092\u7dad\u6301\n"})}),"\n",(0,r.jsx)(e.h3,{id:"64-from\u53e5\u306e\u66f8\u304d\u65b9\u306b\u3088\u308b\u5236\u5fa1",children:"6.4 FROM\u53e5\u306e\u66f8\u304d\u65b9\u306b\u3088\u308b\u5236\u5fa1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u901a\u5e38: \u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u81ea\u7531\u306b\u9806\u5e8f\u3092\u6c7a\u5b9a\nSELECT * FROM a, b, c WHERE a.id = b.a_id AND b.id = c.b_id;\n\n-- CROSS JOIN LATERAL: \u5de6\u304b\u3089\u53f3\u3078\u306e\u9806\u5e8f\u3092\u5f37\u5236\nSELECT * FROM a\nCROSS JOIN LATERAL (SELECT * FROM b WHERE b.a_id = a.id) b\nCROSS JOIN LATERAL (SELECT * FROM c WHERE c.b_id = b.id) c;\n\n-- \u660e\u793a\u7684\u306a\u62ec\u5f27\u3067\u9806\u5e8f\u3092\u30d2\u30f3\u30c8\nSELECT * FROM a JOIN (b JOIN c ON b.id = c.b_id) ON a.id = b.a_id;\n-- join_collapse_limit = 1 \u306e\u5834\u5408\u3001\u3053\u306e\u9806\u5e8f\u304c\u7dad\u6301\u3055\u308c\u308b\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"7-\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9",children:"7. \u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9"}),"\n",(0,r.jsx)(e.h3,{id:"71-explain\u306e\u7a2e\u985e",children:"7.1 EXPLAIN\u306e\u7a2e\u985e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u57fa\u672c\u7684\u306a\u5b9f\u884c\u8a08\u753b\nEXPLAIN SELECT ...;\n\n-- \u5b9f\u969b\u306e\u5b9f\u884c\u6642\u9593\u3082\u8868\u793a\nEXPLAIN ANALYZE SELECT ...;\n\n-- \u30d0\u30c3\u30d5\u30a1\u60c5\u5831\u3082\u8868\u793a\nEXPLAIN (ANALYZE, BUFFERS) SELECT ...;\n\n-- \u8a73\u7d30\u60c5\u5831\nEXPLAIN (ANALYZE, BUFFERS, VERBOSE) SELECT ...;\n\n-- JSON\u5f62\u5f0f\u3067\u51fa\u529b\nEXPLAIN (ANALYZE, FORMAT JSON) SELECT ...;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"72-\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9\u306e\u57fa\u672c",children:"7.2 \u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9\u306e\u57fa\u672c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u5b9f\u884c\u8a08\u753b\u306e\u8aad\u307f\u65b9                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  EXPLAIN ANALYZE \u306e\u51fa\u529b\u4f8b:                                   \u2502\n\u2502                                                              \u2502\n\u2502  HashAggregate  (cost=150..160 rows=100 width=8)            \u2502\n\u2502                  (actual time=5.2..5.5 rows=95 loops=1)     \u2502\n\u2502    Group Key: status                                         \u2502\n\u2502    ->  Hash Join  (cost=25..140 rows=1000 width=4)          \u2502\n\u2502                   (actual time=1.2..4.8 rows=980 loops=1)   \u2502\n\u2502          Hash Cond: (o.user_id = u.id)                      \u2502\n\u2502          ->  Seq Scan on orders o  (cost=0..50 rows=2000)   \u2502\n\u2502                                    (actual time=0.01..1.5)  \u2502\n\u2502          ->  Hash  (cost=20..20 rows=500 width=4)           \u2502\n\u2502                    (actual time=1.0..1.0 rows=490 loops=1)  \u2502\n\u2502                ->  Seq Scan on users u  (cost=0..20)        \u2502\n\u2502                                         (actual time=0.01..0.8)\u2502\n\u2502                      Filter: (status = 'active')             \u2502\n\u2502                      Rows Removed by Filter: 510            \u2502\n\u2502  Planning Time: 0.5 ms                                       \u2502\n\u2502  Execution Time: 6.0 ms                                      \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u8aad\u307f\u65b9\u306e\u30dd\u30a4\u30f3\u30c8\u3011                                        \u2502\n\u2502  1. \u4e0b\u304b\u3089\u4e0a\u306b\u8aad\u3080\uff08\u5b9f\u884c\u9806\u5e8f\uff09                               \u2502\n\u2502  2. \u30a4\u30f3\u30c7\u30f3\u30c8\u304c\u6df1\u3044\u307b\u3069\u5148\u306b\u5b9f\u884c\u3055\u308c\u308b                       \u2502\n\u2502  3. cost \u306e actual \u3068 estimated \u3092\u6bd4\u8f03                       \u2502\n\u2502  4. rows \u306e actual \u3068 estimated \u3092\u6bd4\u8f03                       \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"73-\u3088\u304f\u898b\u308b\u30ce\u30fc\u30c9\u30bf\u30a4\u30d7",children:"7.3 \u3088\u304f\u898b\u308b\u30ce\u30fc\u30c9\u30bf\u30a4\u30d7"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   \u4e3b\u8981\u306a\u30ce\u30fc\u30c9\u30bf\u30a4\u30d7                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30b9\u30ad\u30e3\u30f3\u7cfb\u3011                                              \u2502\n\u2502  Seq Scan          : \u5168\u4ef6\u30b9\u30ad\u30e3\u30f3                            \u2502\n\u2502  Index Scan        : \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4f7f\u7528                        \u2502\n\u2502  Index Only Scan   : \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u307f\u3067\u5b8c\u7d50                  \u2502\n\u2502  Bitmap Heap Scan  : \u30d3\u30c3\u30c8\u30de\u30c3\u30d7\u30b9\u30ad\u30e3\u30f3                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u7d50\u5408\u7cfb\u3011                                                  \u2502\n\u2502  Nested Loop       : \u30cd\u30b9\u30c8\u30eb\u30fc\u30d7\u7d50\u5408                        \u2502\n\u2502  Hash Join         : \u30cf\u30c3\u30b7\u30e5\u7d50\u5408                            \u2502\n\u2502  Merge Join        : \u30de\u30fc\u30b8\u7d50\u5408                              \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u96c6\u7d04\u7cfb\u3011                                                  \u2502\n\u2502  Aggregate         : \u96c6\u7d04 (COUNT, SUM\u7b49)                     \u2502\n\u2502  HashAggregate     : \u30cf\u30c3\u30b7\u30e5\u3092\u4f7f\u3063\u305f GROUP BY               \u2502\n\u2502  GroupAggregate    : \u30bd\u30fc\u30c8\u3092\u4f7f\u3063\u305f GROUP BY                 \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30bd\u30fc\u30c8\u30fb\u5236\u9650\u3011                                            \u2502\n\u2502  Sort              : \u30bd\u30fc\u30c8\u51e6\u7406                              \u2502\n\u2502  Limit             : \u7d50\u679c\u884c\u6570\u306e\u5236\u9650                          \u2502\n\u2502  Unique            : \u91cd\u8907\u6392\u9664                                \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u305d\u306e\u4ed6\u3011                                                  \u2502\n\u2502  Materialize       : \u4e2d\u9593\u7d50\u679c\u306e\u5177\u4f53\u5316                        \u2502\n\u2502  Subquery Scan     : \u30b5\u30d6\u30af\u30a8\u30ea\u306e\u30b9\u30ad\u30e3\u30f3                    \u2502\n\u2502  CTE Scan          : WITH\u53e5\u306e\u30b9\u30ad\u30e3\u30f3                        \u2502\n\u2502  Append            : UNION ALL\u7b49\u306e\u7d50\u5408                       \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"74-\u63a8\u5b9a\u5024\u3068\u5b9f\u969b\u306e\u5024\u306e\u305a\u308c\u3092\u898b\u308b",children:"7.4 \u63a8\u5b9a\u5024\u3068\u5b9f\u969b\u306e\u5024\u306e\u305a\u308c\u3092\u898b\u308b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"EXPLAIN ANALYZE SELECT * FROM users WHERE status = 'active';\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u63a8\u5b9a vs \u5b9f\u969b \u306e\u6bd4\u8f03                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  Seq Scan on users  (cost=0.00..25.00 rows=500 width=100)   \u2502\n\u2502                     (actual time=0.01..2.50 rows=2000 loops=1)\u2502\n\u2502                                 ~~~~       ~~~~              \u2502\n\u2502                               \u63a8\u5b9a500\u884c   \u5b9f\u969b2000\u884c         \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u554f\u984c\u30114\u500d\u306e\u305a\u308c                                           \u2502\n\u2502                                                              \u2502\n\u2502  \u539f\u56e0\u306e\u53ef\u80fd\u6027:                                               \u2502\n\u2502  - \u7d71\u8a08\u60c5\u5831\u304c\u53e4\u3044 \u2192 ANALYZE \u3092\u5b9f\u884c                          \u2502\n\u2502  - \u8907\u96d1\u306a\u6761\u4ef6\u3067\u63a8\u5b9a\u304c\u96e3\u3057\u3044                                  \u2502\n\u2502  - \u76f8\u95a2\u306e\u3042\u308b\u30ab\u30e9\u30e0\u306e\u7d44\u307f\u5408\u308f\u305b                              \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u5f71\u97ff\u3011                                                    \u2502\n\u2502  - \u884c\u6570\u306e\u63a8\u5b9a\u304c\u5927\u304d\u304f\u305a\u308c\u308b\u3068\u3001\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3084             \u2502\n\u2502    \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e\u3092\u8aa4\u308b\u53ef\u80fd\u6027                            \u2502\n\u2502  - \u4e2d\u9593\u7d50\u679c\u306e\u30e1\u30e2\u30ea\u78ba\u4fdd\u304c\u4e0d\u9069\u5207\u306b\u306a\u308b                        \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"75-buffers\u51fa\u529b\u306e\u8aad\u307f\u65b9",children:"7.5 BUFFERS\u51fa\u529b\u306e\u8aad\u307f\u65b9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM users WHERE id = 100;\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Index Scan using users_pkey on users  \n  (cost=0.29..8.30 rows=1 width=100) \n  (actual time=0.05..0.06 rows=1 loops=1)\n  Index Cond: (id = 100)\n  Buffers: shared hit=3          \u2190 \u3053\u3053\u306b\u6ce8\u76ee!\nPlanning Time: 0.1 ms\nExecution Time: 0.1 ms\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   BUFFERS \u306e\u8aad\u307f\u65b9                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  shared hit=3      : \u5171\u6709\u30d0\u30c3\u30d5\u30a1\u5185\u3067\u898b\u3064\u304b\u3063\u305f (\u30ad\u30e3\u30c3\u30b7\u30e5)  \u2502\n\u2502  shared read=5     : \u30c7\u30a3\u30b9\u30af\u304b\u3089\u8aad\u307f\u8fbc\u3093\u3060                  \u2502\n\u2502  shared dirtied=2  : \u30c0\u30fc\u30c6\u30a3\u306b\u3057\u305f\u30da\u30fc\u30b8\u6570                  \u2502\n\u2502  shared written=1  : \u66f8\u304d\u8fbc\u3093\u3060\u30da\u30fc\u30b8\u6570                      \u2502\n\u2502                                                              \u2502\n\u2502  local hit/read/dirtied/written : \u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u7528             \u2502\n\u2502  temp read/written : \u4e00\u6642\u30d5\u30a1\u30a4\u30eb (work_mem\u8d85\u904e\u6642)           \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u6307\u6a19\u3011                                      \u2502\n\u2502  - hit \u304c\u591a\u3044 = \u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u7387\u304c\u826f\u3044                         \u2502\n\u2502  - read \u304c\u591a\u3044 = I/O\u304c\u591a\u3044 (\u9045\u3044\u53ef\u80fd\u6027)                      \u2502\n\u2502  - temp \u304c\u51fa\u73fe = work_mem \u304c\u4e0d\u8db3                             \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"8-\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5236\u5fa1\u3068\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0",children:"8. \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5236\u5fa1\u3068\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0"}),"\n",(0,r.jsx)(e.h3,{id:"81-\u30d7\u30e9\u30f3\u30ca\u30fc\u95a2\u9023\u306e\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf",children:"8.1 \u30d7\u30e9\u30f3\u30ca\u30fc\u95a2\u9023\u306e\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u30b3\u30b9\u30c8\u30e2\u30c7\u30eb\nSET seq_page_cost = 1.0;           -- \u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u8aad\u307f\u53d6\u308a\u30b3\u30b9\u30c8\nSET random_page_cost = 4.0;        -- \u30e9\u30f3\u30c0\u30e0\u8aad\u307f\u53d6\u308a\u30b3\u30b9\u30c8 (SSD\u306a\u3089 1.1-1.5)\nSET cpu_tuple_cost = 0.01;         -- \u884c\u51e6\u7406\u30b3\u30b9\u30c8\nSET cpu_index_tuple_cost = 0.005;  -- \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30a8\u30f3\u30c8\u30ea\u51e6\u7406\u30b3\u30b9\u30c8\nSET cpu_operator_cost = 0.0025;    -- \u6f14\u7b97\u5b50\u5b9f\u884c\u30b3\u30b9\u30c8\n\n-- \u30e1\u30e2\u30ea\u95a2\u9023\nSET effective_cache_size = '4GB';  -- OS\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u542b\u3081\u305f\u898b\u7a4d\u3082\u308a\nSET work_mem = '64MB';             -- \u30bd\u30fc\u30c8\u30fb\u30cf\u30c3\u30b7\u30e5\u7528\u30e1\u30e2\u30ea\n\n-- \u4e26\u5217\u30af\u30a8\u30ea\nSET max_parallel_workers_per_gather = 2;\nSET parallel_tuple_cost = 0.1;\nSET parallel_setup_cost = 1000.0;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"82-\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u5236\u5fa1",children:"8.2 \u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u5236\u5fa1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7279\u5b9a\u306e\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u3092\u7121\u52b9\u5316\uff08\u30c7\u30d0\u30c3\u30b0\u30fb\u691c\u8a3c\u7528\uff09\nSET enable_seqscan = off;       -- Sequential Scan \u3092\u907f\u3051\u308b\nSET enable_indexscan = off;     -- Index Scan \u3092\u907f\u3051\u308b\nSET enable_indexonlyscan = off; -- Index Only Scan \u3092\u907f\u3051\u308b\nSET enable_bitmapscan = off;    -- Bitmap Scan \u3092\u907f\u3051\u308b\n\n-- \u5b9f\u9a13\u4f8b: Sequential Scan \u3092\u907f\u3051\u305f\u5834\u5408\u306e\u8a08\u753b\u3092\u898b\u308b\nSET enable_seqscan = off;\nEXPLAIN SELECT * FROM users WHERE status = 'active';\nSET enable_seqscan = on;  -- \u5143\u306b\u623b\u3059\n"})}),"\n",(0,r.jsx)(e.h3,{id:"83-\u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u5236\u5fa1",children:"8.3 \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u5236\u5fa1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7d50\u5408\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u7121\u52b9\u5316\uff08\u30c7\u30d0\u30c3\u30b0\u30fb\u691c\u8a3c\u7528\uff09\nSET enable_nestloop = off;      -- Nested Loop \u3092\u907f\u3051\u308b\nSET enable_hashjoin = off;      -- Hash Join \u3092\u907f\u3051\u308b\nSET enable_mergejoin = off;     -- Merge Join \u3092\u907f\u3051\u308b\n\n-- \u5b9f\u9a13\u4f8b: Hash Join \u3092\u5f37\u5236\nSET enable_nestloop = off;\nSET enable_mergejoin = off;\nEXPLAIN SELECT * FROM users u JOIN orders o ON u.id = o.user_id;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"84-\u7d71\u8a08\u60c5\u5831\u306e\u8abf\u6574",children:"8.4 \u7d71\u8a08\u60c5\u5831\u306e\u8abf\u6574"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u30ab\u30e9\u30e0\u306e\u7d71\u8a08\u7cbe\u5ea6\u3092\u4e0a\u3052\u308b\nALTER TABLE users ALTER COLUMN status SET STATISTICS 500;\n-- \u30c7\u30d5\u30a9\u30eb\u30c8: 100, \u6700\u5927: 10000\n-- \u5024\u304c\u5927\u304d\u3044\u307b\u3069\u8a73\u7d30\u306a\u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u304c\u4f5c\u6210\u3055\u308c\u308b\n\n-- \u30c6\u30fc\u30d6\u30eb\u5168\u4f53\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u7d71\u8a08\u7cbe\u5ea6\nSET default_statistics_target = 200;\n\n-- \u62e1\u5f35\u7d71\u8a08\uff08\u8907\u6570\u30ab\u30e9\u30e0\u306e\u76f8\u95a2\uff09\nCREATE STATISTICS stats_name ON col1, col2 FROM table_name;\n\n-- \u7d71\u8a08\u60c5\u5831\u3092\u66f4\u65b0\nANALYZE users;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"85-\u5b9f\u8df5\u7684\u306a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u4f8b",children:"8.5 \u5b9f\u8df5\u7684\u306a\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u4f8b1: SSD\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u74b0\u5883\nALTER SYSTEM SET random_page_cost = 1.1;\nSELECT pg_reload_conf();\n\n-- \u4f8b2: \u30e1\u30e2\u30ea\u304c\u6f64\u6ca2\u306a\u74b0\u5883\nALTER SYSTEM SET effective_cache_size = '12GB';\nALTER SYSTEM SET work_mem = '256MB';  -- \u6ce8\u610f: \u63a5\u7d9a\u6570 \xd7 work_mem \u304c\u5fc5\u8981\nSELECT pg_reload_conf();\n\n-- \u4f8b3: \u5927\u898f\u6a21\u306a\u5206\u6790\u30af\u30a8\u30ea\u7528\nSET work_mem = '1GB';  -- \u30bb\u30c3\u30b7\u30e7\u30f3\u5358\u4f4d\u3067\u5909\u66f4\nEXPLAIN ANALYZE SELECT ... (\u8907\u96d1\u306a\u96c6\u8a08\u30af\u30a8\u30ea);\nRESET work_mem;  -- \u5143\u306b\u623b\u3059\n\n-- \u4f8b4: \u4e26\u5217\u30af\u30a8\u30ea\u3092\u6d3b\u7528\nSET max_parallel_workers_per_gather = 4;\nSET parallel_tuple_cost = 0.01;  -- \u4e26\u5217\u51e6\u7406\u306e\u30b3\u30b9\u30c8\u3092\u4e0b\u3052\u308b\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"9-\u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u82e6\u624b\u306a\u30b1\u30fc\u30b9",children:"9. \u30d7\u30e9\u30f3\u30ca\u30fc\u304c\u82e6\u624b\u306a\u30b1\u30fc\u30b9"}),"\n",(0,r.jsx)(e.h3,{id:"91-\u7d71\u8a08\u60c5\u5831\u306e\u554f\u984c",children:"9.1 \u7d71\u8a08\u60c5\u5831\u306e\u554f\u984c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                \u7d71\u8a08\u60c5\u5831\u304c\u4e0d\u6b63\u78ba\u306a\u30b1\u30fc\u30b9                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u2460 \u5927\u91cf\u306e\u30c7\u30fc\u30bf\u5909\u66f4\u5f8c\u306bANALYZE\u3057\u3066\u3044\u306a\u3044                     \u2502\n\u2502     \u2192 \u53e4\u3044\u7d71\u8a08\u60c5\u5831\u3067\u5224\u65ad                                     \u2502\n\u2502     \u89e3\u6c7a: ANALYZE \u30c6\u30fc\u30d6\u30eb\u540d;                                \u2502\n\u2502                                                              \u2502\n\u2502  \u2461 \u30c7\u30fc\u30bf\u306e\u504f\u308a\u304c\u6fc0\u3057\u3044                                      \u2502\n\u2502     \u4f8b: status = 'active' \u304c 99%, \u4ed6\u306f 1%                    \u2502\n\u2502     most_common_vals \u306b\u542b\u307e\u308c\u3066\u3044\u308c\u3070\u6b63\u78ba                    \u2502\n\u2502     \u89e3\u6c7a: SET STATISTICS \u3092\u5897\u3084\u3059                            \u2502\n\u2502                                                              \u2502\n\u2502  \u2462 \u76f8\u95a2\u306e\u3042\u308b\u30ab\u30e9\u30e0                                          \u2502\n\u2502     \u4f8b: city \u3068 zip_code \u306f\u9023\u52d5\u3057\u3066\u3044\u308b                       \u2502\n\u2502     \u89e3\u6c7a: CREATE STATISTICS \u3067\u62e1\u5f35\u7d71\u8a08\u3092\u4f5c\u6210                 \u2502\n\u2502                                                              \u2502\n\u2502  \u2463 \u95a2\u6570\u306e\u7d50\u679c                                                \u2502\n\u2502     \u4f8b: WHERE LOWER(email) = 'alice@example.com'             \u2502\n\u2502     \u2192 \u95a2\u6570\u9069\u7528\u5f8c\u306e\u5206\u5e03\u304c\u308f\u304b\u3089\u306a\u3044                           \u2502\n\u2502     \u89e3\u6c7a: \u5f0f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 + ANALYZE                           \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"92-\u63a8\u5b9a\u304c\u96e3\u3057\u3044\u6761\u4ef6",children:"9.2 \u63a8\u5b9a\u304c\u96e3\u3057\u3044\u6761\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u30d1\u30bf\u30fc\u30f31: \u30d1\u30e9\u30e1\u30fc\u30bf\u5316\u3055\u308c\u305f\u30af\u30a8\u30ea (Prepared Statement)\nPREPARE user_query AS SELECT * FROM users WHERE status = $1;\nEXECUTE user_query('active');\n-- \u2192 $1 \u306e\u5024\u304c\u308f\u304b\u3089\u306a\u3044\u306e\u3067\u300c\u5e73\u5747\u7684\u306a\u300d\u9078\u629e\u6027\u3092\u4f7f\u3046\n--   generic plan \u3068 custom plan \u306e\u5207\u308a\u66ff\u3048\u306b\u6ce8\u610f\n\n-- \u30d1\u30bf\u30fc\u30f32: \u8907\u96d1\u306a\u5f0f\nSELECT * FROM orders \nWHERE total * 1.1 > 1000 AND EXTRACT(YEAR FROM created_at) = 2024;\n-- \u2192 \u5f0f\u306e\u8a55\u4fa1\u5f8c\u306e\u5206\u5e03\u306f\u63a8\u5b9a\u56f0\u96e3\n\n-- \u30d1\u30bf\u30fc\u30f33: \u30b5\u30d6\u30af\u30a8\u30ea\u306e\u7d50\u679c\nSELECT * FROM users \nWHERE id IN (SELECT user_id FROM orders WHERE total > 1000);\n-- \u2192 \u30b5\u30d6\u30af\u30a8\u30ea\u306e\u7d50\u679c\u884c\u6570\u306e\u63a8\u5b9a\u304c\u96e3\u3057\u3044\n\n-- \u30d1\u30bf\u30fc\u30f34: OR\u6761\u4ef6\nSELECT * FROM users \nWHERE email = 'alice@example.com' OR phone = '090-1234-5678';\n-- \u2192 \u5404\u6761\u4ef6\u306e\u9078\u629e\u6027\u3092\u8db3\u3057\u7b97\u3059\u308b\u304c\u3001\u91cd\u8907\u3092\u904e\u5927\u8a55\u4fa1\u3057\u3084\u3059\u3044\n"})}),"\n",(0,r.jsx)(e.h3,{id:"93-\u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u679c\u306e\u898b\u7a4d\u3082\u308a",children:"9.3 \u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u679c\u306e\u898b\u7a4d\u3082\u308a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u30ad\u30e3\u30c3\u30b7\u30e5\u52b9\u679c\u306e\u63a8\u5b9a\u306e\u96e3\u3057\u3055                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u30d7\u30e9\u30f3\u30ca\u30fc\u306f effective_cache_size \u3092\u53c2\u8003\u306b\u3059\u308b\u304c...         \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u5b9f\u969b\u306f\u4e88\u6e2c\u56f0\u96e3\u3011                                          \u2502\n\u2502  - \u3069\u306e\u30da\u30fc\u30b8\u304c\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u8f09\u3063\u3066\u3044\u308b\u304b\u4e0d\u660e                  \u2502\n\u2502  - \u540c\u6642\u306b\u5b9f\u884c\u3055\u308c\u308b\u4ed6\u306e\u30af\u30a8\u30ea\u306e\u5f71\u97ff                          \u2502\n\u2502  - OS\u306e\u30e1\u30e2\u30ea\u5727\u529b                                           \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u7d50\u679c\u3011                                                    \u2502\n\u2502  - \u521d\u56de\u5b9f\u884c\u306f\u9045\u304f\u30012\u56de\u76ee\u4ee5\u964d\u306f\u901f\u3044\uff08\u30a6\u30a9\u30fc\u30e0\u30a2\u30c3\u30d7\u52b9\u679c\uff09     \u2502\n\u2502  - EXPLAIN ANALYZE \u306e\u7d50\u679c\u3068\u5b9f\u904b\u7528\u3067\u5dee\u304c\u51fa\u308b\u3053\u3068\u304c\u3042\u308b        \u2502\n\u2502                                                              \u2502\n\u2502  \u3010\u5bfe\u7b56\u3011                                                    \u2502\n\u2502  - pg_prewarm \u3067\u4e8b\u524d\u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u8f09\u305b\u308b                     \u2502\n\u2502  - effective_cache_size \u3092\u9069\u5207\u306b\u8a2d\u5b9a                        \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"94-\u591a\u30c6\u30fc\u30d6\u30eb\u7d50\u5408\u306e\u8a08\u753b\u6642\u9593",children:"9.4 \u591a\u30c6\u30fc\u30d6\u30eb\u7d50\u5408\u306e\u8a08\u753b\u6642\u9593"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u591a\u6570\u306e\u30c6\u30fc\u30d6\u30eb\u3092\u7d50\u5408\u3059\u308b\u3068\u8a08\u753b\u6642\u9593\u304c\u9577\u304f\u306a\u308b\nSELECT * FROM t1\nJOIN t2 ON t1.id = t2.t1_id\nJOIN t3 ON t2.id = t3.t2_id\n-- ... 15\u30c6\u30fc\u30d6\u30eb\u4ee5\u4e0a\n;\n\n-- \u8a08\u753b\u6642\u9593 >> \u5b9f\u884c\u6642\u9593 \u306b\u306a\u308b\u3053\u3068\u3082\n\n-- \u5bfe\u7b56\nSET geqo_threshold = 8;  -- \u3088\u308a\u65e9\u304fGEQO\u306b\u5207\u308a\u66ff\u3048\nSET from_collapse_limit = 8;  -- \u30b5\u30d6\u30af\u30a8\u30ea\u306e\u5e73\u5766\u5316\u3092\u5236\u9650\nSET join_collapse_limit = 8;  -- \u7d50\u5408\u9806\u5e8f\u306e\u63a2\u7d22\u3092\u5236\u9650\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"10-\u5b9f\u8df5\u7684\u306a\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",children:"10. \u5b9f\u8df5\u7684\u306a\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"}),"\n",(0,r.jsx)(e.h3,{id:"101-\u9045\u3044\u30af\u30a8\u30ea\u306e\u5206\u6790\u624b\u9806",children:"10.1 \u9045\u3044\u30af\u30a8\u30ea\u306e\u5206\u6790\u624b\u9806"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                \u9045\u3044\u30af\u30a8\u30ea\u306e\u5206\u6790\u30d5\u30ed\u30fc                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  Step 1: EXPLAIN ANALYZE \u3067\u5b9f\u884c\u8a08\u753b\u3092\u53d6\u5f97                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 EXPLAIN (ANALYZE, BUFFERS, VERBOSE)                  \u2502   \u2502\n\u2502  \u2502 SELECT ...;                                          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                       \u2502                                      \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  Step 2: \u63a8\u5b9a vs \u5b9f\u969b \u306e\u4e56\u96e2\u3092\u78ba\u8a8d                           \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 rows=100 (\u63a8\u5b9a) vs rows=50000 (\u5b9f\u969b)                 \u2502   \u2502\n\u2502  \u2502 \u2192 \u7d71\u8a08\u60c5\u5831\u304c\u53e4\u3044\u304b\u3001\u63a8\u5b9a\u304c\u96e3\u3057\u3044\u6761\u4ef6                 \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                       \u2502                                      \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  Step 3: \u6700\u3082\u6642\u9593\u304c\u304b\u304b\u3063\u3066\u3044\u308b\u30ce\u30fc\u30c9\u3092\u7279\u5b9a                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 actual time=0.01..5000.00 \u2190 \u3053\u3053\u304c\u9045\u3044               \u2502   \u2502\n\u2502  \u2502 \u2192 \u3053\u306e\u30ce\u30fc\u30c9\u306e\u6539\u5584\u3092\u691c\u8a0e                             \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                       \u2502                                      \u2502\n\u2502                       \u25bc                                      \u2502\n\u2502  Step 4: \u6539\u5584\u7b56\u3092\u5b9f\u884c                                        \u2502\n\u2502  - ANALYZE \u3067statistics\u66f4\u65b0                                  \u2502\n\u2502  - \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u8ffd\u52a0/\u5909\u66f4                                   \u2502\n\u2502  - \u30af\u30a8\u30ea\u306e\u66f8\u304d\u63db\u3048                                          \u2502\n\u2502  - \u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0                                  \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"102-\u3088\u304f\u3042\u308b\u554f\u984c\u3068\u89e3\u6c7a\u7b56",children:"10.2 \u3088\u304f\u3042\u308b\u554f\u984c\u3068\u89e3\u6c7a\u7b56"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u554f\u984c1: \u4e0d\u9069\u5207\u306a\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u75c7\u72b6: \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u3042\u308b\u306e\u306b Seq Scan \u304c\u9078\u3070\u308c\u308b            \u2502\n\u2502                                                              \u2502\n\u2502  \u539f\u56e0\u3068\u5bfe\u7b56:                                                 \u2502\n\u2502  1. \u9078\u629e\u6027\u304c\u4f4e\u3044 \u2192 \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3088\u308a Seq Scan \u304c\u52b9\u7387\u7684        \u2502\n\u2502     \u2192 \u610f\u56f3\u901a\u308a\u306a\u3089OK                                        \u2502\n\u2502                                                              \u2502\n\u2502  2. \u7d71\u8a08\u60c5\u5831\u304c\u53e4\u3044                                           \u2502\n\u2502     \u2192 ANALYZE \u30c6\u30fc\u30d6\u30eb\u540d;                                   \u2502\n\u2502                                                              \u2502\n\u2502  3. \u30c7\u30fc\u30bf\u578b\u306e\u4e0d\u4e00\u81f4                                         \u2502\n\u2502     WHERE int_column = '100' (\u6587\u5b57\u5217)                        \u2502\n\u2502     \u2192 \u6697\u9ed9\u306e\u578b\u5909\u63db\u3067\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u4f7f\u3048\u306a\u3044                   \u2502\n\u2502     \u2192 WHERE int_column = 100 (\u6570\u5024)                         \u2502\n\u2502                                                              \u2502\n\u2502  4. \u95a2\u6570\u9069\u7528                                                 \u2502\n\u2502     WHERE UPPER(name) = 'ALICE'                              \u2502\n\u2502     \u2192 \u5f0f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210                                   \u2502\n\u2502     CREATE INDEX idx ON users (UPPER(name));                 \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u554f\u984c2: \u4e0d\u9069\u5207\u306a\u7d50\u5408\u9806\u5e8f                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u75c7\u72b6: \u4e2d\u9593\u7d50\u679c\u304c\u5de8\u5927\u306b\u306a\u308a\u3001\u30e1\u30e2\u30ea\u4e0d\u8db3\u3084\u30b9\u30ef\u30c3\u30d7            \u2502\n\u2502                                                              \u2502\n\u2502  \u78ba\u8a8d\u65b9\u6cd5:                                                   \u2502\n\u2502  EXPLAIN \u3067\u5404\u7d50\u5408\u30b9\u30c6\u30c3\u30d7\u306e rows \u3092\u78ba\u8a8d                      \u2502\n\u2502  \u2192 \u9014\u4e2d\u3067\u884c\u6570\u304c\u7206\u767a\u3057\u3066\u3044\u306a\u3044\u304b                              \u2502\n\u2502                                                              \u2502\n\u2502  \u5bfe\u7b56:                                                       \u2502\n\u2502  1. \u7d71\u8a08\u60c5\u5831\u306e\u66f4\u65b0 (ANALYZE)                                 \u2502\n\u2502  2. \u7d50\u5408\u6761\u4ef6\u306e\u8ffd\u52a0\uff08\u30d5\u30a3\u30eb\u30bf\u3092\u65e9\u3081\u308b\uff09                       \u2502\n\u2502  3. \u30b5\u30d6\u30af\u30a8\u30ea\u3084 CTE \u3067\u9806\u5e8f\u3092\u5236\u5fa1                            \u2502\n\u2502  4. join_collapse_limit \u3092\u8abf\u6574                              \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u554f\u984c3: \u30bd\u30fc\u30c8\u3084\u30cf\u30c3\u30b7\u30e5\u3067\u306e\u30c7\u30a3\u30b9\u30af\u4f7f\u7528          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u75c7\u72b6: BUFFERS \u306b temp read/written \u304c\u51fa\u73fe                   \u2502\n\u2502                                                              \u2502\n\u2502  \u539f\u56e0: work_mem \u3092\u8d85\u3048\u305f\u305f\u3081\u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528               \u2502\n\u2502                                                              \u2502\n\u2502  \u5bfe\u7b56:                                                       \u2502\n\u2502  1. work_mem \u3092\u5897\u3084\u3059                                        \u2502\n\u2502     SET work_mem = '256MB';                                  \u2502\n\u2502                                                              \u2502\n\u2502  2. \u30af\u30a8\u30ea\u3092\u5206\u5272\u3057\u3066\u4e2d\u9593\u7d50\u679c\u3092\u6e1b\u3089\u3059                         \u2502\n\u2502                                                              \u2502\n\u2502  3. \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u6d3b\u7528\u3057\u3066\u30bd\u30fc\u30c8\u3092\u56de\u907f                       \u2502\n\u2502     ORDER BY \u306b\u5408\u308f\u305b\u305f\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210                    \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"103-\u5b9f\u8df5\u7684\u306a-explain-\u5206\u6790\u4f8b",children:"10.3 \u5b9f\u8df5\u7684\u306a EXPLAIN \u5206\u6790\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u554f\u984c\u306e\u3042\u308b\u30af\u30a8\u30ea\nEXPLAIN (ANALYZE, BUFFERS) \nSELECT u.name, COUNT(o.id) as order_count\nFROM users u\nLEFT JOIN orders o ON u.id = o.user_id\nWHERE u.created_at > '2024-01-01'\nGROUP BY u.id, u.name\nORDER BY order_count DESC\nLIMIT 10;\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Limit  (cost=5000..5000 rows=10 width=40) \n       (actual time=2500..2500 rows=10 loops=1)\n  Buffers: shared hit=100 read=5000, temp read=500 written=500\n                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~\n                                      \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u4f7f\u7528\uff01\n  ->  Sort  (cost=4900..5000 rows=50000 width=40) \n            (actual time=2400..2400 rows=10 loops=1)\n        Sort Key: (count(o.id)) DESC\n        Sort Method: external merge  Disk: 4000kB\n                     ~~~~~~~~~~~~~~  ~~~~~~~~~~~\n                     \u30c7\u30a3\u30b9\u30af\u30bd\u30fc\u30c8\uff01\u30e1\u30e2\u30ea\u4e0d\u8db3\n        ->  HashAggregate  (cost=3000..4000 rows=50000 width=40)\n                           (actual time=1800..2200 rows=50000 loops=1)\n              ->  Hash Left Join  (cost=1000..2500 rows=100000 width=36)\n                                  (actual time=500..1500 rows=100000 loops=1)\n                    ->  Seq Scan on users u  (cost=0..500 rows=50000)\n                                             (actual time=0..200 rows=50000)\n                          Filter: (created_at > '2024-01-01')\n                    ->  Hash  (cost=800..800 rows=100000)\n                              (actual time=400..400 rows=100000 loops=1)\n                          ->  Seq Scan on orders o\nPlanning Time: 1.0 ms\nExecution Time: 2550 ms\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     \u5206\u6790\u7d50\u679c                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u554f\u984c\u70b9:                                                     \u2502\n\u2502  1. \u30c7\u30a3\u30b9\u30af\u30bd\u30fc\u30c8\u304c\u767a\u751f (Sort Method: external merge)       \u2502\n\u2502  2. 50000\u884c\u3092\u96c6\u7d04\u3057\u305f\u5f8c\u306b\u30bd\u30fc\u30c8 \u2192 \u975e\u52b9\u7387                     \u2502\n\u2502  3. users.created_at \u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u306a\u3044\u53ef\u80fd\u6027              \u2502\n\u2502                                                              \u2502\n\u2502  \u6539\u5584\u7b56:                                                     \u2502\n\u2502  1. work_mem \u3092\u5897\u3084\u3059                                        \u2502\n\u2502     SET work_mem = '128MB';                                  \u2502\n\u2502                                                              \u2502\n\u2502  2. \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u4f5c\u6210                                       \u2502\n\u2502     CREATE INDEX idx_users_created_at ON users(created_at);  \u2502\n\u2502                                                              \u2502\n\u2502  3. LIMIT \u3092\u6d3b\u7528\u3057\u305f\u66f8\u304d\u63db\u3048\uff08\u30c8\u30c3\u30d7N\u306e\u6700\u9069\u5316\uff09               \u2502\n\u2502     - \u96c6\u7d04\u524d\u306b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3092\u5f37\u5316                           \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u307e\u3068\u3081",children:"\u307e\u3068\u3081"}),"\n",(0,r.jsx)(e.p,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u3092\u7406\u89e3\u3059\u308b\u3053\u3068\u3067\u3001\u4ee5\u4e0b\u306e\u3053\u3068\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u30b9\u30ad\u30eb"}),(0,r.jsx)(e.th,{children:"\u6d3b\u7528\u5834\u9762"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5b9f\u884c\u8a08\u753b\u306e\u8aad\u89e3"}),(0,r.jsx)(e.td,{children:"\u30af\u30a8\u30ea\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u7279\u5b9a"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u7d71\u8a08\u60c5\u5831\u306e\u7ba1\u7406"}),(0,r.jsx)(e.td,{children:"\u6b63\u78ba\u306a\u30b3\u30b9\u30c8\u63a8\u5b9a\u306e\u7dad\u6301"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u8a2d\u8a08"}),(0,r.jsx)(e.td,{children:"\u9069\u5207\u306a\u30b9\u30ad\u30e3\u30f3\u65b9\u5f0f\u306e\u9078\u629e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0"}),(0,r.jsx)(e.td,{children:"\u74b0\u5883\u306b\u5408\u308f\u305b\u305f\u6700\u9069\u5316"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u30af\u30a8\u30ea\u66f8\u304d\u63db\u3048"}),(0,r.jsx)(e.td,{children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u82e6\u624b\u30b1\u30fc\u30b9\u306e\u56de\u907f"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u53c2\u8003\u30ea\u30f3\u30af",children:"\u53c2\u8003\u30ea\u30f3\u30af"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/sql-explain.html",children:"PostgreSQL EXPLAIN \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/planner-stats.html",children:"\u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u4f7f\u7528\u3059\u308b\u7d71\u8a08\u60c5\u5831"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/runtime-config-query.html",children:"\u30af\u30a8\u30ea\u8a08\u753b"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.interdb.jp/pg/pgsql03.html",children:"The Internals of PostgreSQL - Query Processing"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>d,x:()=>a});var i=s(96540);const r={},l=i.createContext(r);function d(n){const e=i.useContext(l);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);