"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[16273],{36945:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content_11_learning/os-fundamentals/file-descriptors","title":"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf","description":"\u6240\u8981\u6642\u9593: 25\u5206","source":"@site/docs/content_11_learning/21-os-fundamentals/file-descriptors.md","sourceDirName":"content_11_learning/21-os-fundamentals","slug":"/content_11_learning/os-fundamentals/file-descriptors","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/file-descriptors","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/21-os-fundamentals/file-descriptors.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u30e1\u30e2\u30ea\u7ba1\u7406","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/memory-management"},"next":{"title":"I/O \u30e2\u30c7\u30eb","permalink":"/idp-server/docs/content_11_learning/os-fundamentals/io-models"}}');var r=l(74848),s=l(28453);const a={},d="\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf",c={},o=[{value:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",id:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",level:2},{value:"1. \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3068\u306f",id:"1-\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3068\u306f",level:2},{value:"1.1 \u3059\u3079\u3066\u306f\u30d5\u30a1\u30a4\u30eb",id:"11-\u3059\u3079\u3066\u306f\u30d5\u30a1\u30a4\u30eb",level:3},{value:"1.2 FD \u306e\u6b63\u4f53",id:"12-fd-\u306e\u6b63\u4f53",level:3},{value:"1.3 FD \u306e\u64cd\u4f5c",id:"13-fd-\u306e\u64cd\u4f5c",level:3},{value:"2. Linux \u3067\u306e\u78ba\u8a8d",id:"2-linux-\u3067\u306e\u78ba\u8a8d",level:2},{value:"2.1 \u30d7\u30ed\u30bb\u30b9\u306e FD \u4e00\u89a7",id:"21-\u30d7\u30ed\u30bb\u30b9\u306e-fd-\u4e00\u89a7",level:3},{value:"2.2 /proc \u3067\u306e\u78ba\u8a8d",id:"22-proc-\u3067\u306e\u78ba\u8a8d",level:3},{value:"3. \u30bd\u30b1\u30c3\u30c8\u3082 FD",id:"3-\u30bd\u30b1\u30c3\u30c8\u3082-fd",level:2},{value:"3.1 \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a = FD",id:"31-\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a--fd",level:3},{value:"3.2 FD \u3092\u6d88\u8cbb\u3059\u308b\u64cd\u4f5c",id:"32-fd-\u3092\u6d88\u8cbb\u3059\u308b\u64cd\u4f5c",level:3},{value:"4. FD \u306e\u4e0a\u9650",id:"4-fd-\u306e\u4e0a\u9650",level:2},{value:"4.1 \u4e0a\u9650\u306e\u7a2e\u985e",id:"41-\u4e0a\u9650\u306e\u7a2e\u985e",level:3},{value:"4.2 \u4e0a\u9650\u306e\u78ba\u8a8d\u3068\u5909\u66f4",id:"42-\u4e0a\u9650\u306e\u78ba\u8a8d\u3068\u5909\u66f4",level:3},{value:"4.3 &quot;Too many open files&quot; \u30a8\u30e9\u30fc",id:"43-too-many-open-files-\u30a8\u30e9\u30fc",level:3},{value:"4.4 \u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5",id:"44-\u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5",level:3},{value:"5. \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",id:"5-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",level:2},{value:"5.1 \u306a\u305c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u304c\u5fc5\u8981\u304b",id:"51-\u306a\u305c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u304c\u5fc5\u8981\u304b",level:3},{value:"5.2 \u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8a2d\u8a08",id:"52-\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8a2d\u8a08",level:3},{value:"5.3 Java \u3067\u306e\u8a2d\u5b9a\u4f8b\uff08HikariCP\uff09",id:"53-java-\u3067\u306e\u8a2d\u5b9a\u4f8bhikaricp",level:3},{value:"6. FD \u30ea\u30fc\u30af\u306e\u691c\u51fa",id:"6-fd-\u30ea\u30fc\u30af\u306e\u691c\u51fa",level:2},{value:"6.1 \u30ea\u30fc\u30af\u306e\u30d1\u30bf\u30fc\u30f3",id:"61-\u30ea\u30fc\u30af\u306e\u30d1\u30bf\u30fc\u30f3",level:3},{value:"6.2 \u30ea\u30fc\u30af\u306e\u691c\u51fa\u65b9\u6cd5",id:"62-\u30ea\u30fc\u30af\u306e\u691c\u51fa\u65b9\u6cd5",level:3},{value:"7. idp-server \u3067\u306e\u8003\u616e\u4e8b\u9805",id:"7-idp-server-\u3067\u306e\u8003\u616e\u4e8b\u9805",level:2},{value:"7.1 FD \u6d88\u8cbb\u306e\u898b\u7a4d\u3082\u308a",id:"71-fd-\u6d88\u8cbb\u306e\u898b\u7a4d\u3082\u308a",level:3},{value:"7.2 \u30b3\u30f3\u30c6\u30ca\u3067\u306e\u8a2d\u5b9a",id:"72-\u30b3\u30f3\u30c6\u30ca\u3067\u306e\u8a2d\u5b9a",level:3},{value:"8. \u307e\u3068\u3081",id:"8-\u307e\u3068\u3081",level:2},{value:"\u78ba\u8a8d\u554f\u984c",id:"\u78ba\u8a8d\u554f\u984c",level:2},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2}];function t(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf",children:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u6240\u8981\u6642\u9593"}),": 25\u5206"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u524d\u63d0\u77e5\u8b58"}),": ",(0,r.jsx)(e.code,{children:"lsof"}),", ",(0,r.jsx)(e.code,{children:"ulimit"})," \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u3063\u305f\u3053\u3068\u304c\u3042\u308b"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u5b66\u3079\u308b\u3053\u3068"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\uff08FD\uff09\u3068\u306f\u4f55\u304b"}),"\n",(0,r.jsx)(e.li,{children:"\u30bd\u30b1\u30c3\u30c8\u3082 FD"}),"\n",(0,r.jsx)(e.li,{children:"FD \u4e0a\u9650\u3068\u67af\u6e07\u554f\u984c"}),"\n",(0,r.jsx)(e.li,{children:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3068\u306e\u95a2\u4fc2"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f",children:"\u3053\u306e\u7ae0\u3067\u7b54\u3048\u308b\u7591\u554f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u300clsof \u306e\u7d50\u679c\u306e\u610f\u5473\u306f\uff1f\u300d\n\u300cToo many open files \u3063\u3066\u4f55\uff1f\u300d\n\u300c\u306a\u305c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u4f7f\u3046\uff1f\u300d\n\u300c\u30bd\u30b1\u30c3\u30c8\u3063\u3066\u30d5\u30a1\u30a4\u30eb\u306a\u306e\uff1f\u300d\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"1-\u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3068\u306f",children:"1. \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf\u3068\u306f"}),"\n",(0,r.jsx)(e.h3,{id:"11-\u3059\u3079\u3066\u306f\u30d5\u30a1\u30a4\u30eb",children:"1.1 \u3059\u3079\u3066\u306f\u30d5\u30a1\u30a4\u30eb"}),"\n",(0,r.jsx)(e.p,{children:"Unix/Linux \u306e\u8a2d\u8a08\u601d\u60f3:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    "Everything is a file"                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  Unix/Linux \u3067\u306f\u3001\u307b\u3068\u3093\u3069\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u300c\u30d5\u30a1\u30a4\u30eb\u300d\u3068\u3057\u3066\u6271\u3046         \u2502\n\u2502                                                                      \u2502\n\u2502  \u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u6271\u3048\u308b\u3082\u306e:                                           \u2502\n\u2502  \u251c\u2500\u2500 \u901a\u5e38\u306e\u30d5\u30a1\u30a4\u30eb      : /etc/passwd                              \u2502\n\u2502  \u251c\u2500\u2500 \u30c7\u30a3\u30ec\u30af\u30c8\u30ea        : /home/user/                              \u2502\n\u2502  \u251c\u2500\u2500 \u30c7\u30d0\u30a4\u30b9            : /dev/sda, /dev/null                      \u2502\n\u2502  \u251c\u2500\u2500 \u30bd\u30b1\u30c3\u30c8            : TCP/UDP \u63a5\u7d9a                             \u2502\n\u2502  \u251c\u2500\u2500 \u30d1\u30a4\u30d7              : \u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1                           \u2502\n\u2502  \u2514\u2500\u2500 \u64ec\u4f3c\u30d5\u30a1\u30a4\u30eb        : /proc/cpuinfo                            \u2502\n\u2502                                                                      \u2502\n\u2502  \u5229\u70b9:                                                               \u2502\n\u2502  \u251c\u2500\u2500 \u7d71\u4e00\u3055\u308c\u305f\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08open, read, write, close\uff09         \u2502\n\u2502  \u2514\u2500\u2500 \u3069\u3093\u306a\u30ea\u30bd\u30fc\u30b9\u3082\u540c\u3058 API \u3067\u64cd\u4f5c\u3067\u304d\u308b                          \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,r.jsx)(e.h3,{id:"12-fd-\u306e\u6b63\u4f53",children:"1.2 FD \u306e\u6b63\u4f53"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf (FD)                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  FD = \u30aa\u30fc\u30d7\u30f3\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u8b58\u5225\u3059\u308b\u6574\u6570                             \u2502\n\u2502                                                                      \u2502\n\u2502  \u30d7\u30ed\u30bb\u30b9                                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  FD \u30c6\u30fc\u30d6\u30eb\uff08\u30d7\u30ed\u30bb\u30b9\u3054\u3068\uff09                                 \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502    \u2502\n\u2502  \u2502  \u2502 FD   \u2502 \u53c2\u7167\u5148                                  \u2502         \u2502    \u2502\n\u2502  \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524         \u2502    \u2502\n\u2502  \u2502  \u2502  0   \u2502 \u6a19\u6e96\u5165\u529b (stdin)  \u2190 \u30ad\u30fc\u30dc\u30fc\u30c9         \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  1   \u2502 \u6a19\u6e96\u51fa\u529b (stdout) \u2190 \u753b\u9762               \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  2   \u2502 \u6a19\u6e96\u30a8\u30e9\u30fc (stderr) \u2190 \u753b\u9762             \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  3   \u2502 /var/log/app.log \u2190 \u958b\u3044\u305f\u30d5\u30a1\u30a4\u30eb      \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  4   \u2502 TCP socket (192.168.1.1:8080)          \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  5   \u2502 PostgreSQL connection                   \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502 ... \u2502 ...                                     \u2502         \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  FD 0, 1, 2 \u306f\u4e88\u7d04\u6e08\u307f\uff08\u6a19\u6e96\u5165\u51fa\u529b\uff09                                \u2502\n\u2502  \u65b0\u3057\u3044\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\u3068 3 \u304b\u3089\u9806\u756a\u306b\u5272\u308a\u5f53\u3066\u3089\u308c\u308b                   \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"13-fd-\u306e\u64cd\u4f5c",children:"1.3 FD \u306e\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'// C\u8a00\u8a9e\u3067\u306e FD \u64cd\u4f5c\n\n// \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f \u2192 FD \u304c\u8fd4\u3055\u308c\u308b\nint fd = open("/var/log/app.log", O_RDONLY);\n// fd = 3\n\n// FD \u3092\u4f7f\u3063\u3066\u8aad\u307f\u66f8\u304d\nchar buffer[1024];\nread(fd, buffer, sizeof(buffer));   // FD 3 \u304b\u3089\u8aad\u3080\nwrite(fd, "hello", 5);              // FD 3 \u3078\u66f8\u304f\n\n// \u4f7f\u3044\u7d42\u308f\u3063\u305f\u3089\u9589\u3058\u308b\nclose(fd);\n// FD 3 \u304c\u89e3\u653e\u3055\u308c\u308b\n'})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FD \u306e\u30e9\u30a4\u30d5\u30b5\u30a4\u30af\u30eb                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  open()  \u2192  FD \u5272\u308a\u5f53\u3066  \u2192  read/write  \u2192  close()  \u2192  FD \u89e3\u653e    \u2502\n\u2502                                                                      \u2502\n\u2502  \u26a0 close() \u3092\u5fd8\u308c\u308b\u3068 FD \u304c\u30ea\u30fc\u30af\uff08\u67af\u6e07\u306e\u539f\u56e0\uff09                     \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"2-linux-\u3067\u306e\u78ba\u8a8d",children:"2. Linux \u3067\u306e\u78ba\u8a8d"}),"\n",(0,r.jsx)(e.h3,{id:"21-\u30d7\u30ed\u30bb\u30b9\u306e-fd-\u4e00\u89a7",children:"2.1 \u30d7\u30ed\u30bb\u30b9\u306e FD \u4e00\u89a7"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# lsof \u3067\u30d7\u30ed\u30bb\u30b9\u306e FD \u3092\u78ba\u8a8d\n$ lsof -p 12345\nCOMMAND   PID USER   FD   TYPE   DEVICE SIZE/OFF     NODE NAME\njava    12345 app   cwd    DIR    8,1     4096   123456 /opt/app\njava    12345 app   rtd    DIR    8,1     4096        2 /\njava    12345 app   txt    REG    8,1 12345678   234567 /usr/bin/java\njava    12345 app    0u   CHR    1,3      0t0        5 /dev/null\njava    12345 app    1w   REG    8,1   102400   345678 /var/log/app.log\njava    12345 app    2w   REG    8,1    51200   345679 /var/log/app.err\njava    12345 app    3r   REG    8,1     4096   456789 /opt/app/config.yml\njava    12345 app    4u  IPv4 1234567      0t0      TCP 192.168.1.10:8080 (LISTEN)\njava    12345 app    5u  IPv4 1234568      0t0      TCP 192.168.1.10:8080->10.0.0.1:54321 (ESTABLISHED)\njava    12345 app    6u  IPv4 1234569      0t0      TCP 192.168.1.10:5432->db.local:5432 (ESTABLISHED)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    lsof \u306e\u51fa\u529b\u306e\u8aad\u307f\u65b9                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  FD \u5217\u306e\u8aad\u307f\u65b9:                                                      \u2502\n\u2502  \u251c\u2500\u2500 cwd : current working directory                                \u2502\n\u2502  \u251c\u2500\u2500 rtd : root directory                                           \u2502\n\u2502  \u251c\u2500\u2500 txt : program text (\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb)                              \u2502\n\u2502  \u251c\u2500\u2500 0u, 1w, 2w : FD\u756a\u53f7 + \u30e2\u30fc\u30c9                                   \u2502\n\u2502  \u2502   \u2514\u2500\u2500 r=read, w=write, u=read/write                             \u2502\n\u2502  \u2514\u2500\u2500 3r, 4u, 5u, 6u : \u901a\u5e38\u306e FD                                     \u2502\n\u2502                                                                      \u2502\n\u2502  TYPE \u5217:                                                            \u2502\n\u2502  \u251c\u2500\u2500 DIR  : \u30c7\u30a3\u30ec\u30af\u30c8\u30ea                                            \u2502\n\u2502  \u251c\u2500\u2500 REG  : \u901a\u5e38\u306e\u30d5\u30a1\u30a4\u30eb                                          \u2502\n\u2502  \u251c\u2500\u2500 CHR  : \u30ad\u30e3\u30e9\u30af\u30bf\u30c7\u30d0\u30a4\u30b9                                      \u2502\n\u2502  \u251c\u2500\u2500 IPv4 : IPv4 \u30bd\u30b1\u30c3\u30c8                                           \u2502\n\u2502  \u2514\u2500\u2500 unix : Unix \u30c9\u30e1\u30a4\u30f3\u30bd\u30b1\u30c3\u30c8                                   \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"22-proc-\u3067\u306e\u78ba\u8a8d",children:"2.2 /proc \u3067\u306e\u78ba\u8a8d"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# /proc/[pid]/fd \u3067\u3082\u78ba\u8a8d\u53ef\u80fd\n$ ls -la /proc/12345/fd/\ntotal 0\ndr-x------ 2 app app  0 Jan  1 12:00 .\ndr-xr-xr-x 9 app app  0 Jan  1 12:00 ..\nlrwx------ 1 app app 64 Jan  1 12:00 0 -> /dev/null\nl-wx------ 1 app app 64 Jan  1 12:00 1 -> /var/log/app.log\nl-wx------ 1 app app 64 Jan  1 12:00 2 -> /var/log/app.err\nlr-x------ 1 app app 64 Jan  1 12:00 3 -> /opt/app/config.yml\nlrwx------ 1 app app 64 Jan  1 12:00 4 -> socket:[1234567]\nlrwx------ 1 app app 64 Jan  1 12:00 5 -> socket:[1234568]\nlrwx------ 1 app app 64 Jan  1 12:00 6 -> socket:[1234569]\n\n# FD \u306e\u7dcf\u6570\u3092\u78ba\u8a8d\n$ ls /proc/12345/fd | wc -l\n42\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"3-\u30bd\u30b1\u30c3\u30c8\u3082-fd",children:"3. \u30bd\u30b1\u30c3\u30c8\u3082 FD"}),"\n",(0,r.jsx)(e.h3,{id:"31-\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a--fd",children:"3.1 \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a = FD"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30bd\u30b1\u30c3\u30c8\u3068FD                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  TCP/UDP \u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u3082 FD \u3068\u3057\u3066\u7ba1\u7406\u3055\u308c\u308b                    \u2502\n\u2502                                                                      \u2502\n\u2502  \u30b5\u30fc\u30d0\u30fc\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3                                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  FD \u30c6\u30fc\u30d6\u30eb                                                 \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502    \u2502\n\u2502  \u2502  \u2502 FD   \u2502 \u5185\u5bb9                                    \u2502         \u2502    \u2502\n\u2502  \u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524         \u2502    \u2502\n\u2502  \u2502  \u2502  3   \u2502 \u30ea\u30b9\u30cb\u30f3\u30b0\u30bd\u30b1\u30c3\u30c8 (port 8080)         \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  4   \u2502 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8A \u3068\u306e\u63a5\u7d9a                  \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  5   \u2502 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8B \u3068\u306e\u63a5\u7d9a                  \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  6   \u2502 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8C \u3068\u306e\u63a5\u7d9a                  \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  7   \u2502 DB \u30b5\u30fc\u30d0\u30fc\u3078\u306e\u63a5\u7d9a                    \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502  8   \u2502 Redis \u3078\u306e\u63a5\u7d9a                         \u2502         \u2502    \u2502\n\u2502  \u2502  \u2502 ... \u2502 ...                                     \u2502         \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2502  \u2192 \u63a5\u7d9a\u304c\u5897\u3048\u308b\u3068 FD \u3082\u5897\u3048\u308b                               \u2502    \u2502\n\u2502  \u2502  \u2192 \u9ad8\u8ca0\u8377\u6642\u306b FD \u304c\u67af\u6e07\u3059\u308b\u53ef\u80fd\u6027                           \u2502    \u2502\n\u2502  \u2502                                                              \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"32-fd-\u3092\u6d88\u8cbb\u3059\u308b\u64cd\u4f5c",children:"3.2 FD \u3092\u6d88\u8cbb\u3059\u308b\u64cd\u4f5c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FD \u3092\u6d88\u8cbb\u3059\u308b\u64cd\u4f5c                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  1\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u6d88\u8cbb\u3055\u308c\u308b FD \u306e\u4f8b:                                   \u2502\n\u2502                                                                      \u2502\n\u2502  HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u53d7\u4fe1                                                \u2502\n\u2502  \u2514\u2500\u2500 \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a: 1 FD                                         \u2502\n\u2502                                                                      \u2502\n\u2502  DB \u30af\u30a8\u30ea                                                          \u2502\n\u2502  \u2514\u2500\u2500 DB \u63a5\u7d9a: 1 FD\uff08\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3067\u5171\u6709\uff09                      \u2502\n\u2502                                                                      \u2502\n\u2502  \u5916\u90e8 API \u547c\u3073\u51fa\u3057                                                  \u2502\n\u2502  \u2514\u2500\u2500 HTTP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a: 1 FD                                    \u2502\n\u2502                                                                      \u2502\n\u2502  \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f                                                    \u2502\n\u2502  \u2514\u2500\u2500 \u30d5\u30a1\u30a4\u30eb: 1 FD                                                 \u2502\n\u2502                                                                      \u2502\n\u2502  1000 \u540c\u6642\u63a5\u7d9a = \u6700\u4f4e 1000 FD \u304c\u5fc5\u8981                                \u2502\n\u2502  + DB\u63a5\u7d9a + \u30ad\u30e3\u30c3\u30b7\u30e5\u63a5\u7d9a + \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb + ...                     \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"4-fd-\u306e\u4e0a\u9650",children:"4. FD \u306e\u4e0a\u9650"}),"\n",(0,r.jsx)(e.h3,{id:"41-\u4e0a\u9650\u306e\u7a2e\u985e",children:"4.1 \u4e0a\u9650\u306e\u7a2e\u985e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FD \u4e0a\u9650\u306e\u968e\u5c64                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  1. \u30b7\u30b9\u30c6\u30e0\u5168\u4f53\u306e\u4e0a\u9650                                               \u2502\n\u2502     \u2514\u2500\u2500 /proc/sys/fs/file-max                                       \u2502\n\u2502         \u2514\u2500\u2500 \u5168\u30d7\u30ed\u30bb\u30b9\u306e\u5408\u8a08 FD \u6570\u306e\u4e0a\u9650                            \u2502\n\u2502                                                                      \u2502\n\u2502  2. \u30d7\u30ed\u30bb\u30b9\u3054\u3068\u306e\u4e0a\u9650                                               \u2502\n\u2502     \u251c\u2500\u2500 \u30bd\u30d5\u30c8\u30ea\u30df\u30c3\u30c8: ulimit -n \u3067\u8868\u793a                            \u2502\n\u2502     \u2502   \u2514\u2500\u2500 \u30e6\u30fc\u30b6\u30fc\u304c\u5909\u66f4\u53ef\u80fd\u3001\u30c7\u30d5\u30a9\u30eb\u30c8 1024                     \u2502\n\u2502     \u2514\u2500\u2500 \u30cf\u30fc\u30c9\u30ea\u30df\u30c3\u30c8: ulimit -Hn \u3067\u8868\u793a                           \u2502\n\u2502         \u2514\u2500\u2500 root \u306e\u307f\u5909\u66f4\u53ef\u80fd                                       \u2502\n\u2502                                                                      \u2502\n\u2502  \u512a\u5148\u5ea6: \u30bd\u30d5\u30c8\u30ea\u30df\u30c3\u30c8 \u2264 \u30cf\u30fc\u30c9\u30ea\u30df\u30c3\u30c8 \u2264 \u30b7\u30b9\u30c6\u30e0\u4e0a\u9650             \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"42-\u4e0a\u9650\u306e\u78ba\u8a8d\u3068\u5909\u66f4",children:"4.2 \u4e0a\u9650\u306e\u78ba\u8a8d\u3068\u5909\u66f4"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u30b7\u30b9\u30c6\u30e0\u5168\u4f53\u306e\u4e0a\u9650\n$ cat /proc/sys/fs/file-max\n9223372036854775807   # \u7406\u8ad6\u4e0a\u306e\u6700\u5927\u5024\n\n# \u73fe\u5728\u4f7f\u7528\u4e2d\u306e FD \u6570\n$ cat /proc/sys/fs/file-nr\n1234    0    9223372036854775807\n# \u4f7f\u7528\u4e2d   \u89e3\u653e\u6e08\u307f   \u6700\u5927\u5024\n\n# \u30d7\u30ed\u30bb\u30b9\u306e\u30bd\u30d5\u30c8\u30ea\u30df\u30c3\u30c8\n$ ulimit -n\n1024\n\n# \u30d7\u30ed\u30bb\u30b9\u306e\u30cf\u30fc\u30c9\u30ea\u30df\u30c3\u30c8\n$ ulimit -Hn\n65536\n\n# \u30bd\u30d5\u30c8\u30ea\u30df\u30c3\u30c8\u3092\u5909\u66f4\uff08\u73fe\u5728\u306e\u30b7\u30a7\u30eb\u3068\u305d\u306e\u5b50\u30d7\u30ed\u30bb\u30b9\uff09\n$ ulimit -n 65535\n\n# \u6c38\u7d9a\u7684\u306b\u5909\u66f4\n$ cat /etc/security/limits.conf\napp    soft    nofile    65535\napp    hard    nofile    65535\n\n# systemd \u30b5\u30fc\u30d3\u30b9\u306e\u5834\u5408\n# /etc/systemd/system/myapp.service\n[Service]\nLimitNOFILE=65535\n"})}),"\n",(0,r.jsx)(e.h3,{id:"43-too-many-open-files-\u30a8\u30e9\u30fc",children:'4.3 "Too many open files" \u30a8\u30e9\u30fc'}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    FD \u67af\u6e07\u6642\u306e\u30a8\u30e9\u30fc                                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8:                                                   \u2502\n\u2502  java.io.IOException: Too many open files                           \u2502\n\u2502  \u307e\u305f\u306f                                                              \u2502\n\u2502  EMFILE (errno 24)                                                   \u2502\n\u2502                                                                      \u2502\n\u2502  \u767a\u751f\u539f\u56e0:                                                           \u2502\n\u2502  \u251c\u2500\u2500 1. FD \u30ea\u30fc\u30af\uff08close \u3057\u5fd8\u308c\uff09                                  \u2502\n\u2502  \u2502   \u2514\u2500\u2500 \u30d5\u30a1\u30a4\u30eb\u3001\u30bd\u30b1\u30c3\u30c8\u3001DB\u63a5\u7d9a\u3092\u9589\u3058\u3066\u3044\u306a\u3044                  \u2502\n\u2502  \u2502                                                                   \u2502\n\u2502  \u251c\u2500\u2500 2. \u540c\u6642\u63a5\u7d9a\u6570\u304c\u591a\u3059\u304e\u308b                                       \u2502\n\u2502  \u2502   \u2514\u2500\u2500 \u60f3\u5b9a\u4ee5\u4e0a\u306e\u30a2\u30af\u30bb\u30b9                                        \u2502\n\u2502  \u2502                                                                   \u2502\n\u2502  \u2514\u2500\u2500 3. \u4e0a\u9650\u8a2d\u5b9a\u304c\u4f4e\u3059\u304e\u308b                                         \u2502\n\u2502      \u2514\u2500\u2500 \u30c7\u30d5\u30a9\u30eb\u30c8 1024 \u3067\u306f\u4e0d\u8db3                                  \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"44-\u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5",children:"4.4 \u30c7\u30d0\u30c3\u30b0\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u73fe\u5728\u306e FD \u4f7f\u7528\u72b6\u6cc1\u3092\u78ba\u8a8d\n$ ls /proc/$(pgrep java)/fd | wc -l\n1847\n\n# \u3069\u3093\u306a\u7a2e\u985e\u306e FD \u304c\u591a\u3044\u304b\u78ba\u8a8d\n$ lsof -p $(pgrep java) | awk '{print $5}' | sort | uniq -c | sort -rn\n   923 IPv4\n   456 REG\n   234 unix\n   112 CHR\n    89 DIR\n    33 IPv6\n\n# \u5927\u91cf\u306e TCP \u63a5\u7d9a\u304c\u306a\u3044\u304b\u78ba\u8a8d\n$ lsof -p $(pgrep java) | grep TCP | wc -l\n923\n\n# CLOSE_WAIT \u72b6\u614b\u306e\u63a5\u7d9a\uff08\u30ea\u30fc\u30af\u5019\u88dc\uff09\n$ lsof -p $(pgrep java) | grep CLOSE_WAIT\njava    12345 app  123u  IPv4 1234567  TCP 192.168.1.10:8080->10.0.0.1:54321 (CLOSE_WAIT)\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"5-\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb",children:"5. \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb"}),"\n",(0,r.jsx)(e.h3,{id:"51-\u306a\u305c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u304c\u5fc5\u8981\u304b",children:"5.1 \u306a\u305c\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u304c\u5fc5\u8981\u304b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u306a\u3057                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c8\u3054\u3068\u306b DB \u63a5\u7d9a\u3092\u4f5c\u6210\u30fb\u7834\u68c4                                \u2502\n\u2502                                                                      \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c81:  connect() \u2192 query \u2192 close()     1 FD \u4f7f\u7528           \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c82:  connect() \u2192 query \u2192 close()     1 FD \u4f7f\u7528           \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c83:  connect() \u2192 query \u2192 close()     1 FD \u4f7f\u7528           \u2502\n\u2502  ...                                                                 \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c81000: connect() \u2192 query \u2192 close()   1 FD \u4f7f\u7528           \u2502\n\u2502                                                                      \u2502\n\u2502  \u554f\u984c:                                                               \u2502\n\u2502  \u251c\u2500\u2500 \u6bce\u56de\u306e\u63a5\u7d9a\u78ba\u7acb\u306b\u6642\u9593\u304c\u304b\u304b\u308b\uff08TCP handshake + \u8a8d\u8a3c\uff09          \u2502\n\u2502  \u251c\u2500\u2500 \u540c\u6642\u30ea\u30af\u30a8\u30b9\u30c8\u304c\u591a\u3044\u3068 FD \u304c\u4e00\u6642\u7684\u306b\u5927\u91cf\u6d88\u8cbb                   \u2502\n\u2502  \u2514\u2500\u2500 TIME_WAIT \u72b6\u614b\u306e\u63a5\u7d9a\u304c\u6e9c\u307e\u308b                                   \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3042\u308a                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u3042\u3089\u304b\u3058\u3081\u63a5\u7d9a\u3092\u4f5c\u6210\u3057\u3001\u4f7f\u3044\u56de\u3059                                    \u2502\n\u2502                                                                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502               \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb (max=10)                    \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2510 ... \u250c\u2500\u2500\u2500\u2510                  \u2502    \u2502\n\u2502  \u2502  \u2502 1 \u2502 \u2502 2 \u2502 \u2502 3 \u2502 \u2502 4 \u2502 \u2502 5 \u2502     \u250210 \u2502 \u2190 10 FD \u3067\u6e08\u3080   \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2518                  \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                                      \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c81:  \u30d7\u30fc\u30eb\u304b\u3089\u501f\u308a\u308b \u2192 query \u2192 \u30d7\u30fc\u30eb\u306b\u8fd4\u3059              \u2502\n\u2502  \u30ea\u30af\u30a8\u30b9\u30c82:  \u30d7\u30fc\u30eb\u304b\u3089\u501f\u308a\u308b \u2192 query \u2192 \u30d7\u30fc\u30eb\u306b\u8fd4\u3059              \u2502\n\u2502  ...                                                                 \u2502\n\u2502                                                                      \u2502\n\u2502  \u5229\u70b9:                                                               \u2502\n\u2502  \u251c\u2500\u2500 \u63a5\u7d9a\u78ba\u7acb\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u306a\u3057                                  \u2502\n\u2502  \u251c\u2500\u2500 FD \u4f7f\u7528\u91cf\u304c\u4e00\u5b9a\uff08max \u8a2d\u5b9a\u5024\uff09                                 \u2502\n\u2502  \u2514\u2500\u2500 TIME_WAIT \u554f\u984c\u3082\u767a\u751f\u3057\u306a\u3044                                    \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"52-\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8a2d\u8a08",children:"5.2 \u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8a2d\u8a08"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u306e\u8a2d\u8a08                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u5c0f\u3055\u3059\u304e\u308b:                                                         \u2502\n\u2502  \u251c\u2500\u2500 \u63a5\u7d9a\u5f85\u3061\u304c\u767a\u751f\uff08\u30d7\u30fc\u30eb\u67af\u6e07\uff09                                  \u2502\n\u2502  \u2514\u2500\u2500 \u30ea\u30af\u30a8\u30b9\u30c8\u304c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8                                       \u2502\n\u2502                                                                      \u2502\n\u2502  \u5927\u304d\u3059\u304e\u308b:                                                         \u2502\n\u2502  \u251c\u2500\u2500 DB \u30b5\u30fc\u30d0\u30fc\u306e\u63a5\u7d9a\u4e0a\u9650\u306b\u9054\u3059\u308b                                 \u2502\n\u2502  \u251c\u2500\u2500 FD \u3092\u7121\u99c4\u306b\u6d88\u8cbb                                               \u2502\n\u2502  \u2514\u2500\u2500 DB \u306e\u8ca0\u8377\u304c\u4e0a\u304c\u308b                                              \u2502\n\u2502                                                                      \u2502\n\u2502  \u76ee\u5b89:                                                               \u2502\n\u2502  \u251c\u2500\u2500 \u30a2\u30d7\u30ea\u30b5\u30fc\u30d0\u30fc 1 \u53f0: 10\u301c50 \u63a5\u7d9a\u7a0b\u5ea6                          \u2502\n\u2502  \u251c\u2500\u2500 \u8907\u6570\u53f0\u306e\u5834\u5408: \u5408\u8a08\u304c DB \u306e max_connections \u3092\u8d85\u3048\u306a\u3044         \u2502\n\u2502  \u2514\u2500\u2500 Virtual Thread \u4f7f\u7528\u6642: \u5c11\u306a\u3081\u3067\u3082 OK\uff08\u5f85\u6a5f\u52b9\u7387\u304c\u826f\u3044\uff09        \u2502\n\u2502                                                                      \u2502\n\u2502  HikariCP \u306e\u63a8\u5968\u5f0f:                                                  \u2502\n\u2502  connections = ((core_count * 2) + effective_spindle_count)          \u2502\n\u2502  \u2514\u2500\u2500 8\u30b3\u30a2\u30b5\u30fc\u30d0\u30fc\u3001SSD 1\u53f0 = (8 * 2) + 1 = 17 \u63a5\u7d9a\u7a0b\u5ea6            \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"53-java-\u3067\u306e\u8a2d\u5b9a\u4f8bhikaricp",children:"5.3 Java \u3067\u306e\u8a2d\u5b9a\u4f8b\uff08HikariCP\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# application.yml\nspring:\n  datasource:\n    hikari:\n      maximum-pool-size: 20        # \u6700\u5927\u63a5\u7d9a\u6570\n      minimum-idle: 5              # \u6700\u5c0f\u30a2\u30a4\u30c9\u30eb\u63a5\u7d9a\u6570\n      connection-timeout: 30000    # \u63a5\u7d9a\u53d6\u5f97\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8 (ms)\n      idle-timeout: 600000         # \u30a2\u30a4\u30c9\u30eb\u63a5\u7d9a\u306e\u751f\u5b58\u6642\u9593 (ms)\n      max-lifetime: 1800000        # \u63a5\u7d9a\u306e\u6700\u5927\u751f\u5b58\u6642\u9593 (ms)\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"6-fd-\u30ea\u30fc\u30af\u306e\u691c\u51fa",children:"6. FD \u30ea\u30fc\u30af\u306e\u691c\u51fa"}),"\n",(0,r.jsx)(e.h3,{id:"61-\u30ea\u30fc\u30af\u306e\u30d1\u30bf\u30fc\u30f3",children:"6.1 \u30ea\u30fc\u30af\u306e\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// \u274c \u30ea\u30fc\u30af\u3059\u308b\u30b3\u30fc\u30c9\npublic void processFile() {\n    FileInputStream fis = new FileInputStream("data.txt");\n    // ... \u51e6\u7406\u4e2d\u306b\u4f8b\u5916\u304c\u767a\u751f\u3057\u305f\u3089 close \u3055\u308c\u306a\u3044\n    fis.close();  // \u3053\u3053\u306b\u5230\u9054\u3057\u306a\u3044\u53ef\u80fd\u6027\n}\n\n// \u2705 \u30ea\u30fc\u30af\u3057\u306a\u3044\u30b3\u30fc\u30c9\uff08try-with-resources\uff09\npublic void processFile() {\n    try (FileInputStream fis = new FileInputStream("data.txt")) {\n        // ... \u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3082\u81ea\u52d5\u7684\u306b close \u3055\u308c\u308b\n    }\n}\n\n// \u2705 HTTP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u5834\u5408\ntry (CloseableHttpClient client = HttpClients.createDefault()) {\n    try (CloseableHttpResponse response = client.execute(request)) {\n        // \u30ec\u30b9\u30dd\u30f3\u30b9\u3092\u51e6\u7406\n    }\n}  // \u81ea\u52d5\u7684\u306b close\n'})}),"\n",(0,r.jsx)(e.h3,{id:"62-\u30ea\u30fc\u30af\u306e\u691c\u51fa\u65b9\u6cd5",children:"6.2 \u30ea\u30fc\u30af\u306e\u691c\u51fa\u65b9\u6cd5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# FD \u6570\u306e\u63a8\u79fb\u3092\u76e3\u8996\n$ watch -n 5 'ls /proc/$(pgrep java)/fd | wc -l'\n\n# \u5897\u3048\u7d9a\u3051\u3066\u3044\u305f\u3089\u30ea\u30fc\u30af\u306e\u53ef\u80fd\u6027\n\n# \u3069\u306e\u7a2e\u985e\u304c\u5897\u3048\u3066\u3044\u308b\u304b\u78ba\u8a8d\n$ lsof -p $(pgrep java) +D /tmp  # \u7279\u5b9a\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u30d5\u30a1\u30a4\u30eb\n$ lsof -p $(pgrep java) -i TCP   # TCP \u63a5\u7d9a\n$ netstat -anp | grep $(pgrep java) | grep CLOSE_WAIT  # \u9589\u3058\u3089\u308c\u3066\u3044\u306a\u3044\u63a5\u7d9a\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"7-idp-server-\u3067\u306e\u8003\u616e\u4e8b\u9805",children:"7. idp-server \u3067\u306e\u8003\u616e\u4e8b\u9805"}),"\n",(0,r.jsx)(e.h3,{id:"71-fd-\u6d88\u8cbb\u306e\u898b\u7a4d\u3082\u308a",children:"7.1 FD \u6d88\u8cbb\u306e\u898b\u7a4d\u3082\u308a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    idp-server \u306e FD \u4f7f\u7528\u91cf                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  \u56fa\u5b9a:                                                               \u2502\n\u2502  \u251c\u2500\u2500 \u6a19\u6e96\u5165\u51fa\u529b: 3 FD                                              \u2502\n\u2502  \u251c\u2500\u2500 \u30ed\u30b0\u30d5\u30a1\u30a4\u30eb: 2\u301c5 FD                                         \u2502\n\u2502  \u251c\u2500\u2500 DB \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb: 20 FD                                  \u2502\n\u2502  \u251c\u2500\u2500 Redis \u30b3\u30cd\u30af\u30b7\u30e7\u30f3: 10 FD                                     \u2502\n\u2502  \u2514\u2500\u2500 \u305d\u306e\u4ed6: 10 FD                                                  \u2502\n\u2502  \u5c0f\u8a08: \u7d04 50 FD                                                     \u2502\n\u2502                                                                      \u2502\n\u2502  \u5909\u52d5\uff08\u540c\u6642\u63a5\u7d9a\u6570\u306b\u4f9d\u5b58\uff09:                                          \u2502\n\u2502  \u251c\u2500\u2500 HTTP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a: \u540c\u6642\u63a5\u7d9a\u6570 \xd7 1 FD                      \u2502\n\u2502  \u2514\u2500\u2500 \u5916\u90e8 API \u547c\u3073\u51fa\u3057: \u540c\u6642\u6570 \xd7 1 FD                              \u2502\n\u2502                                                                      \u2502\n\u2502  1000 \u540c\u6642\u63a5\u7d9a\u306e\u5834\u5408:                                               \u2502\n\u2502  50 (\u56fa\u5b9a) + 1000 (\u30af\u30e9\u30a4\u30a2\u30f3\u30c8) + \u03b1 = \u7d04 1200 FD                  \u2502\n\u2502                                                                      \u2502\n\u2502  \u2192 ulimit -n 65535 \u7a0b\u5ea6\u306b\u8a2d\u5b9a\u3057\u3066\u304a\u304f\u306e\u304c\u5b89\u5168                       \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.h3,{id:"72-\u30b3\u30f3\u30c6\u30ca\u3067\u306e\u8a2d\u5b9a",children:"7.2 \u30b3\u30f3\u30c6\u30ca\u3067\u306e\u8a2d\u5b9a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.yml\nservices:\n  idp-server:\n    image: idp-server:latest\n    ulimits:\n      nofile:\n        soft: 65535\n        hard: 65535\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# Kubernetes deployment.yaml\napiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: idp-server\n    # Pod \u30ec\u30d9\u30eb\u3067\u306e\u8a2d\u5b9a\u306f initContainers \u304b\u7279\u6a29\u304c\u5fc5\u8981\n    # \u901a\u5e38\u306f\u30ce\u30fc\u30c9\u306e\u8a2d\u5b9a\u3092\u7d99\u627f\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"8-\u307e\u3068\u3081",children:"8. \u307e\u3068\u3081"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u3053\u306e\u7ae0\u3067\u5b66\u3093\u3060\u3053\u3068                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                      \u2502\n\u2502  1. \u30d5\u30a1\u30a4\u30eb\u30c7\u30a3\u30b9\u30af\u30ea\u30d7\u30bf (FD)                                     \u2502\n\u2502     \u251c\u2500\u2500 \u30aa\u30fc\u30d7\u30f3\u3057\u305f\u30ea\u30bd\u30fc\u30b9\u3092\u8b58\u5225\u3059\u308b\u6574\u6570                         \u2502\n\u2502     \u251c\u2500\u2500 0, 1, 2 \u306f\u6a19\u6e96\u5165\u51fa\u529b\u3067\u4e88\u7d04                                 \u2502\n\u2502     \u2514\u2500\u2500 lsof, /proc/[pid]/fd \u3067\u78ba\u8a8d                                \u2502\n\u2502                                                                      \u2502\n\u2502  2. \u30bd\u30b1\u30c3\u30c8\u3082 FD                                                    \u2502\n\u2502     \u251c\u2500\u2500 \u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u3082 FD \u3092\u6d88\u8cbb                               \u2502\n\u2502     \u2514\u2500\u2500 \u540c\u6642\u63a5\u7d9a\u6570 = FD \u4f7f\u7528\u91cf\u306b\u76f4\u7d50                               \u2502\n\u2502                                                                      \u2502\n\u2502  3. FD \u306e\u4e0a\u9650                                                        \u2502\n\u2502     \u251c\u2500\u2500 ulimit -n \u3067\u78ba\u8a8d\uff08\u30c7\u30d5\u30a9\u30eb\u30c8 1024\uff09                        \u2502\n\u2502     \u251c\u2500\u2500 \u30b5\u30fc\u30d0\u30fc\u3067\u306f 65535 \u7a0b\u5ea6\u306b\u8a2d\u5b9a                              \u2502\n\u2502     \u2514\u2500\u2500 Too many open files \u3067\u67af\u6e07\u3092\u691c\u77e5                           \u2502\n\u2502                                                                      \u2502\n\u2502  4. \u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb                                               \u2502\n\u2502     \u251c\u2500\u2500 FD \u3092\u52b9\u7387\u7684\u306b\u4f7f\u3044\u56de\u3059                                      \u2502\n\u2502     \u2514\u2500\u2500 \u63a5\u7d9a\u78ba\u7acb\u30b3\u30b9\u30c8\u3082\u524a\u6e1b                                       \u2502\n\u2502                                                                      \u2502\n\u2502  5. FD \u30ea\u30fc\u30af                                                        \u2502\n\u2502     \u251c\u2500\u2500 close \u5fd8\u308c\u304c\u539f\u56e0                                           \u2502\n\u2502     \u251c\u2500\u2500 try-with-resources \u3067\u9632\u3050                                  \u2502\n\u2502     \u2514\u2500\u2500 lsof \u3067\u5897\u52a0\u50be\u5411\u3092\u76e3\u8996                                      \u2502\n\u2502                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u78ba\u8a8d\u554f\u984c",children:"\u78ba\u8a8d\u554f\u984c"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"FD 0, 1, 2 \u306f\u4f55\u3092\u8868\u3057\u307e\u3059\u304b\uff1f"}),"\n",(0,r.jsx)(e.li,{children:"TCP \u63a5\u7d9a\u3068 FD \u306e\u95a2\u4fc2\u3092\u8aac\u660e\u3057\u3066\u304f\u3060\u3055\u3044"}),"\n",(0,r.jsx)(e.li,{children:'"Too many open files" \u30a8\u30e9\u30fc\u306e\u539f\u56e0\u3068\u5bfe\u7b56\u306f\uff1f'}),"\n",(0,r.jsx)(e.li,{children:"\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u30d7\u30fc\u30eb\u3092\u4f7f\u3046\u5229\u70b9\u306f\uff1f"}),"\n",(0,r.jsx)(e.li,{children:"FD \u30ea\u30fc\u30af\u3092\u691c\u51fa\u3059\u308b\u65b9\u6cd5\u306f\uff1f"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/os-fundamentals/io-models",children:"I/O\u30e2\u30c7\u30eb"})," - FD \u3092\u4f7f\u3063\u305f I/O \u306e\u4ed5\u7d44\u307f"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"/idp-server/docs/content_11_learning/os-fundamentals/signals",children:"\u30b7\u30b0\u30ca\u30eb"})," - \u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1"]}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(t,{...n})}):t(n)}},28453:(n,e,l)=>{l.d(e,{R:()=>a,x:()=>d});var i=l(96540);const r={},s=i.createContext(r);function a(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);