"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[44348],{4352:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>j,frontMatter:()=>t,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"content_11_learning/performance-tuning/measurement-techniques","title":"\u6027\u80fd\u8a08\u6e2c\u306e\u5b9f\u8df5\u30c6\u30af\u30cb\u30c3\u30af","description":"\u6027\u80fd\u6539\u5584\u306e\u7b2c\u4e00\u6b69\u306f\u6b63\u78ba\u306a\u8a08\u6e2c\u3067\u3059\u3002\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u8a08\u6e2c\u3067\u4f7f\u3046\u30c4\u30fc\u30eb\u3068\u300c\u4f55\u3092\u898b\u308b\u304b\u300d\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002","source":"@site/docs/content_11_learning/26-performance-tuning/10-measurement-techniques.md","sourceDirName":"content_11_learning/26-performance-tuning","slug":"/content_11_learning/performance-tuning/measurement-techniques","permalink":"/idp-server/docs/content_11_learning/performance-tuning/measurement-techniques","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/26-performance-tuning/10-measurement-techniques.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"docs","previous":{"title":"\u30ed\u30fc\u30ab\u30eb\u74b0\u5883 vs \u30af\u30e9\u30a6\u30c9\u74b0\u5883 - \u6027\u80fd\u30c6\u30b9\u30c8\u306e\u5b9f\u8df5","permalink":"/idp-server/docs/content_11_learning/performance-tuning/local-vs-cloud"},"next":{"title":"\u8ca0\u8377\u30c6\u30b9\u30c8\u5b9f\u8df5\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3","permalink":"/idp-server/docs/content_11_learning/performance-tuning/load-test-simulation"}}');var d=s(74848),i=s(28453);const t={},l="\u6027\u80fd\u8a08\u6e2c\u306e\u5b9f\u8df5\u30c6\u30af\u30cb\u30c3\u30af",c={},h=[{value:"\u8a08\u6e2c\u306e\u539f\u5247",id:"\u8a08\u6e2c\u306e\u539f\u5247",level:2},{value:"\u63a8\u6e2c\u3059\u308b\u306a\u3001\u8a08\u6e2c\u305b\u3088",id:"\u63a8\u6e2c\u3059\u308b\u306a\u8a08\u6e2c\u305b\u3088",level:3},{value:"\u8a08\u6e2c\u306e3\u539f\u5247",id:"\u8a08\u6e2c\u306e3\u539f\u5247",level:3},{value:"\u8a08\u6e2c\u30c4\u30fc\u30eb\u4e00\u89a7",id:"\u8a08\u6e2c\u30c4\u30fc\u30eb\u4e00\u89a7",level:2},{value:"\u51e6\u7406\u6642\u9593\u306e\u5185\u8a33\u3092\u898b\u308b",id:"\u51e6\u7406\u6642\u9593\u306e\u5185\u8a33\u3092\u898b\u308b",level:2},{value:"StopWatch \u3067\u533a\u9593\u8a08\u6e2c",id:"stopwatch-\u3067\u533a\u9593\u8a08\u6e2c",level:3},{value:"\u5206\u6563\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5168\u4f53\u3092\u4fef\u77b0",id:"\u5206\u6563\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5168\u4f53\u3092\u4fef\u77b0",level:2},{value:"Jaeger / Zipkin \u306e\u898b\u65b9",id:"jaeger--zipkin-\u306e\u898b\u65b9",level:3},{value:"DB\u30af\u30a8\u30ea\u3092\u5206\u6790\u3059\u308b",id:"db\u30af\u30a8\u30ea\u3092\u5206\u6790\u3059\u308b",level:2},{value:"EXPLAIN ANALYZE \u306e\u8aad\u307f\u65b9",id:"explain-analyze-\u306e\u8aad\u307f\u65b9",level:3},{value:"\u63a5\u7d9a\u30d7\u30fc\u30eb\u3092\u76e3\u8996\u3059\u308b",id:"\u63a5\u7d9a\u30d7\u30fc\u30eb\u3092\u76e3\u8996\u3059\u308b",level:2},{value:"HikariCP \u306e\u91cd\u8981\u30e1\u30c8\u30ea\u30af\u30b9",id:"hikaricp-\u306e\u91cd\u8981\u30e1\u30c8\u30ea\u30af\u30b9",level:3},{value:"\u8ca0\u8377\u30c6\u30b9\u30c8\u3067\u9650\u754c\u3092\u77e5\u308b",id:"\u8ca0\u8377\u30c6\u30b9\u30c8\u3067\u9650\u754c\u3092\u77e5\u308b",level:2},{value:"k6 \u306e\u57fa\u672c",id:"k6-\u306e\u57fa\u672c",level:3},{value:"\u8a08\u6e2c\u7d50\u679c\u306e\u8a18\u9332\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",id:"\u8a08\u6e2c\u7d50\u679c\u306e\u8a18\u9332\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",level:2},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2}];function x(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"\u6027\u80fd\u8a08\u6e2c\u306e\u5b9f\u8df5\u30c6\u30af\u30cb\u30c3\u30af",children:"\u6027\u80fd\u8a08\u6e2c\u306e\u5b9f\u8df5\u30c6\u30af\u30cb\u30c3\u30af"})}),"\n",(0,d.jsx)(n.p,{children:"\u6027\u80fd\u6539\u5584\u306e\u7b2c\u4e00\u6b69\u306f\u6b63\u78ba\u306a\u8a08\u6e2c\u3067\u3059\u3002\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u8a08\u6e2c\u3067\u4f7f\u3046\u30c4\u30fc\u30eb\u3068\u300c\u4f55\u3092\u898b\u308b\u304b\u300d\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002"}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u8a08\u6e2c\u306e\u539f\u5247",children:"\u8a08\u6e2c\u306e\u539f\u5247"}),"\n",(0,d.jsx)(n.h3,{id:"\u63a8\u6e2c\u3059\u308b\u306a\u8a08\u6e2c\u305b\u3088",children:"\u63a8\u6e2c\u3059\u308b\u306a\u3001\u8a08\u6e2c\u305b\u3088"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u274c \u60aa\u3044\u4f8b:\n\u300cDB\u304c\u9045\u305d\u3046\u3060\u304b\u3089\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u8ffd\u52a0\u3057\u3088\u3046\u300d\n\u2192 \u5b9f\u969b\u306e\u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u306f\u5916\u90e8API\u3060\u3063\u305f\n\n\u2713 \u826f\u3044\u4f8b:\n1. \u51e6\u7406\u6642\u9593\u306e\u5185\u8a33\u3092\u8a08\u6e2c\n2. DB: 20ms, API: 150ms, App: 30ms \u3068\u5224\u660e\n3. API\u547c\u3073\u51fa\u3057\u306e\u6700\u9069\u5316\u306b\u6ce8\u529b\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u8a08\u6e2c\u306e3\u539f\u5247",children:"\u8a08\u6e2c\u306e3\u539f\u5247"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u539f\u5247"}),(0,d.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u518d\u73fe\u6027"}),(0,d.jsx)(n.td,{children:"\u540c\u3058\u6761\u4ef6\u3067\u8907\u6570\u56de\u8a08\u6e2c\u3057\u3001\u3070\u3089\u3064\u304d\u3092\u78ba\u8a8d"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5206\u96e2\u6027"}),(0,d.jsx)(n.td,{children:"\u8a08\u6e2c\u5bfe\u8c61\u4ee5\u5916\u306e\u8981\u56e0\u3092\u6392\u9664"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u672c\u756a\u8fd1\u4f3c"}),(0,d.jsx)(n.td,{children:"\u53ef\u80fd\u306a\u9650\u308a\u672c\u756a\u306b\u8fd1\u3044\u74b0\u5883\u3067\u8a08\u6e2c"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u8a08\u6e2c\u30c4\u30fc\u30eb\u4e00\u89a7",children:"\u8a08\u6e2c\u30c4\u30fc\u30eb\u4e00\u89a7"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u76ee\u7684"}),(0,d.jsx)(n.th,{children:"\u30c4\u30fc\u30eb"}),(0,d.jsx)(n.th,{children:"\u7528\u9014"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u51e6\u7406\u6642\u9593\u306e\u5185\u8a33"}),(0,d.jsx)(n.td,{children:"StopWatch"}),(0,d.jsx)(n.td,{children:"\u30b3\u30fc\u30c9\u5185\u306e\u533a\u9593\u8a08\u6e2c"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30ea\u30af\u30a8\u30b9\u30c8\u5168\u4f53\u306e\u6d41\u308c"}),(0,d.jsx)(n.td,{children:"Jaeger / Zipkin"}),(0,d.jsx)(n.td,{children:"\u5206\u6563\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"DB\u30af\u30a8\u30ea\u5206\u6790"}),(0,d.jsx)(n.td,{children:"EXPLAIN ANALYZE"}),(0,d.jsx)(n.td,{children:"\u5b9f\u884c\u8a08\u753b\u3068\u5b9f\u884c\u6642\u9593"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u63a5\u7d9a\u30d7\u30fc\u30eb\u72b6\u6cc1"}),(0,d.jsx)(n.td,{children:"HikariCP Metrics"}),(0,d.jsx)(n.td,{children:"\u63a5\u7d9a\u6570\u30fb\u5f85\u3061\u72b6\u6cc1"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8ca0\u8377\u30c6\u30b9\u30c8"}),(0,d.jsx)(n.td,{children:"k6"}),(0,d.jsx)(n.td,{children:"\u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u30fb\u30ec\u30a4\u30c6\u30f3\u30b7\u8a08\u6e2c"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u51e6\u7406\u6642\u9593\u306e\u5185\u8a33\u3092\u898b\u308b",children:"\u51e6\u7406\u6642\u9593\u306e\u5185\u8a33\u3092\u898b\u308b"}),"\n",(0,d.jsx)(n.h3,{id:"stopwatch-\u3067\u533a\u9593\u8a08\u6e2c",children:"StopWatch \u3067\u533a\u9593\u8a08\u6e2c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'StopWatch sw = new StopWatch();\n\nsw.start("DB\u53d6\u5f97");\nUser user = userRepository.findById(userId);\nsw.stop();\n\nsw.start("\u5916\u90e8API");\nProfile profile = externalApi.getProfile(userId);\nsw.stop();\n\nlog.info(sw.prettyPrint());\n'})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u51fa\u529b\u4f8b:"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"StopWatch '': running time = 156 ms\n---------------------------------------------\nms      %     Task name\n---------------------------------------------\n023    15%    DB\u53d6\u5f97\n120    77%    \u5916\u90e8API       \u2190 \u30dc\u30c8\u30eb\u30cd\u30c3\u30af\u767a\u898b\n013    08%    \u30ec\u30b9\u30dd\u30f3\u30b9\u751f\u6210\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u898b\u308b\u3079\u304d\u30dd\u30a4\u30f3\u30c8:"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u3069\u306e\u533a\u9593\u304c\u652f\u914d\u7684\u304b\uff08%\u304c\u5927\u304d\u3044\u3068\u3053\u308d\uff09"}),"\n",(0,d.jsx)(n.li,{children:"\u4e88\u60f3\u3068\u5b9f\u969b\u306e\u4e56\u96e2"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u5206\u6563\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5168\u4f53\u3092\u4fef\u77b0",children:"\u5206\u6563\u30c8\u30ec\u30fc\u30b7\u30f3\u30b0\u3067\u5168\u4f53\u3092\u4fef\u77b0"}),"\n",(0,d.jsx)(n.h3,{id:"jaeger--zipkin-\u306e\u898b\u65b9",children:"Jaeger / Zipkin \u306e\u898b\u65b9"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"POST /oauth/token (total: 250ms)\n\u251c\u2500\u2500 ClientAuthentication (12ms)\n\u2502   \u2514\u2500\u2500 DB: select client (10ms)\n\u251c\u2500\u2500 TokenGeneration (8ms)\n\u251c\u2500\u2500 TokenPersistence (210ms)      \u2190 \u3053\u3053\u304c\u9045\u3044\n\u2502   \u251c\u2500\u2500 DB: insert token (30ms)\n\u2502   \u2514\u2500\u2500 External: audit log (180ms)  \u2190 \u539f\u56e0\u7279\u5b9a\n\u2514\u2500\u2500 Response (20ms)\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u898b\u308b\u3079\u304d\u30dd\u30a4\u30f3\u30c8:"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u78ba\u8a8d\u5185\u5bb9"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5168\u4f53\u6642\u9593"}),(0,d.jsx)(n.td,{children:"SLO\u3092\u6e80\u305f\u3057\u3066\u3044\u308b\u304b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5404\u30b9\u30d1\u30f3\u306e\u6642\u9593"}),(0,d.jsx)(n.td,{children:"\u3069\u3053\u304c\u652f\u914d\u7684\u304b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30b9\u30d1\u30f3\u306e\u6570"}),(0,d.jsx)(n.td,{children:"\u547c\u3073\u51fa\u3057\u56de\u6570\u304c\u59a5\u5f53\u304b\uff08N+1\u306e\u5146\u5019\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30a8\u30e9\u30fc"}),(0,d.jsx)(n.td,{children:"\u4f8b\u5916\u304c\u767a\u751f\u3057\u3066\u3044\u306a\u3044\u304b"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"db\u30af\u30a8\u30ea\u3092\u5206\u6790\u3059\u308b",children:"DB\u30af\u30a8\u30ea\u3092\u5206\u6790\u3059\u308b"}),"\n",(0,d.jsx)(n.h3,{id:"explain-analyze-\u306e\u8aad\u307f\u65b9",children:"EXPLAIN ANALYZE \u306e\u8aad\u307f\u65b9"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM users WHERE tenant_id = 'xxx';\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u51fa\u529b\u4f8b:"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Seq Scan on users  (cost=0.00..1234.00 rows=100 width=200) (actual time=0.020..45.000 rows=100 loops=1)\n  Filter: (tenant_id = 'xxx'::text)\n  Rows Removed by Filter: 9900\n  Buffers: shared hit=500 read=100    \u2190 \u30c7\u30a3\u30b9\u30afI/O\u767a\u751f\nPlanning Time: 0.1 ms\nExecution Time: 45.5 ms\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u5371\u967a\u4fe1\u53f7:"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u5371\u967a\u30b5\u30a4\u30f3"}),(0,d.jsx)(n.th,{children:"\u5bfe\u7b56"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Seq Scan"}),(0,d.jsx)(n.td,{children:"\u5927\u304d\u306a\u30c6\u30fc\u30d6\u30eb\u3067\u767a\u751f"}),(0,d.jsx)(n.td,{children:"\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u8ffd\u52a0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Rows Removed"}),(0,d.jsx)(n.td,{children:"\u5927\u91cf\u306b\u9664\u5916"}),(0,d.jsx)(n.td,{children:"\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 or \u30af\u30a8\u30ea\u898b\u76f4\u3057"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"shared read"}),(0,d.jsx)(n.td,{children:"\u30c7\u30a3\u30b9\u30afI/O\u591a\u767a"}),(0,d.jsx)(n.td,{children:"\u30e1\u30e2\u30ea\u5897\u52a0 or \u30af\u30a8\u30ea\u6700\u9069\u5316"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"loops > 1"}),(0,d.jsx)(n.td,{children:"N+1\u306e\u53ef\u80fd\u6027"}),(0,d.jsx)(n.td,{children:"JOIN or \u30d0\u30c3\u30c1\u53d6\u5f97"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u63a5\u7d9a\u30d7\u30fc\u30eb\u3092\u76e3\u8996\u3059\u308b",children:"\u63a5\u7d9a\u30d7\u30fc\u30eb\u3092\u76e3\u8996\u3059\u308b"}),"\n",(0,d.jsx)(n.h3,{id:"hikaricp-\u306e\u91cd\u8981\u30e1\u30c8\u30ea\u30af\u30b9",children:"HikariCP \u306e\u91cd\u8981\u30e1\u30c8\u30ea\u30af\u30b9"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30e1\u30c8\u30ea\u30af\u30b9"}),(0,d.jsx)(n.th,{children:"\u610f\u5473"}),(0,d.jsx)(n.th,{children:"\u5371\u967a\u30b5\u30a4\u30f3"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"active"}),(0,d.jsx)(n.td,{children:"\u4f7f\u7528\u4e2d\u306e\u63a5\u7d9a\u6570"}),(0,d.jsx)(n.td,{children:"max \u306b\u8fd1\u3044"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"idle"}),(0,d.jsx)(n.td,{children:"\u5f85\u6a5f\u4e2d\u306e\u63a5\u7d9a\u6570"}),(0,d.jsx)(n.td,{children:"0 \u304c\u7d9a\u304f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"pending"}),(0,d.jsx)(n.td,{children:"\u63a5\u7d9a\u5f85\u3061\u30b9\u30ec\u30c3\u30c9\u6570"}),(0,d.jsx)(n.td,{children:"0 \u3088\u308a\u5927\u304d\u3044"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"total"}),(0,d.jsx)(n.td,{children:"\u7dcf\u63a5\u7d9a\u6570"}),(0,d.jsx)(n.td,{children:"max \u306b\u5f35\u308a\u4ed8\u304d"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u53d6\u5f97\u65b9\u6cd5\uff08Actuator\uff09:"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"curl localhost:8080/actuator/metrics/hikaricp.connections.active\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u5224\u65ad\u57fa\u6e96:"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"active = 20, max = 20, pending = 5\n\u2192 \u63a5\u7d9a\u30d7\u30fc\u30eb\u67af\u6e07\u3002\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u5897\u52a0 or \u30af\u30a8\u30ea\u9ad8\u901f\u5316\u304c\u5fc5\u8981\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u8ca0\u8377\u30c6\u30b9\u30c8\u3067\u9650\u754c\u3092\u77e5\u308b",children:"\u8ca0\u8377\u30c6\u30b9\u30c8\u3067\u9650\u754c\u3092\u77e5\u308b"}),"\n",(0,d.jsx)(n.h3,{id:"k6-\u306e\u57fa\u672c",children:"k6 \u306e\u57fa\u672c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"k6 run --vus 100 --duration 2m test.js\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"VUs (Virtual Users) \u3068\u306f:"})}),"\n",(0,d.jsx)(n.p,{children:"VUs\u306f\u300c\u540c\u6642\u306b\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u308b\u4eee\u60f3\u30e6\u30fc\u30b6\u30fc\u6570\u300d\u3067\u3059\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"VUs=1:   \u30e6\u30fc\u30b6\u30fc1\u4eba\u304c\u9023\u7d9a\u3057\u3066\u30ea\u30af\u30a8\u30b9\u30c8\n         [\u30ea\u30af\u30a8\u30b9\u30c8]\u2192[\u5f85\u6a5f]\u2192[\u30ea\u30af\u30a8\u30b9\u30c8]\u2192[\u5f85\u6a5f]\u2192...\n\nVUs=100: 100\u4eba\u304c\u540c\u6642\u4e26\u884c\u3067\u30ea\u30af\u30a8\u30b9\u30c8\n         \u30e6\u30fc\u30b6\u30fc1: [\u30ea\u30af\u30a8\u30b9\u30c8]\u2192[\u5f85\u6a5f]\u2192[\u30ea\u30af\u30a8\u30b9\u30c8]\u2192...\n         \u30e6\u30fc\u30b6\u30fc2: [\u30ea\u30af\u30a8\u30b9\u30c8]\u2192[\u5f85\u6a5f]\u2192[\u30ea\u30af\u30a8\u30b9\u30c8]\u2192...\n         ...\n         \u30e6\u30fc\u30b6\u30fc100: [\u30ea\u30af\u30a8\u30b9\u30c8]\u2192[\u5f85\u6a5f]\u2192[\u30ea\u30af\u30a8\u30b9\u30c8]\u2192...\n"})}),"\n",(0,d.jsx)(n.p,{children:"VUs\u3092\u5897\u3084\u3059\u3068\u540c\u6642\u63a5\u7d9a\u6570\u304c\u5897\u3048\u3001\u30b5\u30fc\u30d0\u30fc\u3078\u306e\u8ca0\u8377\u304c\u4e0a\u304c\u308a\u307e\u3059\u3002VUs\u3068\u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\uff08req/s\uff09\u306f\u6bd4\u4f8b\u3057\u307e\u3059\u304c\u3001\u30b5\u30fc\u30d0\u30fc\u304c\u98fd\u548c\u3059\u308b\u3068\u982d\u6253\u3061\u306b\u306a\u308a\u307e\u3059\u3002"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u7d50\u679c\u306e\u898b\u65b9:"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"http_req_duration...: avg=45ms min=12ms med=38ms max=890ms p(95)=120ms p(99)=340ms\nhttp_reqs...........: 10000  83/s\n"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30e1\u30c8\u30ea\u30af\u30b9"}),(0,d.jsx)(n.th,{children:"\u898b\u308b\u3079\u304d\u70b9"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"p(99)"}),(0,d.jsx)(n.td,{children:"SLO\u5224\u5b9a\u306b\u4f7f\u7528\u3002\u5e73\u5747\u3088\u308a\u91cd\u8981"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"max"}),(0,d.jsx)(n.td,{children:"\u6700\u60aa\u30b1\u30fc\u30b9\u3002\u8a31\u5bb9\u7bc4\u56f2\u304b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"http_reqs/s"}),(0,d.jsx)(n.td,{children:"\u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u3002\u76ee\u6a19\u3092\u6e80\u305f\u3059\u304b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"med vs p99"}),(0,d.jsx)(n.td,{children:"\u5dee\u304c\u5927\u304d\u3044\u2192\u5916\u308c\u5024\u591a\u3044\u3001\u4e0d\u5b89\u5b9a"})]})]})]}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsxs)(n.p,{children:["\u8a73\u7d30\u306a\u30b7\u30ca\u30ea\u30aa\u306f ",(0,d.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/performance-tuning/load-test-simulation",children:"\u8ca0\u8377\u30c6\u30b9\u30c8\u5b9f\u8df5\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3"})," \u3092\u53c2\u7167"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u8a08\u6e2c\u7d50\u679c\u306e\u8a18\u9332\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",children:"\u8a08\u6e2c\u7d50\u679c\u306e\u8a18\u9332\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-markdown",children:"## \u8a08\u6e2c: [\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u540d] (\u65e5\u4ed8)\n\n### \u74b0\u5883\n- \u5bfe\u8c61: \u30b9\u30c6\u30fc\u30b8\u30f3\u30b0 (EKS m5.large x2, Aurora db.r5.large)\n\n### \u7d50\u679c\n| \u6307\u6a19 | \u5024 |\n|------|-----|\n| P50 | 45ms |\n| P95 | 120ms |\n| P99 | 340ms |\n| \u30b9\u30eb\u30fc\u30d7\u30c3\u30c8 | 200 req/s |\n| \u30a8\u30e9\u30fc\u7387 | 0.1% |\n\n### \u30dc\u30c8\u30eb\u30cd\u30c3\u30af\n- HikariCP\u63a5\u7d9a\u30d7\u30fc\u30eb\u67af\u6e07 (active=20/20, pending=5)\n\n### \u6b21\u306e\u30a2\u30af\u30b7\u30e7\u30f3\n- [ ] \u63a5\u7d9a\u30d7\u30fc\u30eb\u30b5\u30a4\u30ba\u309240\u306b\u5897\u52a0\n- [ ] \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u6642\u9593\u306e\u77ed\u7e2e\u3092\u691c\u8a0e\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/performance-tuning/load-test-simulation",children:"\u8ca0\u8377\u30c6\u30b9\u30c8\u5b9f\u8df5\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3"})," - \u30b7\u30ca\u30ea\u30aa\u5f62\u5f0f\u3067\u4e00\u9023\u306e\u6d41\u308c\u3092\u4f53\u9a13"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/idp-server/docs/content_11_learning/performance-tuning/local-vs-cloud",children:"\u30ed\u30fc\u30ab\u30eb\u74b0\u5883 vs \u30af\u30e9\u30a6\u30c9\u74b0\u5883"})," - \u74b0\u5883\u5dee\u3092\u8003\u616e\u3057\u305f\u8a08\u6e2c"]}),"\n"]})]})}function j(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(x,{...e})}):x(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(96540);const d={},i=r.createContext(d);function t(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);