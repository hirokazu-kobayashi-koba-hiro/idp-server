"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[93220],{45043:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"content_10_ai_developer/ai-43-federation-oidc","title":"idp-server-federation-oidc","description":"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981","source":"@site/docs/content_10_ai_developer/ai-43-federation-oidc.md","sourceDirName":"content_10_ai_developer","slug":"/content_10_ai_developer/ai-43-federation-oidc","permalink":"/idp-server/docs/content_10_ai_developer/ai-43-federation-oidc","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_10_ai_developer/ai-43-federation-oidc.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"idp-server-webauthn4j-adapter - WebAuthn4j\u30e9\u30a4\u30d6\u30e9\u30ea\u7d71\u5408","permalink":"/idp-server/docs/content_10_ai_developer/ai-42-webauthn"},"next":{"title":"\u901a\u77e5\u30fb\u30a4\u30d9\u30f3\u30c8\u5c64 - \u901a\u77e5\u914d\u4fe1\u3068\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30a4\u30d9\u30f3\u30c8","permalink":"/idp-server/docs/content_10_ai_developer/ai-50-notification-security-event"}}');var i=r(74848),o=r(28453);const a={},c="idp-server-federation-oidc",d={},s=[{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",level:2},{value:"\u8cac\u52d9",id:"\u8cac\u52d9",level:3},{value:"\u4e3b\u8981\u6a5f\u80fd",id:"\u4e3b\u8981\u6a5f\u80fd",level:3},{value:"FederationInteractor \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",id:"federationinteractor-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",level:2},{value:"FederationInteractorFactory \u30d1\u30bf\u30fc\u30f3",id:"federationinteractorfactory-\u30d1\u30bf\u30fc\u30f3",level:2},{value:"Plugin\u767b\u9332",id:"plugin\u767b\u9332",level:2},{value:"\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc",id:"\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc",level:2},{value:"SsoProvider - SSO \u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u8a2d\u5b9a",id:"ssoprovider---sso-\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u8a2d\u5b9a",level:2},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"idp-server-federation-oidc",children:"idp-server-federation-oidc"})}),"\n",(0,i.jsx)(n.h2,{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981",children:"\u30e2\u30b8\u30e5\u30fc\u30eb\u6982\u8981"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,i.jsx)(n.code,{children:"libs/idp-server-federation-oidc/"}),"\n",(0,i.jsx)(n.strong,{children:"\u78ba\u8a8d\u65e5"}),": 2025-10-12"]}),"\n",(0,i.jsx)(n.h3,{id:"\u8cac\u52d9",children:"\u8cac\u52d9"}),"\n",(0,i.jsx)(n.p,{children:"\u5916\u90e8IdP\u3068\u306eOIDC\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\uff08SSO\u9023\u643a\uff09\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u4ed5\u69d8"}),": ",(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html",children:"OpenID Connect Core 1.0"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u4e3b\u8981\u6a5f\u80fd",children:"\u4e3b\u8981\u6a5f\u80fd"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Discovery"}),": ",(0,i.jsx)(n.code,{children:".well-known/openid-configuration"}),"\u81ea\u52d5\u53d6\u5f97"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Authorization Code Flow"}),": \u5916\u90e8IdP\u3078\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Token Exchange"}),": \u8a8d\u53ef\u30b3\u30fc\u30c9 \u2192 \u30c8\u30fc\u30af\u30f3\u4ea4\u63db"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"UserInfo Fetch"}),": \u5916\u90e8IdP\u304b\u3089\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Account Linking"}),": \u5916\u90e8ID\u3068\u30ed\u30fc\u30ab\u30ebID\u306e\u7d10\u4ed8\u3051"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"federationinteractor-\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9",children:"FederationInteractor \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(54509).A+"#L26",children:"FederationInteractor.java:26"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"/**\n * \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\n * \u78ba\u8a8d\u65b9\u6cd5: \u5b9f\u30d5\u30a1\u30a4\u30eb\u306e26-40\u884c\u76ee\n */\npublic interface FederationInteractor {\n\n  // \u2705 \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u5916\u90e8IdP\u3078\u306e\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\uff09\n  FederationRequestResponse request(\n      Tenant tenant,\n      AuthorizationRequestIdentifier authorizationRequestIdentifier,\n      FederationType federationType,\n      SsoProvider ssoProvider);\n\n  // \u2705 \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\uff08\u5916\u90e8IdP\u304b\u3089\u306e\u623b\u308a\uff09\n  FederationInteractionResult callback(\n      Tenant tenant,\n      FederationType federationType,\n      SsoProvider ssoProvider,\n      FederationCallbackRequest callbackRequest,\n      UserQueryRepository userQueryRepository);\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"federationinteractorfactory-\u30d1\u30bf\u30fc\u30f3",children:"FederationInteractorFactory \u30d1\u30bf\u30fc\u30f3"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,i.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(74098).A+"#L27",children:"OidcFederationInteractorFactory.java:27"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"/**\n * \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc\u306eFactory\n * \u78ba\u8a8d\u65b9\u6cd5: \u5b9f\u30d5\u30a1\u30a4\u30eb\u306e27-52\u884c\u76ee\n */\npublic interface FederationInteractorFactory {\n  FederationType type();\n  FederationInteractor create(FederationDependencyContainer container);\n}\n\n// OIDC\u5b9f\u88c5\npublic class OidcFederationInteractorFactory implements FederationInteractorFactory {\n\n  @Override\n  public FederationType type() {\n    return StandardSupportedFederationType.OIDC.toFederationType();\n  }\n\n  @Override\n  public FederationInteractor create(FederationDependencyContainer container) {\n    OidcSsoExecutors oidcSsoExecutors = container.resolve(OidcSsoExecutors.class);\n    FederationConfigurationQueryRepository configurationQueryRepository =\n        container.resolve(FederationConfigurationQueryRepository.class);\n    // ... \u305d\u306e\u4ed6\u306e\u4f9d\u5b58\u95a2\u4fc2\u3092\u89e3\u6c7a\n\n    return new OidcFederationInteractor(...);\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"plugin\u767b\u9332",children:"Plugin\u767b\u9332"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# META-INF/services/org.idp.server.core.openid.federation.plugin.FederationInteractorFactory\norg.idp.server.federation.sso.oidc.OidcFederationInteractorFactory\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc",children:"\u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30d5\u30ed\u30fc"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// 1. PluginLoader\u3067Factory\u30ed\u30fc\u30c9\nList<FederationInteractorFactory> factories =\n    PluginLoader.loadFromInternalModule(FederationInteractorFactory.class);\n\n// 2. FederationType\u5225\u306bInteractor\u751f\u6210\nFederationDependencyContainer container = new FederationDependencyContainer(...);\nMap<FederationType, FederationInteractor> interactors = new HashMap<>();\n\nfor (FederationInteractorFactory factory : factories) {\n  FederationInteractor interactor = factory.create(container);\n  interactors.put(factory.type(), interactor);\n}\n\n// 3. \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u30ea\u30af\u30a8\u30b9\u30c8\uff08\u5916\u90e8IdP\u3078\u30ea\u30c0\u30a4\u30ec\u30af\u30c8\uff09\nFederationType federationType = FederationType.of("oidc");\nFederationInteractor interactor = interactors.get(federationType);\n\nFederationRequestResponse requestResponse = interactor.request(\n    tenant,\n    authorizationRequestIdentifier,\n    federationType,\n    ssoProvider);\n\n// \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u8fd4\u5374\u3059\u308b\u30ea\u30c0\u30a4\u30ec\u30af\u30c8URL\nString redirectUrl = requestResponse.redirectUrl();\n// \u2192 https://accounts.google.com/o/oauth2/v2/auth?client_id=...&redirect_uri=...\n\n// 4. \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u51e6\u7406\uff08\u5916\u90e8IdP\u304b\u3089\u623b\u3063\u3066\u304d\u305f\u6642\uff09\nFederationCallbackRequest callbackRequest = new FederationCallbackRequest(code, state);\n\nFederationInteractionResult result = interactor.callback(\n    tenant,\n    federationType,\n    ssoProvider,\n    callbackRequest,\n    userQueryRepository);\n\n// 5. \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u53d6\u5f97\nUser externalUser = result.user();\n\n// 6. \u30a2\u30ab\u30a6\u30f3\u30c8\u30ea\u30f3\u30ad\u30f3\u30b0\uff08core.md\u306eIdentity\u30c9\u30e1\u30a4\u30f3\u3067\u8aac\u660e\uff09\n'})}),"\n",(0,i.jsx)(n.h2,{id:"ssoprovider---sso-\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u8a2d\u5b9a",children:"SsoProvider - SSO \u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u8a2d\u5b9a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'public class SsoProvider {\n  String providerId;              // "google", "azure_ad", "facebook"\u7b49\n  String providerName;            // "Google", "Azure AD", "Facebook"\n  String issuer;                  // "https://accounts.google.com"\n  String authorizationEndpoint;   // Discovery or \u624b\u52d5\u8a2d\u5b9a\n  String tokenEndpoint;\n  String userinfoEndpoint;\n  String jwksUri;\n  String clientId;\n  String clientSecret;\n  String redirectUri;\n  List<String> scopes;            // ["openid", "profile", "email"]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-40-authentication-federation",children:"\u8a8d\u8a3c\u30fb\u9023\u643a\u5c64\u7d71\u5408\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})," - \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u542b\u3080\u5168\u8a8d\u8a3c\u30e2\u30b8\u30e5\u30fc\u30eb"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./authentication-federation.md#idp-server-authentication-interactors",children:"idp-server-authentication-interactors"})," - \u8a8d\u8a3c\u30a4\u30f3\u30bf\u30e9\u30af\u30bf\u30fc"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/idp-server/docs/content_10_ai_developer/ai-11-core",children:"idp-server-core"})," - OAuth/OIDC\u30b3\u30a2\u30a8\u30f3\u30b8\u30f3\uff08Identity\u30c9\u30e1\u30a4\u30f3\uff09"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"libs/idp-server-federation-oidc/"}),"\u914d\u4e0b\u306e\u5b9f\u88c5\u30b3\u30fc\u30c9"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"libs/idp-server-core/src/main/java/org/idp/server/core/openid/federation/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html",children:"OpenID Connect Core 1.0"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-12"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},54509:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/files/FederationInteractor-5a9c998f2f1e4194444c7c8f8e7b2e2d.java"},74098:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/files/OidcFederationInteractorFactory-0975d8b15f18ad5f211ef51d13aba3c8.java"},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>c});var t=r(96540);const i={},o=t.createContext(i);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);