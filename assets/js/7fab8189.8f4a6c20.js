"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6985],{66759:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>x,frontMatter:()=>t,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"content_06_developer-guide/reference/database-partitioning-guide","title":"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9","description":"1. \u6982\u8981","source":"@site/docs/content_06_developer-guide/08-reference/database-partitioning-guide.md","sourceDirName":"content_06_developer-guide/08-reference","slug":"/content_06_developer-guide/reference/database-partitioning-guide","permalink":"/idp-server/docs/content_06_developer-guide/reference/database-partitioning-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_06_developer-guide/08-reference/database-partitioning-guide.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"05. \u30b3\u30fc\u30c9\u30ec\u30d3\u30e5\u30fc\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8","permalink":"/idp-server/docs/content_06_developer-guide/reference/code-review-checklist"},"next":{"title":"\ud83e\udded \u8a2d\u8a08\u539f\u5247\u3068\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3","permalink":"/idp-server/docs/content_06_developer-guide/reference/design-principles-guidelines"}}');var d=s(74848),i=s(28453);const t={},l="\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9",c={},h=[{value:"1. \u6982\u8981",id:"1-\u6982\u8981",level:2},{value:"1.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3068\u306f",id:"11-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3068\u306f",level:3},{value:"1.2 \u4e3b\u306a\u30e1\u30ea\u30c3\u30c8",id:"12-\u4e3b\u306a\u30e1\u30ea\u30c3\u30c8",level:3},{value:"2. DELETE vs DROP TABLE",id:"2-delete-vs-drop-table",level:2},{value:"2.1 DELETE\u6587\u306e\u52d5\u4f5c\uff08\u901a\u5e38\u30c6\u30fc\u30d6\u30eb\uff09",id:"21-delete\u6587\u306e\u52d5\u4f5c\u901a\u5e38\u30c6\u30fc\u30d6\u30eb",level:3},{value:"2.2 DROP TABLE\u306e\u52d5\u4f5c\uff08\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\uff09",id:"22-drop-table\u306e\u52d5\u4f5c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb",level:3},{value:"2.3 \u51e6\u7406\u6642\u9593\u6bd4\u8f03\uff085\u5104\u884c/\u65e5\u306e\u5834\u5408\uff09",id:"23-\u51e6\u7406\u6642\u9593\u6bd4\u8f035\u5104\u884c\u65e5\u306e\u5834\u5408",level:3},{value:"3. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0",id:"3-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0",level:2},{value:"3.1 \u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304f\u5834\u5408",id:"31-\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304f\u5834\u5408",level:3},{value:"3.2 \u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304b\u306a\u3044\u5834\u5408",id:"32-\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304b\u306a\u3044\u5834\u5408",level:3},{value:"4. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u5236\u7d04",id:"4-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u5236\u7d04",level:2},{value:"4.1 PRIMARY KEY \u306e\u5236\u7d04",id:"41-primary-key-\u306e\u5236\u7d04",level:3},{value:"4.2 \u5916\u90e8\u30ad\u30fc\uff08FOREIGN KEY\uff09\u306e\u5236\u7d04",id:"42-\u5916\u90e8\u30ad\u30fcforeign-key\u306e\u5236\u7d04",level:3},{value:"4.3 \u904b\u7528\u4e0a\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9",id:"43-\u904b\u7528\u4e0a\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9",level:3},{value:"5. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",id:"5-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",level:2},{value:"5.1 \u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"51-\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:3},{value:"5.2 idp-server\u306e\u30c6\u30fc\u30d6\u30eb\u9069\u6027",id:"52-idp-server\u306e\u30c6\u30fc\u30d6\u30eb\u9069\u6027",level:3},{value:"6. oauth_token \u304c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306b\u4e0d\u5411\u304d\u306a\u7406\u7531",id:"6-oauth_token-\u304c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306b\u4e0d\u5411\u304d\u306a\u7406\u7531",level:2},{value:"6.1 \u30a4\u30f3\u30c8\u30ed\u30b9\u30da\u30af\u30b7\u30e7\u30f3\u306e\u691c\u7d22\u30d1\u30bf\u30fc\u30f3",id:"61-\u30a4\u30f3\u30c8\u30ed\u30b9\u30da\u30af\u30b7\u30e7\u30f3\u306e\u691c\u7d22\u30d1\u30bf\u30fc\u30f3",level:3},{value:"6.2 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3057\u305f\u5834\u5408\u306e\u554f\u984c",id:"62-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3057\u305f\u5834\u5408\u306e\u554f\u984c",level:3},{value:"6.3 oauth_token \u306e\u904b\u7528\u6226\u7565",id:"63-oauth_token-\u306e\u904b\u7528\u6226\u7565",level:3},{value:"7. \u5b9f\u88c5\u4f8b",id:"7-\u5b9f\u88c5\u4f8b",level:2},{value:"7.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\uff08V0_9_1\uff09",id:"71-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210v0_9_1",level:3},{value:"7.2 \u81ea\u52d5\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u7ba1\u7406\uff08V0_9_2\uff09",id:"72-\u81ea\u52d5\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u7ba1\u7406v0_9_2",level:3},{value:"8. \u904b\u7528\u76e3\u8996",id:"8-\u904b\u7528\u76e3\u8996",level:2},{value:"8.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4e00\u89a7\u78ba\u8a8d",id:"81-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4e00\u89a7\u78ba\u8a8d",level:3},{value:"8.2 pg_cron\u30b8\u30e7\u30d6\u72b6\u614b\u78ba\u8a8d",id:"82-pg_cron\u30b8\u30e7\u30d6\u72b6\u614b\u78ba\u8a8d",level:3},{value:"8.3 DEFAULT\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u76e3\u8996",id:"83-default\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u76e3\u8996",level:3},{value:"9. \u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u8003\u5bdf",id:"9-\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u8003\u5bdf",level:2},{value:"9.1 \u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7",id:"91-\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7",level:3},{value:"9.2 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",id:"92-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",level:3},{value:"security_event \u3068\u306e\u6bd4\u8f03",id:"security_event-\u3068\u306e\u6bd4\u8f03",level:4},{value:"\u30c7\u30fc\u30bf\u91cf\u8a66\u7b97\uff08100\u4e07\u30e6\u30fc\u30b6\u30fc\u60f3\u5b9a\uff09",id:"\u30c7\u30fc\u30bf\u91cf\u8a66\u7b97100\u4e07\u30e6\u30fc\u30b6\u30fc\u60f3\u5b9a",level:4},{value:"\u7d50\u8ad6: \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306f\u4e0d\u8981",id:"\u7d50\u8ad6-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306f\u4e0d\u8981",level:4},{value:"9.3 \u63a8\u5968\u904b\u7528\u65b9\u6cd5",id:"93-\u63a8\u5968\u904b\u7528\u65b9\u6cd5",level:3},{value:"9.4 \u5224\u65ad\u306e\u30dd\u30a4\u30f3\u30c8",id:"94-\u5224\u65ad\u306e\u30dd\u30a4\u30f3\u30c8",level:3},{value:"10. \u95a2\u9023Issue\u30fbPR",id:"10-\u95a2\u9023issuepr",level:2},{value:"11. pg_partman / pg_cron \u521d\u671f\u5316",id:"11-pg_partman--pg_cron-\u521d\u671f\u5316",level:2},{value:"11.1 Docker\u74b0\u5883\u3067\u306e\u521d\u671f\u5316",id:"111-docker\u74b0\u5883\u3067\u306e\u521d\u671f\u5316",level:3},{value:"11.2 \u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",id:"112-\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",level:3},{value:"Permission denied \u30a8\u30e9\u30fc",id:"permission-denied-\u30a8\u30e9\u30fc",level:4},{value:"partman \u30b9\u30ad\u30fc\u30de\u304c\u5b58\u5728\u3057\u306a\u3044",id:"partman-\u30b9\u30ad\u30fc\u30de\u304c\u5b58\u5728\u3057\u306a\u3044",level:4},{value:"RAISE NOTICE \u30a8\u30e9\u30fc",id:"raise-notice-\u30a8\u30e9\u30fc",level:4},{value:"11.3 Docker Compose \u8a2d\u5b9a",id:"113-docker-compose-\u8a2d\u5b9a",level:3},{value:"12. \u904b\u7528\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",id:"12-\u904b\u7528\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",level:2},{value:"12.1 \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a",id:"121-\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a",level:3},{value:"12.2 cron\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u5909\u66f4",id:"122-cron\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u5909\u66f4",level:3},{value:"12.3 \u4fdd\u6301\u671f\u9593\u306e\u5909\u66f4",id:"123-\u4fdd\u6301\u671f\u9593\u306e\u5909\u66f4",level:3},{value:"12.4 partman.part_config \u306e\u4e3b\u8981\u8a2d\u5b9a\u9805\u76ee",id:"124-partmanpart_config-\u306e\u4e3b\u8981\u8a2d\u5b9a\u9805\u76ee",level:3},{value:"12.5 \u624b\u52d5\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u5b9f\u884c",id:"125-\u624b\u52d5\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u5b9f\u884c",level:3},{value:"12.6 DDL vs \u904b\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5207\u308a\u5206\u3051",id:"126-ddl-vs-\u904b\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5207\u308a\u5206\u3051",level:3},{value:"13. \u53c2\u8003\u8cc7\u6599",id:"13-\u53c2\u8003\u8cc7\u6599",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9",children:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9"})}),"\n",(0,d.jsx)(n.h2,{id:"1-\u6982\u8981",children:"1. \u6982\u8981"}),"\n",(0,d.jsx)(n.p,{children:"\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001idp-server\u306b\u304a\u3051\u308bPostgreSQL\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u8a2d\u8a08\u6307\u91dd\u3068\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3\u3092\u8aac\u660e\u3057\u307e\u3059\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"11-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3068\u306f",children:"1.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3068\u306f"}),"\n",(0,d.jsx)(n.p,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306f\u30011\u3064\u306e\u8ad6\u7406\u30c6\u30fc\u30d6\u30eb\u3092\u8907\u6570\u306e\u7269\u7406\u30c6\u30fc\u30d6\u30eb\uff08\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\uff09\u306b\u5206\u5272\u3059\u308b\u6280\u8853\u3067\u3059\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    security_event (\u89aa\u30c6\u30fc\u30d6\u30eb = \u8ad6\u7406\u7684\u306a\u7a93\u53e3)               \u2502\n\u2502                                                                             \u2502\n\u2502  \u300c\u79c1\u306f\u305f\u3060\u306e\u5165\u308a\u53e3\u3067\u3059\u3002\u5b9f\u30c7\u30fc\u30bf\u306f\u5b50\u30c6\u30fc\u30d6\u30eb\u304c\u6301\u3063\u3066\u3044\u307e\u3059\u300d                \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                    \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502                         \u2502                                     \u2502\n          \u25bc                         \u25bc                                     \u25bc\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 _2025_12_01   \u2502         \u2502 _2025_12_02   \u2502         ...         \u2502 _2025_12_90   \u2502\n  \u2502               \u2502         \u2502               \u2502                     \u2502               \u2502\n  \u2502 12/01\u306e\u30c7\u30fc\u30bf \u2502         \u2502 12/02\u306e\u30c7\u30fc\u30bf \u2502                     \u2502 90\u65e5\u5f8c\u306e\u30c7\u30fc\u30bf\u2502\n  \u2502               \u2502         \u2502               \u2502                     \u2502               \u2502\n  \u2502 \u7269\u7406\u30d5\u30a1\u30a4\u30ebA \u2502         \u2502 \u7269\u7406\u30d5\u30a1\u30a4\u30ebB \u2502                     \u2502 \u7269\u7406\u30d5\u30a1\u30a4\u30ebN \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u5404\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3 = \u72ec\u7acb\u3057\u305f\u7269\u7406\u30d5\u30a1\u30a4\u30eb\n"})}),"\n",(0,d.jsx)(n.h3,{id:"12-\u4e3b\u306a\u30e1\u30ea\u30c3\u30c8",children:"1.2 \u4e3b\u306a\u30e1\u30ea\u30c3\u30c8"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u5f93\u6765\u65b9\u5f0f"}),(0,d.jsx)(n.th,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u53e4\u3044\u30c7\u30fc\u30bf\u524a\u9664"})}),(0,d.jsx)(n.td,{children:"DELETE\u6587\uff08\u6570\u6642\u9593\u301c\u6570\u65e5\uff09"}),(0,d.jsx)(n.td,{children:"DROP TABLE\uff08\u6570\u79d2\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"VACUUM\u8ca0\u8377"})}),(0,d.jsx)(n.td,{children:"\u9ad8\u3044"}),(0,d.jsx)(n.td,{children:"\u306a\u3057"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u65e5\u4ed8\u7bc4\u56f2\u30af\u30a8\u30ea"})}),(0,d.jsx)(n.td,{children:"\u5168\u4ef6\u30b9\u30ad\u30e3\u30f3"}),(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u30b9\u30c8\u30ec\u30fc\u30b8\u7ba1\u7406"})}),(0,d.jsx)(n.td,{children:"\u624b\u52d5\u7ba1\u7406"}),(0,d.jsx)(n.td,{children:"\u81ea\u52d5\u524a\u9664\u3067\u4e00\u5b9a\u91cf\u7dad\u6301"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"2-delete-vs-drop-table",children:"2. DELETE vs DROP TABLE"}),"\n",(0,d.jsx)(n.h3,{id:"21-delete\u6587\u306e\u52d5\u4f5c\u901a\u5e38\u30c6\u30fc\u30d6\u30eb",children:"2.1 DELETE\u6587\u306e\u52d5\u4f5c\uff08\u901a\u5e38\u30c6\u30fc\u30d6\u30eb\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"DELETE FROM security_event WHERE created_at < '2025-09-05';\n"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          security_event                                     \u2502\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 \u884c1 \u2502 \u884c2 \u2502 \u884c3 \u2502 \u884c4 \u2502 \u884c5 \u2502 \u884c6 \u2502 \u884c7 \u2502 \u884c8 \u2502 \u884c9 \u2502\u884c10 \u2502 ...          \u2502\n\u2502  \u2502 \u53e4\u3044\u2502 \u53e4\u3044\u2502 \u65b0\u3057\u2502 \u53e4\u3044\u2502 \u65b0\u3057\u2502 \u53e4\u3044\u2502 \u65b0\u3057\u2502 \u53e4\u3044\u2502 \u65b0\u3057\u2502 \u53e4\u3044\u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502     \u2193     \u2193           \u2193           \u2193           \u2193           \u2193                \u2502\n\u2502    \u524a\u9664  \u524a\u9664        \u524a\u9664        \u524a\u9664        \u524a\u9664        \u524a\u9664               \u2502\n\u2502   \u30de\u30fc\u30af \u30de\u30fc\u30af      \u30de\u30fc\u30af      \u30de\u30fc\u30af      \u30de\u30fc\u30af      \u30de\u30fc\u30af              \u2502\n\u2502                                                                             \u2502\n\u2502  \u51e6\u7406\u5185\u5bb9:                                                                  \u2502\n\u2502  1. \u5168\u884c\u3092\u30b9\u30ad\u30e3\u30f3 (WHERE\u6761\u4ef6\u30c1\u30a7\u30c3\u30af)     \u2190 \u6642\u9593\u304b\u304b\u308b                     \u2502\n\u2502  2. \u8a72\u5f53\u884c\u306b\u300c\u524a\u9664\u6e08\u307f\u300d\u30de\u30fc\u30af\u3092\u4ed8\u3051\u308b     \u2190 \u6642\u9593\u304b\u304b\u308b                     \u2502\n\u2502  3. \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30ed\u30b0\u306b\u8a18\u9332             \u2190 I/O\u8ca0\u8377                        \u2502\n\u2502  4. \u5f8c\u3067VACUUM\u3067\u5b9f\u969b\u306b\u9818\u57df\u56de\u53ce             \u2190 \u3055\u3089\u306b\u6642\u9593\u304b\u304b\u308b               \u2502\n\u2502                                                                             \u2502\n\u2502  \u7d50\u679c: 5\u5104\u884c\u524a\u9664 = \u6570\u6642\u9593\u301c\u6570\u65e5                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(n.h3,{id:"22-drop-table\u306e\u52d5\u4f5c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb",children:"2.2 DROP TABLE\u306e\u52d5\u4f5c\uff08\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"DROP TABLE security_event_2025_09_05;\n"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                                             \u2502\n\u2502  \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3 = \u72ec\u7acb\u3057\u305f\u7269\u7406\u30d5\u30a1\u30a4\u30eb                                      \u2502\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                                        \u2502\n\u2502  \u2502 _2025_09_05     \u2502   rm /var/lib/postgresql/.../security_event_...        \u2502\n\u2502  \u2502                 \u2502   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6      \u2502\n\u2502  \u2502  \u7269\u7406\u30d5\u30a1\u30a4\u30eb   \u2502                   \u30d5\u30a1\u30a4\u30eb\u524a\u9664\uff01                        \u2502\n\u2502  \u2502    625GB        \u2502                                                        \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                                        \u2502\n\u2502           \u2502                                                                 \u2502\n\u2502           \u25bc                                                                 \u2502\n\u2502        \ud83d\uddd1\ufe0f \u30b4\u30df\u7bb1\u3078\uff08\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u30ec\u30d9\u30eb\u3067\u5373\u524a\u9664\uff09                         \u2502\n\u2502                                                                             \u2502\n\u2502  \u51e6\u7406\u5185\u5bb9:                                                                  \u2502\n\u2502  1. \u30e1\u30bf\u30c7\u30fc\u30bf\uff08\u30ab\u30bf\u30ed\u30b0\uff09\u304b\u3089\u767b\u9332\u89e3\u9664    \u2190 \u4e00\u77ac                            \u2502\n\u2502  2. \u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u304c\u30d5\u30a1\u30a4\u30eb\u524a\u9664        \u2190 \u4e00\u77ac                            \u2502\n\u2502                                                                             \u2502\n\u2502  \u7d50\u679c: 625GB\u524a\u9664 = \u6570\u79d2                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(n.h3,{id:"23-\u51e6\u7406\u6642\u9593\u6bd4\u8f035\u5104\u884c\u65e5\u306e\u5834\u5408",children:"2.3 \u51e6\u7406\u6642\u9593\u6bd4\u8f03\uff085\u5104\u884c/\u65e5\u306e\u5834\u5408\uff09"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u64cd\u4f5c"}),(0,d.jsx)(n.th,{children:"DELETE\u65b9\u5f0f"}),(0,d.jsx)(n.th,{children:"DROP TABLE\u65b9\u5f0f"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8a72\u5f53\u884c\u7279\u5b9a"}),(0,d.jsx)(n.td,{children:"30\u5206"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u524a\u9664\u30de\u30fc\u30af\u4ed8\u4e0e"}),(0,d.jsx)(n.td,{children:"2\u6642\u9593"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30ed\u30b0"}),(0,d.jsx)(n.td,{children:"1\u6642\u9593"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"VACUUM"}),(0,d.jsx)(n.td,{children:"3\u6642\u9593"}),(0,d.jsx)(n.td,{children:"-"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30e1\u30bf\u30c7\u30fc\u30bf\u66f4\u65b0"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"0.1\u79d2"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30d5\u30a1\u30a4\u30eb\u524a\u9664"}),(0,d.jsx)(n.td,{children:"-"}),(0,d.jsx)(n.td,{children:"0.5\u79d2"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u5408\u8a08"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u7d046\u301c7\u6642\u9593"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u7d041\u79d2"})})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"3-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0",children:"3. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0"}),"\n",(0,d.jsx)(n.p,{children:"\u30af\u30a8\u30ea\u5b9f\u884c\u6642\u306b\u3001\u6761\u4ef6\u306b\u5408\u81f4\u3059\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u307f\u3092\u30b9\u30ad\u30e3\u30f3\u3059\u308b\u6700\u9069\u5316\u6a5f\u80fd\u3067\u3059\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"31-\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304f\u5834\u5408",children:"3.1 \u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304f\u5834\u5408"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM security_event\nWHERE created_at >= '2025-12-01' AND created_at < '2025-12-04';\n"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 11/29     \u2502 \u2502 11/30     \u2502 \u2502 12/01     \u2502 \u2502 12/02     \u2502 \u2502 12/03     \u2502\n\u2502           \u2502 \u2502           \u2502 \u2502  \u2713 SCAN   \u2502 \u2502  \u2713 SCAN   \u2502 \u2502  \u2713 SCAN   \u2502\n\u2502  \u2717 SKIP   \u2502 \u2502  \u2717 SKIP   \u2502 \u2502           \u2502 \u2502           \u2502 \u2502           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 12/04     \u2502 \u2502 12/05     \u2502 \u2502 ...       \u2502\n\u2502           \u2502 \u2502           \u2502 \u2502           \u2502\n\u2502  \u2717 SKIP   \u2502 \u2502  \u2717 SKIP   \u2502 \u2502  \u2717 SKIP   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u7d50\u679c: 90\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4e2d\u30013\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306e\u307f\u30b9\u30ad\u30e3\u30f3 = \u7d0430\u500d\u9ad8\u901f\n"})}),"\n",(0,d.jsx)(n.h3,{id:"32-\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304b\u306a\u3044\u5834\u5408",children:"3.2 \u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u304c\u52b9\u304b\u306a\u3044\u5834\u5408"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30ad\u30fc\uff08created_at\uff09\u3092\u6307\u5b9a\u3057\u3066\u3044\u306a\u3044\nSELECT * FROM security_event\nWHERE user_id = 'user-uuid-xxx';\n"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 12/01   \u2502 \u2502 12/02   \u2502 \u2502 12/03   \u2502 \u2502 ...     \u2502 \u2502 03/01   \u2502\n\u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2191\n        \u516890\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u30b9\u30ad\u30e3\u30f3\uff08\u901a\u5e38\u30c6\u30fc\u30d6\u30eb\u3088\u308a\u9045\u304f\u306a\u308b\u53ef\u80fd\u6027\uff09\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"4-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u5236\u7d04",children:"4. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u5236\u7d04"}),"\n",(0,d.jsx)(n.h3,{id:"41-primary-key-\u306e\u5236\u7d04",children:"4.1 PRIMARY KEY \u306e\u5236\u7d04"}),"\n",(0,d.jsx)(n.p,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30ad\u30fc\u3092PRIMARY KEY\u306b\u542b\u3081\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u274c \u4e0d\u53ef\nPRIMARY KEY (id)\n\n-- \u2705 \u5fc5\u9808\nPRIMARY KEY (id, created_at)\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u7406\u7531"}),": PostgreSQL\u306f\u300c\u3053\u306eid\u306f\u3069\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u3042\u308b\uff1f\u300d\u3092\u52b9\u7387\u7684\u306b\u5224\u65ad\u3059\u308b\u305f\u3081"]}),"\n",(0,d.jsx)(n.h3,{id:"42-\u5916\u90e8\u30ad\u30fcforeign-key\u306e\u5236\u7d04",children:"4.2 \u5916\u90e8\u30ad\u30fc\uff08FOREIGN KEY\uff09\u306e\u5236\u7d04"}),"\n",(0,d.jsx)(n.p,{children:"\u4ed6\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\u3078\u306e\u5916\u90e8\u30ad\u30fc\u53c2\u7167\u306f\u4f5c\u6210\u3067\u304d\u307e\u305b\u3093\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u274c \u30a8\u30e9\u30fc\u306b\u306a\u308b\nCREATE TABLE security_event_detail (\n    id UUID PRIMARY KEY,\n    security_event_id UUID,\n    FOREIGN KEY (security_event_id) REFERENCES security_event(id)\n);\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u56de\u907f\u7b56"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5c64\u3067\u6574\u5408\u6027\u30c1\u30a7\u30c3\u30af"}),"\n",(0,d.jsx)(n.li,{children:"RLS\u3067\u5236\u5fa1"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"43-\u904b\u7528\u4e0a\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9",children:"4.3 \u904b\u7528\u4e0a\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u5185\u5bb9"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210"}),(0,d.jsx)(n.td,{children:"\u6bce\u65e5\u81ea\u52d5\u5b9f\u884c\uff08pg_cron\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u524a\u9664"}),(0,d.jsx)(n.td,{children:"\u6bce\u65e5\u81ea\u52d5\u5b9f\u884c\uff08pg_cron\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u76e3\u8996"}),(0,d.jsx)(n.td,{children:"pg_cron\u30b8\u30e7\u30d6\u72b6\u614b\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u6570"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u969c\u5bb3\u5bfe\u5fdc"}),(0,d.jsx)(n.td,{children:"DEFAULT\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u80a5\u5927\u5316\u306e\u76e3\u8996"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"5-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",children:"5. \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad"}),"\n",(0,d.jsx)(n.h3,{id:"51-\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"5.1 \u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,d.jsx)(n.p,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3092\u691c\u8a0e\u3059\u308b\u969b\u306f\u3001\u4ee5\u4e0b\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30c1\u30a7\u30c3\u30af\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u25a1 \u4e3b\u8981\u30af\u30a8\u30ea\u3067\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30ad\u30fc\u3092\u6307\u5b9a\u3067\u304d\u308b\u304b\uff1f"}),(0,d.jsx)(n.td,{children:"\u65e5\u4ed8\u7bc4\u56f2\u691c\u7d22\u304c\u4e3b\u306a\u3089\u9069\u3057\u3066\u3044\u308b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u25a1 \u53e4\u3044\u30c7\u30fc\u30bf\u3092\u300c\u671f\u9593\u5358\u4f4d\u300d\u3067\u524a\u9664\u3057\u305f\u3044\u304b\uff1f"}),(0,d.jsx)(n.td,{children:"90\u65e5\u7d4c\u904e\u3067\u4e00\u62ec\u524a\u9664\u306a\u3069"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u25a1 \u5916\u90e8\u30ad\u30fc\u53c2\u7167\u304c\u306a\u3044\u304b\uff1f"}),(0,d.jsx)(n.td,{children:"\u53c2\u7167\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u4e0d\u53ef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u25a1 PRIMARY KEY\u5909\u66f4\u306e\u5f71\u97ff\u3092\u8a31\u5bb9\u3067\u304d\u308b\u304b\uff1f"}),(0,d.jsx)(n.td,{children:"\u8907\u5408\u30ad\u30fc\u3078\u306e\u5909\u66f4"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"52-idp-server\u306e\u30c6\u30fc\u30d6\u30eb\u9069\u6027",children:"5.2 idp-server\u306e\u30c6\u30fc\u30d6\u30eb\u9069\u6027"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30c6\u30fc\u30d6\u30eb"}),(0,d.jsx)(n.th,{children:"\u9069\u6027"}),(0,d.jsx)(n.th,{children:"\u7406\u7531"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"security_event"})}),(0,d.jsx)(n.td,{children:"\u2713 \u9069\u3057\u3066\u3044\u308b"}),(0,d.jsx)(n.td,{children:"\u65e5\u4ed8\u691c\u7d22\u304c\u4e3b\u3001\u671f\u9593\u524a\u9664\u3057\u305f\u3044"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"security_event_hook_results"})}),(0,d.jsx)(n.td,{children:"\u2713 \u9069\u3057\u3066\u3044\u308b"}),(0,d.jsx)(n.td,{children:"\u540c\u4e0a"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"audit_log"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"\u6c38\u7d9a\u4fdd\u5b58\uff08\u30b3\u30f3\u30d7\u30e9\u30a4\u30a2\u30f3\u30b9\u8981\u4ef6\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"oauth_token"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u5411\u304d"}),(0,d.jsx)(n.td,{children:"\u30cf\u30c3\u30b7\u30e5\u691c\u7d22\u304c\u4e3b\u3001\u65e5\u4ed8\u6307\u5b9a\u4e0d\u53ef\uff08\u5f8c\u8ff0\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"tenant"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u5411\u304d"}),(0,d.jsx)(n.td,{children:"\u30de\u30b9\u30bf\u30c7\u30fc\u30bf\u3001\u5916\u90e8\u30ad\u30fc\u53c2\u7167\u3042\u308a"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"idp_user"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u5411\u304d"}),(0,d.jsx)(n.td,{children:"\u30de\u30b9\u30bf\u30c7\u30fc\u30bf"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"6-oauth_token-\u304c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306b\u4e0d\u5411\u304d\u306a\u7406\u7531",children:"6. oauth_token \u304c\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306b\u4e0d\u5411\u304d\u306a\u7406\u7531"}),"\n",(0,d.jsx)(n.h3,{id:"61-\u30a4\u30f3\u30c8\u30ed\u30b9\u30da\u30af\u30b7\u30e7\u30f3\u306e\u691c\u7d22\u30d1\u30bf\u30fc\u30f3",children:"6.1 \u30a4\u30f3\u30c8\u30ed\u30b9\u30da\u30af\u30b7\u30e7\u30f3\u306e\u691c\u7d22\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"POST /introspect\ntoken=eyJhbGciOiJSUzI1NiIs...\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5074\u306e\u51e6\u7406:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u30c8\u30fc\u30af\u30f3\u6587\u5b57\u5217\u3092\u30cf\u30c3\u30b7\u30e5\u5316\u3057\u3066DB\u3067\u691c\u7d22\nSELECT * FROM oauth_token\nWHERE tenant_id = :tenantId\n  AND hashed_access_token = :hashedToken;\n\n-- \u203b created_at \u306f\u691c\u7d22\u6761\u4ef6\u306b\u4f7f\u3048\u306a\u3044\n-- \u203b \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f\u30c8\u30fc\u30af\u30f3\u6587\u5b57\u5217\u3057\u304b\u77e5\u3089\u306a\u3044\n"})}),"\n",(0,d.jsx)(n.h3,{id:"62-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3057\u305f\u5834\u5408\u306e\u554f\u984c",children:"6.2 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3057\u305f\u5834\u5408\u306e\u554f\u984c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u4eee\u306b PARTITION BY RANGE (access_token_created_at) \u3068\u3057\u305f\u5834\u5408               \u2502\n\u2502                                                                             \u2502\n\u2502  SELECT * FROM oauth_token                                                  \u2502\n\u2502  WHERE hashed_access_token = :hash;                                         \u2502\n\u2502        \u2191 access_token_created_at \u306f\u4e0d\u660e\uff01                                   \u2502\n\u2502                                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502  \u2502 12/01   \u2502 \u2502 12/02   \u2502 \u2502 12/03   \u2502 \u2502 ...     \u2502 \u2502 03/01   \u2502               \u2502\n\u2502  \u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502 \u2502  SCAN   \u2502               \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                               \u2191                                             \u2502\n\u2502                    \u516890\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u3092\u30b9\u30ad\u30e3\u30f3\uff01                            \u2502\n\u2502                    \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u52b9\u304b\u306a\u3044                        \u2502\n\u2502                                                                             \u2502\n\u2502  \u7d50\u679c:                                                                      \u2502\n\u2502  - \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306e\u30e1\u30ea\u30c3\u30c8\uff08\u691c\u7d22\u9ad8\u901f\u5316\uff09\u304c\u5f97\u3089\u308c\u306a\u3044                    \u2502\n\u2502  - \u3080\u3057\u308d\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3067\u9045\u304f\u306a\u308b\u53ef\u80fd\u6027                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(n.h3,{id:"63-oauth_token-\u306e\u904b\u7528\u6226\u7565",children:"6.3 oauth_token \u306e\u904b\u7528\u6226\u7565"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u65b9\u5f0f"}),(0,d.jsx)(n.th,{children:"\u8aac\u660e"}),(0,d.jsx)(n.th,{children:"\u30e1\u30ea\u30c3\u30c8"}),(0,d.jsx)(n.th,{children:"\u30c7\u30e1\u30ea\u30c3\u30c8"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5b9a\u671fDELETE + VACUUM"}),(0,d.jsx)(n.td,{children:"\u5f93\u6765\u65b9\u5f0f\u3067\u671f\u9650\u5207\u308c\u30c8\u30fc\u30af\u30f3\u3092\u524a\u9664"}),(0,d.jsx)(n.td,{children:"\u30b7\u30f3\u30d7\u30eb"}),(0,d.jsx)(n.td,{children:"\u5927\u91cf\u30c7\u30fc\u30bf\u6642\u306f\u91cd\u3044"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"TTL\u30a4\u30f3\u30c7\u30c3\u30af\u30b9"}),(0,d.jsx)(n.td,{children:"PostgreSQL\u62e1\u5f35\u3067\u81ea\u52d5\u524a\u9664"}),(0,d.jsx)(n.td,{children:"\u81ea\u52d5\u5316"}),(0,d.jsx)(n.td,{children:"\u62e1\u5f35\u5c0e\u5165\u304c\u5fc5\u8981"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30a2\u30d7\u30ea\u5c64\u3067\u306e\u671f\u9650\u30c1\u30a7\u30c3\u30af"}),(0,d.jsx)(n.td,{children:"DB\u306b\u554f\u3044\u5408\u308f\u305b\u305a\u671f\u9650\u5224\u5b9a"}),(0,d.jsx)(n.td,{children:"DB\u8ca0\u8377\u8efd\u6e1b"}),(0,d.jsx)(n.td,{children:"\u53d6\u308a\u6d88\u3057\u5bfe\u5fdc\u304c\u5225\u9014\u5fc5\u8981"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"7-\u5b9f\u88c5\u4f8b",children:"7. \u5b9f\u88c5\u4f8b"}),"\n",(0,d.jsx)(n.h3,{id:"71-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210v0_9_1",children:"7.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\uff08V0_9_1\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u89aa\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210\nCREATE TABLE security_event (\n    id UUID,\n    type VARCHAR(255) NOT NULL,\n    tenant_id UUID NOT NULL,\n    detail JSONB NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n    PRIMARY KEY (id, created_at)  -- \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u30ad\u30fc\u3092\u542b\u3081\u308b\n)\nPARTITION BY RANGE (created_at);\n\n-- \u30c7\u30d5\u30a9\u30eb\u30c8\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\uff08\u5b89\u5168\u5f01\uff09\nCREATE TABLE security_event_default PARTITION OF security_event DEFAULT;\n\n-- \u65e5\u5225\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\uff0890\u65e5\u5206\uff09\nDO $$\nDECLARE\n    partition_date DATE;\n    partition_name TEXT;\nBEGIN\n    FOR i IN 0..89 LOOP\n        partition_date := CURRENT_DATE + (i || ' days')::interval;\n        partition_name := 'security_event_' || to_char(partition_date, 'YYYY_MM_DD');\n\n        EXECUTE format(\n            'CREATE TABLE IF NOT EXISTS %I PARTITION OF security_event\n             FOR VALUES FROM (%L) TO (%L)',\n            partition_name,\n            to_char(partition_date, 'YYYY-MM-DD'),\n            to_char(partition_date + interval '1 day', 'YYYY-MM-DD')\n        );\n    END LOOP;\nEND $$;\n"})}),"\n",(0,d.jsx)(n.h3,{id:"72-\u81ea\u52d5\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u7ba1\u7406v0_9_2",children:"7.2 \u81ea\u52d5\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u7ba1\u7406\uff08V0_9_2\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- pg_cron\u62e1\u5f35\u6709\u52b9\u5316\nCREATE EXTENSION IF NOT EXISTS pg_cron;\n\n-- \u65b0\u898f\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\u95a2\u6570\nCREATE OR REPLACE FUNCTION create_next_day_partitions()\nRETURNS void AS $$\nDECLARE\n    next_day DATE := CURRENT_DATE + interval '90 days';\n    partition_name TEXT;\nBEGIN\n    partition_name := 'security_event_' || to_char(next_day, 'YYYY_MM_DD');\n\n    EXECUTE format(\n        'CREATE TABLE IF NOT EXISTS %I PARTITION OF security_event\n         FOR VALUES FROM (%L) TO (%L)',\n        partition_name,\n        to_char(next_day, 'YYYY-MM-DD'),\n        to_char(next_day + interval '1 day', 'YYYY-MM-DD')\n    );\nEND;\n$$ LANGUAGE plpgsql;\n\n-- \u53e4\u3044\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u524a\u9664\u95a2\u6570\nCREATE OR REPLACE FUNCTION drop_old_daily_partitions()\nRETURNS void AS $$\nDECLARE\n    cutoff_date DATE := CURRENT_DATE - interval '90 days';\n    partition_name TEXT;\nBEGIN\n    partition_name := 'security_event_' || to_char(cutoff_date, 'YYYY_MM_DD');\n    EXECUTE format('DROP TABLE IF EXISTS %I CASCADE', partition_name);\nEND;\n$$ LANGUAGE plpgsql;\n\n-- \u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u8a2d\u5b9a\uff08postgres DB\u306b\u63a5\u7d9a\u3057\u3066\u5b9f\u884c\uff09\n-- psql -h localhost -U idp -d postgres\nSELECT cron.schedule_in_database('create-next-day-partitions', '0 2 * * *',\n                     'SELECT create_next_day_partitions();', 'idpserver');\nSELECT cron.schedule_in_database('drop-old-daily-partitions', '0 3 * * *',\n                     'SELECT drop_old_daily_partitions();', 'idpserver');\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"8-\u904b\u7528\u76e3\u8996",children:"8. \u904b\u7528\u76e3\u8996"}),"\n",(0,d.jsx)(n.h3,{id:"81-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4e00\u89a7\u78ba\u8a8d",children:"8.1 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4e00\u89a7\u78ba\u8a8d"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"SELECT\n    tablename,\n    pg_size_pretty(pg_total_relation_size(schemaname || '.' || tablename)) as size\nFROM pg_tables\nWHERE tablename LIKE 'security_event_%'\nORDER BY tablename DESC\nLIMIT 10;\n"})}),"\n",(0,d.jsx)(n.h3,{id:"82-pg_cron\u30b8\u30e7\u30d6\u72b6\u614b\u78ba\u8a8d",children:"8.2 pg_cron\u30b8\u30e7\u30d6\u72b6\u614b\u78ba\u8a8d"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"SELECT jobid, jobname, schedule, command, nodename\nFROM cron.job;\n"})}),"\n",(0,d.jsx)(n.h3,{id:"83-default\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u76e3\u8996",children:"8.3 DEFAULT\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u76e3\u8996"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- DEFAULT\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u306b\u30c7\u30fc\u30bf\u304c\u6e9c\u307e\u3063\u3066\u3044\u306a\u3044\u304b\u78ba\u8a8d\nSELECT COUNT(*) FROM security_event_default;\n\n-- 0\u4ee5\u5916\u306e\u5834\u5408\u3001\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\u304c\u8ffd\u3044\u3064\u3044\u3066\u3044\u306a\u3044\u53ef\u80fd\u6027\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"9-\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u8003\u5bdf",children:"9. \u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306e\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u8003\u5bdf"}),"\n",(0,d.jsx)(n.h3,{id:"91-\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7",children:"9.1 \u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7"}),"\n",(0,d.jsx)(n.p,{children:"idp-server\u306b\u306f\u4ee5\u4e0b\u306e\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u304c\u3042\u308a\u307e\u3059\u3002"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30c6\u30fc\u30d6\u30eb"}),(0,d.jsx)(n.th,{children:"\u7c92\u5ea6"}),(0,d.jsx)(n.th,{children:"\u7528\u9014"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_monthly"})}),(0,d.jsx)(n.td,{children:"\u6708\u6b21\u96c6\u8a08"}),(0,d.jsx)(n.td,{children:"MAU\u3001\u30a4\u30d9\u30f3\u30c8\u30ab\u30a6\u30f3\u30c8\u7b49\u306e\u96c6\u8a08\u30c7\u30fc\u30bf"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_yearly"})}),(0,d.jsx)(n.td,{children:"\u5e74\u6b21\u96c6\u8a08"}),(0,d.jsx)(n.td,{children:"YAU\u7b49\u306e\u5e74\u6b21\u96c6\u8a08\u30c7\u30fc\u30bf"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_daily_users"})}),(0,d.jsx)(n.td,{children:"\u65e5\xd7\u30e6\u30fc\u30b6\u30fc"}),(0,d.jsx)(n.td,{children:"DAU\u8a08\u7b97\u7528\uff08\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u8ffd\u8de1\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_monthly_users"})}),(0,d.jsx)(n.td,{children:"\u6708\xd7\u30e6\u30fc\u30b6\u30fc"}),(0,d.jsx)(n.td,{children:"MAU\u8a08\u7b97\u7528\uff08\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u8ffd\u8de1\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_yearly_users"})}),(0,d.jsx)(n.td,{children:"\u5e74\xd7\u30e6\u30fc\u30b6\u30fc"}),(0,d.jsx)(n.td,{children:"YAU\u8a08\u7b97\u7528\uff08\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u8ffd\u8de1\uff09"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"92-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad",children:"9.2 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u9069\u6027\u5224\u65ad"}),"\n",(0,d.jsx)(n.h4,{id:"security_event-\u3068\u306e\u6bd4\u8f03",children:"security_event \u3068\u306e\u6bd4\u8f03"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"security_event"}),(0,d.jsx)(n.th,{children:"statistics_daily_users"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"1\u65e5\u306e\u30ec\u30b3\u30fc\u30c9\u6570"})}),(0,d.jsx)(n.td,{children:"5\u5104"}),(0,d.jsx)(n.td,{children:"100\u4e07\uff08\u6700\u5927\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"1\u65e5\u306e\u30b5\u30a4\u30ba"})}),(0,d.jsx)(n.td,{children:"625GB"}),(0,d.jsx)(n.td,{children:"~56MB"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"90\u65e5\u306e\u30b5\u30a4\u30ba"})}),(0,d.jsx)(n.td,{children:"56TB"}),(0,d.jsx)(n.td,{children:"~5GB"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"\u524a\u9664\u8ca0\u8377"})}),(0,d.jsx)(n.td,{children:"\u975e\u5e38\u306b\u9ad8\u3044"}),(0,d.jsx)(n.td,{children:"\u4f4e\u3044"})]})]})]}),"\n",(0,d.jsx)(n.h4,{id:"\u30c7\u30fc\u30bf\u91cf\u8a66\u7b97100\u4e07\u30e6\u30fc\u30b6\u30fc\u60f3\u5b9a",children:"\u30c7\u30fc\u30bf\u91cf\u8a66\u7b97\uff08100\u4e07\u30e6\u30fc\u30b6\u30fc\u60f3\u5b9a\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"statistics_daily_users:\n  1\u30ec\u30b3\u30fc\u30c9 \u2248 56 bytes (UUID\xd72 + DATE + TIMESTAMP\xd72)\n  1\u65e5 = 100\u4e07\u30ec\u30b3\u30fc\u30c9 \xd7 56 bytes = 56MB\n  90\u65e5 = 56MB \xd7 90 = \u7d045GB\n\nsecurity_event\uff08\u6bd4\u8f03\u7528\uff09:\n  1\u65e5 = 5\u5104\u30ec\u30b3\u30fc\u30c9 \xd7 1.25KB = 625GB\n  90\u65e5 = 56TB\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u30c7\u30fc\u30bf\u91cf\u306e\u5dee: \u7d0410,000\u500d"})}),"\n",(0,d.jsx)(n.h4,{id:"\u7d50\u8ad6-\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306f\u4e0d\u8981",children:"\u7d50\u8ad6: \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u306f\u4e0d\u8981"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30c6\u30fc\u30d6\u30eb"}),(0,d.jsx)(n.th,{children:"\u5224\u5b9a"}),(0,d.jsx)(n.th,{children:"\u7406\u7531"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_monthly"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"\u6708\u6b21\u96c6\u8a08\u306e\u305f\u3081\u5e74\u959312\u30ec\u30b3\u30fc\u30c9/\u30c6\u30ca\u30f3\u30c8\u7a0b\u5ea6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_yearly"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"\u5e74\u6b21\u96c6\u8a08\u306e\u305f\u3081\u5e74\u95931\u30ec\u30b3\u30fc\u30c9/\u30c6\u30ca\u30f3\u30c8"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_daily_users"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"5GB/90\u65e5\u7a0b\u5ea6\u3001DELETE\u6587\u3067\u5341\u5206\u9ad8\u901f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_monthly_users"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"700MB/12\u30f6\u6708\u7a0b\u5ea6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"statistics_yearly_users"})}),(0,d.jsx)(n.td,{children:"\u2717 \u4e0d\u8981"}),(0,d.jsx)(n.td,{children:"200MB/\u5e74\u7a0b\u5ea6\u3001\u6c38\u7d9a\u4fdd\u6301\u63a8\u5968"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"93-\u63a8\u5968\u904b\u7528\u65b9\u6cd5",children:"9.3 \u63a8\u5968\u904b\u7528\u65b9\u6cd5"}),"\n",(0,d.jsx)(n.p,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3067\u306f\u306a\u304f\u3001\u65e2\u5b58\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7\u95a2\u6570\u3092pg_cron\u3067\u5b9a\u671f\u5b9f\u884c\u3057\u307e\u3059\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u7d71\u8a08\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\uff08\u63a8\u5968\uff09\n-- postgres DB\u306b\u63a5\u7d9a\u3057\u3066\u5b9f\u884c: psql -h localhost -U idp -d postgres\n\n-- daily_users: 90\u65e5\u4fdd\u6301\nSELECT cron.schedule_in_database(\n    'cleanup-daily-users',\n    '0 4 * * *',  -- \u6bce\u65e5\u5348\u524d4\u6642\n    'SELECT cleanup_old_daily_users(90);',\n    'idpserver'\n);\n\n-- monthly_users: 13\u30f6\u6708\u4fdd\u6301\uff08YoY\u6bd4\u8f03\u7528\uff09\nSELECT cron.schedule_in_database(\n    'cleanup-monthly-users',\n    '0 4 1 * *',  -- \u6bce\u67081\u65e5\u5348\u524d4\u6642\n    'SELECT cleanup_old_monthly_users(13);',\n    'idpserver'\n);\n\n-- statistics_monthly: 25\u30f6\u6708\u4fdd\u6301\uff08YoY\u6bd4\u8f03\u7528\uff09\nSELECT cron.schedule_in_database(\n    'cleanup-monthly-statistics',\n    '0 4 1 * *',\n    'SELECT cleanup_old_statistics(25);',\n    'idpserver'\n);\n\n-- yearly_users, statistics_yearly: \u6c38\u7d9a\u4fdd\u6301\uff08\u524a\u9664\u3057\u306a\u3044\uff09\n"})}),"\n",(0,d.jsx)(n.h3,{id:"94-\u5224\u65ad\u306e\u30dd\u30a4\u30f3\u30c8",children:"9.4 \u5224\u65ad\u306e\u30dd\u30a4\u30f3\u30c8"}),"\n",(0,d.jsx)(n.p,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u3092\u5c0e\u5165\u3059\u3079\u304d\u304b\u306e\u5224\u65ad\u57fa\u6e96:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u5c0e\u5165\u5224\u65ad\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8                                    \u2502\n\u2502                                                                             \u2502\n\u2502  Q1: 1\u65e5\u306e\u30c7\u30fc\u30bf\u91cf\u306f100GB\u4ee5\u4e0a\u304b\uff1f                                           \u2502\n\u2502      \u2502                                                                      \u2502\n\u2502      \u251c\u2500 Yes \u2192 Q2\u3078                                                          \u2502\n\u2502      \u2514\u2500 No  \u2192 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u4e0d\u8981\uff08DELETE\u6587\u3067\u5341\u5206\uff09                       \u2502\n\u2502                                                                             \u2502\n\u2502  Q2: \u53e4\u3044\u30c7\u30fc\u30bf\u3092\u65e5\u5358\u4f4d/\u6708\u5358\u4f4d\u3067\u4e00\u62ec\u524a\u9664\u3057\u305f\u3044\u304b\uff1f                          \u2502\n\u2502      \u2502                                                                      \u2502\n\u2502      \u251c\u2500 Yes \u2192 Q3\u3078                                                          \u2502\n\u2502      \u2514\u2500 No  \u2192 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u4e0d\u8981                                        \u2502\n\u2502                                                                             \u2502\n\u2502  Q3: \u30af\u30a8\u30ea\u3067\u65e5\u4ed8\u7bc4\u56f2\u691c\u7d22\u304c\u4e3b\u304b\uff1f                                           \u2502\n\u2502      \u2502                                                                      \u2502\n\u2502      \u251c\u2500 Yes \u2192 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u63a8\u5968                                        \u2502\n\u2502      \u2514\u2500 No  \u2192 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u975e\u63a8\u5968\uff08\u30d7\u30eb\u30fc\u30cb\u30f3\u30b0\u52b9\u679c\u306a\u3057\uff09              \u2502\n\u2502                                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"\u7d71\u8a08\u30c7\u30fc\u30bf\u30c6\u30fc\u30d6\u30eb\u306e\u5834\u5408:"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Q1: No\uff085GB/90\u65e5\u3001100GB/\u65e5\u3088\u308a\u5927\u5e45\u306b\u5c0f\u3055\u3044\uff09"}),"\n",(0,d.jsx)(n.li,{children:"\u2192 \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u4e0d\u8981"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"10-\u95a2\u9023issuepr",children:"10. \u95a2\u9023Issue\u30fbPR"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Issue/PR"}),(0,d.jsx)(n.th,{children:"\u5185\u5bb9"})]})}),(0,d.jsx)(n.tbody,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"#950"}),(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30cb\u30f3\u30b0\u8981\u4ef6\u5b9a\u7fa9"})]})})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"11-pg_partman--pg_cron-\u521d\u671f\u5316",children:"11. pg_partman / pg_cron \u521d\u671f\u5316"}),"\n",(0,d.jsx)(n.h3,{id:"111-docker\u74b0\u5883\u3067\u306e\u521d\u671f\u5316",children:"11.1 Docker\u74b0\u5883\u3067\u306e\u521d\u671f\u5316"}),"\n",(0,d.jsx)(n.p,{children:"idp-server\u3067\u306f\u3001Docker PostgreSQL\u30a4\u30e1\u30fc\u30b8\u306e\u521d\u671f\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u3067 pg_partman \u3068 pg_cron \u3092\u8a2d\u5b9a\u3057\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u91cd\u8981"}),": pg_cron \u306f\u30af\u30ed\u30b9\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30fc\u30c9\u3067\u52d5\u4f5c\u3057\u307e\u3059\u3002"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["pg_cron \u62e1\u5f35\u306f ",(0,d.jsx)(n.code,{children:"postgres"})," \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb"]}),"\n",(0,d.jsxs)(n.li,{children:["\u30b8\u30e7\u30d6\u306f ",(0,d.jsx)(n.code,{children:"cron.schedule_in_database()"})," \u3067 ",(0,d.jsx)(n.code,{children:"idpserver"})," \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u6307\u5b9a\u3057\u3066\u5b9f\u884c"]}),"\n",(0,d.jsx)(n.li,{children:"\u3053\u308c\u306b\u3088\u308a\u8907\u6570\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30b8\u30e7\u30d6\u3092\u4e00\u5143\u7ba1\u7406\u53ef\u80fd"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u521d\u671f\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u4f4d\u7f6e"}),": ",(0,d.jsx)(n.code,{children:"libs/idp-server-database/postgresql/init/02-init-partman.sh"})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'#!/bin/sh\nset -eu\n\n# Application owner user configuration\n: "${DB_OWNER_USER:=idp}"\n\n# ================================================\n# Initialize pg_cron in postgres database (cross-database setup)\n# ================================================\n# pg_cron is configured with cron.database_name=postgres\n# This allows scheduling jobs that run on any database using\n# cron.schedule_in_database() function.\npsql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "postgres" <<-EOSQL\n  -- pg_cron for scheduled execution (cross-database mode)\n  -- Note: pg_cron must be in shared_preload_libraries\n  CREATE EXTENSION IF NOT EXISTS pg_cron;\n\n  -- Grant cron schema permissions to application owner user\n  -- This allows the user to create and manage scheduled jobs\n  GRANT USAGE ON SCHEMA cron TO ${DB_OWNER_USER};\n  GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA cron TO ${DB_OWNER_USER};\nEOSQL\n\n# ================================================\n# Initialize pg_partman in application database\n# ================================================\npsql -v ON_ERROR_STOP=1 --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" <<-EOSQL\n  -- pg_partman for partition management\n  CREATE SCHEMA IF NOT EXISTS partman;\n  CREATE EXTENSION IF NOT EXISTS pg_partman WITH SCHEMA partman;\n\n  -- ================================================\n  -- Grant permissions to application owner user\n  -- ================================================\n\n  -- partman schema permissions\n  GRANT USAGE, CREATE ON SCHEMA partman TO ${DB_OWNER_USER};\n  GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA partman TO ${DB_OWNER_USER};\n  GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA partman TO ${DB_OWNER_USER};\n  GRANT ALL ON ALL SEQUENCES IN SCHEMA partman TO ${DB_OWNER_USER};\n\n  -- ================================================\n  -- Grant file write permission for archive export\n  -- ================================================\n  -- Required for COPY TO file in archive.export_partition_to_external_storage()\n  -- This allows the DB owner to export archived partitions to local files.\n  -- Note: In production with AWS RDS/Aurora, use aws_s3 extension instead.\n  GRANT pg_write_server_files TO ${DB_OWNER_USER};\nEOSQL\n\n# ================================================\n# Create archive export directory\n# ================================================\n# pg_partman archive export writes CSV files to this directory.\n# Located inside the data volume so it persists and is writable by postgres.\nARCHIVE_DIR="/var/lib/postgresql/data/archive"\nmkdir -p "$ARCHIVE_DIR"\nchown postgres:postgres "$ARCHIVE_DIR"\necho "Archive export directory created: $ARCHIVE_DIR"\n\necho "pg_cron and pg_partman extensions initialized with permissions for \'${DB_OWNER_USER}\'"\n'})}),"\n",(0,d.jsx)(n.h3,{id:"112-\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",children:"11.2 \u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"}),"\n",(0,d.jsx)(n.h4,{id:"permission-denied-\u30a8\u30e9\u30fc",children:"Permission denied \u30a8\u30e9\u30fc"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"/bin/sh: /docker-entrypoint-initdb.d/02-init-partman.sh: Permission denied\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u539f\u56e0"}),": \u30b7\u30a7\u30eb\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u8aad\u307f\u53d6\u308a\u6a29\u9650\u304c\u4e0d\u8db3"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"chmod 755 libs/idp-server-database/postgresql/init/02-init-partman.sh\n"})}),"\n",(0,d.jsx)(n.h4,{id:"partman-\u30b9\u30ad\u30fc\u30de\u304c\u5b58\u5728\u3057\u306a\u3044",children:"partman \u30b9\u30ad\u30fc\u30de\u304c\u5b58\u5728\u3057\u306a\u3044"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'ERROR: schema "partman" does not exist\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u539f\u56e0"}),": \u521d\u671f\u5316\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"Docker \u30dc\u30ea\u30e5\u30fc\u30e0\u3092\u524a\u9664\u3057\u3066\u518d\u521d\u671f\u5316"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"docker-compose down -v\ndocker-compose up -d\n"})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"\u624b\u52d5\u3067\u521d\u671f\u5316\uff08\u65e2\u5b58\u30c7\u30fc\u30bf\u304c\u3042\u308b\u5834\u5408\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"CREATE SCHEMA IF NOT EXISTS partman;\nCREATE EXTENSION IF NOT EXISTS pg_partman WITH SCHEMA partman;\n"})}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"raise-notice-\u30a8\u30e9\u30fc",children:"RAISE NOTICE \u30a8\u30e9\u30fc"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'ERROR: syntax error at or near "RAISE"\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u539f\u56e0"}),": ",(0,d.jsx)(n.code,{children:"RAISE NOTICE"})," \u306f PL/pgSQL \u5c02\u7528\u69cb\u6587\u3067\u3042\u308a\u3001\u30d7\u30ec\u30fc\u30f3SQL\u3067\u306f\u4f7f\u7528\u4e0d\u53ef"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),": \u30b7\u30a7\u30eb\u306e ",(0,d.jsx)(n.code,{children:"echo"})," \u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \u274c \u8aa4\u308a\uff08EOSQL\u5185\uff09\n# RAISE NOTICE 'Completed';\n\n# \u2705 \u6b63\u89e3\uff08EOSQL\u5916\uff09\necho \"Completed\"\n"})}),"\n",(0,d.jsx)(n.h3,{id:"113-docker-compose-\u8a2d\u5b9a",children:"11.3 Docker Compose \u8a2d\u5b9a"}),"\n",(0,d.jsxs)(n.p,{children:["pg_partman / pg_cron \u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u3001",(0,d.jsx)(n.code,{children:"shared_preload_libraries"})," \u3068 ",(0,d.jsx)(n.code,{children:"cron.database_name"})," \u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"services:\n  postgres:\n    image: postgres:16\n    # pg_cron \u306f\u30af\u30ed\u30b9\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30fc\u30c9\u3067 postgres \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\n    command: postgres -c shared_preload_libraries=pg_cron,pg_partman_bgw -c cron.database_name=postgres\n    environment:\n      POSTGRES_DB: idpserver\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: password\n    volumes:\n      - ./libs/idp-server-database/postgresql/init:/docker-entrypoint-initdb.d\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"docker-entrypoint-initdb.d"})," \u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u304c\u7a7a\u306e\u5834\u5408\u306e\u307f\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"cron.database_name=postgres"})," \u306b\u3088\u308a\u3001pg_cron \u306f postgres \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u52d5\u4f5c\u3057\u3001",(0,d.jsx)(n.code,{children:"cron.schedule_in_database()"})," \u3067\u4ed6\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30b8\u30e7\u30d6\u3082\u5b9f\u884c\u53ef\u80fd\u3067\u3059\u3002"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"12-\u904b\u7528\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",children:"12. \u904b\u7528\u30ab\u30b9\u30bf\u30de\u30a4\u30ba"}),"\n",(0,d.jsx)(n.h3,{id:"121-\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a",children:"12.1 \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u30c7\u30d5\u30a9\u30eb\u30c8\u5024"}),(0,d.jsx)(n.th,{children:"\u8a2d\u5b9a\u5834\u6240"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u5b9f\u884c\u6642\u523b"}),(0,d.jsx)(n.td,{children:"\u6bce\u65e5 02:00 UTC"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"setup-pg-cron-jobs.sql"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"security_event \u4fdd\u6301\u671f\u9593"}),(0,d.jsx)(n.td,{children:"90\u65e5"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"V0_9_21_1__add_event_partitioning.sql"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"security_event_hook_results \u4fdd\u6301\u671f\u9593"}),(0,d.jsx)(n.td,{children:"90\u65e5"}),(0,d.jsx)(n.td,{children:"\u540c\u4e0a"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"statistics_*_users \u4fdd\u6301\u671f\u9593"}),(0,d.jsx)(n.td,{children:"\u30c6\u30fc\u30d6\u30eb\u306b\u3088\u308a\u7570\u306a\u308b"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"V0_9_21_2__statistics.sql"})})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"122-cron\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u5909\u66f4",children:"12.2 cron\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u306e\u5909\u66f4"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"setup-pg-cron-jobs.sql"})," \u3092\u7de8\u96c6\u3059\u308b\u304b\u3001\u76f4\u63a5SQL\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u91cd\u8981"}),": pg_cron \u306f ",(0,d.jsx)(n.code,{children:"postgres"})," \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001cron\u64cd\u4f5c\u306f ",(0,d.jsx)(n.code,{children:"postgres"})," \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u63a5\u7d9a\u3057\u3066\u884c\u3044\u307e\u3059\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- postgres \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u63a5\u7d9a\u3057\u3066\u64cd\u4f5c\n-- psql -h localhost -U idp -d postgres\n\n-- \u73fe\u5728\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u78ba\u8a8d\nSELECT jobid, jobname, schedule, database, command, active FROM cron.job;\n\n-- \u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u5909\u66f4\uff08\u4f8b: \u6bce\u6642\u5b9f\u884c\u306b\u5909\u66f4\uff09\nSELECT cron.unschedule('partman-maintenance');\nSELECT cron.schedule_in_database(\n    'partman-maintenance',\n    '0 * * * *',  -- \u6bce\u66420\u5206\n    $$CALL partman.run_maintenance_proc()$$,\n    'idpserver'   -- \u5b9f\u884c\u5bfe\u8c61\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\n);\n\n-- \u30b8\u30e7\u30d6\u306e\u4e00\u6642\u505c\u6b62\nUPDATE cron.job SET active = false WHERE jobname = 'partman-maintenance';\n\n-- \u30b8\u30e7\u30d6\u306e\u518d\u958b\nUPDATE cron.job SET active = true WHERE jobname = 'partman-maintenance';\n"})}),"\n",(0,d.jsx)(n.h3,{id:"123-\u4fdd\u6301\u671f\u9593\u306e\u5909\u66f4",children:"12.3 \u4fdd\u6301\u671f\u9593\u306e\u5909\u66f4"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u73fe\u5728\u306e\u8a2d\u5b9a\u78ba\u8a8d\nSELECT parent_table, partition_interval, retention, premake\nFROM partman.part_config;\n\n-- security_event \u306e\u4fdd\u6301\u671f\u9593\u3092180\u65e5\u306b\u5909\u66f4\nUPDATE partman.part_config\nSET retention = '180 days'\nWHERE parent_table = 'public.security_event';\n\n-- security_event_hook_results \u306e\u4fdd\u6301\u671f\u9593\u309230\u65e5\u306b\u77ed\u7e2e\nUPDATE partman.part_config\nSET retention = '30 days'\nWHERE parent_table = 'public.security_event_hook_results';\n"})}),"\n",(0,d.jsx)(n.h3,{id:"124-partmanpart_config-\u306e\u4e3b\u8981\u8a2d\u5b9a\u9805\u76ee",children:"12.4 partman.part_config \u306e\u4e3b\u8981\u8a2d\u5b9a\u9805\u76ee"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u30ab\u30e9\u30e0"}),(0,d.jsx)(n.th,{children:"\u8aac\u660e"}),(0,d.jsx)(n.th,{children:"\u4f8b"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"partition_interval"})}),(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u9593\u9694"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"1 day"}),", ",(0,d.jsx)(n.code,{children:"1 month"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"retention"})}),(0,d.jsx)(n.td,{children:"\u4fdd\u6301\u671f\u9593\uff08\u8d85\u904e\u3067\u81ea\u52d5\u524a\u9664\uff09"}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"90 days"}),", ",(0,d.jsx)(n.code,{children:"1 year"})]})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"premake"})}),(0,d.jsx)(n.td,{children:"\u4e8b\u524d\u4f5c\u6210\u3059\u308b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u6570"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"90"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"infinite_time_partitions"})}),(0,d.jsx)(n.td,{children:"\u7121\u9650\u306b\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"true"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"retention_keep_table"})}),(0,d.jsx)(n.td,{children:"\u524a\u9664\u6642\u306b\u30c6\u30fc\u30d6\u30eb\u3092\u6b8b\u3059\u304b"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"retention_keep_index"})}),(0,d.jsx)(n.td,{children:"\u524a\u9664\u6642\u306b\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u6b8b\u3059\u304b"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"false"})})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"125-\u624b\u52d5\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u5b9f\u884c",children:"12.5 \u624b\u52d5\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u5b9f\u884c"}),"\n",(0,d.jsx)(n.p,{children:"cron\u3092\u5f85\u305f\u305a\u306b\u5373\u6642\u5b9f\u884c\u3057\u305f\u3044\u5834\u5408\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-sql",children:"-- \u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u4f5c\u6210\u30fb\u524a\u9664\u3092\u5373\u6642\u5b9f\u884c\nCALL partman.run_maintenance_proc();\n\n-- \u5b9f\u884c\u7d50\u679c\u78ba\u8a8d\nSELECT * FROM cron.job_run_details ORDER BY runid DESC LIMIT 5;\n"})}),"\n",(0,d.jsx)(n.h3,{id:"126-ddl-vs-\u904b\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5207\u308a\u5206\u3051",children:"12.6 DDL vs \u904b\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u306e\u5207\u308a\u5206\u3051"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9805\u76ee"}),(0,d.jsx)(n.th,{children:"\u7ba1\u7406\u5834\u6240"}),(0,d.jsx)(n.th,{children:"\u5909\u66f4\u65b9\u6cd5"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30c6\u30fc\u30d6\u30eb\u69cb\u9020"}),(0,d.jsx)(n.td,{children:"DDL (Flyway)"}),(0,d.jsx)(n.td,{children:"\u65b0\u898f\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u30d1\u30fc\u30c6\u30a3\u30b7\u30e7\u30f3\u521d\u671f\u8a2d\u5b9a"}),(0,d.jsx)(n.td,{children:"DDL (Flyway)"}),(0,d.jsx)(n.td,{children:"\u65b0\u898f\u30de\u30a4\u30b0\u30ec\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"cron\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"setup-pg-cron-jobs.sql"})}),(0,d.jsx)(n.td,{children:"\u30d5\u30a1\u30a4\u30eb\u7de8\u96c6 or \u76f4\u63a5SQL"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u4fdd\u6301\u671f\u9593"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"partman.part_config"})}),(0,d.jsx)(n.td,{children:"\u76f4\u63a5SQL"})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"\u8a2d\u8a08\u601d\u60f3"}),": DDL\u306f\u30b9\u30ad\u30fc\u30de\u5b9a\u7fa9\uff08\u30ea\u30ea\u30fc\u30b9\u6642\u306b\u78ba\u5b9a\uff09\u3001\u904b\u7528\u8a2d\u5b9a\u306f\u74b0\u5883\u3054\u3068\u306b\u8abf\u6574\u53ef\u80fd\u3002"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"13-\u53c2\u8003\u8cc7\u6599",children:"13. \u53c2\u8003\u8cc7\u6599"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://www.postgresql.org/docs/current/ddl-partitioning.html",children:"PostgreSQL Table Partitioning"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://github.com/citusdata/pg_cron",children:"pg_cron Extension"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://github.com/pgpartman/pg_partman",children:"pg_partman Extension"})}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(96540);const d={},i=r.createContext(d);function t(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);