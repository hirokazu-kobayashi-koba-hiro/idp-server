"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6616],{56252:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"content_06_developer-guide/implementation-guides/impl-17-external-integration","title":"\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u30ac\u30a4\u30c9","description":"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","source":"@site/docs/content_06_developer-guide/04-implementation-guides/impl-17-external-integration.md","sourceDirName":"content_06_developer-guide/04-implementation-guides","slug":"/content_06_developer-guide/implementation-guides/impl-17-external-integration","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-17-external-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_06_developer-guide/04-implementation-guides/impl-17-external-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"HTTP Request Executor","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-16-http-request-executor"},"next":{"title":"Spring Session\u7d71\u5408\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-18-spring-session"}}');var s=t(74848),r=t(28453);const o={},l="\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u30ac\u30a4\u30c9",a={},c=[{value:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",level:2},{value:"\u6240\u8981\u6642\u9593",id:"\u6240\u8981\u6642\u9593",level:3},{value:"\u524d\u63d0\u77e5\u8b58",id:"\u524d\u63d0\u77e5\u8b58",level:3},{value:"HttpRequestExecutor\u3068\u306f",id:"httprequestexecutor\u3068\u306f",level:2},{value:"\u5b9f\u88c5\u4f8b: \u5916\u90e8\u8eab\u5143\u78ba\u8a8d\u30b5\u30fc\u30d3\u30b9\u9023\u643a",id:"\u5b9f\u88c5\u4f8b-\u5916\u90e8\u8eab\u5143\u78ba\u8a8d\u30b5\u30fc\u30d3\u30b9\u9023\u643a",level:2},{value:"Step 1: HttpRequest\u8a2d\u5b9a\u4f5c\u6210",id:"step-1-httprequest\u8a2d\u5b9a\u4f5c\u6210",level:2},{value:"Step 2: \u8a8d\u8a3c\u30d1\u30bf\u30fc\u30f3",id:"step-2-\u8a8d\u8a3c\u30d1\u30bf\u30fc\u30f3",level:2},{value:"OAuth 2.0\u8a8d\u8a3c",id:"oauth-20\u8a8d\u8a3c",level:3},{value:"HMAC\u8a8d\u8a3c",id:"hmac\u8a8d\u8a3c",level:3},{value:"\u8a8d\u8a3c\u306a\u3057",id:"\u8a8d\u8a3c\u306a\u3057",level:3},{value:"Step 3: \u30ea\u30c8\u30e9\u30a4\u6226\u7565",id:"step-3-\u30ea\u30c8\u30e9\u30a4\u6226\u7565",level:2},{value:"\u57fa\u672c\u30ea\u30c8\u30e9\u30a4",id:"\u57fa\u672c\u30ea\u30c8\u30e9\u30a4",level:3},{value:"\u51aa\u7b49\u6027\u4fdd\u8a3c",id:"\u51aa\u7b49\u6027\u4fdd\u8a3c",level:3},{value:"Step 4: E2E\u30c6\u30b9\u30c8\uff08Mockoon\u4f7f\u7528\uff09",id:"step-4-e2e\u30c6\u30b9\u30c8mockoon\u4f7f\u7528",level:2},{value:"Mockoon\u8a2d\u5b9a",id:"mockoon\u8a2d\u5b9a",level:3},{value:"E2E\u30c6\u30b9\u30c8",id:"e2e\u30c6\u30b9\u30c8",level:3},{value:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:2},{value:"HttpRequest\u8a2d\u5b9a",id:"httprequest\u8a2d\u5b9a",level:3},{value:"\u8a8d\u8a3c\u8a2d\u5b9a",id:"\u8a8d\u8a3c\u8a2d\u5b9a",level:3},{value:"\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a",id:"\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a",level:3},{value:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",id:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",level:3},{value:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",level:2},{value:"\u30a8\u30e9\u30fc1: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\u306a\u3057",id:"\u30a8\u30e9\u30fc1-\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\u306a\u3057",level:3},{value:"\u30a8\u30e9\u30fc2: \u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a\u8aa4\u308a",id:"\u30a8\u30e9\u30fc2-\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a\u8aa4\u308a",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2},{value:"\ud83d\udcd6 \u6b21\u306b\u8aad\u3080\u3079\u304d\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"-\u6b21\u306b\u8aad\u3080\u3079\u304d\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:3},{value:"\ud83d\udd17 \u8a73\u7d30\u60c5\u5831",id:"-\u8a73\u7d30\u60c5\u5831",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u30ac\u30a4\u30c9",children:"\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u30ac\u30a4\u30c9"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-16-http-request-executor",children:"HTTP Request Executor"})," - \u30ea\u30c8\u30e9\u30a4\u5236\u5fa1\u3068\u8a8d\u8a3c\u8a2d\u5b9a"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-20-mapping-functions",children:"Mapping Functions \u958b\u767a\u30ac\u30a4\u30c9"})," - \u30c7\u30fc\u30bf\u5909\u63db\u306e\u8a73\u7d30\uff0819\u500b\u306eFunction\uff09"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"HttpRequestExecutor"}),"\u3068",(0,s.jsx)(n.strong,{children:"Mapping Functions"}),"\u3092\u4f7f\u3063\u3066\u3001\u5916\u90e8API\u3068\u9023\u643a\u3059\u308b\u6a5f\u80fd\u3092\u5b9f\u88c5\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u6240\u8981\u6642\u9593",children:"\u6240\u8981\u6642\u9593"}),"\n",(0,s.jsxs)(n.p,{children:["\u23f1\ufe0f ",(0,s.jsx)(n.strong,{children:"\u7d0430\u5206"}),"\uff08\u5b9f\u88c5 + \u30c6\u30b9\u30c8\uff09"]}),"\n",(0,s.jsx)(n.h3,{id:"\u524d\u63d0\u77e5\u8b58",children:"\u524d\u63d0\u77e5\u8b58"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../03-common-patterns.md",children:"03. \u5171\u901a\u5b9f\u88c5\u30d1\u30bf\u30fc\u30f3"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-20-mapping-functions",children:"Mapping Functions \u958b\u767a\u30ac\u30a4\u30c9"})," - \u30ea\u30af\u30a8\u30b9\u30c8/\u30ec\u30b9\u30dd\u30f3\u30b9\u5909\u63db"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"httprequestexecutor\u3068\u306f",children:"HttpRequestExecutor\u3068\u306f"}),"\n",(0,s.jsx)(n.p,{children:"\u5916\u90e8HTTP\u30b5\u30fc\u30d3\u30b9\u3068\u9023\u643a\u3059\u308b\u305f\u3081\u306e\u7d71\u5408\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u6a5f\u80fd"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 HTTP GET/POST/PUT/DELETE"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 OAuth 2.0\u8a8d\u8a3c"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 HMAC\u8a8d\u8a3c"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u30ea\u30c8\u30e9\u30a4\u30fb\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 \u51aa\u7b49\u6027\u4fdd\u8a3c"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u5b9f\u88c5\u4f8b-\u5916\u90e8\u8eab\u5143\u78ba\u8a8d\u30b5\u30fc\u30d3\u30b9\u9023\u643a",children:"\u5b9f\u88c5\u4f8b: \u5916\u90e8\u8eab\u5143\u78ba\u8a8d\u30b5\u30fc\u30d3\u30b9\u9023\u643a"}),"\n",(0,s.jsx)(n.p,{children:"\u5916\u90e8\u306e\u8eab\u5143\u78ba\u8a8dAPI\uff08KYC: Know Your Customer\uff09\u3068\u9023\u643a\u3059\u308b\u4f8b\u3002"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-1-httprequest\u8a2d\u5b9a\u4f5c\u6210",children:"Step 1: HttpRequest\u8a2d\u5b9a\u4f5c\u6210"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u30d5\u30a1\u30a4\u30eb"}),": ",(0,s.jsx)(n.code,{children:"libs/idp-server-core/src/main/java/org/idp/server/core/identity/verification/ExternalVerificationService.java"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.idp.server.core.identity.verification;\n\nimport java.time.Duration;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Set;\nimport org.idp.server.platform.httpclient.*;\nimport org.idp.server.platform.converter.JsonConverter;\n\npublic class ExternalVerificationService {\n\n  private final HttpRequestExecutor httpRequestExecutor;\n  private final JsonConverter converter = JsonConverter.snakeCaseInstance();\n\n  public ExternalVerificationService(HttpRequestExecutor httpRequestExecutor) {\n    this.httpRequestExecutor = httpRequestExecutor;\n  }\n\n  /**\n   * \u5916\u90e8API\u3067\u8eab\u5143\u78ba\u8a8d\u5b9f\u884c\n   *\n   * @param user \u30e6\u30fc\u30b6\u30fc\u60c5\u5831\n   * @return \u78ba\u8a8d\u7d50\u679c\n   */\n  public VerificationResult verify(User user) {\n    // 1. \u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u4f5c\u6210\n    Map<String, Object> requestBody = new HashMap<>();\n    requestBody.put("user_id", user.identifier().value());\n    requestBody.put("name", user.name());\n    requestBody.put("email", user.email().value());\n    requestBody.put("date_of_birth", user.dateOfBirth());\n\n    // 2. HttpRequest\u8a2d\u5b9a\n    HttpRequest httpRequest = HttpRequest.builder()\n        .url("https://external-kyc-service.com/api/v1/verify")\n        .method(HttpMethod.POST)\n        .headers(Map.of(\n            "Content-Type", "application/json",\n            "Accept", "application/json"\n        ))\n        .body(converter.write(requestBody))\n        .build();\n\n    // 3. \u8a8d\u8a3c\u8a2d\u5b9a\uff08OAuth 2.0\uff09\n    OAuth2Configuration oAuth2Config = OAuth2Configuration.builder()\n        .tokenEndpoint("https://external-kyc-service.com/oauth/token")\n        .clientId("your-client-id")\n        .clientSecret("your-client-secret")\n        .scope(Set.of("kyc:verify"))\n        .build();\n\n    // 4. \u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a\n    RetryConfiguration retryConfig = RetryConfiguration.builder()\n        .maxRetries(3)\n        .retryableStatusCodes(Set.of(502, 503, 504))\n        .idempotencyRequired(true)\n        .backoffDelays(List.of(\n            Duration.ofSeconds(1),\n            Duration.ofSeconds(2),\n            Duration.ofSeconds(4)\n        ))\n        .build();\n\n    // 5. HTTP\u5b9f\u884c\u8a2d\u5b9a\n    HttpRequestExecutionConfig executionConfig = HttpRequestExecutionConfig.builder()\n        .httpRequest(httpRequest)\n        .oauth2Configuration(oAuth2Config)\n        .retryConfiguration(retryConfig)\n        .timeout(Duration.ofSeconds(30))\n        .build();\n\n    // 6. \u5b9f\u884c\n    HttpRequestResult result = httpRequestExecutor.execute(executionConfig);\n\n    // 7. \u30ec\u30b9\u30dd\u30f3\u30b9\u89e3\u6790\n    if (result.isSuccess()) {\n      Map<String, Object> responseBody = converter.read(result.responseBody());\n      String status = (String) responseBody.get("status");\n      String verificationId = (String) responseBody.get("verification_id");\n\n      return VerificationResult.success(verificationId, status);\n    } else {\n      return VerificationResult.failure(result.errorMessage());\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-2-\u8a8d\u8a3c\u30d1\u30bf\u30fc\u30f3",children:"Step 2: \u8a8d\u8a3c\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,s.jsx)(n.h3,{id:"oauth-20\u8a8d\u8a3c",children:"OAuth 2.0\u8a8d\u8a3c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'OAuth2Configuration oAuth2Config = OAuth2Configuration.builder()\n    .tokenEndpoint("https://external-service.com/oauth/token")\n    .clientId("your-client-id")\n    .clientSecret("your-client-secret")\n    .scope(Set.of("api:read", "api:write"))\n    .grantType("client_credentials")  // \u30c7\u30d5\u30a9\u30eb\u30c8: client_credentials\n    .build();\n'})}),"\n",(0,s.jsx)(n.h3,{id:"hmac\u8a8d\u8a3c",children:"HMAC\u8a8d\u8a3c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'HmacAuthenticationConfiguration hmacConfig = HmacAuthenticationConfiguration.builder()\n    .secretKey("your-hmac-secret-key")\n    .algorithm("HmacSHA256")\n    .headers(Set.of("X-Request-Timestamp", "X-Request-Body"))\n    .build();\n\nHttpRequestExecutionConfig executionConfig = HttpRequestExecutionConfig.builder()\n    .httpRequest(httpRequest)\n    .hmacAuthenticationConfiguration(hmacConfig)\n    .build();\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u8a8d\u8a3c\u306a\u3057",children:"\u8a8d\u8a3c\u306a\u3057"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"HttpRequestExecutionConfig executionConfig = HttpRequestExecutionConfig.builder()\n    .httpRequest(httpRequest)\n    // \u8a8d\u8a3c\u8a2d\u5b9a\u306a\u3057\n    .build();\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-3-\u30ea\u30c8\u30e9\u30a4\u6226\u7565",children:"Step 3: \u30ea\u30c8\u30e9\u30a4\u6226\u7565"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u672c\u30ea\u30c8\u30e9\u30a4",children:"\u57fa\u672c\u30ea\u30c8\u30e9\u30a4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"RetryConfiguration retryConfig = RetryConfiguration.builder()\n    .maxRetries(3)  // \u6700\u59273\u56de\u30ea\u30c8\u30e9\u30a4\n    .retryableStatusCodes(Set.of(502, 503, 504))  // \u30ea\u30c8\u30e9\u30a4\u5bfe\u8c61\u30b9\u30c6\u30fc\u30bf\u30b9\n    .backoffDelays(List.of(\n        Duration.ofSeconds(1),   // 1\u56de\u76ee: 1\u79d2\u5f85\u6a5f\n        Duration.ofSeconds(2),   // 2\u56de\u76ee: 2\u79d2\u5f85\u6a5f\n        Duration.ofSeconds(4)    // 3\u56de\u76ee: 4\u79d2\u5f85\u6a5f\n    ))\n    .build();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u51aa\u7b49\u6027\u4fdd\u8a3c",children:"\u51aa\u7b49\u6027\u4fdd\u8a3c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"RetryConfiguration retryConfig = RetryConfiguration.builder()\n    .maxRetries(3)\n    .idempotencyRequired(true)  // \u2705 \u51aa\u7b49\u6027\u4fdd\u8a3c\uff08Idempotency-Key\u30d8\u30c3\u30c0\u30fc\u81ea\u52d5\u4ed8\u4e0e\uff09\n    .retryableStatusCodes(Set.of(502, 503, 504))\n    .backoffDelays(List.of(Duration.ofSeconds(1), Duration.ofSeconds(2), Duration.ofSeconds(4)))\n    .build();\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u91cd\u8981"}),": ",(0,s.jsx)(n.code,{children:"idempotencyRequired = true"}),"\u306e\u5834\u5408\u3001HttpRequestExecutor\u304c\u81ea\u52d5\u7684\u306b",(0,s.jsx)(n.code,{children:"Idempotency-Key"}),"\u30d8\u30c3\u30c0\u30fc\u3092\u4ed8\u4e0e\u3057\u307e\u3059\u3002"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-4-e2e\u30c6\u30b9\u30c8mockoon\u4f7f\u7528",children:"Step 4: E2E\u30c6\u30b9\u30c8\uff08Mockoon\u4f7f\u7528\uff09"}),"\n",(0,s.jsx)(n.h3,{id:"mockoon\u8a2d\u5b9a",children:"Mockoon\u8a2d\u5b9a"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u30d5\u30a1\u30a4\u30eb"}),": ",(0,s.jsx)(n.code,{children:"e2e/mockoon/external-kyc-service.json"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "routes": [\n    {\n      "method": "POST",\n      "endpoint": "/api/v1/verify",\n      "responses": [\n        {\n          "statusCode": 200,\n          "headers": {\n            "Content-Type": "application/json"\n          },\n          "body": {\n            "status": "approved",\n            "verification_id": "{{uuid}}",\n            "verified_at": "{{now \'yyyy-MM-dd\'T\'HH:mm:ss\'Z\'}}"\n          }\n        }\n      ]\n    },\n    {\n      "method": "POST",\n      "endpoint": "/api/v1/verify",\n      "responses": [\n        {\n          "statusCode": 503,\n          "headers": {\n            "Content-Type": "application/json"\n          },\n          "body": {\n            "error": "service_unavailable",\n            "error_description": "Service temporarily unavailable"\n          },\n          "rules": [\n            {\n              "target": "header",\n              "modifier": "X-Test-Retry",\n              "value": "true"\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"e2e\u30c6\u30b9\u30c8",children:"E2E\u30c6\u30b9\u30c8"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u30d5\u30a1\u30a4\u30eb"}),": ",(0,s.jsx)(n.code,{children:"e2e/spec/integration/external-verification.spec.js"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const { v4: uuidv4 } = require('uuid');\nconst axios = require('axios');\n\ndescribe('External Verification Integration', () => {\n  let accessToken;\n  let tenantId;\n  let userId;\n\n  beforeAll(async () => {\n    // \u30c8\u30fc\u30af\u30f3\u53d6\u5f97\n    const tokenResponse = await axios.post('http://localhost:8080/oauth/token', {\n      grant_type: 'client_credentials',\n      client_id: 'admin-client',\n      client_secret: 'admin-secret',\n      scope: 'identity:verify'\n    });\n    accessToken = tokenResponse.data.access_token;\n\n    // \u30c6\u30ca\u30f3\u30c8\u30fb\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n    tenantId = uuidv4();\n    userId = uuidv4();\n  });\n\n  test('should verify user with external KYC service', async () => {\n    const response = await axios.post(\n      `http://localhost:8080/v1/identity/verification`,\n      {\n        user_id: userId,\n        name: 'John Doe',\n        email: 'john@example.com',\n        date_of_birth: '1990-01-01'\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${accessToken}`\n        }\n      }\n    );\n\n    expect(response.status).toBe(200);\n    expect(response.data).toHaveProperty('status', 'approved');\n    expect(response.data).toHaveProperty('verification_id');\n  });\n\n  test('should retry on 503 error', async () => {\n    const startTime = Date.now();\n\n    const response = await axios.post(\n      `http://localhost:8080/v1/identity/verification`,\n      {\n        user_id: userId,\n        name: 'Jane Doe',\n        email: 'jane@example.com',\n        date_of_birth: '1992-05-15'\n      },\n      {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n          'X-Test-Retry': 'true'  // Mockoon\u3067\u30ea\u30c8\u30e9\u30a4\u30c8\u30ea\u30ac\u30fc\n        }\n      }\n    );\n\n    const duration = Date.now() - startTime;\n\n    // \u30ea\u30c8\u30e9\u30a4\u5b9f\u884c\u78ba\u8a8d\uff08\u5408\u8a08\u5f85\u6a5f\u6642\u9593: 1 + 2 + 4 = 7\u79d2\u4ee5\u4e0a\uff09\n    expect(duration).toBeGreaterThanOrEqual(7000);\n    expect(response.status).toBe(200);\n  });\n});\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,s.jsx)(n.p,{children:"\u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u5b9f\u88c5\u524d\u306b\u4ee5\u4e0b\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,s.jsx)(n.h3,{id:"httprequest\u8a2d\u5b9a",children:"HttpRequest\u8a2d\u5b9a"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","URL\u6307\u5b9a"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HTTP\u30e1\u30bd\u30c3\u30c9\u6307\u5b9a\uff08GET/POST/PUT/DELETE\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30d8\u30c3\u30c0\u30fc\u8a2d\u5b9a\uff08Content-Type, Accept\u7b49\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30ea\u30af\u30a8\u30b9\u30c8\u30dc\u30c7\u30a3\u8a2d\u5b9a\uff08POST/PUT\uff09"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8a8d\u8a3c\u8a2d\u5b9a",children:"\u8a8d\u8a3c\u8a2d\u5b9a"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","OAuth 2.0\u8a2d\u5b9a\uff08\u30c8\u30fc\u30af\u30f3\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u3001Client ID/Secret\u3001\u30b9\u30b3\u30fc\u30d7\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","HMAC\u8a2d\u5b9a\uff08\u79d8\u5bc6\u9375\u3001\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u8a8d\u8a3c\u306a\u3057\uff08\u516c\u958bAPI\uff09"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a",children:"\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u6700\u5927\u30ea\u30c8\u30e9\u30a4\u56de\u6570"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30ea\u30c8\u30e9\u30a4\u5bfe\u8c61\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9\uff08502, 503, 504\u7b49\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30d0\u30c3\u30af\u30aa\u30d5\u9045\u5ef6\uff08\u6307\u6570\u30d0\u30c3\u30af\u30aa\u30d5\u63a8\u5968\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u51aa\u7b49\u6027\u4fdd\u8a3c\uff08",(0,s.jsx)(n.code,{children:"idempotencyRequired"}),"\uff09"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0",children:"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,s.jsx)(n.code,{children:"HttpRequestResult.isSuccess()"}),"\u30c1\u30a7\u30c3\u30af"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30ec\u30b9\u30dd\u30f3\u30b9\u89e3\u6790\uff08JSON \u2192 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\uff09"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u30a8\u30e9\u30fc\u30ec\u30b9\u30dd\u30f3\u30b9\u51e6\u7406"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",children:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc"}),"\n",(0,s.jsx)(n.h3,{id:"\u30a8\u30e9\u30fc1-\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\u306a\u3057",children:"\u30a8\u30e9\u30fc1: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\u306a\u3057"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u274c \u9593\u9055\u3044: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\u306a\u3057\uff08\u7121\u9650\u5f85\u6a5f\u30ea\u30b9\u30af\uff09\nHttpRequestExecutionConfig executionConfig = HttpRequestExecutionConfig.builder()\n    .httpRequest(httpRequest)\n    .build();\n\n// \u2705 \u6b63\u3057\u3044: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u8a2d\u5b9a\nHttpRequestExecutionConfig executionConfig = HttpRequestExecutionConfig.builder()\n    .httpRequest(httpRequest)\n    .timeout(Duration.ofSeconds(30))  // \u2705 30\u79d2\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\n    .build();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u30a8\u30e9\u30fc2-\u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a\u8aa4\u308a",children:"\u30a8\u30e9\u30fc2: \u30ea\u30c8\u30e9\u30a4\u8a2d\u5b9a\u8aa4\u308a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u274c \u9593\u9055\u3044: \u51aa\u7b49\u6027\u4fdd\u8a3c\u306a\u3057\u3067POST\u30ea\u30c8\u30e9\u30a4\uff08\u91cd\u8907\u30ea\u30b9\u30af\uff09\nRetryConfiguration retryConfig = RetryConfiguration.builder()\n    .maxRetries(3)\n    .retryableStatusCodes(Set.of(502, 503, 504))\n    .idempotencyRequired(false)  // \u274c POST/PUT/DELETE\u3067\u5371\u967a\n    .build();\n\n// \u2705 \u6b63\u3057\u3044: \u51aa\u7b49\u6027\u4fdd\u8a3c\u4ed8\u304d\nRetryConfiguration retryConfig = RetryConfiguration.builder()\n    .maxRetries(3)\n    .retryableStatusCodes(Set.of(502, 503, 504))\n    .idempotencyRequired(true)  // \u2705 Idempotency-Key\u81ea\u52d5\u4ed8\u4e0e\n    .build();\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,s.jsx)(n.p,{children:"\u2705 \u5916\u90e8\u30b5\u30fc\u30d3\u30b9\u9023\u643a\u3092\u30de\u30b9\u30bf\u30fc\u3057\u305f\uff01"}),"\n",(0,s.jsx)(n.h3,{id:"-\u6b21\u306b\u8aad\u3080\u3079\u304d\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\ud83d\udcd6 \u6b21\u306b\u8aad\u3080\u3079\u304d\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/idp-server/docs/content_06_developer-guide/DEVELOPER_GUIDE_TOC#phase-3-%E6%97%A2%E5%AD%98%E6%A9%9F%E8%83%BD%E3%82%AC%E3%82%A4%E3%83%89%E6%8B%A1%E5%85%85%E6%B8%88%E3%81%BF",children:"Phase 3: \u65e2\u5b58\u30d5\u30a1\u30a4\u30eb\u62e1\u5145"})," - \u6280\u8853\u8a73\u7d30\u30ea\u30f3\u30af\u8ffd\u52a0"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-\u8a73\u7d30\u60c5\u5831",children:"\ud83d\udd17 \u8a73\u7d30\u60c5\u5831"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../content_10_ai_developer/ai-12-platform.md#httprequestexecutor---http%E9%80%9A%E4%BF%A1",children:"AI\u958b\u767a\u8005\u5411\u3051: Platform - HttpRequestExecutor"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../developer-guide/http-request-executor.md",children:"developer-guide: HTTP Request Executor\u8a73\u7d30"})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),": ",(0,s.jsx)(n.a,{href:"../../../libs/idp-server-platform/src/main/java/org/idp/server/platform/httpclient/HttpRequestExecutor.java",children:"HttpRequestExecutor.java"}),"\n",(0,s.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-12"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(96540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);