"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6734],{45355:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"content_06_developer-guide/implementation-guides/impl-19-jose-handler","title":"JOSE\uff08JWT/JWS/JWE\uff09\u51e6\u7406\u5b9f\u88c5\u30ac\u30a4\u30c9","description":"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684","source":"@site/docs/content_06_developer-guide/04-implementation-guides/impl-19-jose-handler.md","sourceDirName":"content_06_developer-guide/04-implementation-guides","slug":"/content_06_developer-guide/implementation-guides/impl-19-jose-handler","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-19-jose-handler","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_06_developer-guide/04-implementation-guides/impl-19-jose-handler.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Spring Session\u7d71\u5408\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-18-spring-session"},"next":{"title":"Mapping Functions \u958b\u767a\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_06_developer-guide/implementation-guides/impl-20-mapping-functions"}}');var r=s(74848),t=s(28453);const l={},d="JOSE\uff08JWT/JWS/JWE\uff09\u51e6\u7406\u5b9f\u88c5\u30ac\u30a4\u30c9",c={},a=[{value:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",level:2},{value:"\u6240\u8981\u6642\u9593",id:"\u6240\u8981\u6642\u9593",level:3},{value:"\u524d\u63d0\u77e5\u8b58",id:"\u524d\u63d0\u77e5\u8b58",level:3},{value:"JOSE\u3068\u306f",id:"jose\u3068\u306f",level:2},{value:"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea",id:"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea",level:2},{value:"JoseHandler\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",id:"josehandler\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",level:2},{value:"30\u79d2\u3067\u7406\u89e3\u3059\u308b\u5168\u4f53\u50cf",id:"30\u79d2\u3067\u7406\u89e3\u3059\u308b\u5168\u4f53\u50cf",level:3},{value:"JoseHandler\u5b9f\u88c5",id:"josehandler\u5b9f\u88c5",level:2},{value:"\u30af\u30e9\u30b9\u69cb\u9020",id:"\u30af\u30e9\u30b9\u69cb\u9020",level:3},{value:"JoseType\u5224\u5b9a",id:"josetype\u5224\u5b9a",level:2},{value:"3\u7a2e\u985e\u306eJOSE\u5f62\u5f0f",id:"3\u7a2e\u985e\u306ejose\u5f62\u5f0f",level:3},{value:"JoseContext",id:"josecontext",level:2},{value:"\u5f79\u5272",id:"\u5f79\u5272",level:3},{value:"JWS\uff08\u7f72\u540d\u4ed8\u304dJWT\uff09\u51e6\u7406",id:"jws\u7f72\u540d\u4ed8\u304djwt\u51e6\u7406",level:2},{value:"JwsContextCreator",id:"jwscontextcreator",level:3},{value:"\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",id:"\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",level:2},{value:"\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",id:"\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",level:3},{value:"\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u5171\u6709\u9375\uff09",id:"\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5171\u6709\u9375",level:4},{value:"\u975e\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u516c\u958b\u9375\u6697\u53f7\uff09",id:"\u975e\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u516c\u958b\u9375\u6697\u53f7",level:4},{value:"JsonWebSignature",id:"jsonwebsignature",level:2},{value:"\u7f72\u540d\u4ed8\u304dJWT\u306e\u51e6\u7406",id:"\u7f72\u540d\u4ed8\u304djwt\u306e\u51e6\u7406",level:3},{value:"JsonWebTokenClaims",id:"jsonwebtokenclaims",level:2},{value:"\u30af\u30ec\u30fc\u30e0\uff08\u30da\u30a4\u30ed\u30fc\u30c9\uff09\u306e\u51e6\u7406",id:"\u30af\u30ec\u30fc\u30e0\u30da\u30a4\u30ed\u30fc\u30c9\u306e\u51e6\u7406",level:3},{value:"\u7f72\u540d\u691c\u8a3c\u30d5\u30ed\u30fc",id:"\u7f72\u540d\u691c\u8a3c\u30d5\u30ed\u30fc",level:2},{value:"JwsContextCreator\u306e\u8a73\u7d30\u51e6\u7406",id:"jwscontextcreator\u306e\u8a73\u7d30\u51e6\u7406",level:3},{value:"\u4f7f\u7528\u4f8b",id:"\u4f7f\u7528\u4f8b",level:2},{value:"ID Token\u691c\u8a3c",id:"id-token\u691c\u8a3c",level:3},{value:"Access Token\u751f\u6210",id:"access-token\u751f\u6210",level:3},{value:"JWK\uff08JSON Web Key\uff09",id:"jwkjson-web-key",level:2},{value:"\u516c\u958b\u9375\u306e\u8868\u73fe\u5f62\u5f0f",id:"\u516c\u958b\u9375\u306e\u8868\u73fe\u5f62\u5f0f",level:3},{value:"\u3088\u304f\u3042\u308b\u4f7f\u7528\u30d1\u30bf\u30fc\u30f3",id:"\u3088\u304f\u3042\u308b\u4f7f\u7528\u30d1\u30bf\u30fc\u30f3",level:2},{value:"\u30d1\u30bf\u30fc\u30f31: ID Token\u691c\u8a3c\uff08\u5916\u90e8IdP\uff09",id:"\u30d1\u30bf\u30fc\u30f31-id-token\u691c\u8a3c\u5916\u90e8idp",level:3},{value:"\u30d1\u30bf\u30fc\u30f32: Request Object\u691c\u8a3c\uff08OIDC\uff09",id:"\u30d1\u30bf\u30fc\u30f32-request-object\u691c\u8a3coidc",level:3},{value:"\u30d1\u30bf\u30fc\u30f33: client_secret_jwt\u691c\u8a3c",id:"\u30d1\u30bf\u30fc\u30f33-client_secret_jwt\u691c\u8a3c",level:3},{value:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",level:2},{value:"\u30a8\u30e9\u30fc1: <code>JoseInvalidException</code> - \u7f72\u540d\u691c\u8a3c\u5931\u6557",id:"\u30a8\u30e9\u30fc1-joseinvalidexception---\u7f72\u540d\u691c\u8a3c\u5931\u6557",level:3},{value:"\u30a8\u30e9\u30fc2: <code>ParseException</code> - JWT\u89e3\u6790\u5931\u6557",id:"\u30a8\u30e9\u30fc2-parseexception---jwt\u89e3\u6790\u5931\u6557",level:3},{value:"\u30a8\u30e9\u30fc3: <code>JsonWebKeyNotFoundException</code> - \u9375\u304c\u898b\u3064\u304b\u3089\u306a\u3044",id:"\u30a8\u30e9\u30fc3-jsonwebkeynotfoundexception---\u9375\u304c\u898b\u3064\u304b\u3089\u306a\u3044",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2},{value:"\ud83d\udcd6 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:3},{value:"\ud83d\udd17 \u8a73\u7d30\u60c5\u5831",id:"-\u8a73\u7d30\u60c5\u5831",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"josejwtjwsjwe\u51e6\u7406\u5b9f\u88c5\u30ac\u30a4\u30c9",children:"JOSE\uff08JWT/JWS/JWE\uff09\u51e6\u7406\u5b9f\u88c5\u30ac\u30a4\u30c9"})}),"\n",(0,r.jsx)(n.h2,{id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWT/JWS/JWE"}),"\u306e\u751f\u6210\u30fb\u691c\u8a3c\u51e6\u7406\u3092\u7406\u89e3\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6240\u8981\u6642\u9593",children:"\u6240\u8981\u6642\u9593"}),"\n",(0,r.jsxs)(n.p,{children:["\u23f1\ufe0f ",(0,r.jsx)(n.strong,{children:"\u7d0430\u5206"})]}),"\n",(0,r.jsx)(n.h3,{id:"\u524d\u63d0\u77e5\u8b58",children:"\u524d\u63d0\u77e5\u8b58"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OAuth 2.0/OIDC\u57fa\u790e\u77e5\u8b58"}),"\n",(0,r.jsx)(n.li,{children:"JWT\uff08JSON Web Token\uff09\u57fa\u790e\u77e5\u8b58"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jose\u3068\u306f",children:"JOSE\u3068\u306f"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"JOSE (JSON Object Signing and Encryption)"})}),"\n",(0,r.jsx)(n.p,{children:"OAuth/OIDC\u3067\u4f7f\u7528\u3055\u308c\u308b\u6697\u53f7\u5316\u30fb\u7f72\u540d\u6280\u8853\u306e\u7dcf\u79f0\uff1a"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u6280\u8853"}),(0,r.jsx)(n.th,{children:"\u6b63\u5f0f\u540d\u79f0"}),(0,r.jsx)(n.th,{children:"\u7528\u9014"}),(0,r.jsx)(n.th,{children:"RFC"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"JWT"})}),(0,r.jsx)(n.td,{children:"JSON Web Token"}),(0,r.jsx)(n.td,{children:"\u30af\u30ec\u30fc\u30e0\uff08\u4e3b\u5f35\uff09\u306e\u8868\u73fe"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519",children:"RFC 7519"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"JWS"})}),(0,r.jsx)(n.td,{children:"JSON Web Signature"}),(0,r.jsx)(n.td,{children:"JWT\u3078\u306e\u7f72\u540d"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7515",children:"RFC 7515"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"JWE"})}),(0,r.jsx)(n.td,{children:"JSON Web Encryption"}),(0,r.jsx)(n.td,{children:"JWT\u306e\u6697\u53f7\u5316"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7516",children:"RFC 7516"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"JWK"})}),(0,r.jsx)(n.td,{children:"JSON Web Key"}),(0,r.jsx)(n.td,{children:"\u9375\u306e\u8868\u73fe"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7517",children:"RFC 7517"})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"idp-server\u3067\u306e\u4f7f\u7528\u4f8b"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Token"}),": JWT/JWS\uff08\u7f72\u540d\u4ed8\u304d\u30c8\u30fc\u30af\u30f3\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ID Token"}),": JWT/JWS\uff08\u7f72\u540d\u4ed8\u304d\u30c8\u30fc\u30af\u30f3\uff09"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Refresh Token"}),": JWT/JWS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Request Object"}),": JWT/JWS\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u9001\u4fe1\u3059\u308b\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea",children:"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"idp-server\u306f\u5177\u4f53\u7684\u306aJOSE\u51e6\u7406\u3092\u5916\u90e8\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u59d4\u8b72"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u30e9\u30a4\u30d6\u30e9\u30ea"}),(0,r.jsx)(n.th,{children:"\u30d0\u30fc\u30b8\u30e7\u30f3"}),(0,r.jsx)(n.th,{children:"\u7528\u9014"}),(0,r.jsx)(n.th,{children:"\u516c\u5f0f\u30b5\u30a4\u30c8"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Nimbus JOSE + JWT"})}),(0,r.jsx)(n.td,{children:"9.x+"}),(0,r.jsx)(n.td,{children:"JWT/JWS/JWE\u751f\u6210\u30fb\u691c\u8a3c\u30fb\u89e3\u6790"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"https://connect2id.com/products/nimbus-jose-jwt",children:"connect2id.com/products/nimbus-jose-jwt"})})]})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u4f9d\u5b58\u95a2\u4fc2"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-gradle",children:"implementation 'com.nimbusds:nimbus-jose-jwt:9.x'\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Nimbus JOSE + JWT\u306e\u5f79\u5272"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 JWT/JWS/JWE \u306e\u89e3\u6790\uff08parse\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u7f72\u540d\u751f\u6210\u30fb\u691c\u8a3c\uff08sign/verify\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u6697\u53f7\u5316\u30fb\u5fa9\u53f7\uff08encrypt/decrypt\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 JWKS\u89e3\u6790"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u9375\u751f\u6210\uff08RSA/ECDSA\u7b49\uff09"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"idp-server\u306eJoseHandler\u306e\u5f79\u5272"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Nimbus JOSE + JWT\u306e\u30e9\u30c3\u30d1\u30fc"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u578b\u5224\u5b9a\uff08JWT/JWS/JWE\uff09\u306e\u81ea\u52d5\u5316"}),"\n",(0,r.jsxs)(n.li,{children:["\u2705 idp-server\u56fa\u6709\u306e\u4f8b\u5916\u51e6\u7406\uff08",(0,r.jsx)(n.code,{children:"JoseInvalidException"}),"\uff09"]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u9375\u9078\u629e\u30ed\u30b8\u30c3\u30af\uff08kid\u691c\u7d22\u3001\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5224\u5b9a\uff09"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u306a\u305c\u30e9\u30c3\u30d1\u30fc\u304c\u5fc5\u8981\u304b"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Nimbus JOSE + JWT\u306f\u6c4e\u7528\u30e9\u30a4\u30d6\u30e9\u30ea\uff08\u4f4e\u30ec\u30d9\u30ebAPI\uff09"}),"\n",(0,r.jsx)(n.li,{children:"idp-server\u306e\u7528\u9014\u306b\u7279\u5316\u3057\u305f\u9ad8\u30ec\u30d9\u30ebAPI\u3092\u63d0\u4f9b"}),"\n",(0,r.jsxs)(n.li,{children:["\u4f8b\u5916\u51e6\u7406\u306e\u7d71\u4e00\uff08",(0,r.jsx)(n.code,{children:"JOSEException"})," \u2192 ",(0,r.jsx)(n.code,{children:"JoseInvalidException"}),"\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"josehandler\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3",children:"JoseHandler\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3"}),"\n",(0,r.jsx)(n.h3,{id:"30\u79d2\u3067\u7406\u89e3\u3059\u308b\u5168\u4f53\u50cf",children:"30\u79d2\u3067\u7406\u89e3\u3059\u308b\u5168\u4f53\u50cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"JOSE\u6587\u5b57\u5217\uff08JWT/JWS/JWE\uff09\n    \u2193\nJoseHandler.handle()\n    \u2193\nJoseType\u5224\u5b9a\uff08plain/signature/encryption\uff09\n    \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 JoseContextCreator\u3092\u9078\u629e\uff08Plugin\uff09\u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 plain      \u2192 JwtContextCreator   \u2502\n\u2502 signature  \u2192 JwsContextCreator   \u2502\n\u2502 encryption \u2192 JweContextCreator   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2193\nJoseContext\n    \u251c\u2500 JsonWebSignature\uff08\u7f72\u540d\u60c5\u5831\uff09\n    \u251c\u2500 JsonWebTokenClaims\uff08\u30af\u30ec\u30fc\u30e0\uff09\n    \u251c\u2500 JsonWebSignatureVerifier\uff08\u691c\u8a3c\u5668\uff09\n    \u2514\u2500 JsonWebKey\uff08\u9375\u60c5\u5831\uff09\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(58566).A+"",children:"JoseHandler.java"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"josehandler\u5b9f\u88c5",children:"JoseHandler\u5b9f\u88c5"}),"\n",(0,r.jsx)(n.h3,{id:"\u30af\u30e9\u30b9\u69cb\u9020",children:"\u30af\u30e9\u30b9\u69cb\u9020"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5\u5834\u6240"}),": ",(0,r.jsx)(n.code,{children:"libs/idp-server-platform/src/main/java/org/idp/server/platform/jose/"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JoseHandler {\n\n  Map<JoseType, JoseContextCreator> creators;\n\n  public JoseHandler() {\n    creators = new HashMap<>();\n    creators.put(JoseType.plain, new JwtContextCreator());         // \u7f72\u540d\u306a\u3057JWT\n    creators.put(JoseType.signature, new JwsContextCreator());     // \u7f72\u540d\u4ed8\u304dJWT\n    creators.put(JoseType.encryption, new JweContextCreator());    // \u6697\u53f7\u5316JWT\n  }\n\n  public JoseContext handle(String jose, String publicJwks, String privateJwks, String secret)\n      throws JoseInvalidException {\n\n    // 1. JoseType\u5224\u5b9a\uff08JWT/JWS/JWE\uff09\n    JoseType joseType = JoseType.parse(jose);\n\n    // 2. Creator\u9078\u629e\uff08Plugin\u30d1\u30bf\u30fc\u30f3\uff09\n    JoseContextCreator joseContextCreator = creators.get(joseType);\n\n    // 3. JoseContext\u751f\u6210\n    return joseContextCreator.create(jose, publicJwks, privateJwks, secret);\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30dd\u30a4\u30f3\u30c8"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u2705 Plugin\u30d1\u30bf\u30fc\u30f3\uff08",(0,r.jsx)(n.code,{children:"Map<JoseType, JoseContextCreator>"}),"\uff09"]}),"\n",(0,r.jsx)(n.li,{children:"\u2705 3\u7a2e\u985e\u306eCreator\uff08JWT/JWS/JWE\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 \u9375\u60c5\u5831\u3092\u5f15\u6570\u3067\u53d7\u3051\u53d6\u308b\uff08publicJwks, privateJwks, secret\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"josetype\u5224\u5b9a",children:"JoseType\u5224\u5b9a"}),"\n",(0,r.jsx)(n.h3,{id:"3\u7a2e\u985e\u306ejose\u5f62\u5f0f",children:"3\u7a2e\u985e\u306eJOSE\u5f62\u5f0f"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(32458).A+"",children:"JoseType.java"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public enum JoseType {\n  plain,       // JWT\uff08\u7f72\u540d\u306a\u3057\uff09 - \u975e\u63a8\u5968\uff08\u30c6\u30b9\u30c8\u7528\u9014\u306e\u307f\uff09\n  signature,   // JWS\uff08\u7f72\u540d\u4ed8\u304dJWT\uff09 - \u63a8\u5968\n  encryption;  // JWE\uff08\u6697\u53f7\u5316JWT\uff09 - \u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\n\n  public static JoseType parse(String jose) {\n    String[] parts = jose.split("\\\\.");\n\n    if (parts.length == 3) {\n      return signature;  // JWS\u5f62\u5f0f: header.payload.signature\n    } else if (parts.length == 5) {\n      return encryption; // JWE\u5f62\u5f0f: header.encrypted_key.iv.ciphertext.tag\n    }\n\n    return plain;  // \u305d\u306e\u4ed6\u306fplain JWT\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5224\u5b9a\u30ed\u30b8\u30c3\u30af"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"3\u30d1\u30fc\u30c8"}),": JWS\uff08\u7f72\u540d\u4ed8\u304d\uff09 - ",(0,r.jsx)(n.code,{children:"header.payload.signature"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"5\u30d1\u30fc\u30c8"}),": JWE\uff08\u6697\u53f7\u5316\uff09 - ",(0,r.jsx)(n.code,{children:"header.encrypted_key.iv.ciphertext.tag"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u305d\u306e\u4ed6"}),": Plain JWT\uff08\u7f72\u540d\u306a\u3057\u3001\u975e\u63a8\u5968\uff09"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"josecontext",children:"JoseContext"}),"\n",(0,r.jsx)(n.h3,{id:"\u5f79\u5272",children:"\u5f79\u5272"}),"\n",(0,r.jsx)(n.p,{children:"JOSE\u306e\u89e3\u6790\u7d50\u679c\u3092\u4fdd\u6301\u3059\u308b\u30b3\u30f3\u30c6\u30ca\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(68665).A+"",children:"JoseContext.java"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JoseContext {\n\n  JsonWebSignature jsonWebSignature;  // \u7f72\u540d\u60c5\u5831\n  JsonWebTokenClaims claims;          // \u30af\u30ec\u30fc\u30e0\uff08\u30da\u30a4\u30ed\u30fc\u30c9\uff09\n  JsonWebSignatureVerifier jwsVerifier;  // \u7f72\u540d\u691c\u8a3c\u5668\n  JsonWebKey jsonWebKey;              // \u4f7f\u7528\u3055\u308c\u305f\u9375\n\n  // \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n  public JsonWebTokenClaims claims() {\n    return claims;\n  }\n\n  public Map<String, Object> claimsAsMap() {\n    return claims.toMap();\n  }\n\n  // \u7f72\u540d\u691c\u8a3c\n  public void verifySignature() throws JoseInvalidException {\n    if (hasJsonWebSignature()) {\n      jwsVerifier.verify(jsonWebSignature);\n    }\n  }\n\n  // \u7f72\u540d\u306e\u6709\u7121\u78ba\u8a8d\n  public boolean hasJsonWebSignature() {\n    return jsonWebSignature.exists();\n  }\n\n  // \u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5224\u5b9a\n  public boolean isSymmetricKey() {\n    return jsonWebSignature.isSymmetricType();  // HS256/HS384/HS512\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528\u4f8b"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// JOSE\u6587\u5b57\u5217\u3092\u89e3\u6790\nJoseHandler handler = new JoseHandler();\nJoseContext context = handler.handle(\n    jwtString,\n    publicJwks,   // \u516c\u958b\u9375JWKS\uff08RS256\u7b49\uff09\n    privateJwks,  // \u79d8\u5bc6\u9375JWKS\uff08\u5fa9\u53f7\u7528\uff09\n    secret);      // \u5171\u6709\u9375\uff08HS256\u7b49\uff09\n\n// \u7f72\u540d\u691c\u8a3c\ncontext.verifySignature();\n\n// \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\nMap<String, Object> claims = context.claimsAsMap();\nString sub = (String) claims.get("sub");\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jws\u7f72\u540d\u4ed8\u304djwt\u51e6\u7406",children:"JWS\uff08\u7f72\u540d\u4ed8\u304dJWT\uff09\u51e6\u7406"}),"\n",(0,r.jsx)(n.h3,{id:"jwscontextcreator",children:"JwsContextCreator"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(30438).A+"",children:"JwsContextCreator.java"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JwsContextCreator implements JoseContextCreator {\n\n  @Override\n  public JoseContext create(String jose, String publicJwks, String privateJwks, String secret)\n      throws JoseInvalidException {\n\n    // 1. JWS\u89e3\u6790\n    JsonWebSignature jsonWebSignature = JsonWebSignature.parse(jose);\n\n    // 2. Header\u89e3\u6790\n    JsonWebSignatureHeader header = jsonWebSignature.header();\n    JsonWebSignatureAlgorithm algorithm = header.algorithm();\n    String keyId = header.keyId();\n\n    // 3. \u9375\u9078\u629e\uff08\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306b\u5fdc\u3058\u3066\uff09\n    JsonWebKey jsonWebKey;\n    if (algorithm.isSymmetric()) {\n      // \u5bfe\u79f0\u9375\uff08HS256/HS384/HS512\uff09\n      jsonWebKey = JsonWebKey.parseFromSecret(secret);\n    } else {\n      // \u975e\u5bfe\u79f0\u9375\uff08RS256/ES256\u7b49\uff09\n      JsonWebKeys jsonWebKeys = JsonWebKeys.parse(publicJwks);\n      jsonWebKey = jsonWebKeys.get(keyId);  // kid \u3067\u9375\u3092\u9078\u629e\n    }\n\n    // 4. Verifier\u4f5c\u6210\n    JsonWebSignatureVerifier verifier =\n        JsonWebSignatureVerifierFactory.create(jsonWebKey, algorithm);\n\n    // 5. \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n    JsonWebTokenClaims claims = jsonWebSignature.claims();\n\n    // 6. JoseContext\u751f\u6210\n    return new JoseContext(jsonWebSignature, claims, verifier, jsonWebKey);\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u51e6\u7406\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"JWS\u6587\u5b57\u5217\n    \u2193\n1. \u89e3\u6790\uff08header.payload.signature \u306b\u5206\u5272\uff09\n2. Header\u89e3\u6790\uff08alg, kid\u53d6\u5f97\uff09\n3. \u9375\u9078\u629e\n   - HS256\u7b49 \u2192 secret\u4f7f\u7528\n   - RS256\u7b49 \u2192 publicJwks \u304b\u3089 kid \u3067\u691c\u7d22\n4. Verifier\u4f5c\u6210\n5. \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n    \u2193\nJoseContext\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",children:"\u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),"\n",(0,r.jsx)(n.h3,{id:"\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0",children:"\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u308b\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(78232).A+"",children:"JsonWebSignatureAlgorithm.java"})]}),"\n",(0,r.jsx)(n.h4,{id:"\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5171\u6709\u9375",children:"\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u5171\u6709\u9375\uff09"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,r.jsx)(n.th,{children:"\u8aac\u660e"}),(0,r.jsx)(n.th,{children:"\u9375\u9577"}),(0,r.jsx)(n.th,{children:"\u7528\u9014"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"HS256"})}),(0,r.jsx)(n.td,{children:"HMAC SHA-256"}),(0,r.jsx)(n.td,{children:"256bit"}),(0,r.jsx)(n.td,{children:"Client Secret JWT"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"HS384"})}),(0,r.jsx)(n.td,{children:"HMAC SHA-384"}),(0,r.jsx)(n.td,{children:"384bit"}),(0,r.jsx)(n.td,{children:"-"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"HS512"})}),(0,r.jsx)(n.td,{children:"HMAC SHA-512"}),(0,r.jsx)(n.td,{children:"512bit"}),(0,r.jsx)(n.td,{children:"-"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u7279\u5fb4"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u540c\u3058\u9375\u3067\u7f72\u540d\u30fb\u691c\u8a3c"}),"\n",(0,r.jsx)(n.li,{children:"\u901f\u3044"}),"\n",(0,r.jsx)(n.li,{children:"\u9375\u5171\u6709\u304c\u5fc5\u8981\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ea\u30b9\u30af\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"\u975e\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u516c\u958b\u9375\u6697\u53f7",children:"\u975e\u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08\u516c\u958b\u9375\u6697\u53f7\uff09"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,r.jsx)(n.th,{children:"\u8aac\u660e"}),(0,r.jsx)(n.th,{children:"\u9375\u9577"}),(0,r.jsx)(n.th,{children:"\u7528\u9014"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RS256"})}),(0,r.jsx)(n.td,{children:"RSA SHA-256"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"ID Token\u7f72\u540d\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RS384"})}),(0,r.jsx)(n.td,{children:"RSA SHA-384"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:"-"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"RS512"})}),(0,r.jsx)(n.td,{children:"RSA SHA-512"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:"-"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"ES256"})}),(0,r.jsx)(n.td,{children:"ECDSA P-256 SHA-256"}),(0,r.jsx)(n.td,{children:"256bit"}),(0,r.jsx)(n.td,{children:"\u9ad8\u901f\u30fb\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"ES384"})}),(0,r.jsx)(n.td,{children:"ECDSA P-384 SHA-384"}),(0,r.jsx)(n.td,{children:"384bit"}),(0,r.jsx)(n.td,{children:"-"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"ES512"})}),(0,r.jsx)(n.td,{children:"ECDSA P-521 SHA-512"}),(0,r.jsx)(n.td,{children:"521bit"}),(0,r.jsx)(n.td,{children:"\u6700\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"PS256"})}),(0,r.jsx)(n.td,{children:"RSA-PSS SHA-256"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:"FAPI\u63a8\u5968"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"PS384"})}),(0,r.jsx)(n.td,{children:"RSA-PSS SHA-384"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:"-"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"PS512"})}),(0,r.jsx)(n.td,{children:"RSA-PSS SHA-512"}),(0,r.jsx)(n.td,{children:"2048bit+"}),(0,r.jsx)(n.td,{children:"-"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u7279\u5fb4"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u79d8\u5bc6\u9375\u3067\u7f72\u540d\u3001\u516c\u958b\u9375\u3067\u691c\u8a3c"}),"\n",(0,r.jsx)(n.li,{children:"\u9375\u5171\u6709\u4e0d\u8981\uff08\u516c\u958b\u9375\u306f\u914d\u5e03\u53ef\u80fd\uff09"}),"\n",(0,r.jsx)(n.li,{children:"OIDC\u6a19\u6e96\uff08RS256\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jsonwebsignature",children:"JsonWebSignature"}),"\n",(0,r.jsx)(n.h3,{id:"\u7f72\u540d\u4ed8\u304djwt\u306e\u51e6\u7406",children:"\u7f72\u540d\u4ed8\u304dJWT\u306e\u51e6\u7406"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(90935).A+"",children:"JsonWebSignature.java"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30e9\u30a4\u30d6\u30e9\u30ea\u59d4\u8b72"}),": Nimbus JOSE + JWT\u306e",(0,r.jsx)(n.code,{children:"SignedJWT"}),"\u30af\u30e9\u30b9\u3092\u30e9\u30c3\u30d7"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JsonWebSignature {\n\n  SignedJWT value;  // Nimbus JOSE + JWT\u306eSignedJWT\uff08\u5b9f\u969b\u306e\u51e6\u7406\u306f\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5b9f\u884c\uff09\n\n  // JWS\u6587\u5b57\u5217\u3092\u89e3\u6790\uff08Nimbus JOSE + JWT\u306b\u59d4\u8b72\uff09\n  public static JsonWebSignature parse(String jose) throws JoseInvalidException {\n    try {\n      SignedJWT signedJWT = SignedJWT.parse(jose);  // \u2190 Nimbus JOSE + JWT\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u51e6\u7406\n      return new JsonWebSignature(signedJWT);\n    } catch (ParseException e) {\n      throw new JoseInvalidException(e.getMessage(), e);\n    }\n  }\n\n  // \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n  public JsonWebTokenClaims claims() {\n    JWTClaimsSet jwtClaimsSet = value.getJWTClaimsSet();\n    return new JsonWebTokenClaims(jwtClaimsSet);\n  }\n\n  // \u7f72\u540d\u691c\u8a3c\uff08Nimbus JOSE + JWT\u306b\u59d4\u8b72\uff09\n  boolean verify(JWSVerifier verifier) throws JoseInvalidException {\n    try {\n      return value.verify(verifier);  // \u2190 Nimbus JOSE + JWT\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u51e6\u7406\n    } catch (JOSEException e) {\n      throw new JoseInvalidException(e.getMessage(), e);\n    }\n  }\n\n  // \u5bfe\u79f0\u9375\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5224\u5b9a\n  public boolean isSymmetricType() {\n    JWSAlgorithm algorithm = value.getHeader().getAlgorithm();\n    return algorithm.equals(JWSAlgorithm.HS256)\n        || algorithm.equals(JWSAlgorithm.HS384)\n        || algorithm.equals(JWSAlgorithm.HS512);\n  }\n\n  // Key ID\u53d6\u5f97\n  public String keyId() {\n    return value.getHeader().getKeyID();\n  }\n\n  // \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u53d6\u5f97\n  public String algorithm() {\n    return value.getHeader().getAlgorithm().getName();\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWS\u5f62\u5f0f"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImtleS0xIn0.\neyJzdWIiOiJ1c2VyLTEyMzQ1IiwiaWF0IjoxNjk1NTUyMDAwLCJleHAiOjE2OTU1NTU2MDB9.\nsignature_base64url\n\n\u2193 \u5206\u89e3\n\nHeader (Base64URL):\n{\n  "alg": "RS256",  \u2190 \u7f72\u540d\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\n  "typ": "JWT",\n  "kid": "key-1"   \u2190 Key ID\uff08JWKS\u304b\u3089\u9375\u3092\u691c\u7d22\uff09\n}\n\nPayload (Base64URL):\n{\n  "sub": "user-12345",\n  "iat": 1695552000,\n  "exp": 1695555600\n}\n\nSignature (Base64URL):\nRS256(Header + "." + Payload, privateKey)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jsonwebtokenclaims",children:"JsonWebTokenClaims"}),"\n",(0,r.jsx)(n.h3,{id:"\u30af\u30ec\u30fc\u30e0\u30da\u30a4\u30ed\u30fc\u30c9\u306e\u51e6\u7406",children:"\u30af\u30ec\u30fc\u30e0\uff08\u30da\u30a4\u30ed\u30fc\u30c9\uff09\u306e\u51e6\u7406"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(81461).A+"",children:"JsonWebTokenClaims.java"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30e9\u30a4\u30d6\u30e9\u30ea\u59d4\u8b72"}),": Nimbus JOSE + JWT\u306e",(0,r.jsx)(n.code,{children:"JWTClaimsSet"}),"\u30af\u30e9\u30b9\u3092\u30e9\u30c3\u30d7"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JsonWebTokenClaims {\n\n  JWTClaimsSet value;  // Nimbus JOSE + JWT\u306eJWTClaimsSet\uff08\u5b9f\u969b\u306e\u51e6\u7406\u306f\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5b9f\u884c\uff09\n\n  // \u6a19\u6e96\u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n  public String subject() {\n    return value.getSubject();\n  }\n\n  public String issuer() {\n    return value.getIssuer();\n  }\n\n  public List<String> audience() {\n    return value.getAudience();\n  }\n\n  public Date expirationTime() {\n    return value.getExpirationTime();\n  }\n\n  public Date issuedAt() {\n    return value.getIssueTime();\n  }\n\n  // \u30ab\u30b9\u30bf\u30e0\u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n  public Object getClaim(String key) {\n    return value.getClaim(key);\n  }\n\n  // \u3059\u3079\u3066\u306e\u30af\u30ec\u30fc\u30e0\u3092Map\u3067\u53d6\u5f97\n  public Map<String, Object> toMap() {\n    return value.getClaims();\n  }\n\n  // \u30af\u30ec\u30fc\u30e0\u306e\u5b58\u5728\u78ba\u8a8d\n  public boolean exists() {\n    return Objects.nonNull(value) && !value.getClaims().isEmpty();\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6a19\u6e96\u30af\u30ec\u30fc\u30e0\uff08RFC 7519\uff09"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u30af\u30ec\u30fc\u30e0"}),(0,r.jsx)(n.th,{children:"\u8aac\u660e"}),(0,r.jsx)(n.th,{children:"\u5fc5\u9808"}),(0,r.jsx)(n.th,{children:"\u4f8b"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"sub"})}),(0,r.jsx)(n.td,{children:"Subject\uff08\u30e6\u30fc\u30b6\u30fcID\uff09"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"user-12345"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"iss"})}),(0,r.jsx)(n.td,{children:"Issuer\uff08\u767a\u884c\u8005\uff09"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"https://idp.example.com"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"aud"})}),(0,r.jsx)(n.td,{children:"Audience\uff08\u5bfe\u8c61\uff09"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'["client-app-123"]'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"exp"})}),(0,r.jsx)(n.td,{children:"Expiration Time\uff08\u6709\u52b9\u671f\u9650\uff09"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"1695555600"})," (Unix\u6642\u523b)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"iat"})}),(0,r.jsx)(n.td,{children:"Issued At\uff08\u767a\u884c\u6642\u523b\uff09"}),(0,r.jsx)(n.td,{children:"\u63a8\u5968"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1695552000"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"nbf"})}),(0,r.jsx)(n.td,{children:"Not Before\uff08\u6709\u52b9\u958b\u59cb\u6642\u523b\uff09"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1695552000"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"jti"})}),(0,r.jsx)(n.td,{children:"JWT ID\uff08\u4e00\u610f\u8b58\u5225\u5b50\uff09"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"jwt-uuid-abc"'})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30ab\u30b9\u30bf\u30e0\u30af\u30ec\u30fc\u30e0\u4f8b\uff08ID Token\uff09"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "user-12345",\n  "iss": "https://idp.example.com",\n  "aud": ["client-app"],\n  "exp": 1695555600,\n  "iat": 1695552000,\n  "nonce": "random-nonce-xyz",  \u2190 \u30ab\u30b9\u30bf\u30e0\n  "at_hash": "abc123...",        \u2190 \u30ab\u30b9\u30bf\u30e0\uff08Access Token\u30cf\u30c3\u30b7\u30e5\uff09\n  "c_hash": "def456..."          \u2190 \u30ab\u30b9\u30bf\u30e0\uff08Code\u30cf\u30c3\u30b7\u30e5\uff09\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u7f72\u540d\u691c\u8a3c\u30d5\u30ed\u30fc",children:"\u7f72\u540d\u691c\u8a3c\u30d5\u30ed\u30fc"}),"\n",(0,r.jsx)(n.h3,{id:"jwscontextcreator\u306e\u8a73\u7d30\u51e6\u7406",children:"JwsContextCreator\u306e\u8a73\u7d30\u51e6\u7406"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'JWS\u6587\u5b57\u5217: "eyJhbGc...eyJzdWI...signature"\n    \u2193\n1. JsonWebSignature.parse()\n   \u2514\u2500 SignedJWT\u89e3\u6790\uff08Nimbus JOSE\uff09\n    \u2193\n2. Header\u89e3\u6790\n   \u251c\u2500 alg: "RS256"\n   \u2514\u2500 kid: "key-1"\n    \u2193\n3. \u9375\u9078\u629e\n   \u251c\u2500 algorithm.isSymmetric()?\n   \u2502   YES \u2192 JsonWebKey.parseFromSecret(secret)\n   \u2502   NO  \u2192 JsonWebKeys.parse(publicJwks).get(kid)\n   \u2514\u2500 JsonWebKey\u53d6\u5f97\n    \u2193\n4. Verifier\u4f5c\u6210\n   \u2514\u2500 JsonWebSignatureVerifierFactory.create(key, algorithm)\n      \u251c\u2500 RS256 \u2192 RSASSAVerifier\n      \u251c\u2500 ES256 \u2192 ECDSAVerifier\n      \u2514\u2500 HS256 \u2192 MACVerifier\n    \u2193\n5. \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\n   \u2514\u2500 jsonWebSignature.claims()\n    \u2193\nJoseContext {\n  jsonWebSignature,\n  claims,\n  verifier,\n  jsonWebKey\n}\n    \u2193\n6. \u7f72\u540d\u691c\u8a3c\u5b9f\u884c\uff08\u4f7f\u7528\u5074\u3067\uff09\n   context.verifySignature()\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u4f7f\u7528\u4f8b",children:"\u4f7f\u7528\u4f8b"}),"\n",(0,r.jsx)(n.h3,{id:"id-token\u691c\u8a3c",children:"ID Token\u691c\u8a3c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// ID Token\u691c\u8a3c\npublic void validateIdToken(String idTokenString, String publicJwks)\n    throws JoseInvalidException {\n\n  // 1. JoseHandler \u3067ID Token\u89e3\u6790\n  JoseHandler joseHandler = new JoseHandler();\n  JoseContext context = joseHandler.handle(\n      idTokenString,\n      publicJwks,   // \u516c\u958b\u9375JWKS\n      null,         // \u79d8\u5bc6\u9375\u4e0d\u8981\uff08\u691c\u8a3c\u306e\u307f\uff09\n      null);        // \u5171\u6709\u9375\u4e0d\u8981\uff08RS256\u4f7f\u7528\uff09\n\n  // 2. \u7f72\u540d\u691c\u8a3c\n  context.verifySignature();  // \u7f72\u540d\u304c\u4e0d\u6b63\u306a\u3089JoseInvalidException\n\n  // 3. \u30af\u30ec\u30fc\u30e0\u691c\u8a3c\n  Map<String, Object> claims = context.claimsAsMap();\n\n  // iss\u691c\u8a3c\n  String iss = (String) claims.get("iss");\n  if (!iss.equals("https://idp.example.com")) {\n    throw new JoseInvalidException("Invalid issuer");\n  }\n\n  // aud\u691c\u8a3c\n  List<String> aud = (List<String>) claims.get("aud");\n  if (!aud.contains(expectedClientId)) {\n    throw new JoseInvalidException("Invalid audience");\n  }\n\n  // exp\u691c\u8a3c\n  long exp = (Long) claims.get("exp");\n  if (System.currentTimeMillis() / 1000 > exp) {\n    throw new JoseInvalidException("Token expired");\n  }\n\n  // nonce\u691c\u8a3c\uff08OIDC\uff09\n  String nonce = (String) claims.get("nonce");\n  if (!nonce.equals(expectedNonce)) {\n    throw new JoseInvalidException("Invalid nonce");\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"access-token\u751f\u6210",children:"Access Token\u751f\u6210"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// Access Token\u751f\u6210\uff08JWS\u7f72\u540d\u4ed8\u304d\uff09\npublic String createAccessToken(\n    String sub,\n    List<String> scopes,\n    JsonWebKey privateKey) throws JoseInvalidException {\n\n  // 1. \u30af\u30ec\u30fc\u30e0\u4f5c\u6210\n  Map<String, Object> claims = new HashMap<>();\n  claims.put("sub", sub);\n  claims.put("iss", "https://idp.example.com");\n  claims.put("aud", Arrays.asList("api-server"));\n  claims.put("scope", String.join(" ", scopes));\n  claims.put("iat", System.currentTimeMillis() / 1000);\n  claims.put("exp", System.currentTimeMillis() / 1000 + 3600);  // 1\u6642\u9593\n\n  // 2. JWS\u751f\u6210\n  JsonWebSignatureFactory factory = new JsonWebSignatureFactory();\n  JsonWebSignature jws = factory.create(\n      claims,\n      privateKey,\n      JsonWebSignatureAlgorithm.RS256);\n\n  // 3. JWS\u6587\u5b57\u5217\u5316\n  return jws.serialize();\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jwkjson-web-key",children:"JWK\uff08JSON Web Key\uff09"}),"\n",(0,r.jsx)(n.h3,{id:"\u516c\u958b\u9375\u306e\u8868\u73fe\u5f62\u5f0f",children:"\u516c\u958b\u9375\u306e\u8868\u73fe\u5f62\u5f0f"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u5b9f\u88c5"}),": ",(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(21518).A+"",children:"JsonWebKey.java"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u30e9\u30a4\u30d6\u30e9\u30ea\u59d4\u8b72"}),": Nimbus JOSE + JWT\u306e",(0,r.jsx)(n.code,{children:"JWK"}),"/",(0,r.jsx)(n.code,{children:"JWKSet"}),"\u30af\u30e9\u30b9\u3092\u30e9\u30c3\u30d7"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class JsonWebKey {\n\n  JWK value;  // Nimbus JOSE + JWT\u306eJWK\uff08\u5b9f\u969b\u306e\u51e6\u7406\u306f\u3053\u306e\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u5b9f\u884c\uff09\n\n  // JWKS\u6587\u5b57\u5217\u304b\u3089\u89e3\u6790\n  public static JsonWebKeys parse(String jwks) {\n    JWKSet jwkSet = JWKSet.parse(jwks);\n    return new JsonWebKeys(jwkSet);\n  }\n\n  // Key ID\u53d6\u5f97\n  public String keyId() {\n    return value.getKeyID();\n  }\n\n  // \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u53d6\u5f97\n  public String algorithm() {\n    return value.getAlgorithm().getName();\n  }\n\n  // \u9375\u30bf\u30a4\u30d7\u5224\u5b9a\n  public boolean isRSA() {\n    return value instanceof RSAKey;\n  }\n\n  public boolean isEC() {\n    return value instanceof ECKey;\n  }\n\n  public boolean isOctetSequence() {\n    return value instanceof OctetSequenceKey;\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWKS\u5f62\u5f0f"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "keys": [\n    {\n      "kty": "RSA",\n      "kid": "key-1",\n      "use": "sig",\n      "alg": "RS256",\n      "n": "modulus_base64url",\n      "e": "exponent_base64url"\n    },\n    {\n      "kty": "EC",\n      "kid": "key-2",\n      "use": "sig",\n      "alg": "ES256",\n      "crv": "P-256",\n      "x": "x_coordinate_base64url",\n      "y": "y_coordinate_base64url"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u3088\u304f\u3042\u308b\u4f7f\u7528\u30d1\u30bf\u30fc\u30f3",children:"\u3088\u304f\u3042\u308b\u4f7f\u7528\u30d1\u30bf\u30fc\u30f3"}),"\n",(0,r.jsx)(n.h3,{id:"\u30d1\u30bf\u30fc\u30f31-id-token\u691c\u8a3c\u5916\u90e8idp",children:"\u30d1\u30bf\u30fc\u30f31: ID Token\u691c\u8a3c\uff08\u5916\u90e8IdP\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// \u30d5\u30a7\u30c7\u30ec\u30fc\u30b7\u30e7\u30f3\u3067\u306e\u5916\u90e8IdP\uff08Google\uff09\u306eID Token\u691c\u8a3c\nJoseHandler handler = new JoseHandler();\nJoseContext context = handler.handle(\n    googleIdToken,\n    googlePublicJwks,  // https://www.googleapis.com/oauth2/v3/certs\n    null,\n    null);\n\n// \u7f72\u540d\u691c\u8a3c\ncontext.verifySignature();\n\n// nonce\u691c\u8a3c\nMap<String, Object> claims = context.claimsAsMap();\nString nonce = (String) claims.get("nonce");\nif (!nonce.equals(ssoSession.nonce())) {\n  throw new JoseInvalidException("Nonce mismatch");\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"\u30d1\u30bf\u30fc\u30f32-request-object\u691c\u8a3coidc",children:"\u30d1\u30bf\u30fc\u30f32: Request Object\u691c\u8a3c\uff08OIDC\uff09"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u9001\u4fe1\u3057\u305fRequest Object\uff08JWT\uff09\u306e\u691c\u8a3c\nJoseHandler handler = new JoseHandler();\nJoseContext context = handler.handle(\n    requestObject,\n    clientPublicJwks,  // \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u516c\u958b\u9375JWKS\n    null,\n    null);\n\n// \u7f72\u540d\u691c\u8a3c\ncontext.verifySignature();\n\n// \u30af\u30ec\u30fc\u30e0\u53d6\u5f97\uff08\u30ea\u30af\u30a8\u30b9\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\nMap<String, Object> claims = context.claimsAsMap();\nString clientId = (String) claims.get("client_id");\nString redirectUri = (String) claims.get("redirect_uri");\nString scope = (String) claims.get("scope");\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"\u30d1\u30bf\u30fc\u30f33-client_secret_jwt\u691c\u8a3c",children:"\u30d1\u30bf\u30fc\u30f33: client_secret_jwt\u691c\u8a3c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\uff08client_secret_jwt\uff09\nJoseHandler handler = new JoseHandler();\nJoseContext context = handler.handle(\n    clientAssertion,\n    null,\n    null,\n    clientSecret);  // Client Secret\u3092\u5171\u6709\u9375\u3068\u3057\u3066\u4f7f\u7528\uff08HS256\uff09\n\n// \u7f72\u540d\u691c\u8a3c\ncontext.verifySignature();\n\n// \u30af\u30ec\u30fc\u30e0\u691c\u8a3c\nMap<String, Object> claims = context.claimsAsMap();\nString sub = (String) claims.get("sub");  // client_id\nString aud = (String) claims.get("aud");  // token endpoint\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",children:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc"}),"\n",(0,r.jsxs)(n.h3,{id:"\u30a8\u30e9\u30fc1-joseinvalidexception---\u7f72\u540d\u691c\u8a3c\u5931\u6557",children:["\u30a8\u30e9\u30fc1: ",(0,r.jsx)(n.code,{children:"JoseInvalidException"})," - \u7f72\u540d\u691c\u8a3c\u5931\u6557"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u539f\u56e0"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4e0d\u6b63\u306a\u7f72\u540d"}),"\n",(0,r.jsx)(n.li,{children:"\u9375\u306e\u4e0d\u4e00\u81f4\uff08kid\u304c\u898b\u3064\u304b\u3089\u306a\u3044\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306e\u4e0d\u4e00\u81f4"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// 1. kid\u78ba\u8a8d\nString kid = jsonWebSignature.keyId();\n\n// 2. JWKS \u306b kid \u304c\u5b58\u5728\u3059\u308b\u304b\u78ba\u8a8d\nJsonWebKeys jwks = JsonWebKeys.parse(publicJwks);\nif (!jwks.hasKey(kid)) {\n  throw new JsonWebKeyNotFoundException("Key not found: " + kid);\n}\n\n// 3. \u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u78ba\u8a8d\nString alg = jsonWebSignature.algorithm();  // "RS256"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h3,{id:"\u30a8\u30e9\u30fc2-parseexception---jwt\u89e3\u6790\u5931\u6557",children:["\u30a8\u30e9\u30fc2: ",(0,r.jsx)(n.code,{children:"ParseException"})," - JWT\u89e3\u6790\u5931\u6557"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u539f\u56e0"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"JWT\u5f62\u5f0f\u304c\u4e0d\u6b63"}),"\n",(0,r.jsx)(n.li,{children:"Base64URL\u30c7\u30b3\u30fc\u30c9\u5931\u6557"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'try {\n  JsonWebSignature jws = JsonWebSignature.parse(jwtString);\n} catch (JoseInvalidException e) {\n  // JWT\u5f62\u5f0f\u304c\u4e0d\u6b63\n  log.error("Invalid JWT format: {}", e.getMessage());\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h3,{id:"\u30a8\u30e9\u30fc3-jsonwebkeynotfoundexception---\u9375\u304c\u898b\u3064\u304b\u3089\u306a\u3044",children:["\u30a8\u30e9\u30fc3: ",(0,r.jsx)(n.code,{children:"JsonWebKeyNotFoundException"})," - \u9375\u304c\u898b\u3064\u304b\u3089\u306a\u3044"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u539f\u56e0"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"kid\u304cJWKS\u306b\u5b58\u5728\u3057\u306a\u3044"}),"\n",(0,r.jsx)(n.li,{children:"JWKS\u53d6\u5f97\u5931\u6557"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// JWKS\u66f4\u65b0\uff08\u5916\u90e8IdP\u306eJWKS\u3092\u518d\u53d6\u5f97\uff09\nString jwks = httpClient.get("https://idp.example.com/.well-known/jwks.json");\nJsonWebKeys jsonWebKeys = JsonWebKeys.parse(jwks);\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,r.jsx)(n.p,{children:"\u2705 JOSE\uff08JWT/JWS/JWE\uff09\u51e6\u7406\u306e\u5b9f\u88c5\u3092\u7406\u89e3\u3057\u305f\uff01"}),"\n",(0,r.jsx)(n.h3,{id:"-\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\ud83d\udcd6 \u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"../content_10_ai_developer/ai-12-platform.md#jose---jwtjwsjwe%E5%87%A6%E7%90%86",children:"AI\u958b\u767a\u8005\u5411\u3051: Platform - JOSE"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/idp-server/docs/content_03_concepts/concept-18-id-token",children:"\u5b9f\u88c5\u30ac\u30a4\u30c9: ID Token\u751f\u6210"})," - at_hash/c_hash\u8a08\u7b97"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-\u8a73\u7d30\u60c5\u5831",children:"\ud83d\udd17 \u8a73\u7d30\u60c5\u5831"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519",children:"RFC 7519 - JWT"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7515",children:"RFC 7515 - JWS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7517",children:"RFC 7517 - JWK"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u60c5\u5831\u6e90"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(58566).A+"",children:"JoseHandler.java"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(90935).A+"",children:"JsonWebSignature.java"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(81461).A+"",children:"JsonWebTokenClaims.java"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-13"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},68665:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JoseContext-137799b5906d1a6cb4e25d2bc496d234.java"},58566:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JoseHandler-906368432a343f63b40b3a8c6b1ad18a.java"},32458:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JoseType-9a8364f0bc7911de65684c52a53ff299.java"},21518:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JsonWebKey-be18a737c7ca42750b34f8ec22920168.java"},90935:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JsonWebSignature-5b01f26171544f084b3bc65360921e81.java"},78232:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JsonWebSignatureAlgorithm-2e12d6a674b00b554942608d144a3ece.java"},81461:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JsonWebTokenClaims-fc110caa3d7bb3c18a7129c53e97179f.java"},30438:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/files/JwsContextCreator-1899f22ff137653d110465f8063f5a65.java"},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>d});var i=s(96540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);