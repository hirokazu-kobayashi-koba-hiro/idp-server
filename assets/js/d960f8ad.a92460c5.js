"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[6009],{95639:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"content_05_how-to/how-to-07-authentication-policy-basic","title":"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u57fa\u790e\u7de8\uff09","description":"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684","source":"@site/docs/content_05_how-to/how-to-07-authentication-policy-basic.md","sourceDirName":"content_05_how-to","slug":"/content_05_how-to/how-to-07-authentication-policy-basic","permalink":"/idp-server/docs/content_05_how-to/how-to-07-authentication-policy-basic","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_05_how-to/how-to-07-authentication-policy-basic.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3068\u521d\u56de\u8a8d\u8a3c","permalink":"/idp-server/docs/content_05_how-to/how-to-05-user-registration"},"next":{"title":"MFA\uff08\u591a\u8981\u7d20\u8a8d\u8a3c\uff09\u306e\u8a2d\u5b9a","permalink":"/idp-server/docs/content_05_how-to/how-to-08-mfa-setup"}}');var l=s(74848),o=s(28453);const t={},r="\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u57fa\u790e\u7de8\uff09",a={},c=[{value:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",level:2},{value:"\u6240\u8981\u6642\u9593",id:"\u6240\u8981\u6642\u9593",level:3},{value:"\u524d\u63d0\u6761\u4ef6",id:"\u524d\u63d0\u6761\u4ef6",level:3},{value:"Management API URL",id:"management-api-url",level:3},{value:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3068\u306f",id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3068\u306f",level:2},{value:"Level 1: \u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30dd\u30ea\u30b7\u30fc\uff085\u5206\uff09",id:"level-1-\u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30dd\u30ea\u30b7\u30fc5\u5206",level:2},{value:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u306e\u8a8d\u8a3c",id:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u306e\u8a8d\u8a3c",level:3},{value:"Level 2: MFA\uff08\u591a\u8981\u7d20\u8a8d\u8a3c\uff09\u30dd\u30ea\u30b7\u30fc\uff0810\u5206\uff09",id:"level-2-mfa\u591a\u8981\u7d20\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc10\u5206",level:2},{value:"\u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP",id:"\u30d1\u30b9\u30ef\u30fc\u30c9--sms-otp",level:3},{value:"Level 3: \u9078\u629e\u5f0fMFA\uff0815\u5206\uff09",id:"level-3-\u9078\u629e\u5f0fmfa15\u5206",level:2},{value:"\u30d1\u30b9\u30ef\u30fc\u30c9 + \uff08SMS \u307e\u305f\u306f Email\uff09",id:"\u30d1\u30b9\u30ef\u30fc\u30c9--sms-\u307e\u305f\u306f-email",level:3},{value:"success_conditions\u306e\u57fa\u672c",id:"success_conditions\u306e\u57fa\u672c",level:2},{value:"type: &quot;all&quot; vs &quot;any&quot;",id:"type-all-vs-any",level:3},{value:"\u30d1\u30bf\u30fc\u30f31: type: &quot;all&quot;\uff08AND\u6761\u4ef6\uff09",id:"\u30d1\u30bf\u30fc\u30f31-type-alland\u6761\u4ef6",level:3},{value:"\u30d1\u30bf\u30fc\u30f32: type: &quot;any&quot;\uff08OR\u6761\u4ef6\uff09",id:"\u30d1\u30bf\u30fc\u30f32-type-anyor\u6761\u4ef6",level:3},{value:"\u30d1\u30bf\u30fc\u30f33: \u30cd\u30b9\u30c8\uff08AND + OR\uff09",id:"\u30d1\u30bf\u30fc\u30f33-\u30cd\u30b9\u30c8and--or",level:3},{value:"Level 4: \u8907\u6570\u30dd\u30ea\u30b7\u30fc\uff08priority\uff09",id:"level-4-\u8907\u6570\u30dd\u30ea\u30b7\u30fcpriority",level:2},{value:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u306e\u30dd\u30ea\u30b7\u30fc",id:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u306e\u30dd\u30ea\u30b7\u30fc",level:3},{value:"Level 5: ACR\u30de\u30c3\u30d4\u30f3\u30b0\uff08\u57fa\u790e\uff09",id:"level-5-acr\u30de\u30c3\u30d4\u30f3\u30b0\u57fa\u790e",level:2},{value:"ACR\uff08Authentication Context Class Reference\uff09\u3068\u306f",id:"acrauthentication-context-class-reference\u3068\u306f",level:3},{value:"ACR\u30de\u30c3\u30d4\u30f3\u30b0\u8a2d\u5b9a",id:"acr\u30de\u30c3\u30d4\u30f3\u30b0\u8a2d\u5b9a",level:3},{value:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",level:2},{value:"\u30a8\u30e9\u30fc1: \u8a8d\u8a3c\u65b9\u5f0f\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044",id:"\u30a8\u30e9\u30fc1-\u8a8d\u8a3c\u65b9\u5f0f\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044",level:3},{value:"\u30a8\u30e9\u30fc2: \u6210\u529f\u6761\u4ef6\u3092\u6e80\u305f\u305b\u306a\u3044",id:"\u30a8\u30e9\u30fc2-\u6210\u529f\u6761\u4ef6\u3092\u6e80\u305f\u305b\u306a\u3044",level:3},{value:"\u30a8\u30e9\u30fc3: \u30dd\u30ea\u30b7\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044",id:"\u30a8\u30e9\u30fc3-\u30dd\u30ea\u30b7\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044",level:3},{value:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",level:2},{value:"\u2705 \u63a8\u5968",id:"-\u63a8\u5968",level:3},{value:"\u274c \u907f\u3051\u308b\u3079\u304d\u8a2d\u5b9a",id:"-\u907f\u3051\u308b\u3079\u304d\u8a2d\u5b9a",level:3},{value:"\u8a2d\u5b9a\u306e\u78ba\u8a8d\u65b9\u6cd5",id:"\u8a2d\u5b9a\u306e\u78ba\u8a8d\u65b9\u6cd5",level:2},{value:"\u30dd\u30ea\u30b7\u30fc\u4e00\u89a7\u53d6\u5f97",id:"\u30dd\u30ea\u30b7\u30fc\u4e00\u89a7\u53d6\u5f97",level:3},{value:"\u7279\u5b9a\u306e\u30dd\u30ea\u30b7\u30fc\u53d6\u5f97",id:"\u7279\u5b9a\u306e\u30dd\u30ea\u30b7\u30fc\u53d6\u5f97",level:3},{value:"\u30c6\u30ca\u30f3\u30c8\u306eDiscovery\u3067\u78ba\u8a8d",id:"\u30c6\u30ca\u30f3\u30c8\u306ediscovery\u3067\u78ba\u8a8d",level:3},{value:"\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",id:"\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",level:2},{value:"\u65e2\u5b58\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",id:"\u65e2\u5b58\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",level:3},{value:"\u30dd\u30ea\u30b7\u30fc\u306e\u7121\u52b9\u5316",id:"\u30dd\u30ea\u30b7\u30fc\u306e\u7121\u52b9\u5316",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2},{value:"\u3088\u308a\u9ad8\u5ea6\u306a\u8a2d\u5b9a",id:"\u3088\u308a\u9ad8\u5ea6\u306a\u8a2d\u5b9a",level:3},{value:"\u5b9f\u969b\u306e\u8a8d\u8a3c\u8a2d\u5b9a",id:"\u5b9f\u969b\u306e\u8a8d\u8a3c\u8a2d\u5b9a",level:3},{value:"\u95a2\u9023\u6982\u5ff5",id:"\u95a2\u9023\u6982\u5ff5",level:3},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\u57fa\u790e\u7de8",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u57fa\u790e\u7de8\uff09"})}),"\n",(0,l.jsx)(e.h2,{id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc"}),"\u306e\u57fa\u672c\u3092\u7406\u89e3\u3057\u3001\u30b7\u30f3\u30d7\u30eb\u306a\u8a2d\u5b9a\u304c\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002"]}),"\n",(0,l.jsx)(e.h3,{id:"\u6240\u8981\u6642\u9593",children:"\u6240\u8981\u6642\u9593"}),"\n",(0,l.jsxs)(e.p,{children:["\u23f1\ufe0f ",(0,l.jsx)(e.strong,{children:"\u7d0415\u5206"})]}),"\n",(0,l.jsx)(e.h3,{id:"\u524d\u63d0\u6761\u4ef6",children:"\u524d\u63d0\u6761\u4ef6"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"./how-to-04-password-authentication.md",children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u8a2d\u5b9a"}),"\u5b8c\u4e86"]}),"\n",(0,l.jsx)(e.li,{children:"\u7ba1\u7406\u8005\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u6e08\u307f"}),"\n",(0,l.jsx)(e.li,{children:"\u7d44\u7e54ID\uff08organization-id\uff09\u3092\u53d6\u5f97\u6e08\u307f"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"management-api-url",children:"Management API URL"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u7d44\u7e54\u30ec\u30d9\u30ebAPI"}),"\uff08\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306e\u8868\u8a18\uff09:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"POST /v1/management/organizations/{organization-id}/tenants/{tenant-id}/authentication-policies\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u6ce8\u610f"}),": \u30b7\u30b9\u30c6\u30e0\u30ec\u30d9\u30ebAPI\u3068\u306e\u9055\u3044"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u7d44\u7e54\u30ec\u30d9\u30eb"}),": ",(0,l.jsx)(e.code,{children:"POST /v1/management/organizations/{organization-id}/tenants/{tenant-id}/authentication-policies"})," \u2190 \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u30b7\u30b9\u30c6\u30e0\u30ec\u30d9\u30eb"}),": ",(0,l.jsx)(e.code,{children:"POST /v1/management/tenants/{tenant-id}/authentication-policies"})," \u2190 \u7ba1\u7406\u8005\u306e\u307f"]}),"\n"]}),"\n",(0,l.jsx)(e.p,{children:"\u901a\u5e38\u306e\u904b\u7528\u3067\u306f\u7d44\u7e54\u30ec\u30d9\u30ebAPI\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3068\u306f",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3068\u306f"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u3069\u306e\u8a8d\u8a3c\u65b9\u5f0f\u3092\u4f7f\u3063\u3066\u3001\u3069\u306e\u3088\u3046\u306a\u6761\u4ef6\u3067\u8a8d\u8a3c\u6210\u529f\u3068\u3059\u308b\u304b"}),"\u3092\u5b9a\u7fa9\u3059\u308b\u8a2d\u5b9a\u3067\u3059\u3002"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"Authorization Request\n  \u2193\n\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u78ba\u8a8d\n  \u251c\u2500 \u5229\u7528\u53ef\u80fd\u306a\u8a8d\u8a3c\u65b9\u5f0f\u306f\uff1f \u2192 available_methods\n  \u251c\u2500 \u6210\u529f\u6761\u4ef6\u306f\uff1f \u2192 success_conditions\n  \u2514\u2500 \u5931\u6557/\u30ed\u30c3\u30af\u6761\u4ef6\u306f\uff1f \u2192 failure_conditions, lock_conditions\n  \u2193\n\u8a8d\u8a3c\u5b9f\u884c\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"level-1-\u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30dd\u30ea\u30b7\u30fc5\u5206",children:"Level 1: \u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u30dd\u30ea\u30b7\u30fc\uff085\u5206\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u306e\u8a8d\u8a3c",children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u306e\u8a8d\u8a3c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "password only",\n        "priority": 1,\n        "conditions": {},\n        "available_methods": ["password"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a2d\u5b9a\u5185\u5bb9"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'flow: "oauth"'})," - OAuth/OIDC\u8a8d\u8a3c\u30d5\u30ed\u30fc\u3067\u4f7f\u7528"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'available_methods: ["password"]'})," - \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u306e\u307f\u8a31\u53ef"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'success_conditions.type: "all"'})," - \u6307\u5b9a\u3057\u305f\u5168\u3066\u306e\u8a8d\u8a3c\u65b9\u5f0f\u304c\u5fc5\u8981"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'authentication_methods: ["password"]'})," - \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308c\u3070\u5b8c\u4e86"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"level-2-mfa\u591a\u8981\u7d20\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc10\u5206",children:"Level 2: MFA\uff08\u591a\u8981\u7d20\u8a8d\u8a3c\uff09\u30dd\u30ea\u30b7\u30fc\uff0810\u5206\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30b9\u30ef\u30fc\u30c9--sms-otp",children:"\u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "password + sms mfa",\n        "priority": 1,\n        "conditions": {},\n        "available_methods": ["password", "sms"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password", "sms"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a2d\u5b9a\u5185\u5bb9"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'available_methods: ["password", "sms"]'})," - \u4e21\u65b9\u8a31\u53ef"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:'type: "all"'})," - ",(0,l.jsx)(e.strong,{children:"\u4e21\u65b9\u6210\u529f\u304c\u5fc5\u8981"}),"\uff08MFA\uff09"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a8d\u8a3c\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"1. \u30e6\u30fc\u30b6\u30fc\u304c\u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n   \u2192 \u6210\u529f\n2. SMS OTP\u9001\u4fe1\n   \u2192 \u30e6\u30fc\u30b6\u30fc\u304cOTP\u5165\u529b\n   \u2192 \u6210\u529f\n3. \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"level-3-\u9078\u629e\u5f0fmfa15\u5206",children:"Level 3: \u9078\u629e\u5f0fMFA\uff0815\u5206\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30b9\u30ef\u30fc\u30c9--sms-\u307e\u305f\u306f-email",children:"\u30d1\u30b9\u30ef\u30fc\u30c9 + \uff08SMS \u307e\u305f\u306f Email\uff09"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "password + (sms or email)",\n        "priority": 1,\n        "conditions": {},\n        "available_methods": ["password", "sms", "email"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": [\n            "password",\n            {\n              "type": "any",\n              "authentication_methods": ["sms", "email"]\n            }\n          ]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a2d\u5b9a\u5185\u5bb9"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u5fc5\u9808"}),"\n",(0,l.jsxs)(e.li,{children:["SMS ",(0,l.jsx)(e.strong,{children:"\u307e\u305f\u306f"})," Email\uff08\u30e6\u30fc\u30b6\u30fc\u304c\u9078\u629e\uff09"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a8d\u8a3c\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"1. \u30e6\u30fc\u30b6\u30fc\u304c\u30d1\u30b9\u30ef\u30fc\u30c9\u5165\u529b\n   \u2192 \u6210\u529f\n2. \u30e6\u30fc\u30b6\u30fc\u304c\u9078\u629e\n   - SMS\u3092\u9078\u629e \u2192 SMS OTP\u8a8d\u8a3c\n   - Email\u3092\u9078\u629e \u2192 Email OTP\u8a8d\u8a3c\n3. \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"success_conditions\u306e\u57fa\u672c",children:"success_conditions\u306e\u57fa\u672c"}),"\n",(0,l.jsx)(e.h3,{id:"type-all-vs-any",children:'type: "all" vs "any"'}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"type"}),(0,l.jsx)(e.th,{children:"\u610f\u5473"}),(0,l.jsx)(e.th,{children:"\u4f8b"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"all"})}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.strong,{children:"\u5168\u3066"}),"\u6210\u529f\u304c\u5fc5\u8981"]}),(0,l.jsxs)(e.td,{children:["\u30d1\u30b9\u30ef\u30fc\u30c9 ",(0,l.jsx)(e.strong,{children:"\u304b\u3064"})," SMS OTP"]})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.code,{children:"any"})}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.strong,{children:"\u3044\u305a\u308c\u304b1\u3064"}),"\u6210\u529f\u3067OK"]}),(0,l.jsxs)(e.td,{children:["\u30d1\u30b9\u30ef\u30fc\u30c9 ",(0,l.jsx)(e.strong,{children:"\u307e\u305f\u306f"})," SMS OTP"]})]})]})]}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f31-type-alland\u6761\u4ef6",children:'\u30d1\u30bf\u30fc\u30f31: type: "all"\uff08AND\u6761\u4ef6\uff09'}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "type": "all",\n  "authentication_methods": ["password", "sms"]\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9 ",(0,l.jsx)(e.strong,{children:"AND"})," SMS OTP"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"password\u6210\u529f \u2192 sms\u6210\u529f \u2192 \u8a8d\u8a3c\u5b8c\u4e86\npassword\u5931\u6557 \u2192 \u8a8d\u8a3c\u5931\u6557\nsms\u5931\u6557 \u2192 \u8a8d\u8a3c\u5931\u6557\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f32-type-anyor\u6761\u4ef6",children:'\u30d1\u30bf\u30fc\u30f32: type: "any"\uff08OR\u6761\u4ef6\uff09'}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "type": "any",\n  "authentication_methods": ["password", "sms", "webauthn"]\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9 ",(0,l.jsx)(e.strong,{children:"OR"})," SMS OTP ",(0,l.jsx)(e.strong,{children:"OR"})," WebAuthn"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"password\u3067\u6210\u529f \u2192 \u8a8d\u8a3c\u5b8c\u4e86\uff08sms\u3001webauthn\u306f\u4e0d\u8981\uff09\nsms\u3067\u6210\u529f \u2192 \u8a8d\u8a3c\u5b8c\u4e86\nwebauthn\u3067\u6210\u529f \u2192 \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f33-\u30cd\u30b9\u30c8and--or",children:"\u30d1\u30bf\u30fc\u30f33: \u30cd\u30b9\u30c8\uff08AND + OR\uff09"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "type": "all",\n  "authentication_methods": [\n    "password",\n    {\n      "type": "any",\n      "authentication_methods": ["sms", "email", "webauthn"]\n    }\n  ]\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9 ",(0,l.jsx)(e.strong,{children:"AND"})," \uff08SMS ",(0,l.jsx)(e.strong,{children:"OR"})," Email ",(0,l.jsx)(e.strong,{children:"OR"})," WebAuthn\uff09"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"1. password\u5fc5\u9808\n2. sms\u3001email\u3001webauthn\u306e\u3044\u305a\u308c\u304b1\u3064\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"level-4-\u8907\u6570\u30dd\u30ea\u30b7\u30fcpriority",children:"Level 4: \u8907\u6570\u30dd\u30ea\u30b7\u30fc\uff08priority\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u306e\u30dd\u30ea\u30b7\u30fc",children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u306e\u30dd\u30ea\u30b7\u30fc"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "admin app - high security",\n        "priority": 1,\n        "conditions": {\n          "client_ids": ["admin-app"]\n        },\n        "available_methods": ["password", "webauthn"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password", "webauthn"]\n        }\n      },\n      {\n        "description": "normal app - standard security",\n        "priority": 2,\n        "conditions": {\n          "client_ids": ["user-app"]\n        },\n        "available_methods": ["password"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password"]\n        }\n      },\n      {\n        "description": "default - password only",\n        "priority": 3,\n        "conditions": {},\n        "available_methods": ["password"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u52d5\u4f5c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"admin-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 1 \u306b\u30de\u30c3\u30c1\n  \u2192 \u30d1\u30b9\u30ef\u30fc\u30c9 + WebAuthn\uff08\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\uff09\n\nuser-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 2 \u306b\u30de\u30c3\u30c1\n  \u2192 \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\uff08\u6a19\u6e96\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\uff09\n\nother-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 3 \u306b\u30de\u30c3\u30c1\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09\n  \u2192 \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u91cd\u8981"}),": priority\u304c",(0,l.jsx)(e.strong,{children:"\u5c0f\u3055\u3044"}),"\u307b\u3069\u512a\u5148\uff081 > 2 > 3\uff09"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"level-5-acr\u30de\u30c3\u30d4\u30f3\u30b0\u57fa\u790e",children:"Level 5: ACR\u30de\u30c3\u30d4\u30f3\u30b0\uff08\u57fa\u790e\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"acrauthentication-context-class-reference\u3068\u306f",children:"ACR\uff08Authentication Context Class Reference\uff09\u3068\u306f"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a8d\u8a3c\u306e\u5f37\u5ea6\u30ec\u30d9\u30eb"}),"\u3092\u793a\u3059\u6a19\u6e96\u7684\u306a\u5024\u3067\u3059\u3002"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u30e6\u30fc\u30b6\u30fc\u8a8d\u8a3c\u5b8c\u4e86\n  \u2193\n\u3069\u306e\u8a8d\u8a3c\u65b9\u5f0f\u3092\u4f7f\u3063\u305f\uff1f\n  - WebAuthn \u2192 ACR: urn:mace:incommon:iap:gold\uff08\u9ad8\uff09\n  - SMS OTP \u2192 ACR: urn:mace:incommon:iap:silver\uff08\u4e2d\uff09\n  - \u30d1\u30b9\u30ef\u30fc\u30c9 \u2192 ACR: urn:mace:incommon:iap:bronze\uff08\u4f4e\uff09\n  \u2193\nID Token\u306b acr \u30af\u30ec\u30fc\u30e0\u3068\u3057\u3066\u542b\u3081\u308b\n"})}),"\n",(0,l.jsx)(e.h3,{id:"acr\u30de\u30c3\u30d4\u30f3\u30b0\u8a2d\u5b9a",children:"ACR\u30de\u30c3\u30d4\u30f3\u30b0\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "flow": "oauth",\n  "enabled": true,\n  "policies": [\n    {\n      "description": "with acr mapping",\n      "priority": 1,\n      "conditions": {},\n      "available_methods": ["password", "sms", "webauthn"],\n      "acr_mapping_rules": {\n        "urn:mace:incommon:iap:gold": ["webauthn"],\n        "urn:mace:incommon:iap:silver": ["sms", "email"],\n        "urn:mace:incommon:iap:bronze": ["password"]\n      },\n      "success_conditions": {\n        "type": "any",\n        "authentication_methods": ["password", "sms", "webauthn"]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u52b9\u679c"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'// WebAuthn\u8a8d\u8a3c\u3057\u305f\u5834\u5408\u306eID Token\n{\n  "sub": "user-12345",\n  "acr": "urn:mace:incommon:iap:gold",  // \u9ad8\u30ec\u30d9\u30eb\n  ...\n}\n\n// \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u3057\u305f\u5834\u5408\u306eID Token\n{\n  "sub": "user-12345",\n  "acr": "urn:mace:incommon:iap:bronze",  // \u4f4e\u30ec\u30d9\u30eb\n  ...\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u7528\u9014"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304cACR\u5024\u3092\u78ba\u8a8d\u3057\u3066\u30a2\u30af\u30bb\u30b9\u5236\u5fa1"}),"\n",(0,l.jsxs)(e.li,{children:["\u91cd\u8981\u64cd\u4f5c\u306f",(0,l.jsx)(e.code,{children:"gold"}),"\u30ec\u30d9\u30eb\u5fc5\u9808\u7b49"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u8a73\u7d30"}),": ",(0,l.jsx)(e.a,{href:"./how-to-15-authentication-policy-advanced.md",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30\u30ac\u30a4\u30c9"})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",children:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc"}),"\n",(0,l.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc1-\u8a8d\u8a3c\u65b9\u5f0f\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044",children:"\u30a8\u30e9\u30fc1: \u8a8d\u8a3c\u65b9\u5f0f\u304c\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "error": "authentication_method_not_allowed",\n  "error_description": "password authentication is not allowed"\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u539f\u56e0"}),": ",(0,l.jsx)(e.code,{children:"available_methods"}),"\u306b",(0,l.jsx)(e.code,{children:"password"}),"\u304c\u542b\u307e\u308c\u3066\u3044\u306a\u3044"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3092\u78ba\u8a8d\ncurl "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies/oauth" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}"\n\n# available_methods\u306b\u8ffd\u52a0\ncurl -X PUT "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies/oauth" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "allow password",\n        "priority": 1,\n        "conditions": {},\n        "available_methods": ["password"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc2-\u6210\u529f\u6761\u4ef6\u3092\u6e80\u305f\u305b\u306a\u3044",children:"\u30a8\u30e9\u30fc2: \u6210\u529f\u6761\u4ef6\u3092\u6e80\u305f\u305b\u306a\u3044"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "error": "authentication_incomplete",\n  "error_description": "Required authentication methods not completed"\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u539f\u56e0"}),": ",(0,l.jsx)(e.code,{children:"success_conditions"}),"\u3067\u6307\u5b9a\u3057\u305f\u8a8d\u8a3c\u65b9\u5f0f\u304c\u5b8c\u4e86\u3057\u3066\u3044\u306a\u3044"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u4f8b"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'// \u8a2d\u5b9a\n"success_conditions": {\n  "type": "all",\n  "authentication_methods": ["password", "sms"]\n}\n\n// \u5b9f\u884c\n\u30e6\u30fc\u30b6\u30fc\u304c\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u306e\u307f\u5b9f\u884c\n\u2192 SMS OTP\u8a8d\u8a3c\u304c\u672a\u5b8c\u4e86\n\u2192 \u30a8\u30e9\u30fc\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u89e3\u6c7a\u7b56"}),": \u5168\u3066\u306e\u5fc5\u9808\u8a8d\u8a3c\u65b9\u5f0f\u3092\u5b8c\u4e86\u3059\u308b"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc3-\u30dd\u30ea\u30b7\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044",children:"\u30a8\u30e9\u30fc3: \u30dd\u30ea\u30b7\u30fc\u304c\u898b\u3064\u304b\u3089\u306a\u3044"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "error": "policy_not_found",\n  "error_description": "No matching authentication policy found"\n}\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u539f\u56e0"}),":"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u306a\u3044"}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"conditions"}),"\u306b\u30de\u30c3\u30c1\u3059\u308b\u30dd\u30ea\u30b7\u30fc\u304c\u306a\u3044"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u89e3\u6c7a\u7b56"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# \u30c7\u30d5\u30a9\u30eb\u30c8\u30dd\u30ea\u30b7\u30fc\u3092\u4f5c\u6210\uff08conditions: {}\uff09\ncurl -X POST "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "default policy",\n        "priority": 999,\n        "conditions": {},  // \u3059\u3079\u3066\u306b\u30de\u30c3\u30c1\n        "available_methods": ["password"],\n        "success_conditions": {\n          "type": "all",\n          "authentication_methods": ["password"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u306e\u30d9\u30b9\u30c8\u30d7\u30e9\u30af\u30c6\u30a3\u30b9"}),"\n",(0,l.jsx)(e.h3,{id:"-\u63a8\u5968",children:"\u2705 \u63a8\u5968"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u30c7\u30d5\u30a9\u30eb\u30c8\u30dd\u30ea\u30b7\u30fc\u3092\u5fc5\u305a\u7528\u610f"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "description": "default - fallback policy",\n  "priority": 999,\n  "conditions": {},  // \u3059\u3079\u3066\u306b\u30de\u30c3\u30c1\n  ...\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"priority\u306f10\u523b\u307f\u3067\u8a2d\u5b9a"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:"priority: 10, 20, 30, ...\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u5f8c\u304b\u3089\u633f\u5165\u3057\u3084\u3059\u3044"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"description\u3092\u5206\u304b\u308a\u3084\u3059\u304f"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'// \u2705 \u826f\u3044\n"description": "admin app - password + webauthn mfa"\n\n// \u274c \u60aa\u3044\n"description": "policy1"\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"-\u907f\u3051\u308b\u3079\u304d\u8a2d\u5b9a",children:"\u274c \u907f\u3051\u308b\u3079\u304d\u8a2d\u5b9a"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u30c7\u30d5\u30a9\u30eb\u30c8\u30dd\u30ea\u30b7\u30fc\u306a\u3057"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'"policies": [\n  {\n    "priority": 1,\n    "conditions": { "client_ids": ["specific-app"] },\n    ...\n  }\n]\n// \u274c specific-app\u4ee5\u5916\u304c\u30a8\u30e9\u30fc\u306b\u306a\u308b\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"available_methods\u3068 success_conditions\u306e\u4e0d\u4e00\u81f4"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'// \u274c \u9593\u9055\u3044\n"available_methods": ["password"],  // \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u8a31\u53ef\n"success_conditions": {\n  "type": "all",\n  "authentication_methods": ["password", "sms"]  // SMS\u3082\u5fc5\u8981\uff1f\n}\n// \u2192 SMS\u8a8d\u8a3c\u304c\u3067\u304d\u306a\u3044\uff08available_methods\u306b\u306a\u3044\uff09\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:'type: "all"\u3068type: "any"\u306e\u6df7\u540c'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'// \u274c MFA\u306e\u3064\u3082\u308a\u304cMFA\u306b\u306a\u3063\u3066\u3044\u306a\u3044\n"available_methods": ["password", "sms"],\n"success_conditions": {\n  "type": "any",  // \u3069\u3061\u3089\u304b1\u3064\u3067OK\n  "authentication_methods": ["password", "sms"]\n}\n// \u2192 \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\u3067\u8a8d\u8a3c\u5b8c\u4e86\uff08MFA\u3067\u306f\u306a\u3044\uff09\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u8a2d\u5b9a\u306e\u78ba\u8a8d\u65b9\u6cd5",children:"\u8a2d\u5b9a\u306e\u78ba\u8a8d\u65b9\u6cd5"}),"\n",(0,l.jsx)(e.h3,{id:"\u30dd\u30ea\u30b7\u30fc\u4e00\u89a7\u53d6\u5f97",children:"\u30dd\u30ea\u30b7\u30fc\u4e00\u89a7\u53d6\u5f97"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  | jq \'.\'\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u7279\u5b9a\u306e\u30dd\u30ea\u30b7\u30fc\u53d6\u5f97",children:"\u7279\u5b9a\u306e\u30dd\u30ea\u30b7\u30fc\u53d6\u5f97"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies/oauth" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  | jq \'.policies\'\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u30c6\u30ca\u30f3\u30c8\u306ediscovery\u3067\u78ba\u8a8d",children:"\u30c6\u30ca\u30f3\u30c8\u306eDiscovery\u3067\u78ba\u8a8d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"curl \"http://localhost:8080/${TENANT_ID}/.well-known/openid-configuration\" \\\n  | jq '.acr_values_supported'\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u30ec\u30b9\u30dd\u30f3\u30b9\u4f8b"}),":"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'[\n  "urn:mace:incommon:iap:bronze",\n  "urn:mace:incommon:iap:silver",\n  "urn:mace:incommon:iap:gold"\n]\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",children:"\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0"}),"\n",(0,l.jsx)(e.h3,{id:"\u65e2\u5b58\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0",children:"\u65e2\u5b58\u30dd\u30ea\u30b7\u30fc\u306e\u66f4\u65b0"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X PUT "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies/oauth" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": true,\n    "policies": [\n      {\n        "description": "updated policy",\n        "priority": 1,\n        "conditions": {},\n        "available_methods": ["password", "sms", "webauthn"],\n        "success_conditions": {\n          "type": "any",\n          "authentication_methods": ["password", "sms", "webauthn"]\n        }\n      }\n    ]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u6ce8\u610f"}),": \u5168\u3066\u306e",(0,l.jsx)(e.code,{children:"policies"}),"\u914d\u5217\u3092\u542b\u3081\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff08\u90e8\u5206\u66f4\u65b0\u4e0d\u53ef\uff09"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h3,{id:"\u30dd\u30ea\u30b7\u30fc\u306e\u7121\u52b9\u5316",children:"\u30dd\u30ea\u30b7\u30fc\u306e\u7121\u52b9\u5316"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'curl -X PUT "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/authentication-policies/oauth" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "flow": "oauth",\n    "enabled": false,\n    "policies": [...]\n  }\'\n'})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u52b9\u679c"}),": \u3053\u306e\u30d5\u30ed\u30fc\u306e\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u304c\u7121\u52b9\u5316\u3055\u308c\u308b"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,l.jsx)(e.p,{children:"\u2705 \u57fa\u672c\u7684\u306a\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3057\u305f\uff01"}),"\n",(0,l.jsx)(e.h3,{id:"\u3088\u308a\u9ad8\u5ea6\u306a\u8a2d\u5b9a",children:"\u3088\u308a\u9ad8\u5ea6\u306a\u8a2d\u5b9a"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"./how-to-15-authentication-policy-advanced.md",children:"How-to: \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30"})," - \u6761\u4ef6\u5f0f\u3001JSONPath\u3001failure_conditions"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u5b9f\u969b\u306e\u8a8d\u8a3c\u8a2d\u5b9a",children:"\u5b9f\u969b\u306e\u8a8d\u8a3c\u8a2d\u5b9a"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"./how-to-03-password-authentication.md",children:"How-to: \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"./how-to-09-mfa-setup.md",children:"How-to: MFA\u8a2d\u5b9a"})}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u95a2\u9023\u6982\u5ff5",children:"\u95a2\u9023\u6982\u5ff5"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"/idp-server/docs/content_03_concepts/concept-05-authentication-policy",children:"Concept: \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"/idp-server/docs/content_03_concepts/concept-08-mfa",children:"Concept: MFA"})}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"/idp-server/docs/content_06_developer-guide/application-plane/authentication",children:"Developer Guide: Authentication\u5b9f\u88c5"})," - \u958b\u767a\u8005\u5411\u3051\u5b9f\u88c5\u30ac\u30a4\u30c9"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"/idp-server/docs/content_07_reference/api-reference",children:"API Reference"})," - Management API\u4ed5\u69d8"]}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-10-13\n",(0,l.jsx)(e.strong,{children:"\u96e3\u6613\u5ea6"}),": \u2b50\u2b50\u2606\u2606\u2606\uff08\u521d\u7d1a\u301c\u4e2d\u7d1a\uff09\n",(0,l.jsx)(e.strong,{children:"\u5bfe\u8c61"}),": \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3092\u521d\u3081\u3066\u8a2d\u5b9a\u3059\u308b\u7ba1\u7406\u8005\u30fb\u958b\u767a\u8005\n",(0,l.jsx)(e.strong,{children:"\u7fd2\u5f97\u30b9\u30ad\u30eb"}),': success_conditions\u3001type: "all" vs "any"\u3001priority\u3001ACR\u30de\u30c3\u30d4\u30f3\u30b0\u57fa\u790e']})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>r});var i=s(96540);const l={},o=i.createContext(l);function t(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:t(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);