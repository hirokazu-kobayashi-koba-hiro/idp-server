"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8377],{91651:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"content_11_learning/postgresql/dba-01-installation","title":"PostgreSQL \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u521d\u671f\u8a2d\u5b9a\u30ac\u30a4\u30c9","description":"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001PostgreSQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304b\u3089\u672c\u756a\u74b0\u5883\u5411\u3051\u306e\u521d\u671f\u8a2d\u5b9a\u307e\u3067\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002","source":"@site/docs/content_11_learning/11-postgresql/dba-01-installation.md","sourceDirName":"content_11_learning/11-postgresql","slug":"/content_11_learning/postgresql/dba-01-installation","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-01-installation","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/11-postgresql/dba-01-installation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"PostgreSQL: \u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9 vs \u30bb\u30eb\u30d5\u30db\u30b9\u30c8\u6bd4\u8f03\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-00-managed-vs-self-hosted"},"next":{"title":"PostgreSQL \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3068\u30ea\u30ab\u30d0\u30ea\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_11_learning/postgresql/dba-02-backup-recovery"}}');var l=s(74848),t=s(28453);const r={},i="PostgreSQL \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u521d\u671f\u8a2d\u5b9a\u30ac\u30a4\u30c9",o={},c=[{value:"\u76ee\u6b21",id:"\u76ee\u6b21",level:2},{value:"1. \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5",id:"1-\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5",level:2},{value:"1.1 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306e\u6bd4\u8f03",id:"11-\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306e\u6bd4\u8f03",level:3},{value:"1.2 Linux (RHEL/CentOS/Rocky Linux)",id:"12-linux-rhelcentosrocky-linux",level:3},{value:"1.3 Linux (Ubuntu/Debian)",id:"13-linux-ubuntudebian",level:3},{value:"1.4 macOS",id:"14-macos",level:3},{value:"1.5 Docker",id:"15-docker",level:3},{value:"2. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316",id:"2-\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316",level:2},{value:"2.1 initdb \u306e\u5b9f\u884c",id:"21-initdb-\u306e\u5b9f\u884c",level:3},{value:"2.2 initdb \u306e\u30aa\u30d7\u30b7\u30e7\u30f3",id:"22-initdb-\u306e\u30aa\u30d7\u30b7\u30e7\u30f3",level:3},{value:"2.3 \u672c\u756a\u74b0\u5883\u5411\u3051 initdb \u4f8b",id:"23-\u672c\u756a\u74b0\u5883\u5411\u3051-initdb-\u4f8b",level:3},{value:"2.4 \u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u69cb\u9020",id:"24-\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u69cb\u9020",level:3},{value:"3. postgresql.conf \u306e\u8a2d\u5b9a",id:"3-postgresqlconf-\u306e\u8a2d\u5b9a",level:2},{value:"3.1 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6982\u8981",id:"31-\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6982\u8981",level:3},{value:"3.2 \u63a5\u7d9a\u8a2d\u5b9a",id:"32-\u63a5\u7d9a\u8a2d\u5b9a",level:3},{value:"3.3 \u30e1\u30e2\u30ea\u8a2d\u5b9a",id:"33-\u30e1\u30e2\u30ea\u8a2d\u5b9a",level:3},{value:"3.4 WAL\u8a2d\u5b9a",id:"34-wal\u8a2d\u5b9a",level:3},{value:"3.5 \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a",id:"35-\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a",level:3},{value:"3.6 \u4e26\u5217\u30af\u30a8\u30ea\u8a2d\u5b9a",id:"36-\u4e26\u5217\u30af\u30a8\u30ea\u8a2d\u5b9a",level:3},{value:"3.7 VACUUM / Autovacuum\u8a2d\u5b9a",id:"37-vacuum--autovacuum\u8a2d\u5b9a",level:3},{value:"3.8 \u30ed\u30b0\u8a2d\u5b9a",id:"38-\u30ed\u30b0\u8a2d\u5b9a",level:3},{value:"3.9 \u7d71\u8a08\u60c5\u5831\u8a2d\u5b9a",id:"39-\u7d71\u8a08\u60c5\u5831\u8a2d\u5b9a",level:3},{value:"3.10 SSD\u5411\u3051\u8a2d\u5b9a",id:"310-ssd\u5411\u3051\u8a2d\u5b9a",level:3},{value:"4. pg_hba.conf \u306e\u8a2d\u5b9a",id:"4-pg_hbaconf-\u306e\u8a2d\u5b9a",level:2},{value:"4.1 pg_hba.conf \u306e\u69cb\u9020",id:"41-pg_hbaconf-\u306e\u69cb\u9020",level:3},{value:"4.2 \u672c\u756a\u74b0\u5883\u5411\u3051 pg_hba.conf \u4f8b",id:"42-\u672c\u756a\u74b0\u5883\u5411\u3051-pg_hbaconf-\u4f8b",level:3},{value:"4.3 \u8a2d\u5b9a\u5909\u66f4\u306e\u53cd\u6620",id:"43-\u8a2d\u5b9a\u5909\u66f4\u306e\u53cd\u6620",level:3},{value:"5. \u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u3068\u7ba1\u7406",id:"5-\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u3068\u7ba1\u7406",level:2},{value:"5.1 systemd \u3067\u306e\u7ba1\u7406",id:"51-systemd-\u3067\u306e\u7ba1\u7406",level:3},{value:"5.2 pg_ctl \u3067\u306e\u7ba1\u7406",id:"52-pg_ctl-\u3067\u306e\u7ba1\u7406",level:3},{value:"5.3 \u505c\u6b62\u30e2\u30fc\u30c9\u306e\u9055\u3044",id:"53-\u505c\u6b62\u30e2\u30fc\u30c9\u306e\u9055\u3044",level:3},{value:"6. \u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d",id:"6-\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d",level:2},{value:"6.1 \u521d\u671f\u30e6\u30fc\u30b6\u30fc\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210",id:"61-\u521d\u671f\u30e6\u30fc\u30b6\u30fc\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210",level:3},{value:"6.2 \u62e1\u5f35\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",id:"62-\u62e1\u5f35\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",level:3},{value:"6.3 pg_stat_statements \u306e\u8a2d\u5b9a",id:"63-pg_stat_statements-\u306e\u8a2d\u5b9a",level:3},{value:"7. \u672c\u756a\u74b0\u5883\u5411\u3051\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",id:"7-\u672c\u756a\u74b0\u5883\u5411\u3051\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",level:2},{value:"7.1 \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af",id:"71-\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af",level:3},{value:"7.2 \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c1\u30a7\u30c3\u30af",id:"72-\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c1\u30a7\u30c3\u30af",level:3},{value:"7.3 \u53ef\u7528\u6027\u30c1\u30a7\u30c3\u30af",id:"73-\u53ef\u7528\u6027\u30c1\u30a7\u30c3\u30af",level:3},{value:"7.4 \u73fe\u5728\u306e\u8a2d\u5b9a\u78ba\u8a8d\u30af\u30a8\u30ea",id:"74-\u73fe\u5728\u306e\u8a2d\u5b9a\u78ba\u8a8d\u30af\u30a8\u30ea",level:3},{value:"\u53c2\u8003\u30ea\u30f3\u30af",id:"\u53c2\u8003\u30ea\u30f3\u30af",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"postgresql-\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u521d\u671f\u8a2d\u5b9a\u30ac\u30a4\u30c9",children:"PostgreSQL \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u521d\u671f\u8a2d\u5b9a\u30ac\u30a4\u30c9"})}),"\n",(0,l.jsx)(e.p,{children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001PostgreSQL\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u304b\u3089\u672c\u756a\u74b0\u5883\u5411\u3051\u306e\u521d\u671f\u8a2d\u5b9a\u307e\u3067\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002"}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u76ee\u6b21",children:"\u76ee\u6b21"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#1-%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%96%B9%E6%B3%95",children:"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%81%AE%E5%88%9D%E6%9C%9F%E5%8C%96",children:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#3-postgresqlconf-%E3%81%AE%E8%A8%AD%E5%AE%9A",children:"postgresql.conf \u306e\u8a2d\u5b9a"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#4-pg_hbaconf-%E3%81%AE%E8%A8%AD%E5%AE%9A",children:"pg_hba.conf \u306e\u8a2d\u5b9a"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#5-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E8%B5%B7%E5%8B%95%E3%81%A8%E7%AE%A1%E7%90%86",children:"\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u3068\u7ba1\u7406"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#6-%E5%88%9D%E6%9C%9F%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E4%BD%9C%E6%A5%AD",children:"\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"#7-%E6%9C%AC%E7%95%AA%E7%92%B0%E5%A2%83%E5%90%91%E3%81%91%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%83%AA%E3%82%B9%E3%83%88",children:"\u672c\u756a\u74b0\u5883\u5411\u3051\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"})}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"1-\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5",children:"1. \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5"}),"\n",(0,l.jsx)(e.h3,{id:"11-\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306e\u6bd4\u8f03",children:"1.1 \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306e\u6bd4\u8f03"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u65b9\u6cd5\u306e\u9078\u629e                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u2460 \u30d1\u30c3\u30b1\u30fc\u30b8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc (\u63a8\u5968)                             \u2502\n\u2502     - OS\u6a19\u6e96\u307e\u305f\u306fPGDG\u30ea\u30dd\u30b8\u30c8\u30ea                             \u2502\n\u2502     - \u81ea\u52d5\u66f4\u65b0\u3001\u4f9d\u5b58\u95a2\u4fc2\u7ba1\u7406\u304c\u5bb9\u6613                           \u2502\n\u2502     - \u672c\u756a\u74b0\u5883\u5411\u3051                                           \u2502\n\u2502                                                              \u2502\n\u2502  \u2461 \u30bd\u30fc\u30b9\u304b\u3089\u30d3\u30eb\u30c9                                         \u2502\n\u2502     - \u6700\u65b0\u30d0\u30fc\u30b8\u30e7\u30f3\u3001\u30ab\u30b9\u30bf\u30e0\u30d3\u30eb\u30c9                         \u2502\n\u2502     - \u958b\u767a\u30fb\u691c\u8a3c\u74b0\u5883\u5411\u3051                                     \u2502\n\u2502                                                              \u2502\n\u2502  \u2462 Docker                                                   \u2502\n\u2502     - \u74b0\u5883\u306e\u518d\u73fe\u6027                                           \u2502\n\u2502     - \u958b\u767a\u30fbCI/CD\u5411\u3051                                        \u2502\n\u2502                                                              \u2502\n\u2502  \u2463 \u30af\u30e9\u30a6\u30c9\u30de\u30cd\u30fc\u30b8\u30c9\u30b5\u30fc\u30d3\u30b9                               \u2502\n\u2502     - RDS, Cloud SQL, Azure Database\u7b49                       \u2502\n\u2502     - \u904b\u7528\u8ca0\u8377\u8efd\u6e1b                                           \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"12-linux-rhelcentosrocky-linux",children:"1.2 Linux (RHEL/CentOS/Rocky Linux)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# PGDG (PostgreSQL Global Development Group) \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\nsudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-9-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# \u30c7\u30d5\u30a9\u30eb\u30c8\u306ePostgreSQL\u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u7121\u52b9\u5316\nsudo dnf -qy module disable postgresql\n\n# PostgreSQL 16 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo dnf install -y postgresql16-server postgresql16-contrib\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\n/usr/pgsql-16/bin/postgres --version\n"})}),"\n",(0,l.jsx)(e.h3,{id:"13-linux-ubuntudebian",children:"1.3 Linux (Ubuntu/Debian)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# PGDG\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u8ffd\u52a0\nsudo sh -c 'echo \"deb https://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main\" > /etc/apt/sources.list.d/pgdg.list'\n\n# \u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u7f72\u540d\u30ad\u30fc\u3092\u30a4\u30f3\u30dd\u30fc\u30c8\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\n\n# \u30d1\u30c3\u30b1\u30fc\u30b8\u30ea\u30b9\u30c8\u306e\u66f4\u65b0\nsudo apt-get update\n\n# PostgreSQL 16 \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nsudo apt-get install -y postgresql-16 postgresql-contrib-16\n\n# \u30d0\u30fc\u30b8\u30e7\u30f3\u78ba\u8a8d\npsql --version\n"})}),"\n",(0,l.jsx)(e.h3,{id:"14-macos",children:"1.4 macOS"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# Homebrew\u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nbrew install postgresql@16\n\n# \u30d1\u30b9\u3092\u901a\u3059\necho 'export PATH=\"/opt/homebrew/opt/postgresql@16/bin:$PATH\"' >> ~/.zshrc\nsource ~/.zshrc\n\n# \u30b5\u30fc\u30d3\u30b9\u306e\u958b\u59cb\nbrew services start postgresql@16\n"})}),"\n",(0,l.jsx)(e.h3,{id:"15-docker",children:"1.5 Docker"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u57fa\u672c\u7684\u306a\u8d77\u52d5\ndocker run -d \\\n  --name postgres \\\n  -e POSTGRES_PASSWORD=mysecretpassword \\\n  -p 5432:5432 \\\n  -v pgdata:/var/lib/postgresql/data \\\n  postgres:16\n\n# \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u4ed8\u304d\ndocker run -d \\\n  --name postgres \\\n  -e POSTGRES_PASSWORD=mysecretpassword \\\n  -e POSTGRES_USER=myuser \\\n  -e POSTGRES_DB=mydb \\\n  -p 5432:5432 \\\n  -v pgdata:/var/lib/postgresql/data \\\n  -v ./postgresql.conf:/etc/postgresql/postgresql.conf \\\n  postgres:16 -c 'config_file=/etc/postgresql/postgresql.conf'\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"2-\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316",children:"2. \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30af\u30e9\u30b9\u30bf\u306e\u521d\u671f\u5316"}),"\n",(0,l.jsx)(e.h3,{id:"21-initdb-\u306e\u5b9f\u884c",children:"2.1 initdb \u306e\u5b9f\u884c"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# RHEL\u7cfb\u306e\u5834\u5408\nsudo /usr/pgsql-16/bin/postgresql-16-setup initdb\n\n# \u307e\u305f\u306f\u624b\u52d5\u3067\u5b9f\u884c\nsudo -u postgres /usr/pgsql-16/bin/initdb -D /var/lib/pgsql/16/data\n\n# Ubuntu/Debian\u306e\u5834\u5408\uff08\u81ea\u52d5\u3067\u5b9f\u884c\u3055\u308c\u308b\uff09\n# \u624b\u52d5\u3067\u884c\u3046\u5834\u5408\nsudo -u postgres /usr/lib/postgresql/16/bin/initdb -D /var/lib/postgresql/16/main\n"})}),"\n",(0,l.jsx)(e.h3,{id:"22-initdb-\u306e\u30aa\u30d7\u30b7\u30e7\u30f3",children:"2.2 initdb \u306e\u30aa\u30d7\u30b7\u30e7\u30f3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    initdb \u306e\u4e3b\u8981\u30aa\u30d7\u30b7\u30e7\u30f3                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  -D, --pgdata=DIRECTORY                                      \u2502\n\u2502      \u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a                                 \u2502\n\u2502                                                              \u2502\n\u2502  -E, --encoding=ENCODING                                     \u2502\n\u2502      \u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0 (\u63a8\u5968: UTF8)               \u2502\n\u2502                                                              \u2502\n\u2502  --locale=LOCALE                                             \u2502\n\u2502      \u30ed\u30b1\u30fc\u30eb\u8a2d\u5b9a (\u63a8\u5968: C.UTF-8 \u307e\u305f\u306f en_US.UTF-8)         \u2502\n\u2502                                                              \u2502\n\u2502  --lc-collate=LOCALE                                         \u2502\n\u2502      \u7167\u5408\u9806\u5e8f\u306e\u30ed\u30b1\u30fc\u30eb                                       \u2502\n\u2502                                                              \u2502\n\u2502  --data-checksums                                            \u2502\n\u2502      \u30c7\u30fc\u30bf\u30da\u30fc\u30b8\u306e\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u3092\u6709\u52b9\u5316 (\u63a8\u5968)               \u2502\n\u2502                                                              \u2502\n\u2502  -k, --data-encryption                                       \u2502\n\u2502      TDE (Transparent Data Encryption) - PostgreSQL 16+     \u2502\n\u2502                                                              \u2502\n\u2502  --wal-segsize=SIZE                                          \u2502\n\u2502      WAL\u30bb\u30b0\u30e1\u30f3\u30c8\u30b5\u30a4\u30ba (\u30c7\u30d5\u30a9\u30eb\u30c8: 16MB)                  \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"23-\u672c\u756a\u74b0\u5883\u5411\u3051-initdb-\u4f8b",children:"2.3 \u672c\u756a\u74b0\u5883\u5411\u3051 initdb \u4f8b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"sudo -u postgres /usr/pgsql-16/bin/initdb \\\n  -D /var/lib/pgsql/16/data \\\n  -E UTF8 \\\n  --locale=C.UTF-8 \\\n  --data-checksums \\\n  --wal-segsize=64\n"})}),"\n",(0,l.jsx)(e.h3,{id:"24-\u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u69cb\u9020",children:"2.4 \u30c7\u30fc\u30bf\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306e\u69cb\u9020"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"/var/lib/pgsql/16/data/\n\u251c\u2500\u2500 base/                    # \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\n\u2502   \u251c\u2500\u2500 1/                   # template1\n\u2502   \u251c\u2500\u2500 4/                   # template0\n\u2502   \u2514\u2500\u2500 5/                   # postgres\n\u251c\u2500\u2500 global/                  # \u30af\u30e9\u30b9\u30bf\u5168\u4f53\u306e\u5171\u6709\u30c6\u30fc\u30d6\u30eb\n\u251c\u2500\u2500 pg_commit_ts/            # \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b3\u30df\u30c3\u30c8\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\n\u251c\u2500\u2500 pg_dynshmem/             # \u52d5\u7684\u5171\u6709\u30e1\u30e2\u30ea\n\u251c\u2500\u2500 pg_logical/              # \u8ad6\u7406\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\n\u251c\u2500\u2500 pg_multixact/            # \u30de\u30eb\u30c1\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\u251c\u2500\u2500 pg_notify/               # LISTEN/NOTIFY\n\u251c\u2500\u2500 pg_replslot/             # \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b9\u30ed\u30c3\u30c8\n\u251c\u2500\u2500 pg_serial/               # \u30b7\u30ea\u30a2\u30e9\u30a4\u30b6\u30d6\u30eb\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\u251c\u2500\u2500 pg_snapshots/            # \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3055\u308c\u305f\u30b9\u30ca\u30c3\u30d7\u30b7\u30e7\u30c3\u30c8\n\u251c\u2500\u2500 pg_stat/                 # \u7d71\u8a08\u60c5\u5831\uff08\u6c38\u7d9a\uff09\n\u251c\u2500\u2500 pg_stat_tmp/             # \u7d71\u8a08\u60c5\u5831\uff08\u4e00\u6642\uff09\n\u251c\u2500\u2500 pg_subtrans/             # \u30b5\u30d6\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n\u251c\u2500\u2500 pg_tblspc/               # \u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3078\u306e\u30b7\u30f3\u30dc\u30ea\u30c3\u30af\u30ea\u30f3\u30af\n\u251c\u2500\u2500 pg_twophase/             # 2\u30d5\u30a7\u30fc\u30ba\u30b3\u30df\u30c3\u30c8\n\u251c\u2500\u2500 pg_wal/                  # WAL\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 pg_xact/                 # \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b3\u30df\u30c3\u30c8\u72b6\u614b\n\u251c\u2500\u2500 postgresql.auto.conf     # ALTER SYSTEM\u306b\u3088\u308b\u8a2d\u5b9a\n\u251c\u2500\u2500 postgresql.conf          # \u30e1\u30a4\u30f3\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\n\u251c\u2500\u2500 pg_hba.conf              # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c\u8a2d\u5b9a\n\u251c\u2500\u2500 pg_ident.conf            # \u30e6\u30fc\u30b6\u30fc\u30de\u30c3\u30d4\u30f3\u30b0\n\u251c\u2500\u2500 PG_VERSION               # PostgreSQL\u30d0\u30fc\u30b8\u30e7\u30f3\n\u251c\u2500\u2500 postmaster.opts          # \u6700\u5f8c\u306e\u8d77\u52d5\u30aa\u30d7\u30b7\u30e7\u30f3\n\u2514\u2500\u2500 postmaster.pid           # \u30d7\u30ed\u30bb\u30b9ID\uff08\u8d77\u52d5\u4e2d\u306e\u307f\uff09\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"3-postgresqlconf-\u306e\u8a2d\u5b9a",children:"3. postgresql.conf \u306e\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.h3,{id:"31-\u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6982\u8981",children:"3.1 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u6982\u8981"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb\u306e\u512a\u5148\u9806\u4f4d                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u512a\u5148\u5ea6: \u4f4e \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u9ad8    \u2502\n\u2502                                                              \u2502\n\u2502  postgresql.conf                                             \u2502\n\u2502       \u2193 \u4e0a\u66f8\u304d                                               \u2502\n\u2502  postgresql.auto.conf (ALTER SYSTEM)                         \u2502\n\u2502       \u2193 \u4e0a\u66f8\u304d                                               \u2502\n\u2502  \u8d77\u52d5\u6642\u30aa\u30d7\u30b7\u30e7\u30f3 (-c parameter=value)                       \u2502\n\u2502       \u2193 \u4e0a\u66f8\u304d                                               \u2502\n\u2502  \u30bb\u30c3\u30b7\u30e7\u30f3\u5358\u4f4d (SET parameter = value)                      \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"32-\u63a5\u7d9a\u8a2d\u5b9a",children:"3.2 \u63a5\u7d9a\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u63a5\u7d9a\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u30ea\u30c3\u30b9\u30f3\u3059\u308bIP\u30a2\u30c9\u30ec\u30b9\n# '*' = \u5168\u3066\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3001'localhost' = \u30ed\u30fc\u30ab\u30eb\u306e\u307f\nlisten_addresses = '*'\n\n# \u30dd\u30fc\u30c8\u756a\u53f7\nport = 5432\n\n# \u6700\u5927\u540c\u6642\u63a5\u7d9a\u6570\n# \u6ce8\u610f: \u5404\u63a5\u7d9a\u306f\u30e1\u30e2\u30ea\u3092\u6d88\u8cbb\u3059\u308b (work_mem \xd7 \u63a5\u7d9a\u6570)\nmax_connections = 200\n\n# \u30b9\u30fc\u30d1\u30fc\u30e6\u30fc\u30b6\u30fc\u7528\u306e\u4e88\u7d04\u63a5\u7d9a\u6570\nsuperuser_reserved_connections = 3\n\n# Unix \u30bd\u30b1\u30c3\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\nunix_socket_directories = '/var/run/postgresql'\n\n# \u8a8d\u8a3c\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8 (\u79d2)\nauthentication_timeout = 60\n\n# TCP keepalive\u8a2d\u5b9a\ntcp_keepalives_idle = 60\ntcp_keepalives_interval = 10\ntcp_keepalives_count = 6\n"})}),"\n",(0,l.jsx)(e.h3,{id:"33-\u30e1\u30e2\u30ea\u8a2d\u5b9a",children:"3.3 \u30e1\u30e2\u30ea\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u30e1\u30e2\u30ea\u8a2d\u5b9a\u306e\u8003\u3048\u65b9                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010\u30b5\u30fc\u30d0\u30fc\u7dcf\u30e1\u30e2\u30ea: 64GB \u306e\u5834\u5408\u306e\u76ee\u5b89\u3011                     \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  shared_buffers: 16GB (25%)                          \u2502    \u2502\n\u2502  \u2502  - \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30ad\u30e3\u30c3\u30b7\u30e5                            \u2502    \u2502\n\u2502  \u2502  - \u7dcf\u30e1\u30e2\u30ea\u306e 25% \u304c\u76ee\u5b89                             \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  effective_cache_size: 48GB (75%)                    \u2502    \u2502\n\u2502  \u2502  - OS\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u542b\u3081\u305f\u898b\u7a4d\u3082\u308a                      \u2502    \u2502\n\u2502  \u2502  - \u30d7\u30e9\u30f3\u30ca\u30fc\u306e\u5224\u65ad\u306b\u4f7f\u7528                            \u2502    \u2502\n\u2502  \u2502  - \u5b9f\u969b\u306b\u306f\u30e1\u30e2\u30ea\u78ba\u4fdd\u3057\u306a\u3044                          \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  work_mem: 64MB                                      \u2502    \u2502\n\u2502  \u2502  - \u30bd\u30fc\u30c8/\u30cf\u30c3\u30b7\u30e5\u7528 (\u63a5\u7d9a\u3054\u3068\u30fb\u64cd\u4f5c\u3054\u3068)            \u2502    \u2502\n\u2502  \u2502  - max_connections \xd7 \u4e26\u5217\u5ea6 \u3092\u8003\u616e                   \u2502    \u2502\n\u2502  \u2502  - \u5927\u304d\u3059\u304e\u308b\u3068\u30e1\u30e2\u30ea\u4e0d\u8db3\u306e\u539f\u56e0\u306b                    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502  maintenance_work_mem: 2GB                           \u2502    \u2502\n\u2502  \u2502  - VACUUM, CREATE INDEX\u7528                            \u2502    \u2502\n\u2502  \u2502  - \u5927\u304d\u3044\u307b\u3069\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u304c\u9ad8\u901f                      \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u30e1\u30e2\u30ea\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u5171\u6709\u30d0\u30c3\u30d5\u30a1 - \u7dcf\u30e1\u30e2\u30ea\u306e25%\u7a0b\u5ea6\nshared_buffers = 16GB\n\n# OS\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u542b\u3081\u305f\u30ad\u30e3\u30c3\u30b7\u30e5\u898b\u7a4d\u3082\u308a - \u7dcf\u30e1\u30e2\u30ea\u306e75%\u7a0b\u5ea6\neffective_cache_size = 48GB\n\n# \u30bd\u30fc\u30c8/\u30cf\u30c3\u30b7\u30e5\u7528\u30e1\u30e2\u30ea (\u63a5\u7d9a\u3054\u3068)\nwork_mem = 64MB\n\n# \u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u7528\u30e1\u30e2\u30ea\nmaintenance_work_mem = 2GB\n\n# \u4e00\u6642\u30d0\u30c3\u30d5\u30a1 (\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u7528)\ntemp_buffers = 32MB\n\n# Huge Pages (Linux)\n# \u4e8b\u524d\u306bOS\u3067\u8a2d\u5b9a\u304c\u5fc5\u8981\nhuge_pages = try\n\n# \u52d5\u7684\u5171\u6709\u30e1\u30e2\u30ea\ndynamic_shared_memory_type = posix\n"})}),"\n",(0,l.jsx)(e.h3,{id:"34-wal\u8a2d\u5b9a",children:"3.4 WAL\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# WAL\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# WAL\u30ec\u30d9\u30eb\n# minimal: \u6700\u5c0f\u9650 (\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u4e0d\u53ef)\n# replica: \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5bfe\u5fdc (\u30c7\u30d5\u30a9\u30eb\u30c8)\n# logical: \u8ad6\u7406\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u5bfe\u5fdc\nwal_level = replica\n\n# \u540c\u671f\u30b3\u30df\u30c3\u30c8\n# on: \u5b8c\u5168\u540c\u671f (\u30c7\u30fc\u30bf\u640d\u5931\u306a\u3057\u3001\u9045\u3044)\n# off: \u975e\u540c\u671f (\u9ad8\u901f\u3060\u304c\u30af\u30e9\u30c3\u30b7\u30e5\u6642\u306b\u6700\u59273\xd7wal_writer_delay\u306e\u30c7\u30fc\u30bf\u640d\u5931)\n# local: \u30ed\u30fc\u30ab\u30eb\u306e\u307f\u540c\u671f\n# remote_write: \u30b9\u30bf\u30f3\u30d0\u30a4\u306e\u66f8\u304d\u8fbc\u307f\u307e\u3067\u5f85\u6a5f\n# remote_apply: \u30b9\u30bf\u30f3\u30d0\u30a4\u306e\u9069\u7528\u307e\u3067\u5f85\u6a5f\nsynchronous_commit = on\n\n# WAL\u30d0\u30c3\u30d5\u30a1\u30b5\u30a4\u30ba\nwal_buffers = 64MB\n\n# \u30c1\u30a7\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u95a2\u9023\ncheckpoint_timeout = 15min           # \u30c1\u30a7\u30c3\u30af\u30dd\u30a4\u30f3\u30c8\u9593\u9694\ncheckpoint_completion_target = 0.9   # \u5b8c\u4e86\u76ee\u6a19 (0.9 = \u6b21\u306eCP\u307e\u3067\u306e90%\u306e\u6642\u9593\u3067\u5b8c\u4e86)\nmax_wal_size = 4GB                   # WAL\u306e\u6700\u5927\u30b5\u30a4\u30ba\nmin_wal_size = 1GB                   # WAL\u306e\u6700\u5c0f\u30b5\u30a4\u30ba\n\n# WAL\u5727\u7e2e\nwal_compression = on\n\n# \u30d5\u30eb\u30da\u30fc\u30b8\u66f8\u304d\u8fbc\u307f (\u30c7\u30fc\u30bf\u4fdd\u8b77\u306e\u305f\u3081\u57fa\u672c\u7684\u306bon)\nfull_page_writes = on\n"})}),"\n",(0,l.jsx)(e.h3,{id:"35-\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a",children:"3.5 \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# WAL\u9001\u4fe1\u30d7\u30ed\u30bb\u30b9\u6570\nmax_wal_senders = 10\n\n# \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b9\u30ed\u30c3\u30c8\u6570\nmax_replication_slots = 10\n\n# \u30b9\u30bf\u30f3\u30d0\u30a4\u3067\u306e\u554f\u3044\u5408\u308f\u305b\u4e2d\u306eWAL\u4fdd\u6301\nhot_standby_feedback = on\n\n# \u30a2\u30fc\u30ab\u30a4\u30d6\u30e2\u30fc\u30c9\narchive_mode = on\narchive_command = 'cp %p /var/lib/pgsql/archive/%f'\n\n# WAL\u4fdd\u6301 (\u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b9\u30ed\u30c3\u30c8\u672a\u4f7f\u7528\u6642)\nwal_keep_size = 1GB\n"})}),"\n",(0,l.jsx)(e.h3,{id:"36-\u4e26\u5217\u30af\u30a8\u30ea\u8a2d\u5b9a",children:"3.6 \u4e26\u5217\u30af\u30a8\u30ea\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u4e26\u5217\u30af\u30a8\u30ea\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u4e26\u5217\u30ef\u30fc\u30ab\u30fc\u306e\u6700\u5927\u6570\nmax_parallel_workers = 8\n\n# 1\u30af\u30a8\u30ea\u3042\u305f\u308a\u306e\u6700\u5927\u4e26\u5217\u30ef\u30fc\u30ab\u30fc\u6570\nmax_parallel_workers_per_gather = 4\n\n# \u4e26\u5217\u30e1\u30f3\u30c6\u30ca\u30f3\u30b9\u30ef\u30fc\u30ab\u30fc\u6570\nmax_parallel_maintenance_workers = 4\n\n# \u4e26\u5217\u51e6\u7406\u306e\u30b3\u30b9\u30c8\u8a2d\u5b9a\nparallel_tuple_cost = 0.1\nparallel_setup_cost = 1000\n\n# \u4e26\u5217\u51e6\u7406\u3092\u958b\u59cb\u3059\u308b\u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\nmin_parallel_table_scan_size = 8MB\nmin_parallel_index_scan_size = 512kB\n"})}),"\n",(0,l.jsx)(e.h3,{id:"37-vacuum--autovacuum\u8a2d\u5b9a",children:"3.7 VACUUM / Autovacuum\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# Autovacuum\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# Autovacuum\u306e\u6709\u52b9\u5316\nautovacuum = on\n\n# Autovacuum\u30ef\u30fc\u30ab\u30fc\u6570\nautovacuum_max_workers = 3\n\n# \u30c1\u30a7\u30c3\u30af\u9593\u9694 (\u79d2)\nautovacuum_naptime = 60\n\n# VACUUM\u8d77\u52d5\u95be\u5024\nautovacuum_vacuum_threshold = 50           # \u6700\u5c0f\u884c\u6570\nautovacuum_vacuum_scale_factor = 0.1       # \u30c6\u30fc\u30d6\u30eb\u30b5\u30a4\u30ba\u306e\u5272\u5408\n\n# ANALYZE\u8d77\u52d5\u95be\u5024\nautovacuum_analyze_threshold = 50\nautovacuum_analyze_scale_factor = 0.05\n\n# \u30b3\u30b9\u30c8\u5236\u9650 (I/O\u8ca0\u8377\u5236\u5fa1)\nautovacuum_vacuum_cost_delay = 2ms\nautovacuum_vacuum_cost_limit = 1000\n\n# Freeze\u8a2d\u5b9a\nautovacuum_freeze_max_age = 200000000\nautovacuum_multixact_freeze_max_age = 400000000\n"})}),"\n",(0,l.jsx)(e.h3,{id:"38-\u30ed\u30b0\u8a2d\u5b9a",children:"3.8 \u30ed\u30b0\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u30ed\u30b0\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u30ed\u30b0\u51fa\u529b\u5148\nlogging_collector = on\nlog_directory = 'log'\nlog_filename = 'postgresql-%Y-%m-%d.log'\nlog_rotation_age = 1d\nlog_rotation_size = 0\n\n# \u30ed\u30b0\u30ec\u30d9\u30eb\nlog_min_messages = warning\nlog_min_error_statement = error\n\n# \u30b9\u30ed\u30fc\u30af\u30a8\u30ea\u30ed\u30b0\nlog_min_duration_statement = 1000    # 1\u79d2\u4ee5\u4e0a\u306e\u30af\u30a8\u30ea\u3092\u30ed\u30b0\n\n# \u30ed\u30b0\u5185\u5bb9\nlog_checkpoints = on\nlog_connections = on\nlog_disconnections = on\nlog_lock_waits = on\nlog_temp_files = 0                   # \u4e00\u6642\u30d5\u30a1\u30a4\u30eb\u3092\u5168\u3066\u30ed\u30b0\nlog_autovacuum_min_duration = 0      # Autovacuum\u3092\u5168\u3066\u30ed\u30b0\n\n# \u30ed\u30b0\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\nlog_line_prefix = '%t [%p]: user=%u,db=%d,app=%a,client=%h '\nlog_statement = 'ddl'                # none, ddl, mod, all\n"})}),"\n",(0,l.jsx)(e.h3,{id:"39-\u7d71\u8a08\u60c5\u5831\u8a2d\u5b9a",children:"3.9 \u7d71\u8a08\u60c5\u5831\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# \u7d71\u8a08\u60c5\u5831\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u7d71\u8a08\u60c5\u5831\u30b3\u30ec\u30af\u30bf\u30fc\ntrack_activities = on\ntrack_counts = on\ntrack_io_timing = on                 # I/O\u6642\u9593\u306e\u8a08\u6e2c (\u82e5\u5e72\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9)\ntrack_wal_io_timing = on\ntrack_functions = all                # \u95a2\u6570\u306e\u7d71\u8a08\n\n# \u7d71\u8a08\u60c5\u5831\u306e\u8a73\u7d30\u5ea6\ndefault_statistics_target = 100      # \u30d2\u30b9\u30c8\u30b0\u30e9\u30e0\u306e\u30b5\u30f3\u30d7\u30eb\u6570\n"})}),"\n",(0,l.jsx)(e.h3,{id:"310-ssd\u5411\u3051\u8a2d\u5b9a",children:"3.10 SSD\u5411\u3051\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"#------------------------------------------------------------------------------\n# SSD\u5411\u3051\u8a2d\u5b9a\n#------------------------------------------------------------------------------\n\n# \u30e9\u30f3\u30c0\u30e0\u30a2\u30af\u30bb\u30b9\u306e\u30b3\u30b9\u30c8\u3092\u4e0b\u3052\u308b\nrandom_page_cost = 1.1               # HDD: 4.0, SSD: 1.1-1.5\n\n# \u30b7\u30fc\u30b1\u30f3\u30b7\u30e3\u30eb\u30a2\u30af\u30bb\u30b9\u3068\u306e\u5dee\u3092\u5c0f\u3055\u304f\nseq_page_cost = 1.0\n\n# \u5b9f\u52b9I/O\u4e26\u5217\u5ea6\neffective_io_concurrency = 200       # HDD: 2, SSD: 200\nmaintenance_io_concurrency = 200\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"4-pg_hbaconf-\u306e\u8a2d\u5b9a",children:"4. pg_hba.conf \u306e\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.h3,{id:"41-pg_hbaconf-\u306e\u69cb\u9020",children:"4.1 pg_hba.conf \u306e\u69cb\u9020"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    pg_hba.conf \u306e\u5f62\u5f0f                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  TYPE    DATABASE    USER    ADDRESS         METHOD          \u2502\n\u2502  \u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500\u2500         \u2500\u2500\u2500\u2500\u2500\u2500          \u2502\n\u2502                                                              \u2502\n\u2502  local   all         all                     peer            \u2502\n\u2502  host    all         all     127.0.0.1/32    scram-sha-256   \u2502\n\u2502  host    all         all     ::1/128         scram-sha-256   \u2502\n\u2502  host    mydb        myuser  192.168.1.0/24  scram-sha-256   \u2502\n\u2502                                                              \u2502\n\u2502  \u3010TYPE\u3011                                                    \u2502\n\u2502  local  : Unix\u30c9\u30e1\u30a4\u30f3\u30bd\u30b1\u30c3\u30c8\u63a5\u7d9a                           \u2502\n\u2502  host   : TCP/IP\u63a5\u7d9a (SSL/\u975eSSL\u4e21\u65b9)                         \u2502\n\u2502  hostssl: SSL\u63a5\u7d9a\u306e\u307f                                        \u2502\n\u2502  hostnossl: \u975eSSL\u63a5\u7d9a\u306e\u307f                                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010METHOD\u3011                                                  \u2502\n\u2502  trust       : \u7121\u6761\u4ef6\u3067\u8a31\u53ef (\u5371\u967a)                           \u2502\n\u2502  reject      : \u7121\u6761\u4ef6\u3067\u62d2\u5426                                  \u2502\n\u2502  scram-sha-256: \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c (\u63a8\u5968)                        \u2502\n\u2502  md5         : MD5\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c (\u975e\u63a8\u5968)                    \u2502\n\u2502  peer        : OS\u30e6\u30fc\u30b6\u30fc\u540d\u3067\u8a8d\u8a3c (local\u63a5\u7d9a\u7528)              \u2502\n\u2502  ident       : Ident\u30b5\u30fc\u30d0\u30fc\u3067\u8a8d\u8a3c                           \u2502\n\u2502  cert        : SSL\u8a3c\u660e\u66f8\u8a8d\u8a3c                                 \u2502\n\u2502  ldap        : LDAP\u8a8d\u8a3c                                      \u2502\n\u2502  gss         : GSSAPI\u8a8d\u8a3c                                    \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"42-\u672c\u756a\u74b0\u5883\u5411\u3051-pg_hbaconf-\u4f8b",children:"4.2 \u672c\u756a\u74b0\u5883\u5411\u3051 pg_hba.conf \u4f8b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# TYPE  DATABASE        USER            ADDRESS                 METHOD\n\n# \u30ed\u30fc\u30ab\u30eb\u63a5\u7d9a (postgres \u30e6\u30fc\u30b6\u30fc)\nlocal   all             postgres                                peer\n\n# \u30ed\u30fc\u30ab\u30eb\u63a5\u7d9a (\u4e00\u822c\u30e6\u30fc\u30b6\u30fc)\nlocal   all             all                                     scram-sha-256\n\n# \u30ed\u30fc\u30ab\u30eb\u30db\u30b9\u30c8\u304b\u3089\u306eTCP/IP\u63a5\u7d9a\nhost    all             all             127.0.0.1/32            scram-sha-256\nhost    all             all             ::1/128                 scram-sha-256\n\n# \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u306e\u63a5\u7d9a (SSL\u5fc5\u9808)\nhostssl myapp_prod      myapp_user      10.0.1.0/24             scram-sha-256\n\n# \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u7528\u63a5\u7d9a\nhostssl replication     repl_user       10.0.2.0/24             scram-sha-256\n\n# \u76e3\u8996\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u306e\u63a5\u7d9a\nhostssl all             monitor_user    10.0.3.10/32            scram-sha-256\n\n# \u7ba1\u7406\u8005\u304b\u3089\u306e\u63a5\u7d9a (\u7279\u5b9aIP)\nhostssl all             admin_user      192.168.100.0/24        scram-sha-256\n\n# \u305d\u306e\u4ed6\u306f\u5168\u3066\u62d2\u5426 (\u660e\u793a\u7684\u306b\u8a18\u8f09)\nhost    all             all             0.0.0.0/0               reject\n"})}),"\n",(0,l.jsx)(e.h3,{id:"43-\u8a2d\u5b9a\u5909\u66f4\u306e\u53cd\u6620",children:"4.3 \u8a2d\u5b9a\u5909\u66f4\u306e\u53cd\u6620"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'# \u8a2d\u5b9a\u3092\u30ea\u30ed\u30fc\u30c9 (\u518d\u8d77\u52d5\u4e0d\u8981)\nsudo -u postgres psql -c "SELECT pg_reload_conf();"\n\n# \u307e\u305f\u306f\nsudo systemctl reload postgresql-16\n\n# \u73fe\u5728\u306e\u8a2d\u5b9a\u3092\u78ba\u8a8d\nsudo -u postgres psql -c "SELECT * FROM pg_hba_file_rules;"\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"5-\u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u3068\u7ba1\u7406",children:"5. \u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\u3068\u7ba1\u7406"}),"\n",(0,l.jsx)(e.h3,{id:"51-systemd-\u3067\u306e\u7ba1\u7406",children:"5.1 systemd \u3067\u306e\u7ba1\u7406"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u30b5\u30fc\u30d3\u30b9\u306e\u8d77\u52d5\nsudo systemctl start postgresql-16\n\n# \u30b5\u30fc\u30d3\u30b9\u306e\u505c\u6b62\nsudo systemctl stop postgresql-16\n\n# \u30b5\u30fc\u30d3\u30b9\u306e\u518d\u8d77\u52d5\nsudo systemctl restart postgresql-16\n\n# \u8a2d\u5b9a\u30ea\u30ed\u30fc\u30c9 (\u63a5\u7d9a\u3092\u5207\u65ad\u3057\u306a\u3044)\nsudo systemctl reload postgresql-16\n\n# \u81ea\u52d5\u8d77\u52d5\u306e\u6709\u52b9\u5316\nsudo systemctl enable postgresql-16\n\n# \u30b9\u30c6\u30fc\u30bf\u30b9\u78ba\u8a8d\nsudo systemctl status postgresql-16\n"})}),"\n",(0,l.jsx)(e.h3,{id:"52-pg_ctl-\u3067\u306e\u7ba1\u7406",children:"5.2 pg_ctl \u3067\u306e\u7ba1\u7406"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u8d77\u52d5\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl start -D /var/lib/pgsql/16/data\n\n# \u505c\u6b62\u30e2\u30fc\u30c9\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl stop -D /var/lib/pgsql/16/data -m smart   # \u5168\u63a5\u7d9a\u7d42\u4e86\u5f85\u3061\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl stop -D /var/lib/pgsql/16/data -m fast    # \u5373\u5ea7\u306b\u5207\u65ad\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl stop -D /var/lib/pgsql/16/data -m immediate # \u5f37\u5236\u7d42\u4e86\n\n# \u518d\u8d77\u52d5\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl restart -D /var/lib/pgsql/16/data -m fast\n\n# \u30ea\u30ed\u30fc\u30c9\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl reload -D /var/lib/pgsql/16/data\n\n# \u30b9\u30c6\u30fc\u30bf\u30b9\nsudo -u postgres /usr/pgsql-16/bin/pg_ctl status -D /var/lib/pgsql/16/data\n"})}),"\n",(0,l.jsx)(e.h3,{id:"53-\u505c\u6b62\u30e2\u30fc\u30c9\u306e\u9055\u3044",children:"5.3 \u505c\u6b62\u30e2\u30fc\u30c9\u306e\u9055\u3044"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      \u505c\u6b62\u30e2\u30fc\u30c9\u306e\u6bd4\u8f03                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u3010smart\u3011                                                   \u2502\n\u2502  - \u65b0\u898f\u63a5\u7d9a\u3092\u62d2\u5426                                            \u2502\n\u2502  - \u65e2\u5b58\u63a5\u7d9a\u306e\u7d42\u4e86\u3092\u5f85\u6a5f                                      \u2502\n\u2502  - \u5168\u30bb\u30c3\u30b7\u30e7\u30f3\u7d42\u4e86\u5f8c\u306b\u505c\u6b62                                  \u2502\n\u2502  - \u6642\u9593\u304c\u304b\u304b\u308b\u53ef\u80fd\u6027\u3042\u308a                                    \u2502\n\u2502                                                              \u2502\n\u2502  \u3010fast\u3011(\u63a8\u5968)                                              \u2502\n\u2502  - \u65b0\u898f\u63a5\u7d9a\u3092\u62d2\u5426                                            \u2502\n\u2502  - \u65e2\u5b58\u63a5\u7d9a\u3092\u5207\u65ad                                            \u2502\n\u2502  - \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u30ed\u30fc\u30eb\u30d0\u30c3\u30af                            \u2502\n\u2502  - \u6b63\u5e38\u306a\u30b7\u30e3\u30c3\u30c8\u30c0\u30a6\u30f3                                      \u2502\n\u2502                                                              \u2502\n\u2502  \u3010immediate\u3011                                               \u2502\n\u2502  - \u5373\u5ea7\u306b\u30d7\u30ed\u30bb\u30b9\u3092\u7d42\u4e86                                      \u2502\n\u2502  - \u6b21\u56de\u8d77\u52d5\u6642\u306b\u30ea\u30ab\u30d0\u30ea\u304c\u5fc5\u8981                                \u2502\n\u2502  - \u7dca\u6025\u6642\u306e\u307f\u4f7f\u7528                                            \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"6-\u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d",children:"6. \u521d\u671f\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u4f5c\u696d"}),"\n",(0,l.jsx)(e.h3,{id:"61-\u521d\u671f\u30e6\u30fc\u30b6\u30fc\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210",children:"6.1 \u521d\u671f\u30e6\u30fc\u30b6\u30fc\u3068\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"-- \u30b9\u30fc\u30d1\u30fc\u30e6\u30fc\u30b6\u30fc(postgres)\u3067\u30ed\u30b0\u30a4\u30f3\nsudo -u postgres psql\n\n-- \u7ba1\u7406\u8005\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\nCREATE ROLE admin_user WITH\n    LOGIN\n    PASSWORD 'secure_password_here'\n    CREATEDB\n    CREATEROLE\n    REPLICATION;\n\n-- \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\nCREATE ROLE myapp_user WITH\n    LOGIN\n    PASSWORD 'app_password_here';\n\n-- \u8aad\u307f\u53d6\u308a\u5c02\u7528\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\nCREATE ROLE readonly_user WITH\n    LOGIN\n    PASSWORD 'readonly_password_here';\n\n-- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\nCREATE DATABASE myapp_prod\n    OWNER myapp_user\n    ENCODING 'UTF8'\n    LC_COLLATE 'C.UTF-8'\n    LC_CTYPE 'C.UTF-8'\n    TEMPLATE template0;\n\n-- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u6a29\u9650\nGRANT CONNECT ON DATABASE myapp_prod TO readonly_user;\n\n-- \u30b9\u30ad\u30fc\u30de\u306e\u4f5c\u6210\n\\c myapp_prod\nCREATE SCHEMA app AUTHORIZATION myapp_user;\n\n-- \u8aad\u307f\u53d6\u308a\u5c02\u7528\u30e6\u30fc\u30b6\u30fc\u3078\u306e\u6a29\u9650\nGRANT USAGE ON SCHEMA app TO readonly_user;\nALTER DEFAULT PRIVILEGES IN SCHEMA app GRANT SELECT ON TABLES TO readonly_user;\n"})}),"\n",(0,l.jsx)(e.h3,{id:"62-\u62e1\u5f35\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",children:"6.2 \u62e1\u5f35\u6a5f\u80fd\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:'-- \u3088\u304f\u4f7f\u3046\u62e1\u5f35\u6a5f\u80fd\n\\c myapp_prod\n\n-- UUID\u751f\u6210\nCREATE EXTENSION IF NOT EXISTS "uuid-ossp";\n\n-- \u6697\u53f7\u5316\u95a2\u6570\nCREATE EXTENSION IF NOT EXISTS pgcrypto;\n\n-- \u7d71\u8a08\u60c5\u5831\nCREATE EXTENSION IF NOT EXISTS pg_stat_statements;\n\n-- \u30c8\u30ea\u30b0\u30e9\u30e0 (\u3042\u3044\u307e\u3044\u691c\u7d22)\nCREATE EXTENSION IF NOT EXISTS pg_trgm;\n\n-- \u30c6\u30fc\u30d6\u30eb\u80a5\u5927\u5316\u78ba\u8a8d\nCREATE EXTENSION IF NOT EXISTS pgstattuple;\n\n-- \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u307f\u62e1\u5f35\u306e\u78ba\u8a8d\n\\dx\n'})}),"\n",(0,l.jsx)(e.h3,{id:"63-pg_stat_statements-\u306e\u8a2d\u5b9a",children:"6.3 pg_stat_statements \u306e\u8a2d\u5b9a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ini",children:"# postgresql.conf \u306b\u8ffd\u52a0\nshared_preload_libraries = 'pg_stat_statements'\n\n# pg_stat_statements \u306e\u8a2d\u5b9a\npg_stat_statements.max = 10000\npg_stat_statements.track = all\npg_stat_statements.track_utility = on\npg_stat_statements.track_planning = on\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u8a2d\u5b9a\u5909\u66f4\u5f8c\u306f\u518d\u8d77\u52d5\u304c\u5fc5\u8981\nsudo systemctl restart postgresql-16\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"7-\u672c\u756a\u74b0\u5883\u5411\u3051\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8",children:"7. \u672c\u756a\u74b0\u5883\u5411\u3051\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8"}),"\n",(0,l.jsx)(e.h3,{id:"71-\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af",children:"7.1 \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u25a1 postgres \u30e6\u30fc\u30b6\u30fc\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u8a2d\u5b9a                         \u2502\n\u2502  \u25a1 trust \u8a8d\u8a3c\u3092\u4f7f\u7528\u3057\u3066\u3044\u306a\u3044                                \u2502\n\u2502  \u25a1 listen_addresses \u3092\u5fc5\u8981\u6700\u5c0f\u9650\u306b\u5236\u9650                       \u2502\n\u2502  \u25a1 pg_hba.conf \u3067\u63a5\u7d9a\u5143\u3092\u5236\u9650                                \u2502\n\u2502  \u25a1 SSL/TLS \u3092\u6709\u52b9\u5316                                          \u2502\n\u2502  \u25a1 scram-sha-256 \u8a8d\u8a3c\u3092\u4f7f\u7528                                  \u2502\n\u2502  \u25a1 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30e6\u30fc\u30b6\u30fc\u306b\u6700\u5c0f\u6a29\u9650                        \u2502\n\u2502  \u25a1 \u30c7\u30d5\u30a9\u30eb\u30c8\u306e public \u30b9\u30ad\u30fc\u30de\u6a29\u9650\u3092\u5236\u9650                    \u2502\n\u2502  \u25a1 \u30ed\u30b0\u306b\u63a5\u7d9a\u60c5\u5831\u3092\u8a18\u9332                                      \u2502\n\u2502  \u25a1 \u30d5\u30a1\u30a4\u30a2\u30a6\u30a9\u30fc\u30eb\u3067\u30dd\u30fc\u30c8\u3092\u5236\u9650                            \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"72-\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c1\u30a7\u30c3\u30af",children:"7.2 \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c1\u30a7\u30c3\u30af"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u25a1 shared_buffers \u3092\u9069\u5207\u306b\u8a2d\u5b9a (\u7dcf\u30e1\u30e2\u30ea\u306e25%)               \u2502\n\u2502  \u25a1 effective_cache_size \u3092\u8a2d\u5b9a (\u7dcf\u30e1\u30e2\u30ea\u306e75%)               \u2502\n\u2502  \u25a1 work_mem \u3092\u8a2d\u5b9a (\u8ca0\u8377\u30c6\u30b9\u30c8\u3067\u8abf\u6574)                        \u2502\n\u2502  \u25a1 maintenance_work_mem \u3092\u8a2d\u5b9a                               \u2502\n\u2502  \u25a1 SSD\u306e\u5834\u5408 random_page_cost \u3092\u8abf\u6574                         \u2502\n\u2502  \u25a1 checkpoint_timeout, max_wal_size \u3092\u8abf\u6574                   \u2502\n\u2502  \u25a1 \u4e26\u5217\u30af\u30a8\u30ea\u3092\u6709\u52b9\u5316                                        \u2502\n\u2502  \u25a1 pg_stat_statements \u3092\u6709\u52b9\u5316                               \u2502\n\u2502  \u25a1 \u30b9\u30ed\u30fc\u30af\u30a8\u30ea\u30ed\u30b0\u3092\u6709\u52b9\u5316                                  \u2502\n\u2502  \u25a1 Autovacuum \u304c\u6709\u52b9                                         \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"73-\u53ef\u7528\u6027\u30c1\u30a7\u30c3\u30af",children:"7.3 \u53ef\u7528\u6027\u30c1\u30a7\u30c3\u30af"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  \u53ef\u7528\u6027\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                              \u2502\n\u2502  \u25a1 data_checksums \u304c\u6709\u52b9                                     \u2502\n\u2502  \u25a1 \u30a2\u30fc\u30ab\u30a4\u30d6\u30e2\u30fc\u30c9\u304c\u6709\u52b9                                    \u2502\n\u2502  \u25a1 \u30ec\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304c\u8a2d\u5b9a\u6e08\u307f                                \u2502\n\u2502  \u25a1 \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u30b9\u30af\u30ea\u30d7\u30c8\u304c\u8a2d\u5b9a\u6e08\u307f                          \u2502\n\u2502  \u25a1 \u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u306e\u30ea\u30b9\u30c8\u30a2\u30c6\u30b9\u30c8\u5b9f\u65bd                          \u2502\n\u2502  \u25a1 \u76e3\u8996\u304c\u8a2d\u5b9a\u6e08\u307f                                            \u2502\n\u2502  \u25a1 \u30a2\u30e9\u30fc\u30c8\u304c\u8a2d\u5b9a\u6e08\u307f                                        \u2502\n\u2502  \u25a1 \u969c\u5bb3\u6642\u306e\u624b\u9806\u66f8\u4f5c\u6210                                        \u2502\n\u2502  \u25a1 \u81ea\u52d5\u8d77\u52d5\u304c\u6709\u52b9 (systemctl enable)                         \u2502\n\u2502                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,l.jsx)(e.h3,{id:"74-\u73fe\u5728\u306e\u8a2d\u5b9a\u78ba\u8a8d\u30af\u30a8\u30ea",children:"7.4 \u73fe\u5728\u306e\u8a2d\u5b9a\u78ba\u8a8d\u30af\u30a8\u30ea"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",children:"-- \u4e3b\u8981\u306a\u8a2d\u5b9a\u5024\u306e\u78ba\u8a8d\nSELECT name, setting, unit, context, short_desc\nFROM pg_settings\nWHERE name IN (\n    'max_connections',\n    'shared_buffers',\n    'effective_cache_size',\n    'work_mem',\n    'maintenance_work_mem',\n    'wal_level',\n    'max_wal_senders',\n    'max_replication_slots',\n    'checkpoint_timeout',\n    'max_wal_size',\n    'random_page_cost',\n    'effective_io_concurrency',\n    'autovacuum',\n    'log_min_duration_statement'\n)\nORDER BY name;\n\n-- data_checksums \u306e\u78ba\u8a8d\nSHOW data_checksums;\n\n-- \u73fe\u5728\u306e\u63a5\u7d9a\u6570\nSELECT count(*) FROM pg_stat_activity;\n\n-- \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b5\u30a4\u30ba\nSELECT pg_database.datname, pg_size_pretty(pg_database_size(pg_database.datname))\nFROM pg_database\nORDER BY pg_database_size(pg_database.datname) DESC;\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"\u53c2\u8003\u30ea\u30f3\u30af",children:"\u53c2\u8003\u30ea\u30f3\u30af"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/runtime-config.html",children:"PostgreSQL\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 - \u30b5\u30fc\u30d0\u30fc\u8a2d\u5b9a"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://www.postgresql.org/docs/current/client-authentication.html",children:"PostgreSQL\u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 - \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u8a8d\u8a3c"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://pgtune.leopard.in.ua/",children:"PGTune - \u8a2d\u5b9a\u5024\u8a08\u7b97\u30c4\u30fc\u30eb"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://wiki.postgresql.org/wiki/Tuning_Your_PostgreSQL_Server",children:"PostgreSQL Wiki - Tuning Your PostgreSQL Server"})}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>i});var a=s(96540);const l={},t=a.createContext(l);function r(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),a.createElement(t.Provider,{value:e},n.children)}}}]);