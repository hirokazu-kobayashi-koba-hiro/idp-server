"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3381],{14550:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"content_08_ops/performance/test-execution-guide","title":"\u6027\u80fd\u30c6\u30b9\u30c8\u5b9f\u884c\u30ac\u30a4\u30c9","description":"\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u6027\u80fd\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u624b\u9806\u3092 step-by-step \u3067\u8aac\u660e\u3059\u308b\u3002","source":"@site/docs/content_08_ops/performance/06-test-execution-guide.md","sourceDirName":"content_08_ops/performance","slug":"/content_08_ops/performance/test-execution-guide","permalink":"/idp-server/docs/content_08_ops/performance/test-execution-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_08_ops/performance/06-test-execution-guide.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"docs","previous":{"title":"\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9","permalink":"/idp-server/docs/content_08_ops/performance/tuning-guide"},"next":{"title":"\u5546\u7528\u30c7\u30d7\u30ed\u30a4\u30e1\u30f3\u30c8\u6982\u8981","permalink":"/idp-server/docs/content_08_ops/commercial-deployment/overview"}}');var t=s(74848),d=s(28453);const c={},i="\u6027\u80fd\u30c6\u30b9\u30c8\u5b9f\u884c\u30ac\u30a4\u30c9",l={},a=[{value:"\u524d\u63d0\u6761\u4ef6",id:"\u524d\u63d0\u6761\u4ef6",level:2},{value:"\u5b9f\u884c\u9806\u5e8f\u306e\u6982\u8981",id:"\u5b9f\u884c\u9806\u5e8f\u306e\u6982\u8981",level:2},{value:"Phase 1: Docker\u74b0\u5883\u8d77\u52d5",id:"phase-1-docker\u74b0\u5883\u8d77\u52d5",level:2},{value:"Step 1.1: Docker Compose \u3067\u8d77\u52d5",id:"step-11-docker-compose-\u3067\u8d77\u52d5",level:3},{value:"Step 1.2: \u8d77\u52d5\u78ba\u8a8d",id:"step-12-\u8d77\u52d5\u78ba\u8a8d",level:3},{value:"Step 1.3: pg_stat_statements \u6709\u52b9\u5316",id:"step-13-pg_stat_statements-\u6709\u52b9\u5316",level:3},{value:"Phase 2: \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4e00\u62ec\u6e96\u5099",id:"phase-2-\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4e00\u62ec\u6e96\u5099",level:2},{value:"\u30c6\u30b9\u30c8\u65b9\u91dd\u306b\u57fa\u3065\u304f\u30c7\u30fc\u30bf\u898f\u6a21",id:"\u30c6\u30b9\u30c8\u65b9\u91dd\u306b\u57fa\u3065\u304f\u30c7\u30fc\u30bf\u898f\u6a21",level:3},{value:"Step 2.1: \u30c6\u30ca\u30f3\u30c8\u767b\u9332",id:"step-21-\u30c6\u30ca\u30f3\u30c8\u767b\u9332",level:3},{value:"Step 2.2: \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u751f\u6210",id:"step-22-\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u751f\u6210",level:3},{value:"Step 2.3: \u30c7\u30fc\u30bf\u6295\u5165",id:"step-23-\u30c7\u30fc\u30bf\u6295\u5165",level:3},{value:"Step 2.4: k6\u30c6\u30b9\u30c8\u7528JSON\u306e\u914d\u7f6e",id:"step-24-k6\u30c6\u30b9\u30c8\u7528json\u306e\u914d\u7f6e",level:3},{value:"Step 2.5: \u6295\u5165\u78ba\u8a8d",id:"step-25-\u6295\u5165\u78ba\u8a8d",level:3},{value:"Phase 3: \u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u5b9f\u884c",id:"phase-3-\u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u5b9f\u884c",level:2},{value:"\u7d50\u679c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210",id:"\u7d50\u679c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210",level:3},{value:"Step 3.1: \u8a8d\u53ef\u30ea\u30af\u30a8\u30b9\u30c8",id:"step-31-\u8a8d\u53ef\u30ea\u30af\u30a8\u30b9\u30c8",level:3},{value:"Phase 4: \u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u5b9f\u884c",id:"phase-4-\u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u5b9f\u884c",level:2},{value:"Step 4.0: \u6295\u5165\u78ba\u8a8d",id:"step-40-\u6295\u5165\u78ba\u8a8d",level:3},{value:"\u74b0\u5883\u5909\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7",id:"\u74b0\u5883\u5909\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7",level:3},{value:"Step 7.1: \u30b7\u30f3\u30b0\u30eb\u30c6\u30ca\u30f3\u30c8CIBA",id:"step-71-\u30b7\u30f3\u30b0\u30eb\u30c6\u30ca\u30f3\u30c8ciba",level:3},{value:"Step 7.2: \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8CIBA",id:"step-72-\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8ciba",level:3},{value:"Step 7.3: \u30d4\u30fc\u30af\u8ca0\u8377",id:"step-73-\u30d4\u30fc\u30af\u8ca0\u8377",level:3},{value:"Step 7.4: \u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc",id:"step-74-\u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc",level:3},{value:"Phase 7.5: \u6e2c\u5b9a\u89b3\u70b9\u5225\u30c6\u30b9\u30c8\u5b9f\u884c",id:"phase-75-\u6e2c\u5b9a\u89b3\u70b9\u5225\u30c6\u30b9\u30c8\u5b9f\u884c",level:2},{value:"7.5.1: \u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u6e2c\u5b9a",id:"751-\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u6e2c\u5b9a",level:3},{value:"7.5.2: \u540c\u6642\u8ca0\u8377\u5f71\u97ff\u6e2c\u5b9a",id:"752-\u540c\u6642\u8ca0\u8377\u5f71\u97ff\u6e2c\u5b9a",level:3},{value:"7.5.3: \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5f71\u97ff\u6e2c\u5b9a",id:"753-\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5f71\u97ff\u6e2c\u5b9a",level:3},{value:"7.5.4: \u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u5f71\u97ff\u6e2c\u5b9a",id:"754-\u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u5f71\u97ff\u6e2c\u5b9a",level:3},{value:"7.5.5: \u8ca0\u8377\u9650\u754c\u691c\u8a3c",id:"755-\u8ca0\u8377\u9650\u754c\u691c\u8a3c",level:3},{value:"Phase 8: \u7d50\u679c\u5206\u6790",id:"phase-8-\u7d50\u679c\u5206\u6790",level:2},{value:"Step 8.1: pg_stat_statements\u78ba\u8a8d",id:"step-81-pg_stat_statements\u78ba\u8a8d",level:3},{value:"Step 8.2: \u7d71\u8a08\u30ea\u30bb\u30c3\u30c8\uff08\u6b21\u56de\u30c6\u30b9\u30c8\u524d\uff09",id:"step-82-\u7d71\u8a08\u30ea\u30bb\u30c3\u30c8\u6b21\u56de\u30c6\u30b9\u30c8\u524d",level:3},{value:"Step 8.3: \u30ea\u30bd\u30fc\u30b9\u76e3\u8996",id:"step-83-\u30ea\u30bd\u30fc\u30b9\u76e3\u8996",level:3},{value:"Phase 9: \u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",id:"phase-9-\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",level:2},{value:"\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",id:"\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",level:3},{value:"Docker\u74b0\u5883\u505c\u6b62",id:"docker\u74b0\u5883\u505c\u6b62",level:3},{value:"\u4e00\u62ec\u5b9f\u884c\u30b9\u30af\u30ea\u30d7\u30c8",id:"\u4e00\u62ec\u5b9f\u884c\u30b9\u30af\u30ea\u30d7\u30c8",level:2},{value:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",level:2},{value:"\u30c7\u30fc\u30bf\u6295\u5165\u30a8\u30e9\u30fc",id:"\u30c7\u30fc\u30bf\u6295\u5165\u30a8\u30e9\u30fc",level:3},{value:"k6\u63a5\u7d9a\u30a8\u30e9\u30fc",id:"k6\u63a5\u7d9a\u30a8\u30e9\u30fc",level:3},{value:"\u30e1\u30e2\u30ea\u4e0d\u8db3",id:"\u30e1\u30e2\u30ea\u4e0d\u8db3",level:3},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\u6027\u80fd\u30c6\u30b9\u30c8\u5b9f\u884c\u30ac\u30a4\u30c9",children:"\u6027\u80fd\u30c6\u30b9\u30c8\u5b9f\u884c\u30ac\u30a4\u30c9"})}),"\n",(0,t.jsx)(n.p,{children:"\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u6027\u80fd\u30c6\u30b9\u30c8\u306e\u5b9f\u884c\u624b\u9806\u3092 step-by-step \u3067\u8aac\u660e\u3059\u308b\u3002"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u524d\u63d0\u6761\u4ef6",children:"\u524d\u63d0\u6761\u4ef6"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Docker / Docker Compose \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068"}),"\n",(0,t.jsxs)(n.li,{children:["k6 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068\uff08",(0,t.jsx)(n.code,{children:"brew install k6"}),"\uff09"]}),"\n",(0,t.jsx)(n.li,{children:"Python 3 \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068"}),"\n",(0,t.jsx)(n.li,{children:"PostgreSQL \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08psql\uff09\u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u3066\u3044\u308b\u3053\u3068"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u5b9f\u884c\u9806\u5e8f\u306e\u6982\u8981",children:"\u5b9f\u884c\u9806\u5e8f\u306e\u6982\u8981"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Phase 1: Docker\u74b0\u5883\u8d77\u52d5\n    \u2193\nPhase 2: \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4e00\u62ec\u6e96\u5099\uff08\u5168\u6e2c\u5b9a\u306b\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u3092\u4e8b\u524d\u6295\u5165\uff09\n    \u251c\u2500\u2500 2.1: \u30c6\u30ca\u30f3\u30c8\u767b\u9332\uff08\u6700\u592710\u30c6\u30ca\u30f3\u30c8\uff09\n    \u251c\u2500\u2500 2.2: \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u751f\u6210\uff08\u5404\u30c6\u30ca\u30f3\u30c8100\u4e07\u4ef6\uff09\n    \u2514\u2500\u2500 2.3: PostgreSQL COPY\u6295\u5165\n    \u2193\nPhase 3: \u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u5b9f\u884c\n    \u2193\nPhase 4: \u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u5b9f\u884c\uff08\u30d1\u30e9\u30e1\u30fc\u30bf\u5909\u66f4\u306e\u307f\u3001\u30c7\u30fc\u30bf\u8ffd\u52a0\u4e0d\u8981\uff09\n    \u251c\u2500\u2500 \u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u6e2c\u5b9a\n    \u251c\u2500\u2500 \u540c\u6642\u8ca0\u8377\u5f71\u97ff\u6e2c\u5b9a\n    \u251c\u2500\u2500 \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5f71\u97ff\u6e2c\u5b9a\uff08TENANT_COUNT \u3067\u5236\u5fa1\uff09\n    \u251c\u2500\u2500 \u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u5f71\u97ff\u6e2c\u5b9a\n    \u2514\u2500\u2500 \u8ca0\u8377\u9650\u754c\u691c\u8a3c\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"\u4e00\u62ec\u30c7\u30fc\u30bf\u6e96\u5099\u306e\u5229\u70b9",type:"tip",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u30c6\u30b9\u30c8\u9593\u306e\u4e00\u8cab\u6027\u304c\u4fdd\u8a3c\u3055\u308c\u308b"}),"\n",(0,t.jsx)(n.li,{children:"\u6e2c\u5b9a\u3054\u3068\u306e\u30c7\u30fc\u30bf\u8ffd\u52a0\u304c\u4e0d\u8981"}),"\n",(0,t.jsxs)(n.li,{children:["\u30d1\u30e9\u30e1\u30fc\u30bf\uff08",(0,t.jsx)(n.code,{children:"TENANT_COUNT"}),", ",(0,t.jsx)(n.code,{children:"VU_COUNT"}),"\u7b49\uff09\u3067\u5404\u6e2c\u5b9a\u3092\u5236\u5fa1"]}),"\n"]})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-1-docker\u74b0\u5883\u8d77\u52d5",children:"Phase 1: Docker\u74b0\u5883\u8d77\u52d5"}),"\n",(0,t.jsx)(n.h3,{id:"step-11-docker-compose-\u3067\u8d77\u52d5",children:"Step 1.1: Docker Compose \u3067\u8d77\u52d5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u30eb\u30fc\u30c8\u3067\u5b9f\u884c\ndocker compose up -d\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-12-\u8d77\u52d5\u78ba\u8a8d",children:"Step 1.2: \u8d77\u52d5\u78ba\u8a8d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30b3\u30f3\u30c6\u30ca\u72b6\u614b\u78ba\u8a8d\ndocker compose ps\n\n# \u30d8\u30eb\u30b9\u30c1\u30a7\u30c3\u30af\ncurl http://localhost:8080/health\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-13-pg_stat_statements-\u6709\u52b9\u5316",children:"Step 1.3: pg_stat_statements \u6709\u52b9\u5316"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'docker exec -it postgres-primary psql -U idpserver -d idpserver -c "CREATE EXTENSION IF NOT EXISTS pg_stat_statements;"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-2-\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4e00\u62ec\u6e96\u5099",children:"Phase 2: \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u4e00\u62ec\u6e96\u5099"}),"\n",(0,t.jsx)(n.p,{children:"\u5168\u6e2c\u5b9a\uff08\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u3001\u540c\u6642\u8ca0\u8377\u3001\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u3001\u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\uff09\u306b\u5fc5\u8981\u306a\u30c7\u30fc\u30bf\u3092\u4e8b\u524d\u306b\u4e00\u62ec\u6295\u5165\u3059\u308b\u3002"}),"\n",(0,t.jsx)(n.admonition,{title:"\u524d\u63d0\u6761\u4ef6",type:"note",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Docker\u74b0\u5883\u304c\u8d77\u52d5\u6e08\u307f\u3067\u3042\u308b\u3053\u3068\uff08Phase 1\u5b8c\u4e86\uff09"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:".env"})," \u30d5\u30a1\u30a4\u30eb\u306b\u7ba1\u7406\u8005\u60c5\u5831\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u308b\u3053\u3068"]}),"\n"]})}),"\n",(0,t.jsx)(n.h3,{id:"\u30c6\u30b9\u30c8\u65b9\u91dd\u306b\u57fa\u3065\u304f\u30c7\u30fc\u30bf\u898f\u6a21",children:"\u30c6\u30b9\u30c8\u65b9\u91dd\u306b\u57fa\u3065\u304f\u30c7\u30fc\u30bf\u898f\u6a21"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u6e2c\u5b9a\u89b3\u70b9"}),(0,t.jsx)(n.th,{children:"\u30c6\u30ca\u30f3\u30c8\u6570"}),(0,t.jsx)(n.th,{children:"\u30e6\u30fc\u30b6\u30fc/\u30c6\u30ca\u30f3\u30c8"}),(0,t.jsx)(n.th,{children:"\u5099\u8003"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3"}),(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"100,000"}),(0,t.jsx)(n.td,{children:"\u57fa\u6e96\u5024\u6e2c\u5b9a"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u540c\u6642\u8ca0\u8377"}),(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"100,000"}),(0,t.jsx)(n.td,{children:"VU/\u30ec\u30fc\u30c8\u3092\u5909\u66f4"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8"}),(0,t.jsx)(n.td,{children:"1\u21925\u219210"}),(0,t.jsx)(n.td,{children:"100,000"}),(0,t.jsx)(n.td,{children:"TENANT_COUNT\u3067\u5236\u5fa1"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb"}),(0,t.jsx)(n.td,{children:"1"}),(0,t.jsx)(n.td,{children:"10\u4e07\u2192100\u4e07"}),(0,t.jsx)(n.td,{children:"\u6bb5\u968e\u7684\u306b\u6e2c\u5b9a"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u63a8\u5968\u69cb\u6210"}),": 10\u30c6\u30ca\u30f3\u30c8 \xd7 100,000\u30e6\u30fc\u30b6\u30fc = 1,000,000\u30e6\u30fc\u30b6\u30fc"]}),"\n",(0,t.jsx)(n.h3,{id:"step-21-\u30c6\u30ca\u30f3\u30c8\u767b\u9332",children:"Step 2.1: \u30c6\u30ca\u30f3\u30c8\u767b\u9332"}),"\n",(0,t.jsx)(n.p,{children:"\u30aa\u30f3\u30dc\u30fc\u30c7\u30a3\u30f3\u30b0API\u3067\u5168\u30c6\u30ca\u30f3\u30c8\u3092\u4e00\u62ec\u767b\u9332\u3059\u308b\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u5168\u6e2c\u5b9a\u306b\u5fc5\u8981\u306a\u6700\u5927\u30c6\u30ca\u30f3\u30c8\u6570\uff0810\uff09\u3092\u4e00\u62ec\u767b\u9332\n./performance-test/scripts/register-tenants.sh -n 10\n\n# \u8ffd\u52a0\u3067\u30c6\u30ca\u30f3\u30c8\u3092\u767b\u9332\u3059\u308b\u5834\u5408\uff08\u65e2\u5b58\u3092\u4fdd\u6301\uff09\n./performance-test/scripts/register-tenants.sh -n 5 -a\n\n# \u30c9\u30e9\u30a4\u30e9\u30f3\uff08\u5b9f\u969b\u306b\u306f\u767b\u9332\u3057\u306a\u3044\uff09\n./performance-test/scripts/register-tenants.sh -n 10 -d true\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf\u8aac\u660e\uff1a"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf"}),(0,t.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-n"}),(0,t.jsx)(n.td,{children:"\u767b\u9332\u3059\u308b\u30c6\u30ca\u30f3\u30c8\u6570\uff08\u5fc5\u9808\uff09"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-a"}),(0,t.jsx)(n.td,{children:"\u8ffd\u52a0\u30e2\u30fc\u30c9\uff1a\u65e2\u5b58\u30c6\u30ca\u30f3\u30c8\u3092\u4fdd\u6301\u3057\u3066\u8ffd\u52a0"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-d"}),(0,t.jsx)(n.td,{children:"\u30c9\u30e9\u30a4\u30e9\u30f3\uff08true/false\u3001\u30c7\u30d5\u30a9\u30eb\u30c8: false\uff09"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"-b"}),(0,t.jsxs)(n.td,{children:["\u30d9\u30fc\u30b9URL\uff08\u30c7\u30d5\u30a9\u30eb\u30c8: .env\u306e",(0,t.jsx)(n.code,{children:"AUTHORIZATION_SERVER_URL"}),"\uff09"]})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"\u751f\u6210\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\uff1a"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"performance-test/data/performance-test-tenant.json"})," - \u30c6\u30ca\u30f3\u30c8\u60c5\u5831"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u78ba\u8a8d\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat ./performance-test/data/performance-test-tenant.json | jq 'length'\n# \u2192 10\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-22-\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u751f\u6210",children:"Step 2.2: \u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u751f\u6210"}),"\n",(0,t.jsx)(n.p,{children:"\u5404\u30c6\u30ca\u30f3\u30c8\u306b\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u63a8\u5968\u69cb\u6210: \u6700\u521d\u306e\u30c6\u30ca\u30f3\u30c8100\u4e07\u30e6\u30fc\u30b6\u30fc\u3001\u4ed69\u30c6\u30ca\u30f3\u30c8\u540410\u4e07\u30e6\u30fc\u30b6\u30fc\npython3 ./performance-test/scripts/generate_users.py \\\n  --tenants-file ./performance-test/data/performance-test-tenant.json \\\n  --users 100000 \\\n  --first-tenant-users 1000000\n\n# \u5747\u7b49\u69cb\u6210: \u5168\u30c6\u30ca\u30f3\u30c8\u540410\u4e07\u30e6\u30fc\u30b6\u30fc\npython3 ./performance-test/scripts/generate_users.py \\\n  --tenants-file ./performance-test/data/performance-test-tenant.json \\\n  --users 100000\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf\u8aac\u660e\uff1a"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf"}),(0,t.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"--tenants-file"}),(0,t.jsx)(n.td,{children:"\u30c6\u30ca\u30f3\u30c8\u60c5\u5831JSON\u30d5\u30a1\u30a4\u30eb"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"--users"}),(0,t.jsx)(n.td,{children:"\u5404\u30c6\u30ca\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"--first-tenant-users"}),(0,t.jsx)(n.td,{children:"\u6700\u521d\u306e\u30c6\u30ca\u30f3\u30c8\u306e\u307f\u5225\u306e\u30e6\u30fc\u30b6\u30fc\u6570\u3092\u6307\u5b9a\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"\u751f\u6210\u3055\u308c\u308b\u30d5\u30a1\u30a4\u30eb\uff08\u63a8\u5968\u69cb\u6210\u306e\u5834\u5408\uff09\uff1a"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u30d5\u30a1\u30a4\u30eb"}),(0,t.jsx)(n.th,{children:"\u5185\u5bb9"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"multi_tenant_1m+9x100k_users.tsv"})}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"multi_tenant_1m+9x100k_devices.tsv"})}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u306e\u8a8d\u8a3c\u30c7\u30d0\u30a4\u30b9\u30c7\u30fc\u30bf"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"multi_tenant_1m+9x100k_test_users.json"})}),(0,t.jsx)(n.td,{children:"k6\u30c6\u30b9\u30c8\u7528\uff08\u5404\u30c6\u30ca\u30f3\u30c8500\u30e6\u30fc\u30b6\u30fc\uff09"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"step-23-\u30c7\u30fc\u30bf\u6295\u5165",children:"Step 2.3: \u30c7\u30fc\u30bf\u6295\u5165"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"import_users.sh"})," \u30b9\u30af\u30ea\u30d7\u30c8\u3067\u30c7\u30fc\u30bf\u3092\u6295\u5165\u3059\u308b\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u63a8\u5968\u69cb\u6210\u306e\u30c7\u30fc\u30bf\u3092\u6295\u5165\n./performance-test/scripts/import_users.sh multi_tenant_1m+9x100k\n\n# \u5747\u7b49\u69cb\u6210\u306e\u5834\u5408\n./performance-test/scripts/import_users.sh multi_tenant_10x100k\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-24-k6\u30c6\u30b9\u30c8\u7528json\u306e\u914d\u7f6e",children:"Step 2.4: k6\u30c6\u30b9\u30c8\u7528JSON\u306e\u914d\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u63a8\u5968\u69cb\u6210\u306e\u5834\u5408\ncp ./performance-test/data/multi_tenant_1m+9x100k_test_users.json \\\n   ./performance-test/data/performance-test-multi-tenant-users.json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-25-\u6295\u5165\u78ba\u8a8d",children:"Step 2.5: \u6295\u5165\u78ba\u8a8d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u30c6\u30ca\u30f3\u30c8\u5225\u30e6\u30fc\u30b6\u30fc\u6570\u3092\u78ba\u8a8d\ndocker exec postgres-primary psql -U idpserver -d idpserver -c "\nSELECT tenant_id, COUNT(*) as user_count\nFROM idp_user\nGROUP BY tenant_id\nORDER BY user_count DESC\nLIMIT 15;\n"\n\n# \u5408\u8a08\u78ba\u8a8d\ndocker exec postgres-primary psql -U idpserver -d idpserver -c "\nSELECT\n  (SELECT COUNT(*) FROM idp_user) as total_users,\n  (SELECT COUNT(*) FROM idp_user_authentication_devices) as total_devices,\n  (SELECT COUNT(DISTINCT tenant_id) FROM idp_user) as tenant_count;\n"\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u671f\u5f85\u7d50\u679c\uff0810\u30c6\u30ca\u30f3\u30c8 \xd7 10\u4e07\u30e6\u30fc\u30b6\u30fc\uff09\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" total_users | total_devices | tenant_count\n-------------+---------------+--------------\n     1000000 |       1000000 |           10\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-3-\u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u5b9f\u884c",children:"Phase 3: \u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u5b9f\u884c"}),"\n",(0,t.jsx)(n.h3,{id:"\u7d50\u679c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210",children:"\u7d50\u679c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u4f5c\u6210"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir -p performance-test/result/stress\nmkdir -p performance-test/result/load\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-31-\u8a8d\u53ef\u30ea\u30af\u30a8\u30b9\u30c8",children:"Step 3.1: \u8a8d\u53ef\u30ea\u30af\u30a8\u30b9\u30c8"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"k6 run --summary-export=./performance-test/result/stress/scenario-1-authorization-request.json \\\n  ./performance-test/stress/scenario-1-authorization-request.js\n"})}),"\n",(0,t.jsx)(n.p,{children:"\uff08\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u9805\u76ee\u306f\u5909\u66f4\u306a\u3057\uff09"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-4-\u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u5b9f\u884c",children:"Phase 4: \u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u5b9f\u884c"}),"\n",(0,t.jsx)(n.p,{children:"\u30ed\u30fc\u30c9\u30c6\u30b9\u30c8\u306f\u74b0\u5883\u5909\u6570\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u53ef\u80fd\u3002\nPhase 2 \u3067\u30c7\u30fc\u30bf\u6295\u5165\u6e08\u307f\u306e\u305f\u3081\u3001\u5404\u6e2c\u5b9a\u306f\u30d1\u30e9\u30e1\u30fc\u30bf\u5909\u66f4\u306e\u307f\u3067\u5b9f\u65bd\u3002"}),"\n",(0,t.jsx)(n.h3,{id:"step-40-\u6295\u5165\u78ba\u8a8d",children:"Step 4.0: \u6295\u5165\u78ba\u8a8d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'PGPASSWORD=idpserver psql -U idpserver -d idpserver -h localhost -p 5432 -c "\nSELECT\n  (SELECT COUNT(*) FROM idp_user) as users,\n  (SELECT COUNT(*) FROM idp_user_authentication_devices) as devices;\n"\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u671f\u5f85\u7d50\u679c\uff0810\u30c6\u30ca\u30f3\u30c8 \xd7 10\u4e07\u30e6\u30fc\u30b6\u30fc\uff09\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:" total_users | total_devices | tenant_count\n-------------+---------------+--------------\n     1000000 |       1000000 |           10\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u74b0\u5883\u5909\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7",children:"\u74b0\u5883\u5909\u6570\u30d1\u30e9\u30e1\u30fc\u30bf\u4e00\u89a7"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u30b7\u30ca\u30ea\u30aa"}),(0,t.jsx)(n.th,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf"}),(0,t.jsx)(n.th,{children:"\u30c7\u30d5\u30a9\u30eb\u30c8"}),(0,t.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"scenario-1"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VU_COUNT"})}),(0,t.jsx)(n.td,{children:"50"}),(0,t.jsx)(n.td,{children:"\u540c\u6642VU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"MAX_VU_COUNT"})}),(0,t.jsx)(n.td,{children:"VU_COUNT\xd72"}),(0,t.jsx)(n.td,{children:"\u6700\u5927VU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"LOGIN_RATE"})}),(0,t.jsx)(n.td,{children:"20"}),(0,t.jsx)(n.td,{children:"\u30ed\u30b0\u30a4\u30f3\u30ea\u30af\u30a8\u30b9\u30c8/\u79d2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"INTROSPECT_RATE"})}),(0,t.jsx)(n.td,{children:"80"}),(0,t.jsx)(n.td,{children:"Introspect\u30ea\u30af\u30a8\u30b9\u30c8/\u79d2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DURATION"})}),(0,t.jsx)(n.td,{children:"5m"}),(0,t.jsx)(n.td,{children:"\u30c6\u30b9\u30c8\u6642\u9593"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"scenario-2"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TENANT_COUNT"})}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8"}),(0,t.jsx)(n.td,{children:"\u4f7f\u7528\u3059\u308b\u30c6\u30ca\u30f3\u30c8\u6570\uff08\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u6e2c\u5b9a\u7528\uff09"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TOTAL_VU_COUNT"})}),(0,t.jsx)(n.td,{children:"50"}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u5408\u8a08VU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TOTAL_RATE"})}),(0,t.jsx)(n.td,{children:"20"}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u5408\u8a08\u30ea\u30af\u30a8\u30b9\u30c8/\u79d2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DURATION"})}),(0,t.jsx)(n.td,{children:"5m"}),(0,t.jsx)(n.td,{children:"\u30c6\u30b9\u30c8\u6642\u9593"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"scenario-3"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"PEAK_RATE"})}),(0,t.jsx)(n.td,{children:"30"}),(0,t.jsx)(n.td,{children:"\u30d4\u30fc\u30af\u30ea\u30af\u30a8\u30b9\u30c8/\u79d2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"VU_COUNT"})}),(0,t.jsx)(n.td,{children:"5"}),(0,t.jsx)(n.td,{children:"\u521d\u671fVU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"MAX_VU_COUNT"})}),(0,t.jsx)(n.td,{children:"20"}),(0,t.jsx)(n.td,{children:"\u6700\u5927VU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"RAMP_UP_DURATION"})}),(0,t.jsx)(n.td,{children:"3m"}),(0,t.jsx)(n.td,{children:"\u30e9\u30f3\u30d7\u30a2\u30c3\u30d7\u6642\u9593"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"SUSTAIN_DURATION"})}),(0,t.jsx)(n.td,{children:"5m"}),(0,t.jsx)(n.td,{children:"\u7dad\u6301\u6642\u9593"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"RAMP_DOWN_DURATION"})}),(0,t.jsx)(n.td,{children:"2m"}),(0,t.jsx)(n.td,{children:"\u30e9\u30f3\u30d7\u30c0\u30a6\u30f3\u6642\u9593"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"scenario-4"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TOTAL_VU_COUNT"})}),(0,t.jsx)(n.td,{children:"30"}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u5408\u8a08VU\u6570"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"TOTAL_RATE"})}),(0,t.jsx)(n.td,{children:"10"}),(0,t.jsx)(n.td,{children:"\u5168\u30c6\u30ca\u30f3\u30c8\u5408\u8a08\u30ea\u30af\u30a8\u30b9\u30c8/\u79d2"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"DURATION"})}),(0,t.jsx)(n.td,{children:"5m"}),(0,t.jsx)(n.td,{children:"\u30c6\u30b9\u30c8\u6642\u9593"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"step-71-\u30b7\u30f3\u30b0\u30eb\u30c6\u30ca\u30f3\u30c8ciba",children:"Step 7.1: \u30b7\u30f3\u30b0\u30eb\u30c6\u30ca\u30f3\u30c8CIBA"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u5b9f\u884c\nk6 run ./performance-test/load/scenario-1-ciba-login.js\n\n# \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u3067\u5b9f\u884c\nVU_COUNT=100 LOGIN_RATE=50 DURATION=10m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-72-\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8ciba",children:"Step 7.2: \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8CIBA"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u5b9f\u884c\nk6 run ./performance-test/load/scenario-2-multi-ciba-login.js\n\n# \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u3067\u5b9f\u884c\nTOTAL_VU_COUNT=100 TOTAL_RATE=50 DURATION=10m \\\n  k6 run ./performance-test/load/scenario-2-multi-ciba-login.js\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-73-\u30d4\u30fc\u30af\u8ca0\u8377",children:"Step 7.3: \u30d4\u30fc\u30af\u8ca0\u8377"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u5b9f\u884c\nk6 run ./performance-test/load/scenario-3-peak-login.js\n\n# \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u3067\u5b9f\u884c\nPEAK_RATE=100 MAX_VU_COUNT=50 SUSTAIN_DURATION=10m \\\n  k6 run ./performance-test/load/scenario-3-peak-login.js\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-74-\u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc",children:"Step 7.4: \u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc"}),"\n",(0,t.jsx)(n.p,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c \u2192 \u30c8\u30fc\u30af\u30f3\u767a\u884c \u2192 Userinfo \u2192 Introspection\u306e\u30d5\u30ed\u30fc\u3092\u5b9f\u884c\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u5b9f\u884c\nk6 run ./performance-test/load/scenario-4-authorization-code.js\n\n# \u30ab\u30b9\u30bf\u30e0\u8a2d\u5b9a\u3067\u5b9f\u884c\nTOTAL_VU_COUNT=60 TOTAL_RATE=20 DURATION=10m \\\n  k6 run ./performance-test/load/scenario-4-authorization-code.js\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-75-\u6e2c\u5b9a\u89b3\u70b9\u5225\u30c6\u30b9\u30c8\u5b9f\u884c",children:"Phase 7.5: \u6e2c\u5b9a\u89b3\u70b9\u5225\u30c6\u30b9\u30c8\u5b9f\u884c"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"./07-test-strategy",children:"\u30c6\u30b9\u30c8\u65b9\u91dd"}),"\u306b\u57fa\u3065\u3044\u305f\u6e2c\u5b9a\u89b3\u70b9\u5225\u306e\u5b9f\u884c\u624b\u9806\u3002"]}),"\n",(0,t.jsx)(n.h3,{id:"751-\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u6e2c\u5b9a",children:"7.5.1: \u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\u6e2c\u5b9a"}),"\n",(0,t.jsx)(n.p,{children:"\u6700\u5c0f\u69cb\u6210\u3067\u306e\u57fa\u6e96\u6027\u80fd\u5024\u3092\u53d6\u5f97\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30b7\u30f3\u30b0\u30eb\u30c6\u30ca\u30f3\u30c8\u3001\u4f4e\u8ca0\u8377\u3067\u5b9f\u884c\nVU_COUNT=10 LOGIN_RATE=5 INTROSPECT_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/baseline.json\n\n# \u8a8d\u53ef\u30b3\u30fc\u30c9\u30d5\u30ed\u30fc\u306e\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\nTOTAL_VU_COUNT=10 TOTAL_RATE=5 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-4-authorization-code.js \\\n  --summary-export=./performance-test/result/load/baseline-authcode.json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"752-\u540c\u6642\u8ca0\u8377\u5f71\u97ff\u6e2c\u5b9a",children:"7.5.2: \u540c\u6642\u8ca0\u8377\u5f71\u97ff\u6e2c\u5b9a"}),"\n",(0,t.jsx)(n.p,{children:"VU\u6570\u3092\u6bb5\u968e\u7684\u306b\u5897\u52a0\u3055\u305b\u3066\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u7279\u5b9a\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Step 1: 50 VU\nVU_COUNT=50 LOGIN_RATE=100 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/load-vu50.json\n\n# Step 2: 100 VU\nVU_COUNT=100 LOGIN_RATE=200 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/load-vu100.json\n\n# Step 3: 200 VU\nVU_COUNT=200 LOGIN_RATE=400 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/load-vu200.json\n\n# Step 4: 500 VU\nVU_COUNT=500 LOGIN_RATE=1000 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/load-vu500.json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"753-\u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5f71\u97ff\u6e2c\u5b9a",children:"7.5.3: \u30de\u30eb\u30c1\u30c6\u30ca\u30f3\u30c8\u5f71\u97ff\u6e2c\u5b9a"}),"\n",(0,t.jsxs)(n.p,{children:["\u30c6\u30ca\u30f3\u30c8\u6570\u3092\u5909\u3048\u3066RLS\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3092\u6e2c\u5b9a\u3002\n",(0,t.jsx)(n.code,{children:"TENANT_COUNT"})," \u30d1\u30e9\u30e1\u30fc\u30bf\u3067\u4f7f\u7528\u3059\u308b\u30c6\u30ca\u30f3\u30c8\u6570\u3092\u5236\u5fa1\uff08\u30c7\u30fc\u30bf\u8ffd\u52a0\u4e0d\u8981\uff09\u3002"]}),"\n",(0,t.jsx)(n.admonition,{title:"\u524d\u63d0\u6761\u4ef6",type:"note",children:(0,t.jsx)(n.p,{children:"Phase 2 \u306710\u30c6\u30ca\u30f3\u30c8\u5206\u306e\u30c7\u30fc\u30bf\u304c\u6295\u5165\u6e08\u307f\u3067\u3042\u308b\u3053\u3068\u3002"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Step 1: 1\u30c6\u30ca\u30f3\u30c8\uff08\u30d9\u30fc\u30b9\u30e9\u30a4\u30f3\uff09\nTENANT_COUNT=1 TOTAL_VU_COUNT=50 TOTAL_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-2-multi-ciba-login.js \\\n  --summary-export=./performance-test/result/load/multi-tenant-1.json\n\n# Step 2: 5\u30c6\u30ca\u30f3\u30c8\nTENANT_COUNT=5 TOTAL_VU_COUNT=50 TOTAL_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-2-multi-ciba-login.js \\\n  --summary-export=./performance-test/result/load/multi-tenant-5.json\n\n# Step 3: 10\u30c6\u30ca\u30f3\u30c8\nTENANT_COUNT=10 TOTAL_VU_COUNT=50 TOTAL_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-2-multi-ciba-login.js \\\n  --summary-export=./performance-test/result/load/multi-tenant-10.json\n"})}),"\n",(0,t.jsx)(n.h3,{id:"754-\u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u5f71\u97ff\u6e2c\u5b9a",children:"7.5.4: \u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u5f71\u97ff\u6e2c\u5b9a"}),"\n",(0,t.jsx)(n.p,{children:"\u30e6\u30fc\u30b6\u30fc\u6570\u3092\u5909\u3048\u3066\u6027\u80fd\u52a3\u5316\u3092\u6e2c\u5b9a\u3002"}),"\n",(0,t.jsxs)(n.admonition,{title:"\u72ec\u7acb\u3057\u305f\u6e2c\u5b9a\u3068\u3057\u3066\u5b9f\u65bd",type:"warning",children:[(0,t.jsx)(n.p,{children:"\u3053\u306e\u6e2c\u5b9a\u306f\u30c7\u30fc\u30bf\u898f\u6a21\u306b\u3088\u308b\u6027\u80fd\u5dee\u3092\u6bd4\u8f03\u3059\u308b\u305f\u3081\u3001Phase 2\u3068\u306f\u72ec\u7acb\u3057\u3066\u5b9f\u65bd\u3059\u308b\u3002"}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u5404\u30b9\u30c6\u30c3\u30d7\u306e\u624b\u9806"}),"\uff1a"]}),(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'docker exec postgres-primary psql -U idpserver -d idpserver -c "TRUNCATE idp_user CASCADE;"\n'})}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"\u6307\u5b9a\u898f\u6a21\u306e\u30c7\u30fc\u30bf\u3092\u751f\u6210\u30fb\u6295\u5165"}),"\n",(0,t.jsx)(n.li,{children:"\u30c6\u30b9\u30c8\u5b9f\u884c"}),"\n"]}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u6ce8\u610f"}),": \u3053\u306e\u6e2c\u5b9a\u3067Phase 2\u306e\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306f\u524a\u9664\u3055\u308c\u308b\u3002\u6e2c\u5b9a\u5f8c\u306b\u4ed6\u306e\u30c6\u30b9\u30c8\u3092\u5b9f\u65bd\u3059\u308b\u5834\u5408\u306f\u3001Phase 2\u3092\u518d\u5b9f\u884c\u3059\u308b\u3053\u3068\u3002"]})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Step 1: 10,000\u30e6\u30fc\u30b6\u30fc\uff08\u30af\u30ea\u30fc\u30f3\u74b0\u5883\u3067\u5b9f\u65bd\uff09\npython3 ./performance-test/scripts/generate_users.py \\\n  --tenants-file ./performance-test/data/performance-test-tenant.json \\\n  --users 10000\n./performance-test/scripts/import_users.sh multi_tenant_10x10k\ncp ./performance-test/data/multi_tenant_10x10k_test_users.json \\\n   ./performance-test/data/performance-test-multi-tenant-users.json\n\nVU_COUNT=50 LOGIN_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/scale-10k.json\n\n# Step 2: 100,000\u30e6\u30fc\u30b6\u30fc\npython3 ./performance-test/scripts/generate_users.py \\\n  --tenants-file ./performance-test/data/performance-test-tenant.json \\\n  --users 100000\n./performance-test/scripts/import_users.sh multi_tenant_10x100k\ncp ./performance-test/data/multi_tenant_10x100k_test_users.json \\\n   ./performance-test/data/performance-test-multi-tenant-users.json\n\nVU_COUNT=50 LOGIN_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/scale-100k.json\n\n# Step 3: 1,000,000\u30e6\u30fc\u30b6\u30fc\npython3 ./performance-test/scripts/generate_users.py \\\n  --tenants-file ./performance-test/data/performance-test-tenant.json \\\n  --users 100000 \\\n  --first-tenant-users 1000000\n./performance-test/scripts/import_users.sh multi_tenant_1m+9x100k\ncp ./performance-test/data/multi_tenant_1m+9x100k_test_users.json \\\n   ./performance-test/data/performance-test-multi-tenant-users.json\n\nVU_COUNT=50 LOGIN_RATE=20 DURATION=5m \\\n  k6 run ./performance-test/load/scenario-1-ciba-login.js \\\n  --summary-export=./performance-test/result/load/scale-1m.json\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"\u7c21\u6613\u6e2c\u5b9a",type:"tip",children:(0,t.jsx)(n.p,{children:"\u63a8\u5968\u69cb\u6210\uff081\u30c6\u30ca\u30f3\u30c8100\u4e07 + 9\u30c6\u30ca\u30f3\u30c810\u4e07\uff09\u3092\u4f7f\u7528\u3057\u3001TENANT_INDEX=0 \u3067\u6700\u521d\u306e\u30c6\u30ca\u30f3\u30c8\uff08100\u4e07\u30e6\u30fc\u30b6\u30fc\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5927\u898f\u6a21\u30c7\u30fc\u30bf\u30b9\u30b1\u30fc\u30eb\u306e\u5f71\u97ff\u3092\u6e2c\u5b9a\u3067\u304d\u308b\u3002"})}),"\n",(0,t.jsx)(n.h3,{id:"755-\u8ca0\u8377\u9650\u754c\u691c\u8a3c",children:"7.5.5: \u8ca0\u8377\u9650\u754c\u691c\u8a3c"}),"\n",(0,t.jsx)(n.p,{children:"\u30d4\u30fc\u30af\u8ca0\u8377\u3092\u6bb5\u968e\u7684\u306b\u5897\u52a0\u3055\u305b\u3066\u30d6\u30ec\u30fc\u30af\u30dd\u30a4\u30f3\u30c8\u3092\u7279\u5b9a\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Step 1: 30 req/s\nPEAK_RATE=30 MAX_VU_COUNT=20 \\\n  k6 run ./performance-test/load/scenario-3-peak-login.js \\\n  --summary-export=./performance-test/result/load/peak-30.json\n\n# Step 2: 50 req/s\nPEAK_RATE=50 MAX_VU_COUNT=30 \\\n  k6 run ./performance-test/load/scenario-3-peak-login.js \\\n  --summary-export=./performance-test/result/load/peak-50.json\n\n# Step 3: 100 req/s\nPEAK_RATE=100 MAX_VU_COUNT=60 \\\n  k6 run ./performance-test/load/scenario-3-peak-login.js \\\n  --summary-export=./performance-test/result/load/peak-100.json\n\n# Step 4: 200 req/s\nPEAK_RATE=200 MAX_VU_COUNT=120 \\\n  k6 run ./performance-test/load/scenario-3-peak-login.js \\\n  --summary-export=./performance-test/result/load/peak-200.json\n"})}),"\n",(0,t.jsxs)(n.admonition,{title:"\u7d50\u679c\u306e\u6bd4\u8f03",type:"tip",children:[(0,t.jsx)(n.p,{children:"\u5404\u30b9\u30c6\u30c3\u30d7\u306e\u7d50\u679cJSON\u3092\u6bd4\u8f03\u3057\u3066\u3001\u30a8\u30e9\u30fc\u7387\u306e\u5897\u52a0\u958b\u59cb\u70b9\u3084\u30ec\u30a4\u30c6\u30f3\u30b7\u52a3\u5316\u66f2\u7dda\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u7d50\u679c\u30b5\u30de\u30ea\u30fc\u306e\u78ba\u8a8d\ncat ./performance-test/result/load/load-vu*.json | jq '{file: input_filename, http_req_duration_p95: .metrics.http_req_duration.values.p95}'\n"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-8-\u7d50\u679c\u5206\u6790",children:"Phase 8: \u7d50\u679c\u5206\u6790"}),"\n",(0,t.jsx)(n.h3,{id:"step-81-pg_stat_statements\u78ba\u8a8d",children:"Step 8.1: pg_stat_statements\u78ba\u8a8d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'PGPASSWORD=idpserver psql -U idpserver -d idpserver -h localhost -p 5432 -c "\nSELECT\n  query,\n  calls,\n  round(total_exec_time::numeric, 2) as total_time_ms,\n  round(mean_exec_time::numeric, 2) as mean_time_ms,\n  rows\nFROM pg_stat_statements\nORDER BY total_exec_time DESC\nLIMIT 20;\n"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"step-82-\u7d71\u8a08\u30ea\u30bb\u30c3\u30c8\u6b21\u56de\u30c6\u30b9\u30c8\u524d",children:"Step 8.2: \u7d71\u8a08\u30ea\u30bb\u30c3\u30c8\uff08\u6b21\u56de\u30c6\u30b9\u30c8\u524d\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'PGPASSWORD=idpserver psql -U idpserver -d idpserver -h localhost -p 5432 -c "SELECT pg_stat_statements_reset();"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"step-83-\u30ea\u30bd\u30fc\u30b9\u76e3\u8996",children:"Step 8.3: \u30ea\u30bd\u30fc\u30b9\u76e3\u8996"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u30c6\u30b9\u30c8\u4e2d\u306b\u5225\u30bf\u30fc\u30df\u30ca\u30eb\u3067\u5b9f\u884c\ndocker stats $(docker compose ps -q idp-server)\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"phase-9-\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",children:"Phase 9: \u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7"}),"\n",(0,t.jsx)(n.h3,{id:"\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7",children:"\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u306e\u30af\u30ea\u30fc\u30f3\u30a2\u30c3\u30d7"}),"\n",(0,t.jsx)(n.p,{children:"\u6027\u80fd\u30c6\u30b9\u30c8\u7528\u30c6\u30ca\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u7279\u5b9a\u30c6\u30ca\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3092\u524a\u9664\nTENANT_ID="<\u5bfe\u8c61\u30c6\u30ca\u30f3\u30c8ID>"\ndocker exec postgres-primary psql -U idpserver -d idpserver -c "\nDELETE FROM idp_user WHERE tenant_id = \'$TENANT_ID\';\n"\n\n# \u5168\u30c6\u30ca\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3059\u308b\u5834\u5408\uff08\u6ce8\u610f: \u5168\u30c7\u30fc\u30bf\u304c\u524a\u9664\u3055\u308c\u308b\uff09\n# docker exec postgres-primary psql -U idpserver -d idpserver -c "TRUNCATE idp_user CASCADE;"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"docker\u74b0\u5883\u505c\u6b62",children:"Docker\u74b0\u5883\u505c\u6b62"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose down\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u4e00\u62ec\u5b9f\u884c\u30b9\u30af\u30ea\u30d7\u30c8",children:"\u4e00\u62ec\u5b9f\u884c\u30b9\u30af\u30ea\u30d7\u30c8"}),"\n",(0,t.jsx)(n.p,{children:"\u5168\u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u3092\u9806\u6b21\u5b9f\u884c\u3059\u308b\u5834\u5408\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\nset -e\n\nRESULT_DIR="./performance-test/result/stress"\nSTRESS_DIR="./performance-test/stress"\n\nmkdir -p $RESULT_DIR\n\nscenarios=(\n  "scenario-1-authorization-request"\n  "scenario-2-bc"\n  "scenario-3-ciba-device"\n  "scenario-3-ciba-sub"\n  "scenario-3-ciba-email"\n  "scenario-3-ciba-phone"\n  "scenario-3-ciba-ex-sub"\n  "scenario-4-token-password"\n  "scenario-5-token-client-credentials"\n  "scenario-6-jwks"\n  "scenario-7-token-introspection"\n  "scenario-8-authentication-device"\n  "scenario-9-identity-verification-application"\n)\n\nfor scenario in "${scenarios[@]}"; do\n  echo "=========================================="\n  echo "Running: $scenario"\n  echo "=========================================="\n  k6 run --summary-export="${RESULT_DIR}/${scenario}.json" "${STRESS_DIR}/${scenario}.js"\n  echo ""\n  sleep 5  # \u30af\u30fc\u30eb\u30c0\u30a6\u30f3\ndone\n\necho "All stress tests completed!"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0",children:"\u30c8\u30e9\u30d6\u30eb\u30b7\u30e5\u30fc\u30c6\u30a3\u30f3\u30b0"}),"\n",(0,t.jsx)(n.h3,{id:"\u30c7\u30fc\u30bf\u6295\u5165\u30a8\u30e9\u30fc",children:"\u30c7\u30fc\u30bf\u6295\u5165\u30a8\u30e9\u30fc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ERROR: duplicate key value violates unique constraint\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u2192 \u65e2\u5b58\u30c7\u30fc\u30bf\u3092\u524a\u9664\u3057\u3066\u304b\u3089\u518d\u6295\u5165\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'PGPASSWORD=idpserver psql -U idpserver -d idpserver -h localhost -p 5432 -c "TRUNCATE idp_user CASCADE;"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"k6\u63a5\u7d9a\u30a8\u30e9\u30fc",children:"k6\u63a5\u7d9a\u30a8\u30e9\u30fc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'ERRO[0001] Request Failed error="Get http://localhost:8080/..."\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u2192 \u74b0\u5883\u5909\u6570\u3068\u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\u3092\u78ba\u8a8d\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"echo $BASE_URL\ncurl $BASE_URL/health\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u30e1\u30e2\u30ea\u4e0d\u8db3",children:"\u30e1\u30e2\u30ea\u4e0d\u8db3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"java.lang.OutOfMemoryError: Java heap space\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u2192 JVM\u30d2\u30fc\u30d7\u30b5\u30a4\u30ba\u3092\u5897\u52a0\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'environment:\n  JAVA_TOOL_OPTIONS: "-Xms1g -Xmx4g"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/idp-server/docs/content_08_ops/performance/test-environment",children:"\u30c6\u30b9\u30c8\u74b0\u5883"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/idp-server/docs/content_08_ops/performance/stress-test-results",children:"\u30b9\u30c8\u30ec\u30b9\u30c6\u30b9\u30c8\u7d50\u679c"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/idp-server/docs/content_08_ops/performance/tuning-guide",children:"\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0\u30ac\u30a4\u30c9"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>i});var r=s(96540);const t={},d=r.createContext(t);function c(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);