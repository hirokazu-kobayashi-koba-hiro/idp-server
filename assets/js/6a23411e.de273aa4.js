"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[1678],{51426:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>x,frontMatter:()=>s,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"content_11_learning/oauth-oidc-rfc/jose/rfc7516-jwe","title":"RFC 7516: JSON Web Encryption\uff08JWE\uff09","description":"RFC 7516 \u306f\u3001JSON \u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u6697\u53f7\u5316\u3059\u308b\u305f\u3081\u306e\u4ed5\u69d8\u3067\u3059\u3002\u30da\u30a4\u30ed\u30fc\u30c9\u306e\u6a5f\u5bc6\u6027\u3092\u4fdd\u8b77\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002","source":"@site/docs/content_11_learning/16-oauth-oidc-rfc/jose/rfc7516-jwe.md","sourceDirName":"content_11_learning/16-oauth-oidc-rfc/jose","slug":"/content_11_learning/oauth-oidc-rfc/jose/rfc7516-jwe","permalink":"/idp-server/docs/content_11_learning/oauth-oidc-rfc/jose/rfc7516-jwe","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_11_learning/16-oauth-oidc-rfc/jose/rfc7516-jwe.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"RFC 7515: JSON Web Signature\uff08JWS\uff09","permalink":"/idp-server/docs/content_11_learning/oauth-oidc-rfc/jose/rfc7515-jws"},"next":{"title":"RFC 7517: JSON Web Key\uff08JWK\uff09","permalink":"/idp-server/docs/content_11_learning/oauth-oidc-rfc/jose/rfc7517-jwk"}}');var i=d(74848),c=d(28453);const s={},t="RFC 7516: JSON Web Encryption\uff08JWE\uff09",l={},h=[{value:"\u7b2c1\u90e8: \u6982\u8981\u7de8",id:"\u7b2c1\u90e8-\u6982\u8981\u7de8",level:2},{value:"JWE \u3068\u306f\u4f55\u304b\uff1f",id:"jwe-\u3068\u306f\u4f55\u304b",level:3},{value:"\u3044\u3064 JWE \u3092\u4f7f\u3046\u304b\uff1f",id:"\u3044\u3064-jwe-\u3092\u4f7f\u3046\u304b",level:3},{value:"JWE \u306e\u69cb\u9020",id:"jwe-\u306e\u69cb\u9020",level:3},{value:"\u7b2c2\u90e8: \u8a73\u7d30\u7de8",id:"\u7b2c2\u90e8-\u8a73\u7d30\u7de8",level:2},{value:"\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f",id:"\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f",level:3},{value:"JOSE Header",id:"jose-header",level:3},{value:"\u9375\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08alg\uff09",id:"\u9375\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0alg",level:3},{value:"RSA \u7cfb",id:"rsa-\u7cfb",level:4},{value:"AES Key Wrap \u7cfb",id:"aes-key-wrap-\u7cfb",level:4},{value:"AES-GCM Key Wrap \u7cfb",id:"aes-gcm-key-wrap-\u7cfb",level:4},{value:"\u76f4\u63a5\u6697\u53f7\u5316",id:"\u76f4\u63a5\u6697\u53f7\u5316",level:4},{value:"ECDH \u7cfb",id:"ecdh-\u7cfb",level:4},{value:"\u30d1\u30b9\u30ef\u30fc\u30c9\u30d9\u30fc\u30b9",id:"\u30d1\u30b9\u30ef\u30fc\u30c9\u30d9\u30fc\u30b9",level:4},{value:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08enc\uff09",id:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0enc",level:3},{value:"AES-CBC + HMAC",id:"aes-cbc--hmac",level:4},{value:"AES-GCM\uff08\u63a8\u5968\uff09",id:"aes-gcm\u63a8\u5968",level:4},{value:"\u6697\u53f7\u5316\u306e\u624b\u9806",id:"\u6697\u53f7\u5316\u306e\u624b\u9806",level:3},{value:"\u5fa9\u53f7\u306e\u624b\u9806",id:"\u5fa9\u53f7\u306e\u624b\u9806",level:3},{value:"Nested JWT\uff08Sign-then-Encrypt\uff09",id:"nested-jwtsign-then-encrypt",level:3},{value:"JSON Serialization",id:"json-serialization",level:3},{value:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805",id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805",level:3},{value:"\u53c2\u8003\u30ea\u30f3\u30af",id:"\u53c2\u8003\u30ea\u30f3\u30af",level:2}];function j(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rfc-7516-json-web-encryptionjwe",children:"RFC 7516: JSON Web Encryption\uff08JWE\uff09"})}),"\n",(0,i.jsx)(n.p,{children:"RFC 7516 \u306f\u3001JSON \u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u6697\u53f7\u5316\u3059\u308b\u305f\u3081\u306e\u4ed5\u69d8\u3067\u3059\u3002\u30da\u30a4\u30ed\u30fc\u30c9\u306e\u6a5f\u5bc6\u6027\u3092\u4fdd\u8b77\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u306b\u4f7f\u7528\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c1\u90e8-\u6982\u8981\u7de8",children:"\u7b2c1\u90e8: \u6982\u8981\u7de8"}),"\n",(0,i.jsx)(n.h3,{id:"jwe-\u3068\u306f\u4f55\u304b",children:"JWE \u3068\u306f\u4f55\u304b\uff1f"}),"\n",(0,i.jsxs)(n.p,{children:["JWE\uff08JSON Web Encryption\uff09\u306f\u3001\u4efb\u610f\u306e\u30c7\u30fc\u30bf\u3092",(0,i.jsx)(n.strong,{children:"\u6697\u53f7\u5316"}),"\u3059\u308b\u305f\u3081\u306e\u6a19\u6e96\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067\u3059\u3002JWS \u304c\u300c\u6539\u3056\u3093\u9632\u6b62\u300d\u306a\u3089\u3001JWE \u306f\u300c\u76d7\u8074\u9632\u6b62\u300d\u3067\u3059\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"JWS vs JWE:\n\nJWS\uff08\u7f72\u540d\uff09:\n  \u30da\u30a4\u30ed\u30fc\u30c9\u306f\u898b\u3048\u308b\uff08Base64URL\uff09\n  \u6539\u3056\u3093\u3092\u691c\u77e5\u3067\u304d\u308b\n\nJWE\uff08\u6697\u53f7\u5316\uff09:\n  \u30da\u30a4\u30ed\u30fc\u30c9\u306f\u898b\u3048\u306a\u3044\uff08\u6697\u53f7\u5316\u6e08\u307f\uff09\n  \u6a5f\u5bc6\u6027\u3092\u4fdd\u8b77\u3067\u304d\u308b\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u3044\u3064-jwe-\u3092\u4f7f\u3046\u304b",children:"\u3044\u3064 JWE \u3092\u4f7f\u3046\u304b\uff1f"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\u6a5f\u5bc6\u60c5\u5831\u306e\u9001\u4fe1"}),(0,i.jsx)(n.td,{children:"PII\u3001\u533b\u7642\u60c5\u5831\u3001\u91d1\u878d\u30c7\u30fc\u30bf"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Request Object"}),(0,i.jsx)(n.td,{children:"OIDC \u306e\u6697\u53f7\u5316\u30ea\u30af\u30a8\u30b9\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"ID Token \u306e\u6697\u53f7\u5316"}),(0,i.jsx)(n.td,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u307f\u304c\u5fa9\u53f7\u53ef\u80fd"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Nested JWT"}),(0,i.jsx)(n.td,{children:"\u7f72\u540d\u5f8c\u306b\u6697\u53f7\u5316\uff08Sign-then-Encrypt\uff09"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"jwe-\u306e\u69cb\u9020",children:"JWE \u306e\u69cb\u9020"}),"\n",(0,i.jsx)(n.p,{children:"JWE Compact Serialization \u306f 5 \u3064\u306e\u30d1\u30fc\u30c8\u3067\u69cb\u6210\u3055\u308c\u307e\u3059\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.\nOKOawDo13gRp2ojaHV7LFpZcgV7T6DVZKTyKOMTYUmKoTCVJRgckCL9kiMT03JGe\nipsEdY3mx_etLbbWSrFr05kLzcSr4qKAq7YN7e9jwQRb23nfa6c9d-StnImGyFDb\nSv04uVuxIp5Zms1gNxKKK2Da14B8S4rzVRltdYwam_lDp5XnZAYpQdb76FdIKLaV\nmqgfwX7XWRxv2322i-vDxRfqNzo_tETKzpVLzfiwQyeyPGLBIO56YJ7eObdv0je8\n1860ppamavo35UgoRdbYaBcoh9QcfylQr66oc6vFWXRcZ_ZT2LawVCWTIy3brGPi\n6UklfCpIMfIjf7iGdXKHzg.\n48V1_ALb6US04U3b.\n5eym8TW_c8SuK0ltJ3rpYIzOeDQz7TALvtu6UG9oMo4vpzs9tX_EFShS8iB7j6ji\nSdiwkIr3ajwQzaBtQD_A.\nXFBoMYUZodetZdvTiFvSkQ\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518.\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518.\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518.\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518.\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     Header              Encrypted Key                    IV              Ciphertext                 Tag\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30d1\u30fc\u30c8"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Header"}),(0,i.jsx)(n.td,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u60c5\u5831\uff08JOSE Header\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Encrypted Key"}),(0,i.jsx)(n.td,{children:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u9375\uff08CEK\uff09\u306e\u6697\u53f7\u5316\u7248"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"IV"}),(0,i.jsx)(n.td,{children:"\u521d\u671f\u5316\u30d9\u30af\u30c8\u30eb"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Ciphertext"}),(0,i.jsx)(n.td,{children:"\u6697\u53f7\u5316\u3055\u308c\u305f\u30da\u30a4\u30ed\u30fc\u30c9"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Authentication Tag"}),(0,i.jsx)(n.td,{children:"\u8a8d\u8a3c\u30bf\u30b0\uff08\u5b8c\u5168\u6027\u4fdd\u8a3c\uff09"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u7b2c2\u90e8-\u8a73\u7d30\u7de8",children:"\u7b2c2\u90e8: \u8a73\u7d30\u7de8"}),"\n",(0,i.jsx)(n.h3,{id:"\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f",children:"\u6697\u53f7\u5316\u306e\u4ed5\u7d44\u307f"}),"\n",(0,i.jsx)(n.p,{children:"JWE \u306f 2 \u6bb5\u968e\u306e\u6697\u53f7\u5316\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. \u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\uff08CEK \u3067\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u6697\u53f7\u5316\uff09\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502  Plaintext  \u2502 \u2500\u2500\u25ba \u2502  Ciphertext \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                    \u25b2\n         \u2502                    \u2502\n         \u2514\u2500\u2500 CEK (Content Encryption Key)\n\n2. \u9375\u6697\u53f7\u5316\uff08\u53d7\u4fe1\u8005\u306e\u516c\u958b\u9375\u3067 CEK \u3092\u6697\u53f7\u5316\uff09\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502    CEK      \u2502 \u2500\u2500\u25ba \u2502  Encrypted CEK  \u2502\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502                    \u25b2\n         \u2502                    \u2502\n         \u2514\u2500\u2500 \u53d7\u4fe1\u8005\u306e\u516c\u958b\u9375\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u3053\u306e\u65b9\u5f0f\u3092\u300c\u30cf\u30a4\u30d6\u30ea\u30c3\u30c9\u6697\u53f7\u5316\u300d\u3068\u547c\u3073\u307e\u3059\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"jose-header",children:"JOSE Header"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "RSA-OAEP",\n  "enc": "A256GCM",\n  "kid": "key-2024-01"\n}\n'})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf"}),(0,i.jsx)(n.th,{children:"\u5fc5\u9808"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"alg"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u9375\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"enc"})}),(0,i.jsx)(n.td,{children:"\u2705"}),(0,i.jsx)(n.td,{children:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"zip"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsxs)(n.td,{children:["\u5727\u7e2e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08",(0,i.jsx)(n.code,{children:"DEF"})," = DEFLATE\uff09"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"kid"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsx)(n.td,{children:"\u9375 ID"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"jku"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsx)(n.td,{children:"JWK Set URL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"jwk"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsx)(n.td,{children:"\u516c\u958b\u9375"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"typ"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsx)(n.td,{children:"\u30e1\u30c7\u30a3\u30a2\u30bf\u30a4\u30d7"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cty"})}),(0,i.jsx)(n.td,{children:"\u25b3"}),(0,i.jsx)(n.td,{children:"\u30b3\u30f3\u30c6\u30f3\u30c4\u30bf\u30a4\u30d7"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u9375\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0alg",children:"\u9375\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08alg\uff09"}),"\n",(0,i.jsx)(n.h4,{id:"rsa-\u7cfb",children:"RSA \u7cfb"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"}),(0,i.jsx)(n.th,{children:"\u63a8\u5968"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RSA1_5"})}),(0,i.jsx)(n.td,{children:"RSAES-PKCS1-v1_5"}),(0,i.jsx)(n.td,{children:"\u274c \u975e\u63a8\u5968\uff08\u30d1\u30c7\u30a3\u30f3\u30b0\u653b\u6483\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RSA-OAEP"})}),(0,i.jsx)(n.td,{children:"RSAES OAEP using SHA-1"}),(0,i.jsx)(n.td,{children:"\u26a0\ufe0f"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RSA-OAEP-256"})}),(0,i.jsx)(n.td,{children:"RSAES OAEP using SHA-256"}),(0,i.jsx)(n.td,{children:"\u2705 \u63a8\u5968"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"aes-key-wrap-\u7cfb",children:"AES Key Wrap \u7cfb"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A128KW"})}),(0,i.jsx)(n.td,{children:"AES Key Wrap with 128-bit key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A192KW"})}),(0,i.jsx)(n.td,{children:"AES Key Wrap with 192-bit key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A256KW"})}),(0,i.jsx)(n.td,{children:"AES Key Wrap with 256-bit key"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"aes-gcm-key-wrap-\u7cfb",children:"AES-GCM Key Wrap \u7cfb"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A128GCMKW"})}),(0,i.jsx)(n.td,{children:"AES GCM Key Wrap with 128-bit key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A192GCMKW"})}),(0,i.jsx)(n.td,{children:"AES GCM Key Wrap with 192-bit key"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A256GCMKW"})}),(0,i.jsx)(n.td,{children:"AES GCM Key Wrap with 256-bit key"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"\u76f4\u63a5\u6697\u53f7\u5316",children:"\u76f4\u63a5\u6697\u53f7\u5316"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dir"})}),(0,i.jsx)(n.td,{children:"Direct use of shared symmetric key"})]})})]}),"\n",(0,i.jsx)(n.p,{children:"CEK \u3092\u6697\u53f7\u5316\u305b\u305a\u3001\u5171\u6709\u9375\u3092\u76f4\u63a5\u4f7f\u7528\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"ecdh-\u7cfb",children:"ECDH \u7cfb"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ECDH-ES"})}),(0,i.jsx)(n.td,{children:"ECDH Ephemeral Static"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ECDH-ES+A128KW"})}),(0,i.jsx)(n.td,{children:"ECDH-ES with AES-128 Key Wrap"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ECDH-ES+A192KW"})}),(0,i.jsx)(n.td,{children:"ECDH-ES with AES-192 Key Wrap"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ECDH-ES+A256KW"})}),(0,i.jsx)(n.td,{children:"ECDH-ES with AES-256 Key Wrap"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"\u30d1\u30b9\u30ef\u30fc\u30c9\u30d9\u30fc\u30b9",children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u30d9\u30fc\u30b9"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PBES2-HS256+A128KW"})}),(0,i.jsx)(n.td,{children:"PBES2 with HMAC SHA-256 and A128KW"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PBES2-HS384+A192KW"})}),(0,i.jsx)(n.td,{children:"PBES2 with HMAC SHA-384 and A192KW"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"PBES2-HS512+A256KW"})}),(0,i.jsx)(n.td,{children:"PBES2 with HMAC SHA-512 and A256KW"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0enc",children:"\u30b3\u30f3\u30c6\u30f3\u30c4\u6697\u53f7\u5316\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\uff08enc\uff09"}),"\n",(0,i.jsx)(n.h4,{id:"aes-cbc--hmac",children:"AES-CBC + HMAC"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A128CBC-HS256"})}),(0,i.jsx)(n.td,{children:"AES-128-CBC + HMAC-SHA-256"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A192CBC-HS384"})}),(0,i.jsx)(n.td,{children:"AES-192-CBC + HMAC-SHA-384"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A256CBC-HS512"})}),(0,i.jsx)(n.td,{children:"AES-256-CBC + HMAC-SHA-512"})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"aes-gcm\u63a8\u5968",children:"AES-GCM\uff08\u63a8\u5968\uff09"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}),(0,i.jsx)(n.th,{children:"\u8aac\u660e"}),(0,i.jsx)(n.th,{children:"\u63a8\u5968"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A128GCM"})}),(0,i.jsx)(n.td,{children:"AES-128-GCM"}),(0,i.jsx)(n.td,{children:"\u2705"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A192GCM"})}),(0,i.jsx)(n.td,{children:"AES-192-GCM"}),(0,i.jsx)(n.td,{children:"\u2705"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"A256GCM"})}),(0,i.jsx)(n.td,{children:"AES-256-GCM"}),(0,i.jsx)(n.td,{children:"\u2705 \u63a8\u5968"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"AES-GCM \u306f\u6697\u53f7\u5316\u3068\u8a8d\u8a3c\u3092\u540c\u6642\u306b\u884c\u3046 AEAD\uff08Authenticated Encryption with Associated Data\uff09\u3067\u3059\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u6697\u53f7\u5316\u306e\u624b\u9806",children:"\u6697\u53f7\u5316\u306e\u624b\u9806"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. CEK\uff08Content Encryption Key\uff09\u3092\u751f\u6210\n   CEK = random(256 bits)  // enc \u304c A256GCM \u306e\u5834\u5408\n\n2. CEK \u3092\u53d7\u4fe1\u8005\u306e\u516c\u958b\u9375\u3067\u6697\u53f7\u5316\n   Encrypted_CEK = RSA-OAEP(CEK, recipient_public_key)\n\n3. IV\uff08\u521d\u671f\u5316\u30d9\u30af\u30c8\u30eb\uff09\u3092\u751f\u6210\n   IV = random(96 bits)  // AES-GCM \u306e\u5834\u5408\n\n4. AAD\uff08Additional Authenticated Data\uff09\u3092\u69cb\u7bc9\n   AAD = ASCII(BASE64URL(Header))\n\n5. \u30da\u30a4\u30ed\u30fc\u30c9\u3092\u6697\u53f7\u5316\n   (Ciphertext, Tag) = AES-GCM-Encrypt(\n     Plaintext,\n     CEK,\n     IV,\n     AAD\n   )\n\n6. JWE Compact Serialization \u3092\u69cb\u7bc9\n   Header.Encrypted_CEK.IV.Ciphertext.Tag\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5fa9\u53f7\u306e\u624b\u9806",children:"\u5fa9\u53f7\u306e\u624b\u9806"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. JWE \u3092\u30d1\u30fc\u30b9\n   5 \u3064\u306e\u30d1\u30fc\u30c8\u306b\u5206\u5272\n\n2. Header \u3092\u30c7\u30b3\u30fc\u30c9\u3057\u3066\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u3092\u78ba\u8a8d\n   alg, enc \u3092\u691c\u8a3c\n\n3. CEK \u3092\u5fa9\u53f7\n   CEK = RSA-OAEP-Decrypt(Encrypted_CEK, recipient_private_key)\n\n4. AAD \u3092\u518d\u69cb\u7bc9\n   AAD = ASCII(BASE64URL(Header))\n\n5. \u30da\u30a4\u30ed\u30fc\u30c9\u3092\u5fa9\u53f7\u30fb\u691c\u8a3c\n   Plaintext = AES-GCM-Decrypt(\n     Ciphertext,\n     CEK,\n     IV,\n     AAD,\n     Tag\n   )\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nested-jwtsign-then-encrypt",children:"Nested JWT\uff08Sign-then-Encrypt\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u7f72\u540d\u4ed8\u304d JWT \u3092\u6697\u53f7\u5316\u3059\u308b\u5834\u5408\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. JWT \u3092\u4f5c\u6210\u30fb\u7f72\u540d\n   signed_jwt = JWS(claims, sender_private_key)\n\n2. \u7f72\u540d\u6e08\u307f JWT \u3092\u6697\u53f7\u5316\n   jwe = JWE(signed_jwt, recipient_public_key)\n\n\u53d7\u4fe1\u8005:\n1. JWE \u3092\u5fa9\u53f7\n   signed_jwt = Decrypt(jwe, recipient_private_key)\n\n2. JWT \u306e\u7f72\u540d\u3092\u691c\u8a3c\n   claims = Verify(signed_jwt, sender_public_key)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Nested JWT \u306e\u5834\u5408\u3001\u5916\u5074\u306e JWE \u30d8\u30c3\u30c0\u30fc\u306b ",(0,i.jsx)(n.code,{children:'cty: "JWT"'})," \u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "RSA-OAEP-256",\n  "enc": "A256GCM",\n  "cty": "JWT"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"json-serialization",children:"JSON Serialization"}),"\n",(0,i.jsx)(n.p,{children:"\u8907\u6570\u306e\u53d7\u4fe1\u8005\u306b\u5bfe\u3057\u3066\u6697\u53f7\u5316\u3059\u308b\u5834\u5408\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "protected": "eyJlbmMiOiJBMjU2R0NNIn0",\n  "iv": "48V1_ALb6US04U3b",\n  "ciphertext": "5eym8TW_c8SuK0ltJ3rpYIzOeDQz7TALvtu6UG9oMo4vpzs9tX...",\n  "tag": "XFBoMYUZodetZdvTiFvSkQ",\n  "recipients": [\n    {\n      "header": {\n        "alg": "RSA-OAEP-256",\n        "kid": "recipient-1"\n      },\n      "encrypted_key": "OKOawDo13gRp2ojaHV7LFpZcgV7T6DVZKTyKOMTYUmKoTCV..."\n    },\n    {\n      "header": {\n        "alg": "RSA-OAEP-256",\n        "kid": "recipient-2"\n      },\n      "encrypted_key": "a]G9HnWIgjXJe7UpEZ_R-4q..."\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805",children:"\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8003\u616e\u4e8b\u9805"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u9805\u76ee"}),(0,i.jsx)(n.th,{children:"\u63a8\u5968\u4e8b\u9805"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RSA1_5"})}),(0,i.jsx)(n.td,{children:"\u4f7f\u7528\u7981\u6b62\uff08\u30d1\u30c7\u30a3\u30f3\u30b0\u30aa\u30e9\u30af\u30eb\u653b\u6483\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\u9375\u30b5\u30a4\u30ba"}),(0,i.jsx)(n.td,{children:"RSA \u306f 2048 \u30d3\u30c3\u30c8\u4ee5\u4e0a\u3001AES \u306f 256 \u30d3\u30c3\u30c8"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AES-GCM"}),(0,i.jsx)(n.td,{children:"\u63a8\u5968\uff08AEAD\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"IV \u306e\u518d\u5229\u7528"}),(0,i.jsx)(n.td,{children:"\u7d76\u5bfe\u306b\u7981\u6b62"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"\u5727\u7e2e"}),(0,i.jsx)(n.td,{children:"CRIME \u653b\u6483\u306b\u6ce8\u610f\uff08\u6a5f\u5bc6\u30c7\u30fc\u30bf\u3067\u306f\u907f\u3051\u308b\uff09"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\u53c2\u8003\u30ea\u30f3\u30af",children:"\u53c2\u8003\u30ea\u30f3\u30af"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7516",children:"RFC 7516 - JSON Web Encryption (JWE)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7518",children:"RFC 7518 - JSON Web Algorithms (JWA)"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7517",children:"RFC 7517 - JSON Web Key (JWK)"})}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(j,{...e})}):j(e)}},28453:(e,n,d)=>{d.d(n,{R:()=>s,x:()=>t});var r=d(96540);const i={},c=r.createContext(i);function s(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);