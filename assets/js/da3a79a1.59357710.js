"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[67312],{99954:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"content_05_how-to/phase-2-security/authentication-policy-advanced","title":"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u8a73\u7d30\u7de8\uff09","description":"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684","source":"@site/docs/content_05_how-to/phase-2-security/03-authentication-policy-advanced.md","sourceDirName":"content_05_how-to/phase-2-security","slug":"/content_05_how-to/phase-2-security/authentication-policy-advanced","permalink":"/idp-server/docs/content_05_how-to/phase-2-security/authentication-policy-advanced","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/content_05_how-to/phase-2-security/03-authentication-policy-advanced.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"docs","previous":{"title":"\u30c8\u30fc\u30af\u30f3\u6709\u52b9\u671f\u9650\u30d1\u30bf\u30fc\u30f3","permalink":"/idp-server/docs/content_05_how-to/phase-2-security/token-strategy"},"next":{"title":"\u30b7\u30b9\u30c6\u30e0\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a","permalink":"/idp-server/docs/content_05_how-to/phase-2-security/system-security-setup"}}');var c=s(74848),r=s(28453);const t={},d="\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u8a73\u7d30\u7de8\uff09",l={},o=[{value:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",level:2},{value:"\u6240\u8981\u6642\u9593",id:"\u6240\u8981\u6642\u9593",level:3},{value:"\u524d\u63d0\u6761\u4ef6",id:"\u524d\u63d0\u6761\u4ef6",level:3},{value:"Management API URL",id:"management-api-url",level:3},{value:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30\u8a2d\u5b9a\u306e\u5168\u4f53\u50cf",id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30\u8a2d\u5b9a\u306e\u5168\u4f53\u50cf",level:2},{value:"Level 1: JSONPath\u6761\u4ef6\u5f0f\u306e\u57fa\u790e",id:"level-1-jsonpath\u6761\u4ef6\u5f0f\u306e\u57fa\u790e",level:2},{value:"JSONPath \u3068\u306f",id:"jsonpath-\u3068\u306f",level:3},{value:"\u8a8d\u8a3c\u72b6\u614b\u306e\u4f8b",id:"\u8a8d\u8a3c\u72b6\u614b\u306e\u4f8b",level:3},{value:"JSONPath\u69cb\u6587",id:"jsonpath\u69cb\u6587",level:3},{value:"\u6761\u4ef6\u5f0f\u306e\u69cb\u9020",id:"\u6761\u4ef6\u5f0f\u306e\u69cb\u9020",level:3},{value:"\u6f14\u7b97\u5b50\u4e00\u89a7",id:"\u6f14\u7b97\u5b50\u4e00\u89a7",level:3},{value:"Level 2: success_conditions\uff08\u6210\u529f\u6761\u4ef6\uff09\u306e\u8a73\u7d30",id:"level-2-success_conditions\u6210\u529f\u6761\u4ef6\u306e\u8a73\u7d30",level:2},{value:"\u30d1\u30bf\u30fc\u30f31: \u30b7\u30f3\u30d7\u30eb\u306a\u6761\u4ef6",id:"\u30d1\u30bf\u30fc\u30f31-\u30b7\u30f3\u30d7\u30eb\u306a\u6761\u4ef6",level:3},{value:"\u30d1\u30bf\u30fc\u30f32: OR\u6761\u4ef6\uff08any_of\uff09",id:"\u30d1\u30bf\u30fc\u30f32-or\u6761\u4ef6any_of",level:3},{value:"\u30d1\u30bf\u30fc\u30f33: AND\u6761\u4ef6\uff08\u914d\u5217\u5185\u306b\u8907\u6570\u6761\u4ef6\uff09",id:"\u30d1\u30bf\u30fc\u30f33-and\u6761\u4ef6\u914d\u5217\u5185\u306b\u8907\u6570\u6761\u4ef6",level:3},{value:"\u30d1\u30bf\u30fc\u30f34: \u8907\u96d1\u306a\u6761\u4ef6\uff08AND + OR\uff09",id:"\u30d1\u30bf\u30fc\u30f34-\u8907\u96d1\u306a\u6761\u4ef6and--or",level:3},{value:"Level 3: failure_conditions \u3068 lock_conditions",id:"level-3-failure_conditions-\u3068-lock_conditions",level:2},{value:"\u5931\u6557\u56de\u6570\u5236\u9650",id:"\u5931\u6557\u56de\u6570\u5236\u9650",level:3},{value:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6761\u4ef6\uff08lock_conditions\uff09",id:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6761\u4ef6lock_conditions",level:3},{value:"Level 4: step_definitions\uff08\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1\uff09",id:"level-4-step_definitions\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1",level:2},{value:"step_definitions \u3068\u306f",id:"step_definitions-\u3068\u306f",level:3},{value:"\u4e3b\u8981\u306a\u8a2d\u5b9a\u9805\u76ee",id:"\u4e3b\u8981\u306a\u8a2d\u5b9a\u9805\u76ee",level:3},{value:"\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8aac\u660e",id:"\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8aac\u660e",level:3},{value:"1st Factor vs 2nd Factor",id:"1st-factor-vs-2nd-factor",level:3},{value:"\u4f8b1: Email\uff081st\uff09 \u2192 SMS\uff082nd\uff09\u306e2\u8981\u7d20\u8a8d\u8a3c",id:"\u4f8b1-email1st--sms2nd\u306e2\u8981\u7d20\u8a8d\u8a3c",level:3},{value:"\u4f8b2: SSO\uff081st\uff09 \u2192 Email/SMS\uff082nd\uff09\u306e\u9078\u629e\u5f0f2FA",id:"\u4f8b2-sso1st--emailsms2nd\u306e\u9078\u629e\u5f0f2fa",level:3},{value:"user_identity_source \u306e\u7a2e\u985e",id:"user_identity_source-\u306e\u7a2e\u985e",level:3},{value:"step_definitions \u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9",id:"step_definitions-\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9",level:3},{value:"\u6761\u4ef6\u5f0f\u306e\u8a73\u7d30\u69cb\u6587",id:"\u6761\u4ef6\u5f0f\u306e\u8a73\u7d30\u69cb\u6587",level:2},{value:"any_of \u306e\u69cb\u9020",id:"any_of-\u306e\u69cb\u9020",level:3},{value:"\u306a\u305c <code>all_of</code> \u304c\u4e0d\u8981\u306a\u306e\u304b",id:"\u306a\u305c-all_of-\u304c\u4e0d\u8981\u306a\u306e\u304b",level:3},{value:"\u274c \u3082\u3057 <code>all_of</code> \u304c\u3042\u3063\u305f\u5834\u5408\uff08\u4ed6\u30b7\u30b9\u30c6\u30e0\u306e\u4f8b\uff09",id:"-\u3082\u3057-all_of-\u304c\u3042\u3063\u305f\u5834\u5408\u4ed6\u30b7\u30b9\u30c6\u30e0\u306e\u4f8b",level:4},{value:"\u2705 <code>any_of</code> \u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe",id:"-any_of-\u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe",level:4},{value:"\u8907\u96d1\u306a\u4f8b: (A AND B) OR (C AND D)",id:"\u8907\u96d1\u306a\u4f8b-a-and-b-or-c-and-d",level:4},{value:"\u5b9f\u8df5\u4f8b",id:"\u5b9f\u8df5\u4f8b",level:2},{value:"\u4f8b1: \u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f OR SMS\u6210\u529f",id:"\u4f8b1-\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f-or-sms\u6210\u529f",level:3},{value:"\u4f8b2: \uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f AND SMS\u6210\u529f\uff09OR FIDO2\u6210\u529f",id:"\u4f8b2-\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f-and-sms\u6210\u529for-fido2\u6210\u529f",level:3},{value:"\u4f8b3: \u5931\u6557\u56de\u6570\u5236\u9650\uff08failure_conditions\uff09",id:"\u4f8b3-\u5931\u6557\u56de\u6570\u5236\u9650failure_conditions",level:3},{value:"\u4f8b4: \u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\uff08lock_conditions\uff09",id:"\u4f8b4-\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30aflock_conditions",level:3},{value:"Level 5: ACR\u30de\u30c3\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\uff08\u8a73\u7d30\uff09",id:"level-5-acr\u30de\u30c3\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\u8a73\u7d30",level:2},{value:"ACR\u5024\u306e\u5b9a\u7fa9",id:"acr\u5024\u306e\u5b9a\u7fa9",level:3},{value:"ACR\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a2d\u5b9a",id:"acr\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a2d\u5b9a",level:3},{value:"ACR\u3092\u4f7f\u3063\u305f\u30a2\u30af\u30bb\u30b9\u5236\u5fa1",id:"acr\u3092\u4f7f\u3063\u305f\u30a2\u30af\u30bb\u30b9\u5236\u5fa1",level:3},{value:"Level 6: \u6761\u4ef6\uff08conditions\uff09\u306b\u3088\u308b\u30dd\u30ea\u30b7\u30fc\u5206\u5c90",id:"level-6-\u6761\u4ef6conditions\u306b\u3088\u308b\u30dd\u30ea\u30b7\u30fc\u5206\u5c90",level:2},{value:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u30dd\u30ea\u30b7\u30fc",id:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u30dd\u30ea\u30b7\u30fc",level:3},{value:"\u30b9\u30b3\u30fc\u30d7\u5225\u30dd\u30ea\u30b7\u30fc",id:"\u30b9\u30b3\u30fc\u30d7\u5225\u30dd\u30ea\u30b7\u30fc",level:3},{value:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",level:2},{value:"\u30a8\u30e9\u30fc1: \u6761\u4ef6\u5f0f\u306e\u69cb\u6587\u30a8\u30e9\u30fc",id:"\u30a8\u30e9\u30fc1-\u6761\u4ef6\u5f0f\u306e\u69cb\u6587\u30a8\u30e9\u30fc",level:3},{value:"\u30a8\u30e9\u30fc2: any_of\u306e\u69cb\u9020\u30df\u30b9",id:"\u30a8\u30e9\u30fc2-any_of\u306e\u69cb\u9020\u30df\u30b9",level:3},{value:"\u30a8\u30e9\u30fc3: failure_count\u3068lock_conditions\u306e\u9006\u8ee2",id:"\u30a8\u30e9\u30fc3-failure_count\u3068lock_conditions\u306e\u9006\u8ee2",level:3},{value:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",level:2},{value:"\u3055\u3089\u306b\u9ad8\u5ea6\u306a\u8a2d\u5b9a",id:"\u3055\u3089\u306b\u9ad8\u5ea6\u306a\u8a2d\u5b9a",level:3},{value:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",level:2}];function a(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\u8a73\u7d30\u7de8",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a2d\u5b9a\u30ac\u30a4\u30c9\uff08\u8a73\u7d30\u7de8\uff09"})}),"\n",(0,c.jsx)(e.h2,{id:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684",children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306e\u76ee\u7684"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u8907\u96d1\u306a\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc"}),"\uff08\u6761\u4ef6\u5f0f\u3001JSONPath\u3001failure_conditions\uff09\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002"]}),"\n",(0,c.jsx)(e.h3,{id:"\u6240\u8981\u6642\u9593",children:"\u6240\u8981\u6642\u9593"}),"\n",(0,c.jsxs)(e.p,{children:["\u23f1\ufe0f ",(0,c.jsx)(e.strong,{children:"\u7d0430\u5206"})]}),"\n",(0,c.jsx)(e.h3,{id:"\u524d\u63d0\u6761\u4ef6",children:"\u524d\u63d0\u6761\u4ef6"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"/idp-server/docs/content_05_how-to/phase-1-foundation/authentication-policy",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u57fa\u790e"}),"\u5b8c\u4e86"]}),"\n",(0,c.jsx)(e.li,{children:"JSONPath\u57fa\u790e\u77e5\u8b58\uff08\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b66\u3079\u307e\u3059\uff09"}),"\n",(0,c.jsx)(e.li,{children:"\u7d44\u7e54ID\uff08organization-id\uff09\u3092\u53d6\u5f97\u6e08\u307f"}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"management-api-url",children:"Management API URL"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u7d44\u7e54\u30ec\u30d9\u30ebAPI"}),"\uff08\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306e\u8868\u8a18\uff09:"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"POST /v1/management/organizations/{organization-id}/tenants/{tenant-id}/authentication-policies\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u6ce8\u610f"}),": \u30b7\u30b9\u30c6\u30e0\u30ec\u30d9\u30ebAPI\u3068\u306e\u9055\u3044"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"\u7d44\u7e54\u30ec\u30d9\u30eb"}),": ",(0,c.jsx)(e.code,{children:"POST /v1/management/organizations/{organization-id}/tenants/{tenant-id}/..."})," \u2190 \u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"\u30b7\u30b9\u30c6\u30e0\u30ec\u30d9\u30eb"}),": ",(0,c.jsx)(e.code,{children:"POST /v1/management/tenants/{tenant-id}/..."})," \u2190 \u7ba1\u7406\u8005\u306e\u307f"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u901a\u5e38\u306e\u904b\u7528\u3067\u306f\u7d44\u7e54\u30ec\u30d9\u30ebAPI\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30\u8a2d\u5b9a\u306e\u5168\u4f53\u50cf",children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u8a73\u7d30\u8a2d\u5b9a\u306e\u5168\u4f53\u50cf"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\uff08policies\u914d\u5217\u5185\u306e\u5404\u30dd\u30ea\u30b7\u30fc\uff09\n  \u251c\u2500 priority: \u512a\u5148\u5ea6\uff08\u9ad8\u3044\u5024\u307b\u3069\u512a\u5148\uff09\n  \u251c\u2500 conditions: \u30dd\u30ea\u30b7\u30fc\u9069\u7528\u6761\u4ef6\uff08\u30b9\u30b3\u30fc\u30d7\u3001\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u3001ACR\u5024\uff09\n  \u251c\u2500 available_methods: \u3069\u306e\u8a8d\u8a3c\u65b9\u5f0f\u3092\u8a31\u53ef\u3059\u308b\u304b\n  \u251c\u2500 success_conditions: \u6210\u529f\u6761\u4ef6\uff08\u3069\u306e\u8a8d\u8a3c\u304c\u6210\u529f\u3059\u308c\u3070\u5b8c\u4e86\u304b\uff09\n  \u251c\u2500 failure_conditions: \u5931\u6557\u6761\u4ef6\uff08\u4f55\u56de\u5931\u6557\u3057\u305f\u3089\u8a8d\u8a3c\u5931\u6557\u304b\uff09\n  \u251c\u2500 lock_conditions: \u30ed\u30c3\u30af\u6761\u4ef6\uff08\u4f55\u56de\u5931\u6557\u3057\u305f\u3089\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u304b\uff09\n  \u251c\u2500 step_definitions: \u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1\uff081st/2nd factor\uff09\n  \u2514\u2500 acr_mapping_rules: \u8a8d\u8a3c\u65b9\u5f0f \u2192 ACR\u30ec\u30d9\u30eb\u306e\u30de\u30c3\u30d4\u30f3\u30b0\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u3053\u306e\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u5b66\u3079\u308b\u3053\u3068"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"Level 1: JSONPath\u6761\u4ef6\u5f0f\u306e\u57fa\u790e"}),"\n",(0,c.jsx)(e.li,{children:"Level 2: success_conditions\uff08\u6210\u529f\u6761\u4ef6\uff09\u306e\u8a73\u7d30"}),"\n",(0,c.jsx)(e.li,{children:"Level 3: failure_conditions \u3068 lock_conditions\uff08\u5931\u6557\u30fb\u30ed\u30c3\u30af\u6761\u4ef6\uff09"}),"\n",(0,c.jsx)(e.li,{children:"Level 4: step_definitions\uff08\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1\uff09"}),"\n",(0,c.jsx)(e.li,{children:"Level 5: ACR\u30de\u30c3\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\uff08\u8a73\u7d30\uff09"}),"\n",(0,c.jsx)(e.li,{children:"Level 6: \u6761\u4ef6\u306b\u3088\u308b\u30dd\u30ea\u30b7\u30fc\u5206\u5c90\uff08\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u30fb\u30b9\u30b3\u30fc\u30d7\u5225\uff09"}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-1-jsonpath\u6761\u4ef6\u5f0f\u306e\u57fa\u790e",children:"Level 1: JSONPath\u6761\u4ef6\u5f0f\u306e\u57fa\u790e"}),"\n",(0,c.jsx)(e.h3,{id:"jsonpath-\u3068\u306f",children:"JSONPath \u3068\u306f"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u8a8d\u8a3c\u72b6\u614b\u3092JSON\u5f62\u5f0f\u3067\u8868\u73fe\u3057\u3001\u305d\u306e\u5024\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u8a18\u6cd5"}),"\u3067\u3059\u3002"]}),"\n",(0,c.jsx)(e.h3,{id:"\u8a8d\u8a3c\u72b6\u614b\u306e\u4f8b",children:"\u8a8d\u8a3c\u72b6\u614b\u306e\u4f8b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "password-authentication": {\n    "success_count": 0,\n    "failure_count": 2,\n    "last_attempt_at": "2025-10-13T10:00:00Z"\n  },\n  "sms-authentication": {\n    "success_count": 1,\n    "failure_count": 0\n  }\n}\n'})}),"\n",(0,c.jsx)(e.h3,{id:"jsonpath\u69cb\u6587",children:"JSONPath\u69cb\u6587"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"JSONPath"}),(0,c.jsx)(e.th,{children:"\u610f\u5473"}),(0,c.jsx)(e.th,{children:"\u4f8b\u306e\u5024"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"$.password-authentication.success_count"})}),(0,c.jsx)(e.td,{children:"password\u8a8d\u8a3c\u306e\u6210\u529f\u56de\u6570"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"0"})})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"$.password-authentication.failure_count"})}),(0,c.jsx)(e.td,{children:"password\u8a8d\u8a3c\u306e\u5931\u6557\u56de\u6570"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"2"})})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"$.sms-authentication.success_count"})}),(0,c.jsx)(e.td,{children:"SMS\u8a8d\u8a3c\u306e\u6210\u529f\u56de\u6570"}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"1"})})]})]})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u6761\u4ef6\u5f0f\u306e\u69cb\u9020",children:"\u6761\u4ef6\u5f0f\u306e\u69cb\u9020"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "path": "$.password-authentication.success_count",  // \u4f55\u3092\u30c1\u30a7\u30c3\u30af\u3059\u308b\u304b\n  "type": "integer",                                  // \u5024\u306e\u578b\n  "operation": "gte",                                 // \u6bd4\u8f03\u6f14\u7b97\u5b50\uff08>=\uff09\n  "value": 1                                          // \u671f\u5f85\u5024\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": ",(0,c.jsx)(e.code,{children:"password-authentication.success_count >= 1"})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u6f14\u7b97\u5b50\u4e00\u89a7",children:"\u6f14\u7b97\u5b50\u4e00\u89a7"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"operation"}),(0,c.jsx)(e.th,{children:"\u610f\u5473"}),(0,c.jsx)(e.th,{children:"\u4f8b"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"eq"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"="})," \u7b49\u3057\u3044"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 1'})," \u2192 1\u3068\u7b49\u3057\u3044"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"ne"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"!="})," \u7b49\u3057\u304f\u306a\u3044"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 0'})," \u2192 0\u3067\u306a\u3044"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"gt"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:">"})," \u3088\u308a\u5927\u304d\u3044"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 0'})," \u2192 0\u3088\u308a\u5927\u304d\u3044"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"gte"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:">="})," \u4ee5\u4e0a"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 1'})," \u2192 1\u4ee5\u4e0a"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"lt"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"<"})," \u672a\u6e80"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 5'})," \u2192 5\u672a\u6e80"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"lte"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"<="})," \u4ee5\u4e0b"]}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:'"value": 3'})," \u2192 3\u4ee5\u4e0b"]})]})]})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-2-success_conditions\u6210\u529f\u6761\u4ef6\u306e\u8a73\u7d30",children:"Level 2: success_conditions\uff08\u6210\u529f\u6761\u4ef6\uff09\u306e\u8a73\u7d30"}),"\n",(0,c.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f31-\u30b7\u30f3\u30d7\u30eb\u306a\u6761\u4ef6",children:"\u30d1\u30bf\u30fc\u30f31: \u30b7\u30f3\u30d7\u30eb\u306a\u6761\u4ef6"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u304c1\u56de\u4ee5\u4e0a\u6210\u529f"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"password\u6210\u529f \u2192 password-authentication.success_count = 1\n  \u2192 1 >= 1 \u2192 \u6761\u4ef6\u6e80\u305f\u3059\n  \u2192 \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f32-or\u6761\u4ef6any_of",children:"\u30d1\u30bf\u30fc\u30f32: OR\u6761\u4ef6\uff08any_of\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ],\n    [\n      {\n        "path": "$.sms-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f ",(0,c.jsx)(e.strong,{children:"OR"})," SMS\u6210\u529f"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"Case 1: password\u6210\u529f\n  \u2192 password-authentication.success_count = 1\n  \u2192 \u6761\u4ef6\u6e80\u305f\u3059 \u2192 \u8a8d\u8a3c\u5b8c\u4e86\n\nCase 2: sms\u6210\u529f\n  \u2192 sms-authentication.success_count = 1\n  \u2192 \u6761\u4ef6\u6e80\u305f\u3059 \u2192 \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f33-and\u6761\u4ef6\u914d\u5217\u5185\u306b\u8907\u6570\u6761\u4ef6",children:"\u30d1\u30bf\u30fc\u30f33: AND\u6761\u4ef6\uff08\u914d\u5217\u5185\u306b\u8907\u6570\u6761\u4ef6\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      },\n      {\n        "path": "$.sms-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f ",(0,c.jsx)(e.strong,{children:"AND"})," SMS\u6210\u529f\uff08MFA\uff09"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"password\u6210\u529f \u2192 password-authentication.success_count = 1\nsms\u6210\u529f \u2192 sms-authentication.success_count = 1\n  \u2192 \u4e21\u65b9 >= 1 \u2192 \u6761\u4ef6\u6e80\u305f\u3059\n  \u2192 \u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30d1\u30bf\u30fc\u30f34-\u8907\u96d1\u306a\u6761\u4ef6and--or",children:"\u30d1\u30bf\u30fc\u30f34: \u8907\u96d1\u306a\u6761\u4ef6\uff08AND + OR\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.fido2-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ],\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      },\n      {\n        "path": "$.sms-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": FIDO2\u6210\u529f ",(0,c.jsx)(e.strong,{children:"OR"})," \uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f ",(0,c.jsx)(e.strong,{children:"AND"})," SMS\u6210\u529f\uff09"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"Case 1: FIDO2\u306e\u307f\u3067\u8a8d\u8a3c\u5b8c\u4e86\nCase 2: \u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP\u3067\u8a8d\u8a3c\u5b8c\u4e86\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-3-failure_conditions-\u3068-lock_conditions",children:"Level 3: failure_conditions \u3068 lock_conditions"}),"\n",(0,c.jsx)(e.h3,{id:"\u5931\u6557\u56de\u6570\u5236\u9650",children:"\u5931\u6557\u56de\u6570\u5236\u9650"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "flow": "oauth",\n  "enabled": true,\n  "policies": [\n    {\n      "description": "with failure limit",\n      "priority": 1,\n      "conditions": {},\n      "available_methods": ["password"],\n      "success_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ]\n        ]\n      },\n      "failure_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.failure_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 5\n            }\n          ]\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u304c5\u56de\u5931\u6557\u3057\u305f\u3089\u8a8d\u8a3c\u5931\u6557\uff08\u30a8\u30e9\u30fc\u8fd4\u5374\uff09"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"1\u56de\u76ee\u5931\u6557 \u2192 failure_count = 1 \u2192 \u7d99\u7d9a\u53ef\u80fd\n2\u56de\u76ee\u5931\u6557 \u2192 failure_count = 2 \u2192 \u7d99\u7d9a\u53ef\u80fd\n...\n5\u56de\u76ee\u5931\u6557 \u2192 failure_count = 5\n  \u2192 5 >= 5 \u2192 failure_conditions\u6e80\u305f\u3059\n  \u2192 \u8a8d\u8a3c\u5931\u6557\u30a8\u30e9\u30fc\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6761\u4ef6lock_conditions",children:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\u6761\u4ef6\uff08lock_conditions\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "flow": "oauth",\n  "enabled": true,\n  "policies": [\n    {\n      "description": "with account lock",\n      "priority": 1,\n      "conditions": {},\n      "available_methods": ["password"],\n      "success_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ]\n        ]\n      },\n      "failure_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.failure_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 3\n            }\n          ]\n        ]\n      },\n      "lock_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.failure_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 5\n            }\n          ]\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"3\u56de\u5931\u6557 \u2192 \u8a8d\u8a3c\u5931\u6557\u30a8\u30e9\u30fc\uff08\u307e\u3060\u30ed\u30c3\u30af\u3055\u308c\u3066\u3044\u306a\u3044\uff09"}),"\n",(0,c.jsxs)(e.li,{children:["5\u56de\u5931\u6557 \u2192 ",(0,c.jsx)(e.strong,{children:"\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af"}),"\uff08\u30e6\u30fc\u30b6\u30fc\u30b9\u30c6\u30fc\u30bf\u30b9\u304cLOCKED\u306b\u5909\u66f4\uff09"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"1-2\u56de\u5931\u6557 \u2192 \u7d99\u7d9a\u53ef\u80fd\n3\u56de\u76ee\u5931\u6557 \u2192 failure_conditions\u6e80\u305f\u3059 \u2192 \u8a8d\u8a3c\u5931\u6557\u30a8\u30e9\u30fc\n  \u2193 \u30e6\u30fc\u30b6\u30fc\u304c\u518d\u8a66\u884c\n4\u56de\u76ee\u5931\u6557 \u2192 \u8a8d\u8a3c\u5931\u6557\u30a8\u30e9\u30fc\n5\u56de\u76ee\u5931\u6557 \u2192 lock_conditions\u6e80\u305f\u3059\n  \u2192 \u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\n  \u2192 UserLifecycleEvent\u767a\u884c\uff08LOCK\uff09\n  \u2192 \u7ba1\u7406\u8005\u306b\u3088\u308b\u89e3\u9664\u304c\u5fc5\u8981\n"})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30ed\u30c3\u30af\u89e3\u9664"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'curl -X PUT "http://localhost:8080/v1/management/organizations/${ORGANIZATION_ID}/tenants/${TENANT_ID}/users/${USER_ID}" \\\n  -H "Content-Type: application/json" \\\n  -H "Authorization: Bearer ${ADMIN_TOKEN}" \\\n  -d \'{\n    "status": "ACTIVE"\n  }\'\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-4-step_definitions\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1",children:"Level 4: step_definitions\uff08\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u5236\u5fa1\uff09"}),"\n",(0,c.jsx)(e.h3,{id:"step_definitions-\u3068\u306f",children:"step_definitions \u3068\u306f"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\u306e\u8a73\u7d30\u306a\u52d5\u4f5c\u3092\u5b9a\u7fa9\u3059\u308b\u6a5f\u80fd"}),"\u3067\u3059\u3002Keycloak\u306e\u8a8d\u8a3c\u30d5\u30ed\u30fc\u30d1\u30bf\u30fc\u30f3\u306b\u6e96\u62e0\u3057\u3066\u3044\u307e\u3059\u3002"]}),"\n",(0,c.jsx)(e.h3,{id:"\u4e3b\u8981\u306a\u8a2d\u5b9a\u9805\u76ee",children:"\u4e3b\u8981\u306a\u8a2d\u5b9a\u9805\u76ee"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "step_definitions": [\n    {\n      "method": "email",              // \u8a8d\u8a3c\u65b9\u5f0f\n      "order": 1,                     // \u5b9f\u884c\u9806\u5e8f\n      "requires_user": false,         // \u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u6e08\u307f\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\uff081st/2nd factor\uff09\n      "allow_registration": true,     // \u30ea\u30af\u30a8\u30b9\u30c8\u5024\u3067\u306e\u65b0\u898f\u767b\u9332\u3092\u8a31\u53ef\u3059\u308b\u304b\n      "user_identity_source": "email" // \u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u306b\u4f7f\u7528\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\n    }\n  ]\n}\n'})}),"\n",(0,c.jsx)(e.h3,{id:"\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8aac\u660e",children:"\u4e3b\u8981\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u8aac\u660e"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"\u30d1\u30e9\u30e1\u30fc\u30bf"}),(0,c.jsx)(e.th,{children:"\u8aac\u660e"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"method"})}),(0,c.jsxs)(e.td,{children:["\u8a8d\u8a3c\u65b9\u5f0f\uff08",(0,c.jsx)(e.code,{children:"email"}),", ",(0,c.jsx)(e.code,{children:"sms"}),", ",(0,c.jsx)(e.code,{children:"password"}),", ",(0,c.jsx)(e.code,{children:"fido2"})," \u7b49\uff09"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"order"})}),(0,c.jsx)(e.td,{children:"\u5b9f\u884c\u9806\u5e8f\uff08\u540c\u3058order\u5024\u306f\u9078\u629e\u53ef\u80fd\uff09"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"requires_user"})}),(0,c.jsxs)(e.td,{children:["\u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u6e08\u307f\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308b\u304b\uff08",(0,c.jsx)(e.code,{children:"false"}),"=1st factor, ",(0,c.jsx)(e.code,{children:"true"}),"=2nd factor\uff09"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"allow_registration"})}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.strong,{children:"\u30ea\u30af\u30a8\u30b9\u30c8\u5024\u3067\u306e\u65b0\u898f\u767b\u9332\u3092\u8a31\u53ef\u3059\u308b\u304b"}),(0,c.jsx)("br",{}),"- ",(0,c.jsx)(e.code,{children:"true"}),": \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u30e1\u30fc\u30eb/\u96fb\u8a71\u756a\u53f7\u3067\u65b0\u898f\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u53ef\u80fd",(0,c.jsx)("br",{}),"- ",(0,c.jsx)(e.code,{children:"false"}),": \u65e2\u5b58\u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb/\u96fb\u8a71\u756a\u53f7\u3068\u4e00\u81f4\u3059\u308b\u5fc5\u8981"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"user_identity_source"})}),(0,c.jsxs)(e.td,{children:["\u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u306b\u4f7f\u7528\u3059\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\uff08",(0,c.jsx)(e.code,{children:"email"}),", ",(0,c.jsx)(e.code,{children:"phone_number"}),", ",(0,c.jsx)(e.code,{children:"username"})," \u7b49\uff09"]})]})]})]}),"\n",(0,c.jsx)(e.h3,{id:"1st-factor-vs-2nd-factor",children:"1st Factor vs 2nd Factor"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"\u9805\u76ee"}),(0,c.jsx)(e.th,{children:"1st Factor"}),(0,c.jsx)(e.th,{children:"2nd Factor"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"requires_user"})}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"false"})}),(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"true"})})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"\u5f79\u5272"}),(0,c.jsx)(e.td,{children:"\u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u30d5\u30a7\u30fc\u30ba"}),(0,c.jsx)(e.td,{children:"\u8a8d\u8a3c\u691c\u8a3c\u30d5\u30a7\u30fc\u30ba"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"\u65b0\u898f\u30e6\u30fc\u30b6\u30fc"}),(0,c.jsxs)(e.td,{children:["\u30ea\u30af\u30a8\u30b9\u30c8\u5024\u3067\u767b\u9332\u53ef\u80fd",(0,c.jsx)("br",{}),"\uff08",(0,c.jsx)(e.code,{children:"allow_registration=true"}),"\uff09"]}),(0,c.jsxs)(e.td,{children:["\u767b\u9332\u4e0d\u53ef",(0,c.jsx)("br",{}),"\uff08\u65e2\u5b58\u30e6\u30fc\u30b6\u30fc\u306e\u307f\uff09"]})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"\u8b58\u5225\u65b9\u6cd5"}),(0,c.jsxs)(e.td,{children:[(0,c.jsx)(e.code,{children:"user_identity_source"})," \u3067\u6307\u5b9a"]}),(0,c.jsx)(e.td,{children:"\u65e2\u306b\u8b58\u5225\u6e08\u307f\u306e\u30e6\u30fc\u30b6\u30fc\u3092\u691c\u8a3c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:"\u4f8b"}),(0,c.jsx)(e.td,{children:"Email/SMS challenge, Password, \u65b0\u898f\u767b\u9332"}),(0,c.jsx)(e.td,{children:"OTP\u691c\u8a3c, FIDO\u8a8d\u8a3c"})]})]})]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsxs)(e.strong,{children:["Keycloak\u306e ",(0,c.jsx)(e.code,{children:"requiresUser()"})," \u30d1\u30bf\u30fc\u30f3\u3092\u8e0f\u8972"]}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.a,{href:"https://www.keycloak.org/docs-api/latest/javadocs/org/keycloak/authentication/Authenticator.html#requiresUser()",children:"Keycloak Authenticator.requiresUser()"})}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b1-email1st--sms2nd\u306e2\u8981\u7d20\u8a8d\u8a3c",children:"\u4f8b1: Email\uff081st\uff09 \u2192 SMS\uff082nd\uff09\u306e2\u8981\u7d20\u8a8d\u8a3c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "policies": [\n    {\n      "description": "email_then_sms_2fa",\n      "priority": 10,\n      "conditions": { "scopes": ["openid"] },\n      "available_methods": ["email", "sms"],\n      "step_definitions": [\n        {\n          "method": "email",\n          "order": 1,\n          "requires_user": false,\n          "allow_registration": true,\n          "user_identity_source": "email"\n        },\n        {\n          "method": "sms",\n          "order": 2,\n          "requires_user": true,\n          "allow_registration": false,\n          "user_identity_source": "phone_number"\n        }\n      ],\n      "success_conditions": {\n        "any_of": [\n          [\n            { "path": "$.email-authentication.success_count", "type": "integer", "operation": "gte", "value": 1 },\n            { "path": "$.sms-authentication.success_count", "type": "integer", "operation": "gte", "value": 1 }\n          ]\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"1. Email\u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\uff081st factor\uff09\n   - requires_user=false \u2192 \u30e6\u30fc\u30b6\u30fc\u672a\u8b58\u5225\u3067OK\n   - allow_registration=true \u2192 \u65b0\u898f\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u53ef\u80fd\n   - user_identity_source=email \u2192 \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225\n   \u2193\n2. Email OTP\u691c\u8a3c\n   - \u30e6\u30fc\u30b6\u30fc\u304c\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306b\u7d10\u4ed8\u3051\u3089\u308c\u308b\n   \u2193\n3. SMS\u8a8d\u8a3c\u30c1\u30e3\u30ec\u30f3\u30b8\uff082nd factor\uff09\n   - requires_user=true \u2192 \u30e6\u30fc\u30b6\u30fc\u8b58\u5225\u6e08\u307f\u3067\u3042\u308b\u5fc5\u8981\n   - allow_registration=false \u2192 \u65b0\u898f\u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\u4e0d\u53ef\n   - user_identity_source=phone_number \u2192 \u96fb\u8a71\u756a\u53f7\u3067\u30e6\u30fc\u30b6\u30fc\u691c\u8a3c\n   \u2193\n4. SMS OTP\u691c\u8a3c\n   \u2193\n5. \u8a8d\u8a3c\u5b8c\u4e86\uff08\u4e21\u65b9\u306e success_count >= 1\uff09\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b2-sso1st--emailsms2nd\u306e\u9078\u629e\u5f0f2fa",children:"\u4f8b2: SSO\uff081st\uff09 \u2192 Email/SMS\uff082nd\uff09\u306e\u9078\u629e\u5f0f2FA"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "step_definitions": [\n    {\n      "method": "sso",\n      "order": 1,\n      "requires_user": false,\n      "allow_registration": true,\n      "user_identity_source": "sso"\n    },\n    {\n      "method": "email",\n      "order": 2,\n      "requires_user": true,\n      "allow_registration": false,\n      "user_identity_source": "email"\n    },\n    {\n      "method": "sms",\n      "order": 2,\n      "requires_user": true,\n      "allow_registration": false,\n      "user_identity_source": "phone_number"\n    }\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30d5\u30ed\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"1. SSO\u8a8d\u8a3c\uff081st factor, order=1\uff09\n   \u2193\n2. Email\u8a8d\u8a3c OR SMS\u8a8d\u8a3c\uff082nd factor, order=2\uff09\n   - \u540c\u3058order\u306f\u9078\u629e\u53ef\u80fd\uff08\u3069\u3061\u3089\u304b1\u3064\u3067OK\uff09\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"user_identity_source-\u306e\u7a2e\u985e",children:"user_identity_source \u306e\u7a2e\u985e"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"\u5024"}),(0,c.jsx)(e.th,{children:"\u610f\u5473"}),(0,c.jsx)(e.th,{children:"\u4f7f\u7528\u4f8b"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"email"})}),(0,c.jsx)(e.td,{children:"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225"}),(0,c.jsx)(e.td,{children:"Email\u8a8d\u8a3c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"phone_number"})}),(0,c.jsx)(e.td,{children:"\u96fb\u8a71\u756a\u53f7\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225"}),(0,c.jsx)(e.td,{children:"SMS\u8a8d\u8a3c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"username"})}),(0,c.jsx)(e.td,{children:"\u30e6\u30fc\u30b6\u30fc\u540d\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225"}),(0,c.jsx)(e.td,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"webauthn_credential"})}),(0,c.jsx)(e.td,{children:"WebAuthn\u8cc7\u683c\u60c5\u5831\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225"}),(0,c.jsx)(e.td,{children:"FIDO2\u8a8d\u8a3c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"sso"})}),(0,c.jsx)(e.td,{children:"SSO\uff08\u5916\u90e8IdP\uff09\u3067\u30e6\u30fc\u30b6\u30fc\u8b58\u5225"}),(0,c.jsx)(e.td,{children:"OIDC\u9023\u643a"})]})]})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"step_definitions-\u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9",children:"step_definitions \u3092\u4f7f\u3046\u3079\u304d\u30b1\u30fc\u30b9"}),"\n",(0,c.jsxs)(e.p,{children:["\u2705 ",(0,c.jsx)(e.strong,{children:"\u4f7f\u3046\u3079\u304d"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"\u30de\u30eb\u30c1\u30b9\u30c6\u30c3\u30d7\u8a8d\u8a3c\u30d5\u30ed\u30fc\uff08Email \u2192 SMS\u7b49\uff09\u3092\u5b9a\u7fa9\u3057\u305f\u3044"}),"\n",(0,c.jsx)(e.li,{children:"1st/2nd factor\u306e\u5236\u5fa1\u304c\u5fc5\u8981"}),"\n",(0,c.jsx)(e.li,{children:"\u65b0\u898f\u30e6\u30fc\u30b6\u30fc\u767b\u9332\u3092\u7279\u5b9a\u30b9\u30c6\u30c3\u30d7\u3067\u306e\u307f\u8a31\u53ef\u3057\u305f\u3044"}),"\n",(0,c.jsx)(e.li,{children:"\u8a8d\u8a3c\u9806\u5e8f\u3092\u660e\u793a\u7684\u306b\u5236\u5fa1\u3057\u305f\u3044"}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["\u274c ",(0,c.jsx)(e.strong,{children:"\u4f7f\u308f\u306a\u304f\u3066\u3088\u3044"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"\u30b7\u30f3\u30d7\u30eb\u306aMFA\uff08success_conditions\u3060\u3051\u3067\u5341\u5206\uff09"}),"\n",(0,c.jsx)(e.li,{children:"\u8a8d\u8a3c\u9806\u5e8f\u306e\u5236\u5fa1\u304c\u4e0d\u8981"}),"\n",(0,c.jsx)(e.li,{children:"\u3059\u3079\u3066\u306e\u30b9\u30c6\u30c3\u30d7\u3067\u767b\u9332\u3092\u8a31\u53ef\u3059\u308b\u5834\u5408"}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u91cd\u8981"}),": ",(0,c.jsx)(e.code,{children:"step_definitions"})," \u306f\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3067\u3059\u3002\u901a\u5e38\u306eMFA\u8a2d\u5b9a\u3067\u306f ",(0,c.jsx)(e.code,{children:"success_conditions"})," \u306e\u307f\u3067\u5341\u5206\u3067\u3059\u3002"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u6761\u4ef6\u5f0f\u306e\u8a73\u7d30\u69cb\u6587",children:"\u6761\u4ef6\u5f0f\u306e\u8a73\u7d30\u69cb\u6587"}),"\n",(0,c.jsx)(e.h3,{id:"any_of-\u306e\u69cb\u9020",children:"any_of \u306e\u69cb\u9020"}),"\n",(0,c.jsxs)(e.p,{children:["\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3067\u306f ",(0,c.jsxs)(e.strong,{children:[(0,c.jsx)(e.code,{children:"any_of"})," \u306e\u307f\u30b5\u30dd\u30fc\u30c8"]}),"\u3055\u308c\u3066\u3044\u307e\u3059\uff08",(0,c.jsx)(e.code,{children:"all_of"})," \u306f\u5b58\u5728\u3057\u307e\u305b\u3093\uff09\u3002"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"any_of": [\n  [ \u6761\u4ef6A ],  // \u2190 \u3053\u306e\u914d\u5217\u5185\u306f AND\n  [ \u6761\u4ef6B ],  // \u2190 \u3053\u306e\u914d\u5217\u5185\u306f AND\n  [ \u6761\u4ef6C ]   // \u2190 \u3053\u306e\u914d\u5217\u5185\u306f AND\n]\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u6761\u4ef6A ",(0,c.jsx)(e.strong,{children:"OR"})," \u6761\u4ef6B ",(0,c.jsx)(e.strong,{children:"OR"})," \u6761\u4ef6C"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u91cd\u8981"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\u5916\u5074\u306e\u914d\u5217 = ",(0,c.jsx)(e.strong,{children:"OR\u6761\u4ef6"}),"\uff08\u3044\u305a\u308c\u304b1\u3064\u6e80\u305f\u305b\u3070OK\uff09"]}),"\n",(0,c.jsxs)(e.li,{children:["\u5185\u5074\u306e\u914d\u5217 = ",(0,c.jsx)(e.strong,{children:"AND\u6761\u4ef6"}),"\uff08\u3059\u3079\u3066\u6e80\u305f\u3059\u5fc5\u8981\u3042\u308a\uff09"]}),"\n",(0,c.jsx)(e.li,{children:"\u3053\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u8907\u96d1\u306a\u8ad6\u7406\u5f0f\u3092\u8868\u73fe\u53ef\u80fd"}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsxs)(e.h3,{id:"\u306a\u305c-all_of-\u304c\u4e0d\u8981\u306a\u306e\u304b",children:["\u306a\u305c ",(0,c.jsx)(e.code,{children:"all_of"})," \u304c\u4e0d\u8981\u306a\u306e\u304b"]}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsxs)(e.strong,{children:[(0,c.jsx)(e.code,{children:"any_of"})," \u306e\u5185\u5074\u914d\u5217\u304cAND\u6761\u4ef6\u3068\u3057\u3066\u6a5f\u80fd\u3059\u308b\u305f\u3081\u3001",(0,c.jsx)(e.code,{children:"all_of"})," \u306f\u4e0d\u8981\u3067\u3059\u3002"]})}),"\n",(0,c.jsxs)(e.h4,{id:"-\u3082\u3057-all_of-\u304c\u3042\u3063\u305f\u5834\u5408\u4ed6\u30b7\u30b9\u30c6\u30e0\u306e\u4f8b",children:["\u274c \u3082\u3057 ",(0,c.jsx)(e.code,{children:"all_of"})," \u304c\u3042\u3063\u305f\u5834\u5408\uff08\u4ed6\u30b7\u30b9\u30c6\u30e0\u306e\u4f8b\uff09"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"all_of": [\n  [ { "path": "$.password-authentication.success_count", "operation": "gte", "value": 1 } ],\n  [ { "path": "$.sms-authentication.success_count", "operation": "gte", "value": 1 } ]\n]\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u2192 \u3059\u3079\u3066\u306e\u30b0\u30eb\u30fc\u30d7\u3092\u6e80\u305f\u3059\u5fc5\u8981\uff08AND\uff09"}),"\n",(0,c.jsxs)(e.h4,{id:"-any_of-\u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe",children:["\u2705 ",(0,c.jsx)(e.code,{children:"any_of"})," \u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"any_of": [\n  [\n    { "path": "$.password-authentication.success_count", "operation": "gte", "value": 1 },\n    { "path": "$.sms-authentication.success_count", "operation": "gte", "value": 1 }\n  ]\n]\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u2192 \u5185\u5074\u914d\u5217\u306e\u8907\u6570\u6761\u4ef6 = \u3059\u3079\u3066\u6e80\u305f\u3059\u5fc5\u8981\uff08AND\uff09"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u7d50\u8ad6"}),": ",(0,c.jsx)(e.code,{children:"any_of"})," \u306e\u5185\u5074\u914d\u5217\u3067AND\u6761\u4ef6\u3092\u8868\u73fe\u3067\u304d\u308b\u305f\u3081\u3001",(0,c.jsx)(e.code,{children:"all_of"})," \u306f\u5197\u9577\u3067\u3059\u3002"]}),"\n",(0,c.jsx)(e.h4,{id:"\u8907\u96d1\u306a\u4f8b-a-and-b-or-c-and-d",children:"\u8907\u96d1\u306a\u4f8b: (A AND B) OR (C AND D)"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"any_of": [\n  [\n    { "path": "$.password-authentication.success_count", "operation": "gte", "value": 1 },\n    { "path": "$.sms-authentication.success_count", "operation": "gte", "value": 1 }\n  ],\n  [\n    { "path": "$.email-authentication.success_count", "operation": "gte", "value": 1 },\n    { "path": "$.fido2-authentication.success_count", "operation": "gte", "value": 1 }\n  ]\n]\n'})}),"\n",(0,c.jsxs)(e.p,{children:["\u2192 (password AND sms) ",(0,c.jsx)(e.strong,{children:"OR"})," (email AND fido2)"]}),"\n",(0,c.jsx)(e.p,{children:"\u3053\u306e\u8a2d\u8a08\u306b\u3088\u308a\u3001\u30b7\u30f3\u30d7\u30eb\u304b\u3064\u67d4\u8edf\u306a\u6761\u4ef6\u5b9a\u7fa9\u304c\u53ef\u80fd\u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u91cd\u8981"}),": \u30d1\u30b9\u306e\u547d\u540d\u898f\u5247"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u57fa\u672c\u5f62\u5f0f"}),": ",(0,c.jsx)(e.code,{children:"$.{method}-authentication.{property}"})]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.password-authentication.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.sms-authentication.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.email-authentication.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.fido2-authentication.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.fido-uaf-authentication.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u274c ",(0,c.jsx)(e.code,{children:"$.password.success_count"})," \uff08\u9593\u9055\u3044\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u4f8b\u5916"}),": ",(0,c.jsx)(e.code,{children:"external-token"})," \u3068 OIDC\u9023\u643a\u306f ",(0,c.jsx)(e.code,{children:"-authentication"})," \u30b5\u30d5\u30a3\u30c3\u30af\u30b9\u306a\u3057"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.external-token.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.oidc-google.success_count"})]}),"\n",(0,c.jsxs)(e.li,{children:["\u2705 ",(0,c.jsx)(e.code,{children:"$.oidc-facebook.success_count"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u5b9f\u8df5\u4f8b",children:"\u5b9f\u8df5\u4f8b"}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b1-\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f-or-sms\u6210\u529f",children:"\u4f8b1: \u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f OR SMS\u6210\u529f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ],\n    [\n      {\n        "path": "$.sms-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b2-\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f-and-sms\u6210\u529for-fido2\u6210\u529f",children:"\u4f8b2: \uff08\u30d1\u30b9\u30ef\u30fc\u30c9\u6210\u529f AND SMS\u6210\u529f\uff09OR FIDO2\u6210\u529f"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"success_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.fido2-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ],\n    [\n      {\n        "path": "$.password-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      },\n      {\n        "path": "$.sms-authentication.success_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 1\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),":"]}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"FIDO2\u3060\u3051\u3067\u8a8d\u8a3c\u5b8c\u4e86\uff08\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\uff09"}),"\n",(0,c.jsx)(e.li,{children:"\u307e\u305f\u306f\u3001\u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP\u3067\u8a8d\u8a3c\u5b8c\u4e86\uff08\u6a19\u6e96MFA\uff09"}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b3-\u5931\u6557\u56de\u6570\u5236\u9650failure_conditions",children:"\u4f8b3: \u5931\u6557\u56de\u6570\u5236\u9650\uff08failure_conditions\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"failure_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.failure_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 3\n      }\n    ],\n    [\n      {\n        "path": "$.sms-authentication.failure_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 5\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c93\u56de\u5931\u6557 ",(0,c.jsx)(e.strong,{children:"OR"})," SMS 5\u56de\u5931\u6557 \u2192 \u8a8d\u8a3c\u5931\u6557"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u4f8b4-\u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30aflock_conditions",children:"\u4f8b4: \u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af\uff08lock_conditions\uff09"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"lock_conditions": {\n  "any_of": [\n    [\n      {\n        "path": "$.password-authentication.failure_count",\n        "type": "integer",\n        "operation": "gte",\n        "value": 5\n      }\n    ]\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u610f\u5473"}),": \u30d1\u30b9\u30ef\u30fc\u30c95\u56de\u5931\u6557 \u2192 \u30a2\u30ab\u30a6\u30f3\u30c8\u30ed\u30c3\u30af"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-5-acr\u30de\u30c3\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\u8a73\u7d30",children:"Level 5: ACR\u30de\u30c3\u30d4\u30f3\u30b0\u30eb\u30fc\u30eb\uff08\u8a73\u7d30\uff09"}),"\n",(0,c.jsx)(e.h3,{id:"acr\u5024\u306e\u5b9a\u7fa9",children:"ACR\u5024\u306e\u5b9a\u7fa9"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"ACR\uff08Authentication Context Class Reference\uff09"})," = \u8a8d\u8a3c\u306e\u5f37\u5ea6\u30ec\u30d9\u30eb"]}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"ACR\u5024"}),(0,c.jsx)(e.th,{children:"\u30ec\u30d9\u30eb"}),(0,c.jsx)(e.th,{children:"\u8a8d\u8a3c\u65b9\u5f0f\u306e\u4f8b"}),(0,c.jsx)(e.th,{children:"\u7528\u9014"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"urn:mace:incommon:iap:bronze"})}),(0,c.jsx)(e.td,{children:"\u4f4e"}),(0,c.jsx)(e.td,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f"}),(0,c.jsx)(e.td,{children:"\u901a\u5e38\u64cd\u4f5c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"urn:mace:incommon:iap:silver"})}),(0,c.jsx)(e.td,{children:"\u4e2d"}),(0,c.jsx)(e.td,{children:"\u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP"}),(0,c.jsx)(e.td,{children:"\u91cd\u8981\u64cd\u4f5c"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"urn:mace:incommon:iap:gold"})}),(0,c.jsx)(e.td,{children:"\u9ad8"}),(0,c.jsx)(e.td,{children:"FIDO2\u751f\u4f53\u8a8d\u8a3c"}),(0,c.jsx)(e.td,{children:"\u975e\u5e38\u306b\u91cd\u8981\u306a\u64cd\u4f5c"})]})]})]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30ab\u30b9\u30bf\u30e0ACR\u5024\u3082\u5b9a\u7fa9\u53ef\u80fd"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"urn:example:acr:level1"\n"urn:example:acr:level2"\n"urn:example:acr:level3"\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"acr\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a2d\u5b9a",children:"ACR\u30de\u30c3\u30d4\u30f3\u30b0\u306e\u8a2d\u5b9a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"acr_mapping_rules": {\n  "urn:mace:incommon:iap:gold": ["fido2", "fido-uaf"],\n  "urn:mace:incommon:iap:silver": ["sms", "email", "totp"],\n  "urn:mace:incommon:iap:bronze": ["password"]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u52d5\u4f5c"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:'FIDO2\u8a8d\u8a3c\u6210\u529f\n  \u2192 ACR: urn:mace:incommon:iap:gold\n  \u2192 ID Token.acr = "urn:mace:incommon:iap:gold"\n\nSMS OTP\u8a8d\u8a3c\u6210\u529f\n  \u2192 ACR: urn:mace:incommon:iap:silver\n  \u2192 ID Token.acr = "urn:mace:incommon:iap:silver"\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u8a8d\u8a3c\u6210\u529f\n  \u2192 ACR: urn:mace:incommon:iap:bronze\n  \u2192 ID Token.acr = "urn:mace:incommon:iap:bronze"\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"acr\u3092\u4f7f\u3063\u305f\u30a2\u30af\u30bb\u30b9\u5236\u5fa1",children:"ACR\u3092\u4f7f\u3063\u305f\u30a2\u30af\u30bb\u30b9\u5236\u5fa1"}),"\n",(0,c.jsx)(e.p,{children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u3067ACR\u5024\u3092\u78ba\u8a8d\u3057\u3066\u64cd\u4f5c\u3092\u5236\u9650\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-javascript",children:'// \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5074\u306e\u30b3\u30fc\u30c9\nconst idToken = parseJwt(response.id_token);\n\nif (idToken.acr === "urn:mace:incommon:iap:gold") {\n  // \u9ad8\u30ec\u30d9\u30eb\u8a8d\u8a3c \u2192 \u3059\u3079\u3066\u306e\u64cd\u4f5c\u3092\u8a31\u53ef\n  allowSensitiveOperation();\n} else if (idToken.acr === "urn:mace:incommon:iap:silver") {\n  // \u4e2d\u30ec\u30d9\u30eb\u8a8d\u8a3c \u2192 \u901a\u5e38\u64cd\u4f5c\u306e\u307f\n  allowNormalOperation();\n} else {\n  // \u4f4e\u30ec\u30d9\u30eb\u8a8d\u8a3c \u2192 \u8aad\u307f\u53d6\u308a\u306e\u307f\n  allowReadOnlyOperation();\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u307e\u305f\u306f\u3001Authorization Request\u3067\u8981\u6c42"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'curl "http://localhost:8080/${TENANT_ID}/v1/authorizations?\\\nresponse_type=code&\\\nclient_id=${CLIENT_ID}&\\\nacr_values=urn:mace:incommon:iap:gold"  # gold \u30ec\u30d9\u30eb\u5fc5\u9808\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u52b9\u679c"}),": gold \u30ec\u30d9\u30eb\u306e\u8a8d\u8a3c\u65b9\u5f0f\uff08FIDO2\u7b49\uff09\u306e\u307f\u8a31\u53ef\u3055\u308c\u308b"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"level-6-\u6761\u4ef6conditions\u306b\u3088\u308b\u30dd\u30ea\u30b7\u30fc\u5206\u5c90",children:"Level 6: \u6761\u4ef6\uff08conditions\uff09\u306b\u3088\u308b\u30dd\u30ea\u30b7\u30fc\u5206\u5c90"}),"\n",(0,c.jsx)(e.h3,{id:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u30dd\u30ea\u30b7\u30fc",children:"\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u5225\u30dd\u30ea\u30b7\u30fc"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u91cd\u8981"}),": priority\u306f",(0,c.jsx)(e.strong,{children:"\u5024\u304c\u5927\u304d\u3044\u307b\u3069\u512a\u5148\u5ea6\u304c\u9ad8\u3044"}),"\u3067\u3059\uff08100 > 50 > 1\uff09\u3002"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "flow": "oauth",\n  "enabled": true,\n  "policies": [\n    {\n      "description": "admin app - high security",\n      "priority": 100,\n      "conditions": {\n        "client_ids": ["admin-app", "super-admin-app"]\n      },\n      "available_methods": ["password", "initial-registration", "fido2"],\n      "success_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            },\n            {\n              "path": "$.fido2-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ],\n          [\n            {\n              "path": "$.initial-registration.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            },\n            {\n              "path": "$.fido2-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ]\n        ]\n      }\n    },\n    {\n      "description": "normal app - standard security",\n      "priority": 50,\n      "conditions": {\n        "client_ids": ["user-app"]\n      },\n      "available_methods": ["password", "initial-registration", "sms"],\n      "success_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            },\n            {\n              "path": "$.sms-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ],\n          [\n            {\n              "path": "$.initial-registration.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            },\n            {\n              "path": "$.sms-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ]\n        ]\n      }\n    },\n    {\n      "description": "default - password only",\n      "priority": 1,\n      "conditions": {},\n      "available_methods": ["password", "initial-registration"],\n      "success_conditions": {\n        "any_of": [\n          [\n            {\n              "path": "$.password-authentication.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ],\n          [\n            {\n              "path": "$.initial-registration.success_count",\n              "type": "integer",\n              "operation": "gte",\n              "value": 1\n            }\n          ]\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u52d5\u4f5c"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"admin-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 100 \u306b\u30de\u30c3\u30c1\uff08client_ids\u6761\u4ef6\u3001\u6700\u9ad8\u512a\u5148\u5ea6\uff09\n  \u2192 \u30ed\u30b0\u30a4\u30f3: \u30d1\u30b9\u30ef\u30fc\u30c9 + FIDO2\u5fc5\u9808\n  \u2192 \u767b\u9332: \u65b0\u898f\u767b\u9332 + FIDO2\u5fc5\u9808\n\nuser-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 50 \u306b\u30de\u30c3\u30c1\n  \u2192 \u30ed\u30b0\u30a4\u30f3: \u30d1\u30b9\u30ef\u30fc\u30c9 + SMS OTP\u5fc5\u9808\n  \u2192 \u767b\u9332: \u65b0\u898f\u767b\u9332 + SMS OTP\u5fc5\u9808\n\nother-app \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\n  \u2192 priority 1 \u306b\u30de\u30c3\u30c1\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u3001\u6700\u4f4e\u512a\u5148\u5ea6\uff09\n  \u2192 \u30ed\u30b0\u30a4\u30f3: \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f\n  \u2192 \u767b\u9332: \u65b0\u898f\u767b\u9332\u306e\u307f\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30b9\u30b3\u30fc\u30d7\u5225\u30dd\u30ea\u30b7\u30fc",children:"\u30b9\u30b3\u30fc\u30d7\u5225\u30dd\u30ea\u30b7\u30fc"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "description": "sensitive scope requires high auth",\n  "priority": 100,\n  "conditions": {\n    "scopes": ["admin", "delete", "update_sensitive"]\n  },\n  "available_methods": ["password", "initial-registration", "fido2"],\n  "success_conditions": {\n    "any_of": [\n      [\n        {\n          "path": "$.password-authentication.success_count",\n          "type": "integer",\n          "operation": "gte",\n          "value": 1\n        },\n        {\n          "path": "$.fido2-authentication.success_count",\n          "type": "integer",\n          "operation": "gte",\n          "value": 1\n        }\n      ],\n      [\n        {\n          "path": "$.initial-registration.success_count",\n          "type": "integer",\n          "operation": "gte",\n          "value": 1\n        },\n        {\n          "path": "$.fido2-authentication.success_count",\n          "type": "integer",\n          "operation": "gte",\n          "value": 1\n        }\n      ]\n    ]\n  }\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u52d5\u4f5c"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{children:"scope=admin \u3092\u8981\u6c42\n  \u2192 priority 100 \u306b\u30de\u30c3\u30c1\uff08\u6700\u9ad8\u512a\u5148\u5ea6\uff09\n  \u2192 \u30ed\u30b0\u30a4\u30f3: \u30d1\u30b9\u30ef\u30fc\u30c9 + FIDO2\u5fc5\u9808\uff08\u9ad8\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\uff09\n  \u2192 \u767b\u9332: \u65b0\u898f\u767b\u9332 + FIDO2\u5fc5\u9808\n\nscope=read \u3092\u8981\u6c42\n  \u2192 \u30de\u30c3\u30c1\u305b\u305a\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u30dd\u30ea\u30b7\u30fc\uff08\u4f4e\u3044priority\uff09\n  \u2192 \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u307f \u307e\u305f\u306f \u65b0\u898f\u767b\u9332\u306e\u307f\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc",children:"\u3088\u304f\u3042\u308b\u30a8\u30e9\u30fc"}),"\n",(0,c.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc1-\u6761\u4ef6\u5f0f\u306e\u69cb\u6587\u30a8\u30e9\u30fc",children:"\u30a8\u30e9\u30fc1: \u6761\u4ef6\u5f0f\u306e\u69cb\u6587\u30a8\u30e9\u30fc"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "error": "invalid_policy",\n  "error_description": "Invalid JSONPath expression"\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u539f\u56e0"}),": JSONPath\u69cb\u6587\u304c\u9593\u9055\u3063\u3066\u3044\u308b"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u4f8b"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'// \u274c \u9593\u9055\u3044\n"path": "password-authentication.success_count"  // $ \u304c\u306a\u3044\n\n// \u2705 \u6b63\u3057\u3044\n"path": "$.password-authentication.success_count"\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc2-any_of\u306e\u69cb\u9020\u30df\u30b9",children:"\u30a8\u30e9\u30fc2: any_of\u306e\u69cb\u9020\u30df\u30b9"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "error": "invalid_policy",\n  "error_description": "success_conditions must have \'any_of\'"\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u539f\u56e0"}),": ",(0,c.jsx)(e.code,{children:"any_of"}),"\u306e\u4e8c\u91cd\u914d\u5217\u3092\u5fd8\u308c\u3066\u3044\u308b\u3001\u307e\u305f\u306f ",(0,c.jsx)(e.code,{children:"any_of"})," \u30d5\u30a3\u30fc\u30eb\u30c9\u81ea\u4f53\u304c\u306a\u3044"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u4f8b"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'// \u274c \u9593\u9055\u3044: \u5358\u4e00\u914d\u5217\n"any_of": [\n  {\n    "path": "$.password-authentication.success_count",\n    ...\n  }\n]\n\n// \u2705 \u6b63\u3057\u3044: \u4e8c\u91cd\u914d\u5217\n"any_of": [\n  [\n    {\n      "path": "$.password-authentication.success_count",\n      ...\n    }\n  ]\n]\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"\u30a8\u30e9\u30fc3-failure_count\u3068lock_conditions\u306e\u9006\u8ee2",children:"\u30a8\u30e9\u30fc3: failure_count\u3068lock_conditions\u306e\u9006\u8ee2"}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u30a8\u30e9\u30fc"}),": \u30ed\u30c3\u30af\u3055\u308c\u308b\u524d\u306b\u8a8d\u8a3c\u5931\u6557\u30a8\u30e9\u30fc\u306b\u306a\u3063\u3066\u3057\u307e\u3046"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u539f\u56e0"}),":"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"failure_conditions": {\n  "any_of": [[\n    { "path": "$.password-authentication.failure_count", "operation": "gte", "value": 5 }\n  ]]\n},\n"lock_conditions": {\n  "any_of": [[\n    { "path": "$.password-authentication.failure_count", "operation": "gte", "value": 3 }\n  ]]\n}\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u554f\u984c"}),": 3\u56de\u5931\u6557\u3067\u30ed\u30c3\u30af\u30015\u56de\u5931\u6557\u3067\u8a8d\u8a3c\u5931\u6557 \u2192 \u30ed\u30c3\u30af\u304c\u5148\u306b\u767a\u52d5\u3057\u30665\u56de\u306b\u5230\u9054\u3057\u306a\u3044"]}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u89e3\u6c7a\u7b56"}),": lock_conditions \u306e\u5024 > failure_conditions \u306e\u5024"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'"failure_conditions": { "value": 3 },  // \u5148\u306b\u767a\u52d5\n"lock_conditions": { "value": 5 }      // \u5f8c\u306b\u767a\u52d5\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7",children:"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7"}),"\n",(0,c.jsx)(e.p,{children:"\u2705 \u8907\u96d1\u306a\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3057\u305f\uff01"}),"\n",(0,c.jsx)(e.h3,{id:"\u3055\u3089\u306b\u9ad8\u5ea6\u306a\u8a2d\u5b9a",children:"\u3055\u3089\u306b\u9ad8\u5ea6\u306a\u8a2d\u5b9a"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.a,{href:"/idp-server/docs/content_05_how-to/phase-3-advanced/fido-uaf/ciba-flow",children:"How-to: CIBA\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc"})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.a,{href:"/idp-server/docs/content_05_how-to/phase-3-advanced/fido-uaf/registration",children:"How-to: FIDO UAF\u767b\u9332\u30dd\u30ea\u30b7\u30fc"})}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8",children:"\u95a2\u9023\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"../content_03_concepts/03-authentication-authorization/concept-01-authentication-policy.md",children:"Concept: \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc"})," - \u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u6982\u5ff5"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"../content_06_developer-guide/03-application-plane/04-authentication.md",children:"Developer Guide: Authentication\u5b9f\u88c5"})," - \u5b9f\u88c5\u8a73\u7d30"]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.a,{href:"../content_06_developer-guide/04-implementation-guides/impl-05-authentication-policy.md",children:"Implementation Guide: Authentication Policy"})," - \u5185\u90e8\u5b9f\u88c5"]}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.strong,{children:"\u6700\u7d42\u66f4\u65b0"}),": 2025-01-19\n",(0,c.jsx)(e.strong,{children:"\u96e3\u6613\u5ea6"}),": \u2b50\u2b50\u2b50\u2b50\u2606\uff08\u4e2d\u7d1a\u301c\u4e0a\u7d1a\uff09\n",(0,c.jsx)(e.strong,{children:"\u5bfe\u8c61"}),": \u8907\u96d1\u306a\u8a8d\u8a3c\u30dd\u30ea\u30b7\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u7ba1\u7406\u8005\u30fb\u958b\u767a\u8005\n",(0,c.jsx)(e.strong,{children:"\u7fd2\u5f97\u30b9\u30ad\u30eb"}),": JSONPath\u6761\u4ef6\u5f0f\u3001any_of\u6761\u4ef6\u5f0f\u3001failure_conditions\u3001lock_conditions\u3001step_definitions\u3001ACR\u30de\u30c3\u30d4\u30f3\u30b0\u8a73\u7d30"]})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(a,{...n})}):a(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>d});var i=s(96540);const c={},r=i.createContext(c);function t(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:t(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);